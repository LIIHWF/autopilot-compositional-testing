var VB=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Wme=VB((npe,Sp)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function f0(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const xt={},Ec=[],js=()=>{},WB=()=>!1,Pw=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),g0=t=>t.startsWith("onUpdate:"),rr=Object.assign,m0=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},BB=Object.prototype.hasOwnProperty,gt=(t,e)=>BB.call(t,e),Ae=Array.isArray,Tc=t=>If(t)==="[object Map]",Ow=t=>If(t)==="[object Set]",DM=t=>If(t)==="[object Date]",ke=t=>typeof t=="function",yn=t=>typeof t=="string",Xi=t=>typeof t=="symbol",$t=t=>t!==null&&typeof t=="object",UD=t=>($t(t)||ke(t))&&ke(t.then)&&ke(t.catch),zD=Object.prototype.toString,If=t=>zD.call(t),jB=t=>If(t).slice(8,-1),YD=t=>If(t)==="[object Object]",p0=t=>yn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Md=f0(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Aw=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},UB=/-(\w)/g,Fa=Aw(t=>t.replace(UB,(e,n)=>n?n.toUpperCase():"")),zB=/\B([A-Z])/g,gu=Aw(t=>t.replace(zB,"-$1").toLowerCase()),GD=Aw(t=>t.charAt(0).toUpperCase()+t.slice(1)),qC=Aw(t=>t?`on${GD(t)}`:""),Aa=(t,e)=>!Object.is(t,e),qm=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},qD=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},Rp=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let LM;const Hw=()=>LM||(LM=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function w0(t){if(Ae(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],i=yn(r)?KB(r):w0(r);if(i)for(const s in i)e[s]=i[s]}return e}else if(yn(t)||$t(t))return t}const YB=/;(?![^(]*\))/g,GB=/:([^]+)/,qB=/\/\*[^]*?\*\//g;function KB(t){const e={};return t.replace(qB,"").split(YB).forEach(n=>{if(n){const r=n.split(GB);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Us(t){let e="";if(yn(t))e=t;else if(Ae(t))for(let n=0;n<t.length;n++){const r=Us(t[n]);r&&(e+=r+" ")}else if($t(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const XB="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ZB=f0(XB);function KD(t){return!!t||t===""}function JB(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=Nw(t[r],e[r]);return n}function Nw(t,e){if(t===e)return!0;let n=DM(t),r=DM(e);if(n||r)return n&&r?t.getTime()===e.getTime():!1;if(n=Xi(t),r=Xi(e),n||r)return t===e;if(n=Ae(t),r=Ae(e),n||r)return n&&r?JB(t,e):!1;if(n=$t(t),r=$t(e),n||r){if(!n||!r)return!1;const i=Object.keys(t).length,s=Object.keys(e).length;if(i!==s)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Nw(t[o],e[o]))return!1}}return String(t)===String(e)}function QB(t,e){return t.findIndex(n=>Nw(n,e))}const XD=t=>!!(t&&t.__v_isRef===!0),Tn=t=>yn(t)?t:t==null?"":Ae(t)||$t(t)&&(t.toString===zD||!ke(t.toString))?XD(t)?Tn(t.value):JSON.stringify(t,ZD,2):String(t),ZD=(t,e)=>XD(e)?ZD(t,e.value):Tc(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,i],s)=>(n[KC(r,s)+" =>"]=i,n),{})}:Ow(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>KC(n))}:Xi(e)?KC(e):$t(e)&&!Ae(e)&&!YD(e)?String(e):e,KC=(t,e="")=>{var n;return Xi(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Yr;class ej{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Yr,!e&&Yr&&(this.index=(Yr.scopes||(Yr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Yr;try{return Yr=this,e()}finally{Yr=n}}}on(){Yr=this}off(){Yr=this.parent}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function tj(){return Yr}let At;const XC=new WeakSet;class JD{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Yr&&Yr.active&&Yr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,XC.has(this)&&(XC.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||eL(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,kM(this),tL(this);const e=At,n=Yi;At=this,Yi=!0;try{return this.fn()}finally{nL(this),At=e,Yi=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)v0(e);this.deps=this.depsTail=void 0,kM(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?XC.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){KR(this)&&this.run()}get dirty(){return KR(this)}}let QD=0,Id,Pd;function eL(t,e=!1){if(t.flags|=8,e){t.next=Pd,Pd=t;return}t.next=Id,Id=t}function C0(){QD++}function y0(){if(--QD>0)return;if(Pd){let e=Pd;for(Pd=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Id;){let e=Id;for(Id=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function tL(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function nL(t){let e,n=t.depsTail,r=n;for(;r;){const i=r.prevDep;r.version===-1?(r===n&&(n=i),v0(r),nj(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}t.deps=e,t.depsTail=n}function KR(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(rL(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function rL(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===nf))return;t.globalVersion=nf;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!KR(t)){t.flags&=-3;return}const n=At,r=Yi;At=t,Yi=!0;try{tL(t);const i=t.fn(t._value);(e.version===0||Aa(i,t._value))&&(t._value=i,e.version++)}catch(i){throw e.version++,i}finally{At=n,Yi=r,nL(t),t.flags&=-3}}function v0(t,e=!1){const{dep:n,prevSub:r,nextSub:i}=t;if(r&&(r.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let s=n.computed.deps;s;s=s.nextDep)v0(s,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function nj(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Yi=!0;const iL=[];function za(){iL.push(Yi),Yi=!1}function Ya(){const t=iL.pop();Yi=t===void 0?!0:t}function kM(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=At;At=void 0;try{e()}finally{At=n}}}let nf=0;class rj{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class b0{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!At||!Yi||At===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==At)n=this.activeLink=new rj(At,this),At.deps?(n.prevDep=At.depsTail,At.depsTail.nextDep=n,At.depsTail=n):At.deps=At.depsTail=n,sL(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=At.depsTail,n.nextDep=void 0,At.depsTail.nextDep=n,At.depsTail=n,At.deps===n&&(At.deps=r)}return n}trigger(e){this.version++,nf++,this.notify(e)}notify(e){C0();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{y0()}}}function sL(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)sL(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const XR=new WeakMap,eu=Symbol(""),ZR=Symbol(""),rf=Symbol("");function Xn(t,e,n){if(Yi&&At){let r=XR.get(t);r||XR.set(t,r=new Map);let i=r.get(n);i||(r.set(n,i=new b0),i.map=r,i.key=n),i.track()}}function xo(t,e,n,r,i,s){const o=XR.get(t);if(!o){nf++;return}const a=l=>{l&&l.trigger()};if(C0(),e==="clear")o.forEach(a);else{const l=Ae(t),u=l&&p0(n);if(l&&n==="length"){const c=Number(r);o.forEach((h,d)=>{(d==="length"||d===rf||!Xi(d)&&d>=c)&&a(h)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),u&&a(o.get(rf)),e){case"add":l?u&&a(o.get("length")):(a(o.get(eu)),Tc(t)&&a(o.get(ZR)));break;case"delete":l||(a(o.get(eu)),Tc(t)&&a(o.get(ZR)));break;case"set":Tc(t)&&a(o.get(eu));break}}y0()}function _u(t){const e=ft(t);return e===t?e:(Xn(e,"iterate",rf),Ci(t)?e:e.map(Zn))}function Dw(t){return Xn(t=ft(t),"iterate",rf),t}const ij={__proto__:null,[Symbol.iterator](){return ZC(this,Symbol.iterator,Zn)},concat(...t){return _u(this).concat(...t.map(e=>Ae(e)?_u(e):e))},entries(){return ZC(this,"entries",t=>(t[1]=Zn(t[1]),t))},every(t,e){return to(this,"every",t,e,void 0,arguments)},filter(t,e){return to(this,"filter",t,e,n=>n.map(Zn),arguments)},find(t,e){return to(this,"find",t,e,Zn,arguments)},findIndex(t,e){return to(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return to(this,"findLast",t,e,Zn,arguments)},findLastIndex(t,e){return to(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return to(this,"forEach",t,e,void 0,arguments)},includes(...t){return JC(this,"includes",t)},indexOf(...t){return JC(this,"indexOf",t)},join(t){return _u(this).join(t)},lastIndexOf(...t){return JC(this,"lastIndexOf",t)},map(t,e){return to(this,"map",t,e,void 0,arguments)},pop(){return mh(this,"pop")},push(...t){return mh(this,"push",t)},reduce(t,...e){return FM(this,"reduce",t,e)},reduceRight(t,...e){return FM(this,"reduceRight",t,e)},shift(){return mh(this,"shift")},some(t,e){return to(this,"some",t,e,void 0,arguments)},splice(...t){return mh(this,"splice",t)},toReversed(){return _u(this).toReversed()},toSorted(t){return _u(this).toSorted(t)},toSpliced(...t){return _u(this).toSpliced(...t)},unshift(...t){return mh(this,"unshift",t)},values(){return ZC(this,"values",Zn)}};function ZC(t,e,n){const r=Dw(t),i=r[e]();return r!==t&&!Ci(t)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.value&&(s.value=n(s.value)),s}),i}const sj=Array.prototype;function to(t,e,n,r,i,s){const o=Dw(t),a=o!==t&&!Ci(t),l=o[e];if(l!==sj[e]){const h=l.apply(t,s);return a?Zn(h):h}let u=n;o!==t&&(a?u=function(h,d){return n.call(this,Zn(h),d,t)}:n.length>2&&(u=function(h,d){return n.call(this,h,d,t)}));const c=l.call(o,u,r);return a&&i?i(c):c}function FM(t,e,n,r){const i=Dw(t);let s=n;return i!==t&&(Ci(t)?n.length>3&&(s=function(o,a,l){return n.call(this,o,a,l,t)}):s=function(o,a,l){return n.call(this,o,Zn(a),l,t)}),i[e](s,...r)}function JC(t,e,n){const r=ft(t);Xn(r,"iterate",rf);const i=r[e](...n);return(i===-1||i===!1)&&E0(n[0])?(n[0]=ft(n[0]),r[e](...n)):i}function mh(t,e,n=[]){za(),C0();const r=ft(t)[e].apply(t,n);return y0(),Ya(),r}const oj=f0("__proto__,__v_isRef,__isVue"),oL=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Xi));function aj(t){Xi(t)||(t=String(t));const e=ft(this);return Xn(e,"has",t),e.hasOwnProperty(t)}class aL{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const i=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return s;if(n==="__v_raw")return r===(i?s?wj:hL:s?cL:uL).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=Ae(e);if(!i){let l;if(o&&(l=ij[n]))return l;if(n==="hasOwnProperty")return aj}const a=Reflect.get(e,n,tr(e)?e:r);return(Xi(n)?oL.has(n):oj(n))||(i||Xn(e,"get",n),s)?a:tr(a)?o&&p0(n)?a:a.value:$t(a)?i?dL(a):Bc(a):a}}class lL extends aL{constructor(e=!1){super(!1,e)}set(e,n,r,i){let s=e[n];if(!this._isShallow){const l=iu(s);if(!Ci(r)&&!iu(r)&&(s=ft(s),r=ft(r)),!Ae(e)&&tr(s)&&!tr(r))return l?!1:(s.value=r,!0)}const o=Ae(e)&&p0(n)?Number(n)<e.length:gt(e,n),a=Reflect.set(e,n,r,tr(e)?e:i);return e===ft(i)&&(o?Aa(r,s)&&xo(e,"set",n,r):xo(e,"add",n,r)),a}deleteProperty(e,n){const r=gt(e,n);e[n];const i=Reflect.deleteProperty(e,n);return i&&r&&xo(e,"delete",n,void 0),i}has(e,n){const r=Reflect.has(e,n);return(!Xi(n)||!oL.has(n))&&Xn(e,"has",n),r}ownKeys(e){return Xn(e,"iterate",Ae(e)?"length":eu),Reflect.ownKeys(e)}}class lj extends aL{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const uj=new lL,cj=new lj,hj=new lL(!0),JR=t=>t,hg=t=>Reflect.getPrototypeOf(t);function dj(t,e,n){return function(...r){const i=this.__v_raw,s=ft(i),o=Tc(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,u=i[t](...r),c=n?JR:e?QR:Zn;return!e&&Xn(s,"iterate",l?ZR:eu),{next(){const{value:h,done:d}=u.next();return d?{value:h,done:d}:{value:a?[c(h[0]),c(h[1])]:c(h),done:d}},[Symbol.iterator](){return this}}}}function dg(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function fj(t,e){const n={get(i){const s=this.__v_raw,o=ft(s),a=ft(i);t||(Aa(i,a)&&Xn(o,"get",i),Xn(o,"get",a));const{has:l}=hg(o),u=e?JR:t?QR:Zn;if(l.call(o,i))return u(s.get(i));if(l.call(o,a))return u(s.get(a));s!==o&&s.get(i)},get size(){const i=this.__v_raw;return!t&&Xn(ft(i),"iterate",eu),Reflect.get(i,"size",i)},has(i){const s=this.__v_raw,o=ft(s),a=ft(i);return t||(Aa(i,a)&&Xn(o,"has",i),Xn(o,"has",a)),i===a?s.has(i):s.has(i)||s.has(a)},forEach(i,s){const o=this,a=o.__v_raw,l=ft(a),u=e?JR:t?QR:Zn;return!t&&Xn(l,"iterate",eu),a.forEach((c,h)=>i.call(s,u(c),u(h),o))}};return rr(n,t?{add:dg("add"),set:dg("set"),delete:dg("delete"),clear:dg("clear")}:{add(i){!e&&!Ci(i)&&!iu(i)&&(i=ft(i));const s=ft(this);return hg(s).has.call(s,i)||(s.add(i),xo(s,"add",i,i)),this},set(i,s){!e&&!Ci(s)&&!iu(s)&&(s=ft(s));const o=ft(this),{has:a,get:l}=hg(o);let u=a.call(o,i);u||(i=ft(i),u=a.call(o,i));const c=l.call(o,i);return o.set(i,s),u?Aa(s,c)&&xo(o,"set",i,s):xo(o,"add",i,s),this},delete(i){const s=ft(this),{has:o,get:a}=hg(s);let l=o.call(s,i);l||(i=ft(i),l=o.call(s,i)),a&&a.call(s,i);const u=s.delete(i);return l&&xo(s,"delete",i,void 0),u},clear(){const i=ft(this),s=i.size!==0,o=i.clear();return s&&xo(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=dj(i,t,e)}),n}function S0(t,e){const n=fj(t,e);return(r,i,s)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?r:Reflect.get(gt(n,i)&&i in r?n:r,i,s)}const gj={get:S0(!1,!1)},mj={get:S0(!1,!0)},pj={get:S0(!0,!1)},uL=new WeakMap,cL=new WeakMap,hL=new WeakMap,wj=new WeakMap;function Cj(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function yj(t){return t.__v_skip||!Object.isExtensible(t)?0:Cj(jB(t))}function Bc(t){return iu(t)?t:R0(t,!1,uj,gj,uL)}function vj(t){return R0(t,!1,hj,mj,cL)}function dL(t){return R0(t,!0,cj,pj,hL)}function R0(t,e,n,r,i){if(!$t(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=i.get(t);if(s)return s;const o=yj(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return i.set(t,a),a}function _c(t){return iu(t)?_c(t.__v_raw):!!(t&&t.__v_isReactive)}function iu(t){return!!(t&&t.__v_isReadonly)}function Ci(t){return!!(t&&t.__v_isShallow)}function E0(t){return t?!!t.__v_raw:!1}function ft(t){const e=t&&t.__v_raw;return e?ft(e):t}function fL(t){return!gt(t,"__v_skip")&&Object.isExtensible(t)&&qD(t,"__v_skip",!0),t}const Zn=t=>$t(t)?Bc(t):t,QR=t=>$t(t)?dL(t):t;function tr(t){return t?t.__v_isRef===!0:!1}function fi(t){return bj(t,!1)}function bj(t,e){return tr(t)?t:new Sj(t,e)}class Sj{constructor(e,n){this.dep=new b0,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:ft(e),this._value=n?e:Zn(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,r=this.__v_isShallow||Ci(e)||iu(e);e=r?e:ft(e),Aa(e,n)&&(this._rawValue=e,this._value=r?e:Zn(e),this.dep.trigger())}}function gL(t){return tr(t)?t.value:t}const Rj={get:(t,e,n)=>e==="__v_raw"?t:gL(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const i=t[e];return tr(i)&&!tr(n)?(i.value=n,!0):Reflect.set(t,e,n,r)}};function mL(t){return _c(t)?t:new Proxy(t,Rj)}class Ej{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new b0(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=nf-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&At!==this)return eL(this,!0),!0}get value(){const e=this.dep.track();return rL(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Tj(t,e,n=!1){let r,i;return ke(t)?r=t:(r=t.get,i=t.set),new Ej(r,i,n)}const fg={},Ep=new WeakMap;let $l;function _j(t,e=!1,n=$l){if(n){let r=Ep.get(n);r||Ep.set(n,r=[]),r.push(t)}}function xj(t,e,n=xt){const{immediate:r,deep:i,once:s,scheduler:o,augmentJob:a,call:l}=n,u=b=>i?b:Ci(b)||i===!1||i===0?Mo(b,1):Mo(b);let c,h,d,f,m=!1,y=!1;if(tr(t)?(h=()=>t.value,m=Ci(t)):_c(t)?(h=()=>u(t),m=!0):Ae(t)?(y=!0,m=t.some(b=>_c(b)||Ci(b)),h=()=>t.map(b=>{if(tr(b))return b.value;if(_c(b))return u(b);if(ke(b))return l?l(b,2):b()})):ke(t)?e?h=l?()=>l(t,2):t:h=()=>{if(d){za();try{d()}finally{Ya()}}const b=$l;$l=c;try{return l?l(t,3,[f]):t(f)}finally{$l=b}}:h=js,e&&i){const b=h,H=i===!0?1/0:i;h=()=>Mo(b(),H)}const C=tj(),T=()=>{c.stop(),C&&C.active&&m0(C.effects,c)};if(s&&e){const b=e;e=(...H)=>{b(...H),T()}}let x=y?new Array(t.length).fill(fg):fg;const O=b=>{if(!(!(c.flags&1)||!c.dirty&&!b))if(e){const H=c.run();if(i||m||(y?H.some((k,V)=>Aa(k,x[V])):Aa(H,x))){d&&d();const k=$l;$l=c;try{const V=[H,x===fg?void 0:y&&x[0]===fg?[]:x,f];l?l(e,3,V):e(...V),x=H}finally{$l=k}}}else c.run()};return a&&a(O),c=new JD(h),c.scheduler=o?()=>o(O,!1):O,f=b=>_j(b,!1,c),d=c.onStop=()=>{const b=Ep.get(c);if(b){if(l)l(b,4);else for(const H of b)H();Ep.delete(c)}},e?r?O(!0):x=c.run():o?o(O.bind(null,!0),!0):c.run(),T.pause=c.pause.bind(c),T.resume=c.resume.bind(c),T.stop=T,T}function Mo(t,e=1/0,n){if(e<=0||!$t(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,tr(t))Mo(t.value,e,n);else if(Ae(t))for(let r=0;r<t.length;r++)Mo(t[r],e,n);else if(Ow(t)||Tc(t))t.forEach(r=>{Mo(r,e,n)});else if(YD(t)){for(const r in t)Mo(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&Mo(t[r],e,n)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Pf(t,e,n,r){try{return r?t(...r):t()}catch(i){Lw(i,e,n)}}function Ys(t,e,n,r){if(ke(t)){const i=Pf(t,e,n,r);return i&&UD(i)&&i.catch(s=>{Lw(s,e,n)}),i}if(Ae(t)){const i=[];for(let s=0;s<t.length;s++)i.push(Ys(t[s],e,n,r));return i}}function Lw(t,e,n,r=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||xt;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const c=a.ec;if(c){for(let h=0;h<c.length;h++)if(c[h](t,l,u)===!1)return}a=a.parent}if(s){za(),Pf(s,null,10,[t,l,u]),Ya();return}}Mj(t,n,i,r,o)}function Mj(t,e,n,r=!0,i=!1){if(i)throw t;console.error(t)}const Cr=[];let Is=-1;const xc=[];let ma=null,uc=0;const pL=Promise.resolve();let Tp=null;function wL(t){const e=Tp||pL;return t?e.then(this?t.bind(this):t):e}function Ij(t){let e=Is+1,n=Cr.length;for(;e<n;){const r=e+n>>>1,i=Cr[r],s=sf(i);s<t||s===t&&i.flags&2?e=r+1:n=r}return e}function T0(t){if(!(t.flags&1)){const e=sf(t),n=Cr[Cr.length-1];!n||!(t.flags&2)&&e>=sf(n)?Cr.push(t):Cr.splice(Ij(e),0,t),t.flags|=1,CL()}}function CL(){Tp||(Tp=pL.then(vL))}function Pj(t){Ae(t)?xc.push(...t):ma&&t.id===-1?ma.splice(uc+1,0,t):t.flags&1||(xc.push(t),t.flags|=1),CL()}function $M(t,e,n=Is+1){for(;n<Cr.length;n++){const r=Cr[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;Cr.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function yL(t){if(xc.length){const e=[...new Set(xc)].sort((n,r)=>sf(n)-sf(r));if(xc.length=0,ma){ma.push(...e);return}for(ma=e,uc=0;uc<ma.length;uc++){const n=ma[uc];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}ma=null,uc=0}}const sf=t=>t.id==null?t.flags&2?-1:1/0:t.id;function vL(t){try{for(Is=0;Is<Cr.length;Is++){const e=Cr[Is];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Pf(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Is<Cr.length;Is++){const e=Cr[Is];e&&(e.flags&=-2)}Is=-1,Cr.length=0,yL(),Tp=null,(Cr.length||xc.length)&&vL()}}let er=null,bL=null;function _p(t){const e=er;return er=t,bL=t&&t.type.__scopeId||null,e}function Oj(t,e=er,n){if(!e||t._n)return t;const r=(...i)=>{r._d&&qM(-1);const s=_p(e);let o;try{o=t(...i)}finally{_p(s),r._d&&qM(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function qn(t,e){if(er===null)return t;const n=Vw(er),r=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[s,o,a,l=xt]=e[i];s&&(ke(s)&&(s={mounted:s,updated:s}),s.deep&&Mo(o),r.push({dir:s,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function Qa(t,e,n,r){const i=t.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let l=a.dir[r];l&&(za(),Ys(l,n,8,[t.el,a,t,e]),Ya())}}const Aj=Symbol("_vte"),Hj=t=>t.__isTeleport;function _0(t,e){t.shapeFlag&6&&t.component?(t.transition=e,_0(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function SL(t,e){return ke(t)?rr({name:t.name},e,{setup:t}):t}function RL(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function xp(t,e,n,r,i=!1){if(Ae(t)){t.forEach((m,y)=>xp(m,e&&(Ae(e)?e[y]:e),n,r,i));return}if(Mc(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&xp(t,e,n,r.component.subTree);return}const s=r.shapeFlag&4?Vw(r.component):r.el,o=i?null:s,{i:a,r:l}=t,u=e&&e.r,c=a.refs===xt?a.refs={}:a.refs,h=a.setupState,d=ft(h),f=h===xt?()=>!1:m=>gt(d,m);if(u!=null&&u!==l&&(yn(u)?(c[u]=null,f(u)&&(h[u]=null)):tr(u)&&(u.value=null)),ke(l))Pf(l,a,12,[o,c]);else{const m=yn(l),y=tr(l);if(m||y){const C=()=>{if(t.f){const T=m?f(l)?h[l]:c[l]:l.value;i?Ae(T)&&m0(T,s):Ae(T)?T.includes(s)||T.push(s):m?(c[l]=[s],f(l)&&(h[l]=c[l])):(l.value=[s],t.k&&(c[t.k]=l.value))}else m?(c[l]=o,f(l)&&(h[l]=o)):y&&(l.value=o,t.k&&(c[t.k]=o))};o?(C.id=-1,jr(C,n)):C()}}}Hw().requestIdleCallback;Hw().cancelIdleCallback;const Mc=t=>!!t.type.__asyncLoader,EL=t=>t.type.__isKeepAlive;function Nj(t,e){TL(t,"a",e)}function Dj(t,e){TL(t,"da",e)}function TL(t,e,n=yr){const r=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(kw(e,r,n),n){let i=n.parent;for(;i&&i.parent;)EL(i.parent.vnode)&&Lj(r,e,n,i),i=i.parent}}function Lj(t,e,n,r){const i=kw(e,t,r,!0);_L(()=>{m0(r[e],i)},n)}function kw(t,e,n=yr,r=!1){if(n){const i=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{za();const a=Of(n),l=Ys(e,n,t,o);return a(),Ya(),l});return r?i.unshift(s):i.push(s),s}}const Yo=t=>(e,n=yr)=>{(!af||t==="sp")&&kw(t,(...r)=>e(...r),n)},kj=Yo("bm"),Fj=Yo("m"),$j=Yo("bu"),Vj=Yo("u"),Wj=Yo("bum"),_L=Yo("um"),Bj=Yo("sp"),jj=Yo("rtg"),Uj=Yo("rtc");function zj(t,e=yr){kw("ec",t,e)}const Yj=Symbol.for("v-ndc");function tu(t,e,n,r){let i;const s=n,o=Ae(t);if(o||yn(t)){const a=o&&_c(t);let l=!1;a&&(l=!Ci(t),t=Dw(t)),i=new Array(t.length);for(let u=0,c=t.length;u<c;u++)i[u]=e(l?Zn(t[u]):t[u],u,void 0,s)}else if(typeof t=="number"){i=new Array(t);for(let a=0;a<t;a++)i[a]=e(a+1,a,void 0,s)}else if($t(t))if(t[Symbol.iterator])i=Array.from(t,(a,l)=>e(a,l,void 0,s));else{const a=Object.keys(t);i=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const c=a[l];i[l]=e(t[c],c,l,s)}}else i=[];return i}function Gj(t,e,n={},r,i){if(er.ce||er.parent&&Mc(er.parent)&&er.parent.ce)return Xe(),nu(_n,null,[Gi("slot",n,r)],64);let s=t[e];s&&s._c&&(s._d=!1),Xe();const o=s&&xL(s(n)),a=n.key||o&&o.key,l=nu(_n,{key:(a&&!Xi(a)?a:`_${e}`)+""},o||[],o&&t._===1?64:-2);return l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),s&&s._c&&(s._d=!0),l}function xL(t){return t.some(e=>M0(e)?!(e.type===$a||e.type===_n&&!xL(e.children)):!0)?t:null}const eE=t=>t?qL(t)?Vw(t):eE(t.parent):null,Od=rr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>eE(t.parent),$root:t=>eE(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>IL(t),$forceUpdate:t=>t.f||(t.f=()=>{T0(t.update)}),$nextTick:t=>t.n||(t.n=wL.bind(t.proxy)),$watch:t=>mU.bind(t)}),QC=(t,e)=>t!==xt&&!t.__isScriptSetup&&gt(t,e),qj={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:i,props:s,accessCache:o,type:a,appContext:l}=t;let u;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return i[e];case 4:return n[e];case 3:return s[e]}else{if(QC(r,e))return o[e]=1,r[e];if(i!==xt&&gt(i,e))return o[e]=2,i[e];if((u=t.propsOptions[0])&&gt(u,e))return o[e]=3,s[e];if(n!==xt&&gt(n,e))return o[e]=4,n[e];tE&&(o[e]=0)}}const c=Od[e];let h,d;if(c)return e==="$attrs"&&Xn(t.attrs,"get",""),c(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==xt&&gt(n,e))return o[e]=4,n[e];if(d=l.config.globalProperties,gt(d,e))return d[e]},set({_:t},e,n){const{data:r,setupState:i,ctx:s}=t;return QC(i,e)?(i[e]=n,!0):r!==xt&&gt(r,e)?(r[e]=n,!0):gt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:i,propsOptions:s}},o){let a;return!!n[o]||t!==xt&&gt(t,o)||QC(e,o)||(a=s[0])&&gt(a,o)||gt(r,o)||gt(Od,o)||gt(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:gt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function VM(t){return Ae(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let tE=!0;function Kj(t){const e=IL(t),n=t.proxy,r=t.ctx;tE=!1,e.beforeCreate&&WM(e.beforeCreate,t,"bc");const{data:i,computed:s,methods:o,watch:a,provide:l,inject:u,created:c,beforeMount:h,mounted:d,beforeUpdate:f,updated:m,activated:y,deactivated:C,beforeDestroy:T,beforeUnmount:x,destroyed:O,unmounted:b,render:H,renderTracked:k,renderTriggered:V,errorCaptured:U,serverPrefetch:Z,expose:Y,inheritAttrs:Q,components:ne,directives:ce,filters:ae}=e;if(u&&Xj(u,r,null),o)for(const me in o){const be=o[me];ke(be)&&(r[me]=be.bind(n))}if(i){const me=i.call(n,n);$t(me)&&(t.data=Bc(me))}if(tE=!0,s)for(const me in s){const be=s[me],st=ke(be)?be.bind(n,n):ke(be.get)?be.get.bind(n,n):js,Ht=!ke(be)&&ke(be.set)?be.set.bind(n):js,g=DU({get:st,set:Ht});Object.defineProperty(r,me,{enumerable:!0,configurable:!0,get:()=>g.value,set:w=>g.value=w})}if(a)for(const me in a)ML(a[me],r,n,me);if(l){const me=ke(l)?l.call(n):l;Reflect.ownKeys(me).forEach(be=>{nU(be,me[be])})}c&&WM(c,t,"c");function Le(me,be){Ae(be)?be.forEach(st=>me(st.bind(n))):be&&me(be.bind(n))}if(Le(kj,h),Le(Fj,d),Le($j,f),Le(Vj,m),Le(Nj,y),Le(Dj,C),Le(zj,U),Le(Uj,k),Le(jj,V),Le(Wj,x),Le(_L,b),Le(Bj,Z),Ae(Y))if(Y.length){const me=t.exposed||(t.exposed={});Y.forEach(be=>{Object.defineProperty(me,be,{get:()=>n[be],set:st=>n[be]=st})})}else t.exposed||(t.exposed={});H&&t.render===js&&(t.render=H),Q!=null&&(t.inheritAttrs=Q),ne&&(t.components=ne),ce&&(t.directives=ce),Z&&RL(t)}function Xj(t,e,n=js){Ae(t)&&(t=nE(t));for(const r in t){const i=t[r];let s;$t(i)?"default"in i?s=Km(i.from||r,i.default,!0):s=Km(i.from||r):s=Km(i),tr(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[r]=s}}function WM(t,e,n){Ys(Ae(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function ML(t,e,n,r){let i=r.includes(".")?jL(n,r):()=>n[r];if(yn(t)){const s=e[t];ke(s)&&Xm(i,s)}else if(ke(t))Xm(i,t.bind(n));else if($t(t))if(Ae(t))t.forEach(s=>ML(s,e,n,r));else{const s=ke(t.handler)?t.handler.bind(n):e[t.handler];ke(s)&&Xm(i,s,t)}}function IL(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let l;return a?l=a:!i.length&&!n&&!r?l=e:(l={},i.length&&i.forEach(u=>Mp(l,u,o,!0)),Mp(l,e,o)),$t(e)&&s.set(e,l),l}function Mp(t,e,n,r=!1){const{mixins:i,extends:s}=e;s&&Mp(t,s,n,!0),i&&i.forEach(o=>Mp(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=Zj[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Zj={data:BM,props:jM,emits:jM,methods:yd,computed:yd,beforeCreate:dr,created:dr,beforeMount:dr,mounted:dr,beforeUpdate:dr,updated:dr,beforeDestroy:dr,beforeUnmount:dr,destroyed:dr,unmounted:dr,activated:dr,deactivated:dr,errorCaptured:dr,serverPrefetch:dr,components:yd,directives:yd,watch:Qj,provide:BM,inject:Jj};function BM(t,e){return e?t?function(){return rr(ke(t)?t.call(this,this):t,ke(e)?e.call(this,this):e)}:e:t}function Jj(t,e){return yd(nE(t),nE(e))}function nE(t){if(Ae(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function dr(t,e){return t?[...new Set([].concat(t,e))]:e}function yd(t,e){return t?rr(Object.create(null),t,e):e}function jM(t,e){return t?Ae(t)&&Ae(e)?[...new Set([...t,...e])]:rr(Object.create(null),VM(t),VM(e??{})):e}function Qj(t,e){if(!t)return e;if(!e)return t;const n=rr(Object.create(null),t);for(const r in e)n[r]=dr(t[r],e[r]);return n}function PL(){return{app:null,config:{isNativeTag:WB,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let eU=0;function tU(t,e){return function(r,i=null){ke(r)||(r=rr({},r)),i!=null&&!$t(i)&&(i=null);const s=PL(),o=new WeakSet,a=[];let l=!1;const u=s.app={_uid:eU++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:LU,get config(){return s.config},set config(c){},use(c,...h){return o.has(c)||(c&&ke(c.install)?(o.add(c),c.install(u,...h)):ke(c)&&(o.add(c),c(u,...h))),u},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),u},component(c,h){return h?(s.components[c]=h,u):s.components[c]},directive(c,h){return h?(s.directives[c]=h,u):s.directives[c]},mount(c,h,d){if(!l){const f=u._ceVNode||Gi(r,i);return f.appContext=s,d===!0?d="svg":d===!1&&(d=void 0),t(f,c,d),l=!0,u._container=c,c.__vue_app__=u,Vw(f.component)}},onUnmount(c){a.push(c)},unmount(){l&&(Ys(a,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(c,h){return s.provides[c]=h,u},runWithContext(c){const h=Ic;Ic=u;try{return c()}finally{Ic=h}}};return u}}let Ic=null;function nU(t,e){if(yr){let n=yr.provides;const r=yr.parent&&yr.parent.provides;r===n&&(n=yr.provides=Object.create(r)),n[t]=e}}function Km(t,e,n=!1){const r=yr||er;if(r||Ic){const i=Ic?Ic._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return n&&ke(e)?e.call(r&&r.proxy):e}}const OL={},AL=()=>Object.create(OL),HL=t=>Object.getPrototypeOf(t)===OL;function rU(t,e,n,r=!1){const i={},s=AL();t.propsDefaults=Object.create(null),NL(t,e,i,s);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=r?i:vj(i):t.type.props?t.props=i:t.props=s,t.attrs=s}function iU(t,e,n,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=t,a=ft(i),[l]=t.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const c=t.vnode.dynamicProps;for(let h=0;h<c.length;h++){let d=c[h];if(Fw(t.emitsOptions,d))continue;const f=e[d];if(l)if(gt(s,d))f!==s[d]&&(s[d]=f,u=!0);else{const m=Fa(d);i[m]=rE(l,a,m,f,t,!1)}else f!==s[d]&&(s[d]=f,u=!0)}}}else{NL(t,e,i,s)&&(u=!0);let c;for(const h in a)(!e||!gt(e,h)&&((c=gu(h))===h||!gt(e,c)))&&(l?n&&(n[h]!==void 0||n[c]!==void 0)&&(i[h]=rE(l,a,h,void 0,t,!0)):delete i[h]);if(s!==a)for(const h in s)(!e||!gt(e,h))&&(delete s[h],u=!0)}u&&xo(t.attrs,"set","")}function NL(t,e,n,r){const[i,s]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(Md(l))continue;const u=e[l];let c;i&&gt(i,c=Fa(l))?!s||!s.includes(c)?n[c]=u:(a||(a={}))[c]=u:Fw(t.emitsOptions,l)||(!(l in r)||u!==r[l])&&(r[l]=u,o=!0)}if(s){const l=ft(n),u=a||xt;for(let c=0;c<s.length;c++){const h=s[c];n[h]=rE(i,l,h,u[h],t,!gt(u,h))}}return o}function rE(t,e,n,r,i,s){const o=t[n];if(o!=null){const a=gt(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&ke(l)){const{propsDefaults:u}=i;if(n in u)r=u[n];else{const c=Of(i);r=u[n]=l.call(null,e),c()}}else r=l;i.ce&&i.ce._setProp(n,r)}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===gu(n))&&(r=!0))}return r}const sU=new WeakMap;function DL(t,e,n=!1){const r=n?sU:e.propsCache,i=r.get(t);if(i)return i;const s=t.props,o={},a=[];let l=!1;if(!ke(t)){const c=h=>{l=!0;const[d,f]=DL(h,e,!0);rr(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!s&&!l)return $t(t)&&r.set(t,Ec),Ec;if(Ae(s))for(let c=0;c<s.length;c++){const h=Fa(s[c]);UM(h)&&(o[h]=xt)}else if(s)for(const c in s){const h=Fa(c);if(UM(h)){const d=s[c],f=o[h]=Ae(d)||ke(d)?{type:d}:rr({},d),m=f.type;let y=!1,C=!0;if(Ae(m))for(let T=0;T<m.length;++T){const x=m[T],O=ke(x)&&x.name;if(O==="Boolean"){y=!0;break}else O==="String"&&(C=!1)}else y=ke(m)&&m.name==="Boolean";f[0]=y,f[1]=C,(y||gt(f,"default"))&&a.push(h)}}const u=[o,a];return $t(t)&&r.set(t,u),u}function UM(t){return t[0]!=="$"&&!Md(t)}const LL=t=>t[0]==="_"||t==="$stable",x0=t=>Ae(t)?t.map(ks):[ks(t)],oU=(t,e,n)=>{if(e._n)return e;const r=Oj((...i)=>x0(e(...i)),n);return r._c=!1,r},kL=(t,e,n)=>{const r=t._ctx;for(const i in t){if(LL(i))continue;const s=t[i];if(ke(s))e[i]=oU(i,s,r);else if(s!=null){const o=x0(s);e[i]=()=>o}}},FL=(t,e)=>{const n=x0(e);t.slots.default=()=>n},$L=(t,e,n)=>{for(const r in e)(n||r!=="_")&&(t[r]=e[r])},aU=(t,e,n)=>{const r=t.slots=AL();if(t.vnode.shapeFlag&32){const i=e._;i?($L(r,e,n),n&&qD(r,"_",i,!0)):kL(e,r)}else e&&FL(t,e)},lU=(t,e,n)=>{const{vnode:r,slots:i}=t;let s=!0,o=xt;if(r.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:$L(i,e,n):(s=!e.$stable,kL(e,i)),o=e}else e&&(FL(t,e),o={default:1});if(s)for(const a in i)!LL(a)&&o[a]==null&&delete i[a]},jr=SU;function uU(t){return cU(t)}function cU(t,e){const n=Hw();n.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:a,createComment:l,setText:u,setElementText:c,parentNode:h,nextSibling:d,setScopeId:f=js,insertStaticContent:m}=t,y=(p,v,E,I=null,N=null,M=null,A=void 0,L=null,D=!!v.dynamicChildren)=>{if(p===v)return;p&&!ph(p,v)&&(I=J(p),w(p,N,M,!0),p=null),v.patchFlag===-2&&(D=!1,v.dynamicChildren=null);const{type:$,ref:q,shapeFlag:G}=v;switch($){case $w:C(p,v,E,I);break;case $a:T(p,v,E,I);break;case Zm:p==null&&x(v,E,I,A);break;case _n:ne(p,v,E,I,N,M,A,L,D);break;default:G&1?H(p,v,E,I,N,M,A,L,D):G&6?ce(p,v,E,I,N,M,A,L,D):(G&64||G&128)&&$.process(p,v,E,I,N,M,A,L,D,S)}q!=null&&N&&xp(q,p&&p.ref,M,v||p,!v)},C=(p,v,E,I)=>{if(p==null)r(v.el=a(v.children),E,I);else{const N=v.el=p.el;v.children!==p.children&&u(N,v.children)}},T=(p,v,E,I)=>{p==null?r(v.el=l(v.children||""),E,I):v.el=p.el},x=(p,v,E,I)=>{[p.el,p.anchor]=m(p.children,v,E,I,p.el,p.anchor)},O=({el:p,anchor:v},E,I)=>{let N;for(;p&&p!==v;)N=d(p),r(p,E,I),p=N;r(v,E,I)},b=({el:p,anchor:v})=>{let E;for(;p&&p!==v;)E=d(p),i(p),p=E;i(v)},H=(p,v,E,I,N,M,A,L,D)=>{v.type==="svg"?A="svg":v.type==="math"&&(A="mathml"),p==null?k(v,E,I,N,M,A,L,D):Z(p,v,N,M,A,L,D)},k=(p,v,E,I,N,M,A,L)=>{let D,$;const{props:q,shapeFlag:G,transition:te,dirs:oe}=p;if(D=p.el=o(p.type,M,q&&q.is,q),G&8?c(D,p.children):G&16&&U(p.children,D,null,I,N,ey(p,M),A,L),oe&&Qa(p,null,I,"created"),V(D,p,p.scopeId,A,I),q){for(const le in q)le!=="value"&&!Md(le)&&s(D,le,null,q[le],M,I);"value"in q&&s(D,"value",null,q.value,M),($=q.onVnodeBeforeMount)&&ls($,I,p)}oe&&Qa(p,null,I,"beforeMount");const pe=hU(N,te);pe&&te.beforeEnter(D),r(D,v,E),(($=q&&q.onVnodeMounted)||pe||oe)&&jr(()=>{$&&ls($,I,p),pe&&te.enter(D),oe&&Qa(p,null,I,"mounted")},N)},V=(p,v,E,I,N)=>{if(E&&f(p,E),I)for(let M=0;M<I.length;M++)f(p,I[M]);if(N){let M=N.subTree;if(v===M||zL(M.type)&&(M.ssContent===v||M.ssFallback===v)){const A=N.vnode;V(p,A,A.scopeId,A.slotScopeIds,N.parent)}}},U=(p,v,E,I,N,M,A,L,D=0)=>{for(let $=D;$<p.length;$++){const q=p[$]=L?pa(p[$]):ks(p[$]);y(null,q,v,E,I,N,M,A,L)}},Z=(p,v,E,I,N,M,A)=>{const L=v.el=p.el;let{patchFlag:D,dynamicChildren:$,dirs:q}=v;D|=p.patchFlag&16;const G=p.props||xt,te=v.props||xt;let oe;if(E&&el(E,!1),(oe=te.onVnodeBeforeUpdate)&&ls(oe,E,v,p),q&&Qa(v,p,E,"beforeUpdate"),E&&el(E,!0),(G.innerHTML&&te.innerHTML==null||G.textContent&&te.textContent==null)&&c(L,""),$?Y(p.dynamicChildren,$,L,E,I,ey(v,N),M):A||be(p,v,L,null,E,I,ey(v,N),M,!1),D>0){if(D&16)Q(L,G,te,E,N);else if(D&2&&G.class!==te.class&&s(L,"class",null,te.class,N),D&4&&s(L,"style",G.style,te.style,N),D&8){const pe=v.dynamicProps;for(let le=0;le<pe.length;le++){const de=pe[le],Ze=G[de],It=te[de];(It!==Ze||de==="value")&&s(L,de,Ze,It,N,E)}}D&1&&p.children!==v.children&&c(L,v.children)}else!A&&$==null&&Q(L,G,te,E,N);((oe=te.onVnodeUpdated)||q)&&jr(()=>{oe&&ls(oe,E,v,p),q&&Qa(v,p,E,"updated")},I)},Y=(p,v,E,I,N,M,A)=>{for(let L=0;L<v.length;L++){const D=p[L],$=v[L],q=D.el&&(D.type===_n||!ph(D,$)||D.shapeFlag&70)?h(D.el):E;y(D,$,q,null,I,N,M,A,!0)}},Q=(p,v,E,I,N)=>{if(v!==E){if(v!==xt)for(const M in v)!Md(M)&&!(M in E)&&s(p,M,v[M],null,N,I);for(const M in E){if(Md(M))continue;const A=E[M],L=v[M];A!==L&&M!=="value"&&s(p,M,L,A,N,I)}"value"in E&&s(p,"value",v.value,E.value,N)}},ne=(p,v,E,I,N,M,A,L,D)=>{const $=v.el=p?p.el:a(""),q=v.anchor=p?p.anchor:a("");let{patchFlag:G,dynamicChildren:te,slotScopeIds:oe}=v;oe&&(L=L?L.concat(oe):oe),p==null?(r($,E,I),r(q,E,I),U(v.children||[],E,q,N,M,A,L,D)):G>0&&G&64&&te&&p.dynamicChildren?(Y(p.dynamicChildren,te,E,N,M,A,L),(v.key!=null||N&&v===N.subTree)&&VL(p,v,!0)):be(p,v,E,q,N,M,A,L,D)},ce=(p,v,E,I,N,M,A,L,D)=>{v.slotScopeIds=L,p==null?v.shapeFlag&512?N.ctx.activate(v,E,I,A,D):ae(v,E,I,N,M,A,D):ye(p,v,D)},ae=(p,v,E,I,N,M,A)=>{const L=p.component=IU(p,I,N);if(EL(p)&&(L.ctx.renderer=S),PU(L,!1,A),L.asyncDep){if(N&&N.registerDep(L,Le,A),!p.el){const D=L.subTree=Gi($a);T(null,D,v,E)}}else Le(L,p,v,E,N,M,A)},ye=(p,v,E)=>{const I=v.component=p.component;if(vU(p,v,E))if(I.asyncDep&&!I.asyncResolved){me(I,v,E);return}else I.next=v,I.update();else v.el=p.el,I.vnode=v},Le=(p,v,E,I,N,M,A)=>{const L=()=>{if(p.isMounted){let{next:G,bu:te,u:oe,parent:pe,vnode:le}=p;{const Ct=WL(p);if(Ct){G&&(G.el=le.el,me(p,G,A)),Ct.asyncDep.then(()=>{p.isUnmounted||L()});return}}let de=G,Ze;el(p,!1),G?(G.el=le.el,me(p,G,A)):G=le,te&&qm(te),(Ze=G.props&&G.props.onVnodeBeforeUpdate)&&ls(Ze,pe,G,le),el(p,!0);const It=YM(p),cn=p.subTree;p.subTree=It,y(cn,It,h(cn.el),J(cn),p,N,M),G.el=It.el,de===null&&bU(p,It.el),oe&&jr(oe,N),(Ze=G.props&&G.props.onVnodeUpdated)&&jr(()=>ls(Ze,pe,G,le),N)}else{let G;const{el:te,props:oe}=v,{bm:pe,m:le,parent:de,root:Ze,type:It}=p,cn=Mc(v);el(p,!1),pe&&qm(pe),!cn&&(G=oe&&oe.onVnodeBeforeMount)&&ls(G,de,v),el(p,!0);{Ze.ce&&Ze.ce._injectChildStyle(It);const Ct=p.subTree=YM(p);y(null,Ct,E,I,p,N,M),v.el=Ct.el}if(le&&jr(le,N),!cn&&(G=oe&&oe.onVnodeMounted)){const Ct=v;jr(()=>ls(G,de,Ct),N)}(v.shapeFlag&256||de&&Mc(de.vnode)&&de.vnode.shapeFlag&256)&&p.a&&jr(p.a,N),p.isMounted=!0,v=E=I=null}};p.scope.on();const D=p.effect=new JD(L);p.scope.off();const $=p.update=D.run.bind(D),q=p.job=D.runIfDirty.bind(D);q.i=p,q.id=p.uid,D.scheduler=()=>T0(q),el(p,!0),$()},me=(p,v,E)=>{v.component=p;const I=p.vnode.props;p.vnode=v,p.next=null,iU(p,v.props,I,E),lU(p,v.children,E),za(),$M(p),Ya()},be=(p,v,E,I,N,M,A,L,D=!1)=>{const $=p&&p.children,q=p?p.shapeFlag:0,G=v.children,{patchFlag:te,shapeFlag:oe}=v;if(te>0){if(te&128){Ht($,G,E,I,N,M,A,L,D);return}else if(te&256){st($,G,E,I,N,M,A,L,D);return}}oe&8?(q&16&&z($,N,M),G!==$&&c(E,G)):q&16?oe&16?Ht($,G,E,I,N,M,A,L,D):z($,N,M,!0):(q&8&&c(E,""),oe&16&&U(G,E,I,N,M,A,L,D))},st=(p,v,E,I,N,M,A,L,D)=>{p=p||Ec,v=v||Ec;const $=p.length,q=v.length,G=Math.min($,q);let te;for(te=0;te<G;te++){const oe=v[te]=D?pa(v[te]):ks(v[te]);y(p[te],oe,E,null,N,M,A,L,D)}$>q?z(p,N,M,!0,!1,G):U(v,E,I,N,M,A,L,D,G)},Ht=(p,v,E,I,N,M,A,L,D)=>{let $=0;const q=v.length;let G=p.length-1,te=q-1;for(;$<=G&&$<=te;){const oe=p[$],pe=v[$]=D?pa(v[$]):ks(v[$]);if(ph(oe,pe))y(oe,pe,E,null,N,M,A,L,D);else break;$++}for(;$<=G&&$<=te;){const oe=p[G],pe=v[te]=D?pa(v[te]):ks(v[te]);if(ph(oe,pe))y(oe,pe,E,null,N,M,A,L,D);else break;G--,te--}if($>G){if($<=te){const oe=te+1,pe=oe<q?v[oe].el:I;for(;$<=te;)y(null,v[$]=D?pa(v[$]):ks(v[$]),E,pe,N,M,A,L,D),$++}}else if($>te)for(;$<=G;)w(p[$],N,M,!0),$++;else{const oe=$,pe=$,le=new Map;for($=pe;$<=te;$++){const ze=v[$]=D?pa(v[$]):ks(v[$]);ze.key!=null&&le.set(ze.key,$)}let de,Ze=0;const It=te-pe+1;let cn=!1,Ct=0;const Pt=new Array(It);for($=0;$<It;$++)Pt[$]=0;for($=oe;$<=G;$++){const ze=p[$];if(Ze>=It){w(ze,N,M,!0);continue}let Fe;if(ze.key!=null)Fe=le.get(ze.key);else for(de=pe;de<=te;de++)if(Pt[de-pe]===0&&ph(ze,v[de])){Fe=de;break}Fe===void 0?w(ze,N,M,!0):(Pt[Fe-pe]=$+1,Fe>=Ct?Ct=Fe:cn=!0,y(ze,v[Fe],E,null,N,M,A,L,D),Ze++)}const Nt=cn?dU(Pt):Ec;for(de=Nt.length-1,$=It-1;$>=0;$--){const ze=pe+$,Fe=v[ze],je=ze+1<q?v[ze+1].el:I;Pt[$]===0?y(null,Fe,E,je,N,M,A,L,D):cn&&(de<0||$!==Nt[de]?g(Fe,E,je,2):de--)}}},g=(p,v,E,I,N=null)=>{const{el:M,type:A,transition:L,children:D,shapeFlag:$}=p;if($&6){g(p.component.subTree,v,E,I);return}if($&128){p.suspense.move(v,E,I);return}if($&64){A.move(p,v,E,S);return}if(A===_n){r(M,v,E);for(let G=0;G<D.length;G++)g(D[G],v,E,I);r(p.anchor,v,E);return}if(A===Zm){O(p,v,E);return}if(I!==2&&$&1&&L)if(I===0)L.beforeEnter(M),r(M,v,E),jr(()=>L.enter(M),N);else{const{leave:G,delayLeave:te,afterLeave:oe}=L,pe=()=>r(M,v,E),le=()=>{G(M,()=>{pe(),oe&&oe()})};te?te(M,pe,le):le()}else r(M,v,E)},w=(p,v,E,I=!1,N=!1)=>{const{type:M,props:A,ref:L,children:D,dynamicChildren:$,shapeFlag:q,patchFlag:G,dirs:te,cacheIndex:oe}=p;if(G===-2&&(N=!1),L!=null&&xp(L,null,E,p,!0),oe!=null&&(v.renderCache[oe]=void 0),q&256){v.ctx.deactivate(p);return}const pe=q&1&&te,le=!Mc(p);let de;if(le&&(de=A&&A.onVnodeBeforeUnmount)&&ls(de,v,p),q&6)W(p.component,E,I);else{if(q&128){p.suspense.unmount(E,I);return}pe&&Qa(p,null,v,"beforeUnmount"),q&64?p.type.remove(p,v,E,S,I):$&&!$.hasOnce&&(M!==_n||G>0&&G&64)?z($,v,E,!1,!0):(M===_n&&G&384||!N&&q&16)&&z(D,v,E),I&&R(p)}(le&&(de=A&&A.onVnodeUnmounted)||pe)&&jr(()=>{de&&ls(de,v,p),pe&&Qa(p,null,v,"unmounted")},E)},R=p=>{const{type:v,el:E,anchor:I,transition:N}=p;if(v===_n){P(E,I);return}if(v===Zm){b(p);return}const M=()=>{i(E),N&&!N.persisted&&N.afterLeave&&N.afterLeave()};if(p.shapeFlag&1&&N&&!N.persisted){const{leave:A,delayLeave:L}=N,D=()=>A(E,M);L?L(p.el,M,D):D()}else M()},P=(p,v)=>{let E;for(;p!==v;)E=d(p),i(p),p=E;i(v)},W=(p,v,E)=>{const{bum:I,scope:N,job:M,subTree:A,um:L,m:D,a:$}=p;zM(D),zM($),I&&qm(I),N.stop(),M&&(M.flags|=8,w(A,p,v,E)),L&&jr(L,v),jr(()=>{p.isUnmounted=!0},v),v&&v.pendingBranch&&!v.isUnmounted&&p.asyncDep&&!p.asyncResolved&&p.suspenseId===v.pendingId&&(v.deps--,v.deps===0&&v.resolve())},z=(p,v,E,I=!1,N=!1,M=0)=>{for(let A=M;A<p.length;A++)w(p[A],v,E,I,N)},J=p=>{if(p.shapeFlag&6)return J(p.component.subTree);if(p.shapeFlag&128)return p.suspense.next();const v=d(p.anchor||p.el),E=v&&v[Aj];return E?d(E):v};let X=!1;const fe=(p,v,E)=>{p==null?v._vnode&&w(v._vnode,null,null,!0):y(v._vnode||null,p,v,null,null,null,E),v._vnode=p,X||(X=!0,$M(),yL(),X=!1)},S={p:y,um:w,m:g,r:R,mt:ae,mc:U,pc:be,pbc:Y,n:J,o:t};return{render:fe,hydrate:void 0,createApp:tU(fe)}}function ey({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function el({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function hU(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function VL(t,e,n=!1){const r=t.children,i=e.children;if(Ae(r)&&Ae(i))for(let s=0;s<r.length;s++){const o=r[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=pa(i[s]),a.el=o.el),!n&&a.patchFlag!==-2&&VL(o,a)),a.type===$w&&(a.el=o.el)}}function dU(t){const e=t.slice(),n=[0];let r,i,s,o,a;const l=t.length;for(r=0;r<l;r++){const u=t[r];if(u!==0){if(i=n[n.length-1],t[i]<u){e[r]=i,n.push(r);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<u?s=a+1:o=a;u<t[n[s]]&&(s>0&&(e[r]=n[s-1]),n[s]=r)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}function WL(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:WL(e)}function zM(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const fU=Symbol.for("v-scx"),gU=()=>Km(fU);function Xm(t,e,n){return BL(t,e,n)}function BL(t,e,n=xt){const{immediate:r,deep:i,flush:s,once:o}=n,a=rr({},n),l=e&&r||!e&&s!=="post";let u;if(af){if(s==="sync"){const f=gU();u=f.__watcherHandles||(f.__watcherHandles=[])}else if(!l){const f=()=>{};return f.stop=js,f.resume=js,f.pause=js,f}}const c=yr;a.call=(f,m,y)=>Ys(f,c,m,y);let h=!1;s==="post"?a.scheduler=f=>{jr(f,c&&c.suspense)}:s!=="sync"&&(h=!0,a.scheduler=(f,m)=>{m?f():T0(f)}),a.augmentJob=f=>{e&&(f.flags|=4),h&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const d=xj(t,e,a);return af&&(u?u.push(d):l&&d()),d}function mU(t,e,n){const r=this.proxy,i=yn(t)?t.includes(".")?jL(r,t):()=>r[t]:t.bind(r,r);let s;ke(e)?s=e:(s=e.handler,n=e);const o=Of(this),a=BL(i,s.bind(r),n);return o(),a}function jL(t,e){const n=e.split(".");return()=>{let r=t;for(let i=0;i<n.length&&r;i++)r=r[n[i]];return r}}const pU=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Fa(e)}Modifiers`]||t[`${gu(e)}Modifiers`];function wU(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||xt;let i=n;const s=e.startsWith("update:"),o=s&&pU(r,e.slice(7));o&&(o.trim&&(i=n.map(c=>yn(c)?c.trim():c)),o.number&&(i=n.map(Rp)));let a,l=r[a=qC(e)]||r[a=qC(Fa(e))];!l&&s&&(l=r[a=qC(gu(e))]),l&&Ys(l,t,6,i);const u=r[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Ys(u,t,6,i)}}function UL(t,e,n=!1){const r=e.emitsCache,i=r.get(t);if(i!==void 0)return i;const s=t.emits;let o={},a=!1;if(!ke(t)){const l=u=>{const c=UL(u,e,!0);c&&(a=!0,rr(o,c))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?($t(t)&&r.set(t,null),null):(Ae(s)?s.forEach(l=>o[l]=null):rr(o,s),$t(t)&&r.set(t,o),o)}function Fw(t,e){return!t||!Pw(e)?!1:(e=e.slice(2).replace(/Once$/,""),gt(t,e[0].toLowerCase()+e.slice(1))||gt(t,gu(e))||gt(t,e))}function YM(t){const{type:e,vnode:n,proxy:r,withProxy:i,propsOptions:[s],slots:o,attrs:a,emit:l,render:u,renderCache:c,props:h,data:d,setupState:f,ctx:m,inheritAttrs:y}=t,C=_p(t);let T,x;try{if(n.shapeFlag&4){const b=i||r,H=b;T=ks(u.call(H,b,c,h,f,d,m)),x=a}else{const b=e;T=ks(b.length>1?b(h,{attrs:a,slots:o,emit:l}):b(h,null)),x=e.props?a:CU(a)}}catch(b){Ad.length=0,Lw(b,t,1),T=Gi($a)}let O=T;if(x&&y!==!1){const b=Object.keys(x),{shapeFlag:H}=O;b.length&&H&7&&(s&&b.some(g0)&&(x=yU(x,s)),O=jc(O,x,!1,!0))}return n.dirs&&(O=jc(O,null,!1,!0),O.dirs=O.dirs?O.dirs.concat(n.dirs):n.dirs),n.transition&&_0(O,n.transition),T=O,_p(C),T}const CU=t=>{let e;for(const n in t)(n==="class"||n==="style"||Pw(n))&&((e||(e={}))[n]=t[n]);return e},yU=(t,e)=>{const n={};for(const r in t)(!g0(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function vU(t,e,n){const{props:r,children:i,component:s}=t,{props:o,children:a,patchFlag:l}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return r?GM(r,o,u):!!o;if(l&8){const c=e.dynamicProps;for(let h=0;h<c.length;h++){const d=c[h];if(o[d]!==r[d]&&!Fw(u,d))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?GM(r,o,u):!0:!!o;return!1}function GM(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==t[s]&&!Fw(n,s))return!0}return!1}function bU({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const zL=t=>t.__isSuspense;function SU(t,e){e&&e.pendingBranch?Ae(t)?e.effects.push(...t):e.effects.push(t):Pj(t)}const _n=Symbol.for("v-fgt"),$w=Symbol.for("v-txt"),$a=Symbol.for("v-cmt"),Zm=Symbol.for("v-stc"),Ad=[];let Zr=null;function Xe(t=!1){Ad.push(Zr=t?null:[])}function RU(){Ad.pop(),Zr=Ad[Ad.length-1]||null}let of=1;function qM(t,e=!1){of+=t,t<0&&Zr&&e&&(Zr.hasOnce=!0)}function YL(t){return t.dynamicChildren=of>0?Zr||Ec:null,RU(),of>0&&Zr&&Zr.push(t),t}function mt(t,e,n,r,i,s){return YL(j(t,e,n,r,i,s,!0))}function nu(t,e,n,r,i){return YL(Gi(t,e,n,r,i,!0))}function M0(t){return t?t.__v_isVNode===!0:!1}function ph(t,e){return t.type===e.type&&t.key===e.key}const GL=({key:t})=>t??null,Jm=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?yn(t)||tr(t)||ke(t)?{i:er,r:t,k:e,f:!!n}:t:null);function j(t,e=null,n=null,r=0,i=null,s=t===_n?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&GL(e),ref:e&&Jm(e),scopeId:bL,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:er};return a?(I0(l,n),s&128&&t.normalize(l)):n&&(l.shapeFlag|=yn(n)?8:16),of>0&&!o&&Zr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Zr.push(l),l}const Gi=EU;function EU(t,e=null,n=null,r=0,i=null,s=!1){if((!t||t===Yj)&&(t=$a),M0(t)){const a=jc(t,e,!0);return n&&I0(a,n),of>0&&!s&&Zr&&(a.shapeFlag&6?Zr[Zr.indexOf(t)]=a:Zr.push(a)),a.patchFlag=-2,a}if(NU(t)&&(t=t.__vccOpts),e){e=TU(e);let{class:a,style:l}=e;a&&!yn(a)&&(e.class=Us(a)),$t(l)&&(E0(l)&&!Ae(l)&&(l=rr({},l)),e.style=w0(l))}const o=yn(t)?1:zL(t)?128:Hj(t)?64:$t(t)?4:ke(t)?2:0;return j(t,e,n,r,i,o,s,!0)}function TU(t){return t?E0(t)||HL(t)?rr({},t):t:null}function jc(t,e,n=!1,r=!1){const{props:i,ref:s,patchFlag:o,children:a,transition:l}=t,u=e?_U(i||{},e):i,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&GL(u),ref:e&&e.ref?n&&s?Ae(s)?s.concat(Jm(e)):[s,Jm(e)]:Jm(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==_n?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&jc(t.ssContent),ssFallback:t.ssFallback&&jc(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&r&&_0(c,l.clone(c)),c}function ot(t=" ",e=0){return Gi($w,null,t,e)}function iE(t,e){const n=Gi(Zm,null,t);return n.staticCount=e,n}function Fo(t="",e=!1){return e?(Xe(),nu($a,null,t)):Gi($a,null,t)}function ks(t){return t==null||typeof t=="boolean"?Gi($a):Ae(t)?Gi(_n,null,t.slice()):M0(t)?pa(t):Gi($w,null,String(t))}function pa(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:jc(t)}function I0(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(Ae(e))n=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),I0(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!HL(e)?e._ctx=er:i===3&&er&&(er.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ke(e)?(e={default:e,_ctx:er},n=32):(e=String(e),r&64?(n=16,e=[ot(e)]):n=8);t.children=e,t.shapeFlag|=n}function _U(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=Us([e.class,r.class]));else if(i==="style")e.style=w0([e.style,r.style]);else if(Pw(i)){const s=e[i],o=r[i];o&&s!==o&&!(Ae(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function ls(t,e,n,r=null){Ys(t,e,7,[n,r])}const xU=PL();let MU=0;function IU(t,e,n){const r=t.type,i=(e?e.appContext:t.appContext)||xU,s={uid:MU++,vnode:t,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ej(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:DL(r,i),emitsOptions:UL(r,i),emit:null,emitted:null,propsDefaults:xt,inheritAttrs:r.inheritAttrs,ctx:xt,data:xt,props:xt,attrs:xt,slots:xt,refs:xt,setupState:xt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=wU.bind(null,s),t.ce&&t.ce(s),s}let yr=null,Ip,sE;{const t=Hw(),e=(n,r)=>{let i;return(i=t[n])||(i=t[n]=[]),i.push(r),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};Ip=e("__VUE_INSTANCE_SETTERS__",n=>yr=n),sE=e("__VUE_SSR_SETTERS__",n=>af=n)}const Of=t=>{const e=yr;return Ip(t),t.scope.on(),()=>{t.scope.off(),Ip(e)}},KM=()=>{yr&&yr.scope.off(),Ip(null)};function qL(t){return t.vnode.shapeFlag&4}let af=!1;function PU(t,e=!1,n=!1){e&&sE(e);const{props:r,children:i}=t.vnode,s=qL(t);rU(t,r,s,e),aU(t,i,n);const o=s?OU(t,e):void 0;return e&&sE(!1),o}function OU(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,qj);const{setup:r}=n;if(r){za();const i=t.setupContext=r.length>1?HU(t):null,s=Of(t),o=Pf(r,t,0,[t.props,i]),a=UD(o);if(Ya(),s(),(a||t.sp)&&!Mc(t)&&RL(t),a){if(o.then(KM,KM),e)return o.then(l=>{XM(t,l)}).catch(l=>{Lw(l,t,0)});t.asyncDep=o}else XM(t,o)}else KL(t)}function XM(t,e,n){ke(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:$t(e)&&(t.setupState=mL(e)),KL(t)}function KL(t,e,n){const r=t.type;t.render||(t.render=r.render||js);{const i=Of(t);za();try{Kj(t)}finally{Ya(),i()}}}const AU={get(t,e){return Xn(t,"get",""),t[e]}};function HU(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,AU),slots:t.slots,emit:t.emit,expose:e}}function Vw(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(mL(fL(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Od)return Od[n](t)},has(e,n){return n in e||n in Od}})):t.proxy}function NU(t){return ke(t)&&"__vccOpts"in t}const DU=(t,e)=>Tj(t,e,af),LU="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let oE;const ZM=typeof window<"u"&&window.trustedTypes;if(ZM)try{oE=ZM.createPolicy("vue",{createHTML:t=>t})}catch{}const XL=oE?t=>oE.createHTML(t):t=>t,kU="http://www.w3.org/2000/svg",FU="http://www.w3.org/1998/Math/MathML",bo=typeof document<"u"?document:null,JM=bo&&bo.createElement("template"),$U={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const i=e==="svg"?bo.createElementNS(kU,t):e==="mathml"?bo.createElementNS(FU,t):n?bo.createElement(t,{is:n}):bo.createElement(t);return t==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:t=>bo.createTextNode(t),createComment:t=>bo.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>bo.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,i,s){const o=n?n.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===s||!(i=i.nextSibling)););else{JM.innerHTML=XL(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const a=JM.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},VU=Symbol("_vtc");function WU(t,e,n){const r=t[VU];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const QM=Symbol("_vod"),BU=Symbol("_vsh"),jU=Symbol(""),UU=/(^|;)\s*display\s*:/;function zU(t,e,n){const r=t.style,i=yn(n);let s=!1;if(n&&!i){if(e)if(yn(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&Qm(r,a,"")}else for(const o in e)n[o]==null&&Qm(r,o,"");for(const o in n)o==="display"&&(s=!0),Qm(r,o,n[o])}else if(i){if(e!==n){const o=r[jU];o&&(n+=";"+o),r.cssText=n,s=UU.test(n)}}else e&&t.removeAttribute("style");QM in t&&(t[QM]=s?r.display:"",t[BU]&&(r.display="none"))}const eI=/\s*!important$/;function Qm(t,e,n){if(Ae(n))n.forEach(r=>Qm(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=YU(t,e);eI.test(n)?t.setProperty(gu(r),n.replace(eI,""),"important"):t[r]=n}}const tI=["Webkit","Moz","ms"],ty={};function YU(t,e){const n=ty[e];if(n)return n;let r=Fa(e);if(r!=="filter"&&r in t)return ty[e]=r;r=GD(r);for(let i=0;i<tI.length;i++){const s=tI[i]+r;if(s in t)return ty[e]=s}return e}const nI="http://www.w3.org/1999/xlink";function rI(t,e,n,r,i,s=ZB(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(nI,e.slice(6,e.length)):t.setAttributeNS(nI,e,n):n==null||s&&!KD(n)?t.removeAttribute(e):t.setAttribute(e,s?"":Xi(n)?String(n):n)}function iI(t,e,n,r,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?XL(n):n);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?t.getAttribute("value")||"":t.value,l=n==null?t.type==="checkbox"?"on":"":String(n);(a!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=KD(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(i||e)}function Ul(t,e,n,r){t.addEventListener(e,n,r)}function GU(t,e,n,r){t.removeEventListener(e,n,r)}const sI=Symbol("_vei");function qU(t,e,n,r,i=null){const s=t[sI]||(t[sI]={}),o=s[e];if(r&&o)o.value=r;else{const[a,l]=KU(e);if(r){const u=s[e]=JU(r,i);Ul(t,a,u,l)}else o&&(GU(t,a,o,l),s[e]=void 0)}}const oI=/(?:Once|Passive|Capture)$/;function KU(t){let e;if(oI.test(t)){e={};let r;for(;r=t.match(oI);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):gu(t.slice(2)),e]}let ny=0;const XU=Promise.resolve(),ZU=()=>ny||(XU.then(()=>ny=0),ny=Date.now());function JU(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Ys(QU(r,n.value),e,5,[r])};return n.value=t,n.attached=ZU(),n}function QU(t,e){if(Ae(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const aI=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,ez=(t,e,n,r,i,s)=>{const o=i==="svg";e==="class"?WU(t,r,o):e==="style"?zU(t,n,r):Pw(e)?g0(e)||qU(t,e,n,r,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):tz(t,e,r,o))?(iI(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&rI(t,e,r,o,s,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!yn(r))?iI(t,Fa(e),r,s,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),rI(t,e,r,o))};function tz(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&aI(e)&&ke(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return aI(e)&&yn(n)?!1:e in t}const Pp=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Ae(e)?n=>qm(e,n):e};function nz(t){t.target.composing=!0}function lI(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Pc=Symbol("_assign"),li={created(t,{modifiers:{lazy:e,trim:n,number:r}},i){t[Pc]=Pp(i);const s=r||i.props&&i.props.type==="number";Ul(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),s&&(a=Rp(a)),t[Pc](a)}),n&&Ul(t,"change",()=>{t.value=t.value.trim()}),e||(Ul(t,"compositionstart",nz),Ul(t,"compositionend",lI),Ul(t,"change",lI))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:r,trim:i,number:s}},o){if(t[Pc]=Pp(o),t.composing)return;const a=(s||t.type==="number")&&!/^0\d/.test(t.value)?Rp(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(r&&e===n||i&&t.value.trim()===l)||(t.value=l))}},Op={deep:!0,created(t,{value:e,modifiers:{number:n}},r){const i=Ow(e);Ul(t,"change",()=>{const s=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Rp(Ap(o)):Ap(o));t[Pc](t.multiple?i?new Set(s):s:s[0]),t._assigning=!0,wL(()=>{t._assigning=!1})}),t[Pc]=Pp(r)},mounted(t,{value:e}){uI(t,e)},beforeUpdate(t,e,n){t[Pc]=Pp(n)},updated(t,{value:e}){t._assigning||uI(t,e)}};function uI(t,e){const n=t.multiple,r=Ae(e);if(!(n&&!r&&!Ow(e))){for(let i=0,s=t.options.length;i<s;i++){const o=t.options[i],a=Ap(o);if(n)if(r){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(u=>String(u)===String(a)):o.selected=QB(e,a)>-1}else o.selected=e.has(a);else if(Nw(Ap(o),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Ap(t){return"_value"in t?t._value:t.value}const rz=["ctrl","shift","alt","meta"],iz={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>rz.some(n=>t[`${n}Key`]&&!e.includes(n))},sz=(t,e)=>{const n=t._withMods||(t._withMods={}),r=e.join(".");return n[r]||(n[r]=(i,...s)=>{for(let o=0;o<e.length;o++){const a=iz[e[o]];if(a&&a(i,e))return}return t(i,...s)})},oz=rr({patchProp:ez},$U);let cI;function az(){return cI||(cI=uU(oz))}const lz=(...t)=>{const e=az().createApp(...t),{mount:n}=e;return e.mount=r=>{const i=cz(r);if(!i)return;const s=e._component;!ke(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=n(i,!1,uz(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function uz(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function cz(t){return yn(t)?document.querySelector(t):t}var hI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dI={},wh,fI;function In(){if(fI)return wh;fI=1;var t=function(e){return e&&e.Math===Math&&e};return wh=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof hI=="object"&&hI)||t(typeof wh=="object"&&wh)||function(){return this}()||Function("return this")(),wh}var ry={},iy,gI;function Vn(){return gI||(gI=1,iy=function(t){try{return!!t()}catch{return!0}}),iy}var sy,mI;function Si(){if(mI)return sy;mI=1;var t=Vn();return sy=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),sy}var oy,pI;function Ww(){if(pI)return oy;pI=1;var t=Vn();return oy=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),oy}var ay,wI;function or(){if(wI)return ay;wI=1;var t=Ww(),e=Function.prototype.call;return ay=t?e.bind(e):function(){return e.apply(e,arguments)},ay}var ly={},CI;function hz(){if(CI)return ly;CI=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return ly.f=n?function(i){var s=e(this,i);return!!s&&s.enumerable}:t,ly}var uy,yI;function Bw(){return yI||(yI=1,uy=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),uy}var cy,vI;function gn(){if(vI)return cy;vI=1;var t=Ww(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return cy=t?r:function(i){return function(){return n.apply(i,arguments)}},cy}var hy,bI;function mu(){if(bI)return hy;bI=1;var t=gn(),e=t({}.toString),n=t("".slice);return hy=function(r){return n(e(r),8,-1)},hy}var dy,SI;function dz(){if(SI)return dy;SI=1;var t=gn(),e=Vn(),n=mu(),r=Object,i=t("".split);return dy=e(function(){return!r("z").propertyIsEnumerable(0)})?function(s){return n(s)==="String"?i(s,""):r(s)}:r,dy}var fy,RI;function jw(){return RI||(RI=1,fy=function(t){return t==null}),fy}var gy,EI;function Af(){if(EI)return gy;EI=1;var t=jw(),e=TypeError;return gy=function(n){if(t(n))throw new e("Can't call method on "+n);return n},gy}var my,TI;function Hf(){if(TI)return my;TI=1;var t=dz(),e=Af();return my=function(n){return t(e(n))},my}var py,_I;function vn(){if(_I)return py;_I=1;var t=typeof document=="object"&&document.all;return py=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},py}var wy,xI;function ts(){if(xI)return wy;xI=1;var t=vn();return wy=function(e){return typeof e=="object"?e!==null:t(e)},wy}var Cy,MI;function Xc(){if(MI)return Cy;MI=1;var t=In(),e=vn(),n=function(r){return e(r)?r:void 0};return Cy=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},Cy}var yy,II;function Nf(){if(II)return yy;II=1;var t=gn();return yy=t({}.isPrototypeOf),yy}var vy,PI;function Uw(){if(PI)return vy;PI=1;var t=In(),e=t.navigator,n=e&&e.userAgent;return vy=n?String(n):"",vy}var by,OI;function fz(){if(OI)return by;OI=1;var t=In(),e=Uw(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,s=i&&i.v8,o,a;return s&&(o=s.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),by=a,by}var Sy,AI;function P0(){if(AI)return Sy;AI=1;var t=fz(),e=Vn(),n=In(),r=n.String;return Sy=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Sy}var Ry,HI;function ZL(){if(HI)return Ry;HI=1;var t=P0();return Ry=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ry}var Ey,NI;function O0(){if(NI)return Ey;NI=1;var t=Xc(),e=vn(),n=Nf(),r=ZL(),i=Object;return Ey=r?function(s){return typeof s=="symbol"}:function(s){var o=t("Symbol");return e(o)&&n(o.prototype,i(s))},Ey}var Ty,DI;function zw(){if(DI)return Ty;DI=1;var t=String;return Ty=function(e){try{return t(e)}catch{return"Object"}},Ty}var _y,LI;function kr(){if(LI)return _y;LI=1;var t=vn(),e=zw(),n=TypeError;return _y=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},_y}var xy,kI;function Df(){if(kI)return xy;kI=1;var t=kr(),e=jw();return xy=function(n,r){var i=n[r];return e(i)?void 0:t(i)},xy}var My,FI;function gz(){if(FI)return My;FI=1;var t=or(),e=vn(),n=ts(),r=TypeError;return My=function(i,s){var o,a;if(s==="string"&&e(o=i.toString)&&!n(a=t(o,i))||e(o=i.valueOf)&&!n(a=t(o,i))||s!=="string"&&e(o=i.toString)&&!n(a=t(o,i)))return a;throw new r("Can't convert object to primitive value")},My}var Iy={exports:{}},Py,$I;function Ga(){return $I||($I=1,Py=!1),Py}var Oy,VI;function A0(){if(VI)return Oy;VI=1;var t=In(),e=Object.defineProperty;return Oy=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},Oy}var WI;function H0(){if(WI)return Iy.exports;WI=1;var t=Ga(),e=In(),n=A0(),r="__core-js_shared__",i=Iy.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.40.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Iy.exports}var Ay,BI;function JL(){if(BI)return Ay;BI=1;var t=H0();return Ay=function(e,n){return t[e]||(t[e]=n||{})},Ay}var Hy,jI;function Zc(){if(jI)return Hy;jI=1;var t=Af(),e=Object;return Hy=function(n){return e(t(n))},Hy}var Ny,UI;function Ri(){if(UI)return Ny;UI=1;var t=gn(),e=Zc(),n=t({}.hasOwnProperty);return Ny=Object.hasOwn||function(i,s){return n(e(i),s)},Ny}var Dy,zI;function QL(){if(zI)return Dy;zI=1;var t=gn(),e=0,n=Math.random(),r=t(1 .toString);return Dy=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},Dy}var Ly,YI;function ns(){if(YI)return Ly;YI=1;var t=In(),e=JL(),n=Ri(),r=QL(),i=P0(),s=ZL(),o=t.Symbol,a=e("wks"),l=s?o.for||o:o&&o.withoutSetter||r;return Ly=function(u){return n(a,u)||(a[u]=i&&n(o,u)?o[u]:l("Symbol."+u)),a[u]},Ly}var ky,GI;function mz(){if(GI)return ky;GI=1;var t=or(),e=ts(),n=O0(),r=Df(),i=gz(),s=ns(),o=TypeError,a=s("toPrimitive");return ky=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new o("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},ky}var Fy,qI;function ek(){if(qI)return Fy;qI=1;var t=mz(),e=O0();return Fy=function(n){var r=t(n,"string");return e(r)?r:r+""},Fy}var $y,KI;function N0(){if(KI)return $y;KI=1;var t=In(),e=ts(),n=t.document,r=e(n)&&e(n.createElement);return $y=function(i){return r?n.createElement(i):{}},$y}var Vy,XI;function tk(){if(XI)return Vy;XI=1;var t=Si(),e=Vn(),n=N0();return Vy=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),Vy}var ZI;function nk(){if(ZI)return ry;ZI=1;var t=Si(),e=or(),n=hz(),r=Bw(),i=Hf(),s=ek(),o=Ri(),a=tk(),l=Object.getOwnPropertyDescriptor;return ry.f=t?l:function(c,h){if(c=i(c),h=s(h),a)try{return l(c,h)}catch{}if(o(c,h))return r(!e(n.f,c,h),c[h])},ry}var Wy={},By,JI;function rk(){if(JI)return By;JI=1;var t=Si(),e=Vn();return By=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),By}var jy,QI;function bn(){if(QI)return jy;QI=1;var t=ts(),e=String,n=TypeError;return jy=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},jy}var eP;function qa(){if(eP)return Wy;eP=1;var t=Si(),e=tk(),n=rk(),r=bn(),i=ek(),s=TypeError,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Wy.f=t?n?function(d,f,m){if(r(d),f=i(f),r(m),typeof d=="function"&&f==="prototype"&&"value"in m&&c in m&&!m[c]){var y=a(d,f);y&&y[c]&&(d[f]=m.value,m={configurable:u in m?m[u]:y[u],enumerable:l in m?m[l]:y[l],writable:!1})}return o(d,f,m)}:o:function(d,f,m){if(r(d),f=i(f),r(m),e)try{return o(d,f,m)}catch{}if("get"in m||"set"in m)throw new s("Accessors not supported");return"value"in m&&(d[f]=m.value),d},Wy}var Uy,tP;function Jc(){if(tP)return Uy;tP=1;var t=Si(),e=qa(),n=Bw();return Uy=t?function(r,i,s){return e.f(r,i,n(1,s))}:function(r,i,s){return r[i]=s,r},Uy}var zy={exports:{}},Yy,nP;function pz(){if(nP)return Yy;nP=1;var t=Si(),e=Ri(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),s=i&&(function(){}).name==="something",o=i&&(!t||t&&r(n,"name").configurable);return Yy={EXISTS:i,PROPER:s,CONFIGURABLE:o},Yy}var Gy,rP;function wz(){if(rP)return Gy;rP=1;var t=gn(),e=vn(),n=H0(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),Gy=n.inspectSource,Gy}var qy,iP;function Cz(){if(iP)return qy;iP=1;var t=In(),e=vn(),n=t.WeakMap;return qy=e(n)&&/native code/.test(String(n)),qy}var Ky,sP;function D0(){if(sP)return Ky;sP=1;var t=JL(),e=QL(),n=t("keys");return Ky=function(r){return n[r]||(n[r]=e(r))},Ky}var Xy,oP;function L0(){return oP||(oP=1,Xy={}),Xy}var Zy,aP;function ik(){if(aP)return Zy;aP=1;var t=Cz(),e=In(),n=ts(),r=Jc(),i=Ri(),s=H0(),o=D0(),a=L0(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,m=function(x){return f(x)?d(x):h(x,{})},y=function(x){return function(O){var b;if(!n(O)||(b=d(O)).type!==x)throw new u("Incompatible receiver, "+x+" required");return b}};if(t||s.state){var C=s.state||(s.state=new c);C.get=C.get,C.has=C.has,C.set=C.set,h=function(x,O){if(C.has(x))throw new u(l);return O.facade=x,C.set(x,O),O},d=function(x){return C.get(x)||{}},f=function(x){return C.has(x)}}else{var T=o("state");a[T]=!0,h=function(x,O){if(i(x,T))throw new u(l);return O.facade=x,r(x,T,O),O},d=function(x){return i(x,T)?x[T]:{}},f=function(x){return i(x,T)}}return Zy={set:h,get:d,has:f,enforce:m,getterFor:y},Zy}var lP;function sk(){if(lP)return zy.exports;lP=1;var t=gn(),e=Vn(),n=vn(),r=Ri(),i=Si(),s=pz().CONFIGURABLE,o=wz(),a=ik(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),m=t([].join),y=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),C=String(String).split("String"),T=zy.exports=function(x,O,b){d(c(O),0,7)==="Symbol("&&(O="["+f(c(O),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),b&&b.getter&&(O="get "+O),b&&b.setter&&(O="set "+O),(!r(x,"name")||s&&x.name!==O)&&(i?h(x,"name",{value:O,configurable:!0}):x.name=O),y&&b&&r(b,"arity")&&x.length!==b.arity&&h(x,"length",{value:b.arity});try{b&&r(b,"constructor")&&b.constructor?i&&h(x,"prototype",{writable:!1}):x.prototype&&(x.prototype=void 0)}catch{}var H=l(x);return r(H,"source")||(H.source=m(C,typeof O=="string"?O:"")),x};return Function.prototype.toString=T(function(){return n(this)&&u(this).source||o(this)},"toString"),zy.exports}var Jy,uP;function k0(){if(uP)return Jy;uP=1;var t=vn(),e=qa(),n=sk(),r=A0();return Jy=function(i,s,o,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:s;if(t(o)&&n(o,u,a),a.global)l?i[s]=o:r(s,o);else{try{a.unsafe?i[s]&&(l=!0):delete i[s]}catch{}l?i[s]=o:e.f(i,s,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Jy}var Qy={},ev,cP;function yz(){if(cP)return ev;cP=1;var t=Math.ceil,e=Math.floor;return ev=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},ev}var tv,hP;function Lf(){if(hP)return tv;hP=1;var t=yz();return tv=function(e){var n=+e;return n!==n||n===0?0:t(n)},tv}var nv,dP;function vz(){if(dP)return nv;dP=1;var t=Lf(),e=Math.max,n=Math.min;return nv=function(r,i){var s=t(r);return s<0?e(s+i,0):n(s,i)},nv}var rv,fP;function bz(){if(fP)return rv;fP=1;var t=Lf(),e=Math.min;return rv=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},rv}var iv,gP;function Qc(){if(gP)return iv;gP=1;var t=bz();return iv=function(e){return t(e.length)},iv}var sv,mP;function Sz(){if(mP)return sv;mP=1;var t=Hf(),e=vz(),n=Qc(),r=function(i){return function(s,o,a){var l=t(s),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&o!==o){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===o)return i||c||0;return!i&&-1}};return sv={includes:r(!0),indexOf:r(!1)},sv}var ov,pP;function ok(){if(pP)return ov;pP=1;var t=gn(),e=Ri(),n=Hf(),r=Sz().indexOf,i=L0(),s=t([].push);return ov=function(o,a){var l=n(o),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&s(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||s(c,h));return c},ov}var av,wP;function F0(){return wP||(wP=1,av=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),av}var CP;function Rz(){if(CP)return Qy;CP=1;var t=ok(),e=F0(),n=e.concat("length","prototype");return Qy.f=Object.getOwnPropertyNames||function(i){return t(i,n)},Qy}var lv={},yP;function Ez(){return yP||(yP=1,lv.f=Object.getOwnPropertySymbols),lv}var uv,vP;function Tz(){if(vP)return uv;vP=1;var t=Xc(),e=gn(),n=Rz(),r=Ez(),i=bn(),s=e([].concat);return uv=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?s(l,u(a)):l},uv}var cv,bP;function ak(){if(bP)return cv;bP=1;var t=Ri(),e=Tz(),n=nk(),r=qa();return cv=function(i,s,o){for(var a=e(s),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(o&&t(o,h))&&l(i,h,u(s,h))}},cv}var hv,SP;function _z(){if(SP)return hv;SP=1;var t=Vn(),e=vn(),n=/#|\.prototype\./,r=function(l,u){var c=s[i(l)];return c===a?!0:c===o?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},s=r.data={},o=r.NATIVE="N",a=r.POLYFILL="P";return hv=r,hv}var dv,RP;function Mt(){if(RP)return dv;RP=1;var t=In(),e=nk().f,n=Jc(),r=k0(),i=A0(),s=ak(),o=_z();return dv=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,m,y,C,T;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(m in l){if(C=l[m],a.dontCallGetSet?(T=e(f,m),y=T&&T.value):y=f[m],d=o(c?m:u+(h?".":"#")+m,a.forced),!d&&y!==void 0){if(typeof C==typeof y)continue;s(C,y)}(a.sham||y&&y.sham)&&n(C,"sham",!0),r(f,m,C,a)}},dv}var fv,EP;function Yw(){if(EP)return fv;EP=1;var t=Ww(),e=Function.prototype,n=e.apply,r=e.call;return fv=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),fv}var gv,TP;function lk(){if(TP)return gv;TP=1;var t=gn(),e=kr();return gv=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},gv}var mv,_P;function xz(){if(_P)return mv;_P=1;var t=ts();return mv=function(e){return t(e)||e===null},mv}var pv,xP;function Mz(){if(xP)return pv;xP=1;var t=xz(),e=String,n=TypeError;return pv=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},pv}var wv,MP;function uk(){if(MP)return wv;MP=1;var t=lk(),e=ts(),n=Af(),r=Mz();return wv=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,s={},o;try{o=t(Object.prototype,"__proto__","set"),o(s,[]),i=s instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?o(l,u):l.__proto__=u),l}}():void 0),wv}var Cv,IP;function Iz(){if(IP)return Cv;IP=1;var t=qa().f;return Cv=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},Cv}var yv,PP;function Pz(){if(PP)return yv;PP=1;var t=vn(),e=ts(),n=uk();return yv=function(r,i,s){var o,a;return n&&t(o=i.constructor)&&o!==s&&e(a=o.prototype)&&a!==s.prototype&&n(r,a),r},yv}var vv,OP;function Oz(){if(OP)return vv;OP=1;var t=ns(),e=t("toStringTag"),n={};return n[e]="z",vv=String(n)==="[object z]",vv}var bv,AP;function ck(){if(AP)return bv;AP=1;var t=Oz(),e=vn(),n=mu(),r=ns(),i=r("toStringTag"),s=Object,o=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return bv=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=s(l),i))=="string"?c:o?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},bv}var Sv,HP;function Gw(){if(HP)return Sv;HP=1;var t=ck(),e=String;return Sv=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},Sv}var Rv,NP;function Az(){if(NP)return Rv;NP=1;var t=Gw();return Rv=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},Rv}var Ev,DP;function Hz(){if(DP)return Ev;DP=1;var t=ts(),e=Jc();return Ev=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},Ev}var Tv,LP;function Nz(){if(LP)return Tv;LP=1;var t=gn(),e=Error,n=t("".replace),r=function(o){return String(new e(o).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,s=i.test(r);return Tv=function(o,a){if(s&&typeof o=="string"&&!e.prepareStackTrace)for(;a--;)o=n(o,i,"");return o},Tv}var _v,kP;function Dz(){if(kP)return _v;kP=1;var t=Vn(),e=Bw();return _v=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),_v}var xv,FP;function Lz(){if(FP)return xv;FP=1;var t=Jc(),e=Nz(),n=Dz(),r=Error.captureStackTrace;return xv=function(i,s,o,a){n&&(r?r(i,s):t(i,"stack",e(o,a)))},xv}var Mv,$P;function kz(){if($P)return Mv;$P=1;var t=Xc(),e=Ri(),n=Jc(),r=Nf(),i=uk(),s=ak(),o=Iz(),a=Pz(),l=Az(),u=Hz(),c=Lz(),h=Si(),d=Ga();return Mv=function(f,m,y,C){var T="stackTraceLimit",x=C?2:1,O=f.split("."),b=O[O.length-1],H=t.apply(null,O);if(H){var k=H.prototype;if(!d&&e(k,"cause")&&delete k.cause,!y)return H;var V=t("Error"),U=m(function(Z,Y){var Q=l(C?Y:Z,void 0),ne=C?new H(Z):new H;return Q!==void 0&&n(ne,"message",Q),c(ne,U,ne.stack,2),this&&r(k,this)&&a(ne,this,U),arguments.length>x&&u(ne,arguments[x]),ne});if(U.prototype=k,b!=="Error"?i?i(U,V):s(U,V,{name:!0}):h&&T in H&&(o(U,H,T),o(U,H,"prepareStackTrace")),s(U,H),!d)try{k.name!==b&&n(k,"name",b),k.constructor=U}catch{}return U}},Mv}var VP;function Fz(){if(VP)return dI;VP=1;var t=Mt(),e=In(),n=Yw(),r=kz(),i="WebAssembly",s=e[i],o=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,o),t({global:!0,constructor:!0,arity:1,forced:o},h)},l=function(u,c){if(s&&s[u]){var h={};h[u]=r(i+"."+u,c,o),t({target:i,stat:!0,constructor:!0,arity:1,forced:o},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),dI}Fz();var WP={},Iv,BP;function hk(){if(BP)return Iv;BP=1;var t=mu();return Iv=Array.isArray||function(n){return t(n)==="Array"},Iv}var Pv,jP;function dk(){if(jP)return Pv;jP=1;var t=Si(),e=hk(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}}();return Pv=i?function(s,o){if(e(s)&&!r(s,"length").writable)throw new n("Cannot set read only .length");return s.length=o}:function(s,o){return s.length=o},Pv}var Ov,UP;function fk(){if(UP)return Ov;UP=1;var t=TypeError,e=9007199254740991;return Ov=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},Ov}var zP;function $z(){if(zP)return WP;zP=1;var t=Mt(),e=Zc(),n=Qc(),r=dk(),i=fk(),s=Vn(),o=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var m=0;m<f;m++)h[d]=arguments[m],d++;return r(h,d),d}}),WP}$z();var YP={},Av,GP;function qs(){if(GP)return Av;GP=1;var t=gn(),e=Set.prototype;return Av={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Av}var Hv,qP;function pu(){if(qP)return Hv;qP=1;var t=qs().has;return Hv=function(e){return t(e),e},Hv}var Nv,KP;function wu(){if(KP)return Nv;KP=1;var t=or();return Nv=function(e,n,r){for(var i=r?e:e.iterator,s=e.next,o,a;!(o=t(s,i)).done;)if(a=n(o.value),a!==void 0)return a},Nv}var Dv,XP;function kf(){if(XP)return Dv;XP=1;var t=gn(),e=wu(),n=qs(),r=n.Set,i=n.proto,s=t(i.forEach),o=t(i.keys),a=o(new r).next;return Dv=function(l,u,c){return c?e({iterator:o(l),next:a},u):s(l,u)},Dv}var Lv,ZP;function $0(){if(ZP)return Lv;ZP=1;var t=qs(),e=kf(),n=t.Set,r=t.add;return Lv=function(i){var s=new n;return e(i,function(o){r(s,o)}),s},Lv}var kv,JP;function Ff(){if(JP)return kv;JP=1;var t=lk(),e=qs();return kv=t(e.proto,"size","get")||function(n){return n.size},kv}var Fv,QP;function Ks(){return QP||(QP=1,Fv=function(t){return{iterator:t,next:t.next,done:!1}}),Fv}var $v,e1;function Cu(){if(e1)return $v;e1=1;var t=kr(),e=bn(),n=or(),r=Lf(),i=Ks(),s="Invalid size",o=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},$v=function(c){e(c);var h=+c.size;if(h!==h)throw new a(s);var d=r(h);if(d<0)throw new o(s);return new u(c,d)},$v}var Vv,t1;function Vz(){if(t1)return Vv;t1=1;var t=pu(),e=qs(),n=$0(),r=Ff(),i=Cu(),s=kf(),o=wu(),a=e.has,l=e.remove;return Vv=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?s(h,function(m){d.includes(m)&&l(f,m)}):o(d.getIterator(),function(m){a(h,m)&&l(f,m)}),f},Vv}var Wv,n1;function yu(){if(n1)return Wv;n1=1;var t=Xc(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return Wv=function(r,i){var s=t("Set");try{new s()[r](e(0));try{return new s()[r](e(-1)),!1}catch{if(!i)return!0;try{return new s()[r](n(-1/0)),!1}catch{var o=new s;return o.add(1),o.add(2),i(o[r](n(1/0)))}}}catch{return!1}},Wv}var r1;function Wz(){if(r1)return YP;r1=1;var t=Mt(),e=Vz(),n=yu(),r=!n("difference",function(i){return i.size===0});return t({target:"Set",proto:!0,real:!0,forced:r},{difference:e}),YP}Wz();var i1={},Bv,s1;function Bz(){if(s1)return Bv;s1=1;var t=pu(),e=qs(),n=Ff(),r=Cu(),i=kf(),s=wu(),o=e.Set,a=e.add,l=e.has;return Bv=function(c){var h=t(this),d=r(c),f=new o;return n(h)>d.size?s(d.getIterator(),function(m){l(h,m)&&a(f,m)}):i(h,function(m){d.includes(m)&&a(f,m)}),f},Bv}var o1;function jz(){if(o1)return i1;o1=1;var t=Mt(),e=Vn(),n=Bz(),r=yu(),i=!r("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),i1}jz();var a1={},jv,l1;function eh(){if(l1)return jv;l1=1;var t=or(),e=bn(),n=Df();return jv=function(r,i,s){var o,a;e(r);try{if(o=n(r,"return"),!o){if(i==="throw")throw s;return s}o=t(o,r)}catch(l){a=!0,o=l}if(i==="throw")throw s;if(a)throw o;return e(o),s},jv}var Uv,u1;function Uz(){if(u1)return Uv;u1=1;var t=pu(),e=qs().has,n=Ff(),r=Cu(),i=kf(),s=wu(),o=eh();return Uv=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return s(h,function(d){if(e(u,d))return o(h,"normal",!1)})!==!1},Uv}var c1;function zz(){if(c1)return a1;c1=1;var t=Mt(),e=Uz(),n=yu(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),a1}zz();var h1={},zv,d1;function Yz(){if(d1)return zv;d1=1;var t=pu(),e=Ff(),n=kf(),r=Cu();return zv=function(s){var o=t(this),a=r(s);return e(o)>a.size?!1:n(o,function(l){if(!a.includes(l))return!1},!0)!==!1},zv}var f1;function Gz(){if(f1)return h1;f1=1;var t=Mt(),e=Yz(),n=yu(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),h1}Gz();var g1={},Yv,m1;function qz(){if(m1)return Yv;m1=1;var t=pu(),e=qs().has,n=Ff(),r=Cu(),i=wu(),s=eh();return Yv=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return s(c,"normal",!1)})!==!1},Yv}var p1;function Kz(){if(p1)return g1;p1=1;var t=Mt(),e=qz(),n=yu(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),g1}Kz();var w1={},Gv,C1;function Xz(){if(C1)return Gv;C1=1;var t=pu(),e=qs(),n=$0(),r=Cu(),i=wu(),s=e.add,o=e.has,a=e.remove;return Gv=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){o(c,f)?a(d,f):s(d,f)}),d},Gv}var y1;function Zz(){if(y1)return w1;y1=1;var t=Mt(),e=Xz(),n=yu();return t({target:"Set",proto:!0,real:!0,forced:!n("symmetricDifference")},{symmetricDifference:e}),w1}Zz();var v1={},qv,b1;function Jz(){if(b1)return qv;b1=1;var t=pu(),e=qs().add,n=$0(),r=Cu(),i=wu();return qv=function(o){var a=t(this),l=r(o).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},qv}var S1;function Qz(){if(S1)return v1;S1=1;var t=Mt(),e=Jz(),n=yu();return t({target:"Set",proto:!0,real:!0,forced:!n("union")},{union:e}),v1}Qz();var R1={},E1={},Kv,T1;function e2(){if(T1)return Kv;T1=1;var t=Nf(),e=TypeError;return Kv=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},Kv}var Xv,_1;function t2(){if(_1)return Xv;_1=1;var t=Vn();return Xv=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Xv}var Zv,x1;function gk(){if(x1)return Zv;x1=1;var t=Ri(),e=vn(),n=Zc(),r=D0(),i=t2(),s=r("IE_PROTO"),o=Object,a=o.prototype;return Zv=i?o.getPrototypeOf:function(l){var u=n(l);if(t(u,s))return u[s];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof o?a:null},Zv}var Jv,M1;function n2(){if(M1)return Jv;M1=1;var t=sk(),e=qa();return Jv=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},Jv}var Qv,I1;function mk(){if(I1)return Qv;I1=1;var t=Si(),e=qa(),n=Bw();return Qv=function(r,i,s){t?e.f(r,i,n(0,s)):r[i]=s},Qv}var eb={},tb,P1;function r2(){if(P1)return tb;P1=1;var t=ok(),e=F0();return tb=Object.keys||function(r){return t(r,e)},tb}var O1;function i2(){if(O1)return eb;O1=1;var t=Si(),e=rk(),n=qa(),r=bn(),i=Hf(),s=r2();return eb.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=s(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},eb}var nb,A1;function pk(){if(A1)return nb;A1=1;var t=Xc();return nb=t("document","documentElement"),nb}var rb,H1;function V0(){if(H1)return rb;H1=1;var t=bn(),e=i2(),n=F0(),r=L0(),i=pk(),s=N0(),o=D0(),a=">",l="<",u="prototype",c="script",h=o("IE_PROTO"),d=function(){},f=function(x){return l+c+a+x+l+"/"+c+a},m=function(x){x.write(f("")),x.close();var O=x.parentWindow.Object;return x=null,O},y=function(){var x=s("iframe"),O="java"+c+":",b;return x.style.display="none",i.appendChild(x),x.src=String(O),b=x.contentWindow.document,b.open(),b.write(f("document.F=Object")),b.close(),b.F},C,T=function(){try{C=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&C?m(C):y():m(C);for(var x=n.length;x--;)delete T[u][n[x]];return T()};return r[h]=!0,rb=Object.create||function(O,b){var H;return O!==null?(d[u]=t(O),H=new d,d[u]=null,H[h]=O):H=T(),b===void 0?H:e.f(H,b)},rb}var ib,N1;function wk(){if(N1)return ib;N1=1;var t=Vn(),e=vn(),n=ts(),r=V0(),i=gk(),s=k0(),o=ns(),a=Ga(),l=o("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var m={};return c[l].call(m)!==m});return f?c={}:a&&(c=r(c)),e(c[l])||s(c,l,function(){return this}),ib={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},ib}var D1;function s2(){if(D1)return E1;D1=1;var t=Mt(),e=In(),n=e2(),r=bn(),i=vn(),s=gk(),o=n2(),a=mk(),l=Vn(),u=Ri(),c=ns(),h=wk().IteratorPrototype,d=Si(),f=Ga(),m="constructor",y="Iterator",C=c("toStringTag"),T=TypeError,x=e[y],O=f||!i(x)||x.prototype!==h||!l(function(){x({})}),b=function(){if(n(this,h),s(this)===h)throw new T("Abstract class Iterator not directly constructable")},H=function(k,V){d?o(h,k,{configurable:!0,get:function(){return V},set:function(U){if(r(this),this===h)throw new T("You can't redefine this property");u(this,k)?this[k]=U:a(this,k,U)}}):h[k]=V};return u(h,C)||H(C,y),(O||!u(h,m)||h[m]===Object)&&H(m,b),b.prototype=h,t({global:!0,constructor:!0,forced:O},{Iterator:b}),E1}var L1;function o2(){return L1||(L1=1,s2()),R1}o2();var k1={},F1={},sb,$1;function a2(){if($1)return sb;$1=1;var t=k0();return sb=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},sb}var ob,V1;function l2(){return V1||(V1=1,ob=function(t,e){return{value:t,done:e}}),ob}var ab,W1;function W0(){if(W1)return ab;W1=1;var t=or(),e=V0(),n=Jc(),r=a2(),i=ns(),s=ik(),o=Df(),a=wk().IteratorPrototype,l=l2(),u=eh(),c=i("toStringTag"),h="IteratorHelper",d="WrapForValidIterator",f=s.set,m=function(T){var x=s.getterFor(T?d:h);return r(e(a),{next:function(){var b=x(this);if(T)return b.nextHandler();if(b.done)return l(void 0,!0);try{var H=b.nextHandler();return b.returnHandlerResult?H:l(H,b.done)}catch(k){throw b.done=!0,k}},return:function(){var O=x(this),b=O.iterator;if(O.done=!0,T){var H=o(b,"return");return H?t(H,b):l(void 0,!0)}if(O.inner)try{u(O.inner.iterator,"normal")}catch(k){return u(b,"throw",k)}return b&&u(b,"normal"),l(void 0,!0)}})},y=m(!0),C=m(!1);return n(C,c,"Iterator Helper"),ab=function(T,x,O){var b=function(k,V){V?(V.iterator=k.iterator,V.next=k.next):V=k,V.type=x?d:h,V.returnHandlerResult=!!O,V.nextHandler=T,V.counter=0,V.done=!1,f(this,V)};return b.prototype=x?y:C,b},ab}var lb,B1;function Ck(){if(B1)return lb;B1=1;var t=bn(),e=eh();return lb=function(n,r,i,s){try{return s?r(t(i)[0],i[1]):r(i)}catch(o){e(n,"throw",o)}},lb}var j1;function u2(){if(j1)return F1;j1=1;var t=Mt(),e=or(),n=kr(),r=bn(),i=Ks(),s=W0(),o=Ck(),a=Ga(),l=s(function(){for(var u=this.iterator,c=this.predicate,h=this.next,d,f,m;;){if(d=r(e(h,u)),f=this.done=!!d.done,f)return;if(m=d.value,o(u,c,[m,this.counter++],!0))return m}});return t({target:"Iterator",proto:!0,real:!0,forced:a},{filter:function(c){return r(this),n(c),new l(i(this),{predicate:c})}}),F1}var U1;function c2(){return U1||(U1=1,u2()),k1}c2();var z1={},Y1={},ub,G1;function h2(){if(G1)return ub;G1=1;var t=mu(),e=gn();return ub=function(n){if(t(n)==="Function")return e(n)},ub}var cb,q1;function yk(){if(q1)return cb;q1=1;var t=h2(),e=kr(),n=Ww(),r=t(t.bind);return cb=function(i,s){return e(i),s===void 0?i:n?r(i,s):function(){return i.apply(s,arguments)}},cb}var hb,K1;function vk(){return K1||(K1=1,hb={}),hb}var db,X1;function d2(){if(X1)return db;X1=1;var t=ns(),e=vk(),n=t("iterator"),r=Array.prototype;return db=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},db}var fb,Z1;function B0(){if(Z1)return fb;Z1=1;var t=ck(),e=Df(),n=jw(),r=vk(),i=ns(),s=i("iterator");return fb=function(o){if(!n(o))return e(o,s)||e(o,"@@iterator")||r[t(o)]},fb}var gb,J1;function f2(){if(J1)return gb;J1=1;var t=or(),e=kr(),n=bn(),r=zw(),i=B0(),s=TypeError;return gb=function(o,a){var l=arguments.length<2?i(o):a;if(e(l))return n(t(l,o));throw new s(r(o)+" is not iterable")},gb}var mb,Q1;function th(){if(Q1)return mb;Q1=1;var t=yk(),e=or(),n=bn(),r=zw(),i=d2(),s=Qc(),o=Nf(),a=f2(),l=B0(),u=eh(),c=TypeError,h=function(f,m){this.stopped=f,this.result=m},d=h.prototype;return mb=function(f,m,y){var C=y&&y.that,T=!!(y&&y.AS_ENTRIES),x=!!(y&&y.IS_RECORD),O=!!(y&&y.IS_ITERATOR),b=!!(y&&y.INTERRUPTED),H=t(m,C),k,V,U,Z,Y,Q,ne,ce=function(ye){return k&&u(k,"normal",ye),new h(!0,ye)},ae=function(ye){return T?(n(ye),b?H(ye[0],ye[1],ce):H(ye[0],ye[1])):b?H(ye,ce):H(ye)};if(x)k=f.iterator;else if(O)k=f;else{if(V=l(f),!V)throw new c(r(f)+" is not iterable");if(i(V)){for(U=0,Z=s(f);Z>U;U++)if(Y=ae(f[U]),Y&&o(d,Y))return Y;return new h(!1)}k=a(f,V)}for(Q=x?f.next:k.next;!(ne=e(Q,k)).done;){try{Y=ae(ne.value)}catch(ye){u(k,"throw",ye)}if(typeof Y=="object"&&Y&&o(d,Y))return Y}return new h(!1)},mb}var eO;function g2(){if(eO)return Y1;eO=1;var t=Mt(),e=th(),n=kr(),r=bn(),i=Ks();return t({target:"Iterator",proto:!0,real:!0},{forEach:function(o){r(this),n(o);var a=i(this),l=0;e(a,function(u){o(u,l++)},{IS_RECORD:!0})}}),Y1}var tO;function m2(){return tO||(tO=1,g2()),z1}m2();var nO={},rO={},pb,iO;function p2(){if(iO)return pb;iO=1;var t=or(),e=kr(),n=bn(),r=Ks(),i=W0(),s=Ck(),o=i(function(){var a=this.iterator,l=n(t(this.next,a)),u=this.done=!!l.done;if(!u)return s(a,this.mapper,[l.value,this.counter++],!0)});return pb=function(l){return n(this),e(l),new o(r(this),{mapper:l})},pb}var sO;function w2(){if(sO)return rO;sO=1;var t=Mt(),e=p2(),n=Ga();return t({target:"Iterator",proto:!0,real:!0,forced:n},{map:e}),rO}var oO;function C2(){return oO||(oO=1,w2()),nO}C2();var aO={},lO={},wb,uO;function j0(){if(uO)return wb;uO=1;var t=gn();return wb=t([].slice),wb}var Cb,cO;function bk(){if(cO)return Cb;cO=1;var t=TypeError;return Cb=function(e,n){if(e<n)throw new t("Not enough arguments");return e},Cb}var yb,hO;function y2(){if(hO)return yb;hO=1;var t=Uw();return yb=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),yb}var vb,dO;function Sk(){if(dO)return vb;dO=1;var t=In(),e=Uw(),n=mu(),r=function(i){return e.slice(0,i.length)===i};return vb=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),vb}var bb,fO;function v2(){if(fO)return bb;fO=1;var t=Sk();return bb=t==="NODE",bb}var Sb,gO;function Rk(){if(gO)return Sb;gO=1;var t=In(),e=Yw(),n=yk(),r=vn(),i=Ri(),s=Vn(),o=pk(),a=j0(),l=N0(),u=bk(),c=y2(),h=v2(),d=t.setImmediate,f=t.clearImmediate,m=t.process,y=t.Dispatch,C=t.Function,T=t.MessageChannel,x=t.String,O=0,b={},H="onreadystatechange",k,V,U,Z;s(function(){k=t.location});var Y=function(ae){if(i(b,ae)){var ye=b[ae];delete b[ae],ye()}},Q=function(ae){return function(){Y(ae)}},ne=function(ae){Y(ae.data)},ce=function(ae){t.postMessage(x(ae),k.protocol+"//"+k.host)};return(!d||!f)&&(d=function(ye){u(arguments.length,1);var Le=r(ye)?ye:C(ye),me=a(arguments,1);return b[++O]=function(){e(Le,void 0,me)},V(O),O},f=function(ye){delete b[ye]},h?V=function(ae){m.nextTick(Q(ae))}:y&&y.now?V=function(ae){y.now(Q(ae))}:T&&!c?(U=new T,Z=U.port2,U.port1.onmessage=ne,V=n(Z.postMessage,Z)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&k&&k.protocol!=="file:"&&!s(ce)?(V=ce,t.addEventListener("message",ne,!1)):H in l("script")?V=function(ae){o.appendChild(l("script"))[H]=function(){o.removeChild(this),Y(ae)}}:V=function(ae){setTimeout(Q(ae),0)}),Sb={set:d,clear:f},Sb}var mO;function b2(){if(mO)return lO;mO=1;var t=Mt(),e=In(),n=Rk().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),lO}var pO={},Rb,wO;function S2(){if(wO)return Rb;wO=1;var t=In(),e=Yw(),n=vn(),r=Sk(),i=Uw(),s=j0(),o=bk(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return Rb=function(u,c){var h=c?2:1;return l?function(d,f){var m=o(arguments.length,1)>h,y=n(d)?d:a(d),C=m?s(arguments,h):[],T=m?function(){e(y,this,C)}:y;return c?u(T,f):u(T)}:u},Rb}var CO;function R2(){if(CO)return pO;CO=1;var t=Mt(),e=In(),n=Rk().set,r=S2(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),pO}var yO;function E2(){return yO||(yO=1,b2(),R2()),aO}E2();/*! @license DOMPurify 3.2.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.3/LICENSE */const{entries:Ek,setPrototypeOf:vO,isFrozen:T2,getPrototypeOf:_2,getOwnPropertyDescriptor:x2}=Object;let{freeze:vr,seal:vi,create:Tk}=Object,{apply:aE,construct:lE}=typeof Reflect<"u"&&Reflect;vr||(vr=function(e){return e});vi||(vi=function(e){return e});aE||(aE=function(e,n,r){return e.apply(n,r)});lE||(lE=function(e,n){return new e(...n)});const gg=Jr(Array.prototype.forEach),bO=Jr(Array.prototype.pop),Ch=Jr(Array.prototype.push),ep=Jr(String.prototype.toLowerCase),Eb=Jr(String.prototype.toString),SO=Jr(String.prototype.match),yh=Jr(String.prototype.replace),M2=Jr(String.prototype.indexOf),I2=Jr(String.prototype.trim),ki=Jr(Object.prototype.hasOwnProperty),lr=Jr(RegExp.prototype.test),vh=P2(TypeError);function Jr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return aE(t,e,r)}}function P2(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return lE(t,n)}}function Ke(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ep;vO&&vO(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=n(i);s!==i&&(T2(e)||(e[r]=s),i=s)}t[i]=!0}return t}function O2(t){for(let e=0;e<t.length;e++)ki(t,e)||(t[e]=null);return t}function Vl(t){const e=Tk(null);for(const[n,r]of Ek(t))ki(t,n)&&(Array.isArray(r)?e[n]=O2(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Vl(r):e[n]=r);return e}function bh(t,e){for(;t!==null;){const r=x2(t,e);if(r){if(r.get)return Jr(r.get);if(typeof r.value=="function")return Jr(r.value)}t=_2(t)}function n(){return null}return n}const RO=vr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Tb=vr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),_b=vr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),A2=vr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),xb=vr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),H2=vr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),EO=vr(["#text"]),TO=vr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Mb=vr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),_O=vr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),mg=vr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),N2=vi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),D2=vi(/<%[\w\W]*|[\w\W]*%>/gm),L2=vi(/\$\{[\w\W]*}/gm),k2=vi(/^data-[\-\w.\u00B7-\uFFFF]+$/),F2=vi(/^aria-[\-\w]+$/),_k=vi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$2=vi(/^(?:\w+script|data):/i),V2=vi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),xk=vi(/^html$/i),W2=vi(/^[a-z][.\w]*(-[.\w]+)+$/i);var xO=Object.freeze({__proto__:null,ARIA_ATTR:F2,ATTR_WHITESPACE:V2,CUSTOM_ELEMENT:W2,DATA_ATTR:k2,DOCTYPE_NAME:xk,ERB_EXPR:D2,IS_ALLOWED_URI:_k,IS_SCRIPT_OR_DATA:$2,MUSTACHE_EXPR:N2,TMPLIT_EXPR:L2});const Sh={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},B2=function(){return typeof window>"u"?null:window},j2=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},MO=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Mk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:B2();const e=Ie=>Mk(Ie);if(e.version="3.2.3",e.removed=[],!t||!t.document||t.document.nodeType!==Sh.document)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,m=l.prototype,y=bh(m,"cloneNode"),C=bh(m,"remove"),T=bh(m,"nextSibling"),x=bh(m,"childNodes"),O=bh(m,"parentNode");if(typeof o=="function"){const Ie=n.createElement("template");Ie.content&&Ie.content.ownerDocument&&(n=Ie.content.ownerDocument)}let b,H="";const{implementation:k,createNodeIterator:V,createDocumentFragment:U,getElementsByTagName:Z}=n,{importNode:Y}=r;let Q=MO();e.isSupported=typeof Ek=="function"&&typeof O=="function"&&k&&k.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ne,ERB_EXPR:ce,TMPLIT_EXPR:ae,DATA_ATTR:ye,ARIA_ATTR:Le,IS_SCRIPT_OR_DATA:me,ATTR_WHITESPACE:be,CUSTOM_ELEMENT:st}=xO;let{IS_ALLOWED_URI:Ht}=xO,g=null;const w=Ke({},[...RO,...Tb,..._b,...xb,...EO]);let R=null;const P=Ke({},[...TO,...Mb,..._O,...mg]);let W=Object.seal(Tk(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,J=null,X=!0,fe=!0,S=!1,_=!0,p=!1,v=!0,E=!1,I=!1,N=!1,M=!1,A=!1,L=!1,D=!0,$=!1;const q="user-content-";let G=!0,te=!1,oe={},pe=null;const le=Ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let de=null;const Ze=Ke({},["audio","video","img","source","image","track"]);let It=null;const cn=Ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ct="http://www.w3.org/1998/Math/MathML",Pt="http://www.w3.org/2000/svg",Nt="http://www.w3.org/1999/xhtml";let ze=Nt,Fe=!1,je=null;const lg=Ke({},[Ct,Pt,Nt],Eb);let Ja=Ke({},["mi","mo","mn","ms","mtext"]),ug=Ke({},["annotation-xml"]);const NB=Ke({},["title","style","font","a","script"]);let fh=null;const DB=["application/xhtml+xml","text/html"],LB="text/html";let Pn=null,Tu=null;const kB=n.createElement("form"),RM=function(B){return B instanceof RegExp||B instanceof Function},YC=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Tu&&Tu===B)){if((!B||typeof B!="object")&&(B={}),B=Vl(B),fh=DB.indexOf(B.PARSER_MEDIA_TYPE)===-1?LB:B.PARSER_MEDIA_TYPE,Pn=fh==="application/xhtml+xml"?Eb:ep,g=ki(B,"ALLOWED_TAGS")?Ke({},B.ALLOWED_TAGS,Pn):w,R=ki(B,"ALLOWED_ATTR")?Ke({},B.ALLOWED_ATTR,Pn):P,je=ki(B,"ALLOWED_NAMESPACES")?Ke({},B.ALLOWED_NAMESPACES,Eb):lg,It=ki(B,"ADD_URI_SAFE_ATTR")?Ke(Vl(cn),B.ADD_URI_SAFE_ATTR,Pn):cn,de=ki(B,"ADD_DATA_URI_TAGS")?Ke(Vl(Ze),B.ADD_DATA_URI_TAGS,Pn):Ze,pe=ki(B,"FORBID_CONTENTS")?Ke({},B.FORBID_CONTENTS,Pn):le,z=ki(B,"FORBID_TAGS")?Ke({},B.FORBID_TAGS,Pn):{},J=ki(B,"FORBID_ATTR")?Ke({},B.FORBID_ATTR,Pn):{},oe=ki(B,"USE_PROFILES")?B.USE_PROFILES:!1,X=B.ALLOW_ARIA_ATTR!==!1,fe=B.ALLOW_DATA_ATTR!==!1,S=B.ALLOW_UNKNOWN_PROTOCOLS||!1,_=B.ALLOW_SELF_CLOSE_IN_ATTR!==!1,p=B.SAFE_FOR_TEMPLATES||!1,v=B.SAFE_FOR_XML!==!1,E=B.WHOLE_DOCUMENT||!1,M=B.RETURN_DOM||!1,A=B.RETURN_DOM_FRAGMENT||!1,L=B.RETURN_TRUSTED_TYPE||!1,N=B.FORCE_BODY||!1,D=B.SANITIZE_DOM!==!1,$=B.SANITIZE_NAMED_PROPS||!1,G=B.KEEP_CONTENT!==!1,te=B.IN_PLACE||!1,Ht=B.ALLOWED_URI_REGEXP||_k,ze=B.NAMESPACE||Nt,Ja=B.MATHML_TEXT_INTEGRATION_POINTS||Ja,ug=B.HTML_INTEGRATION_POINTS||ug,W=B.CUSTOM_ELEMENT_HANDLING||{},B.CUSTOM_ELEMENT_HANDLING&&RM(B.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=B.CUSTOM_ELEMENT_HANDLING.tagNameCheck),B.CUSTOM_ELEMENT_HANDLING&&RM(B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),B.CUSTOM_ELEMENT_HANDLING&&typeof B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),p&&(fe=!1),A&&(M=!0),oe&&(g=Ke({},EO),R=[],oe.html===!0&&(Ke(g,RO),Ke(R,TO)),oe.svg===!0&&(Ke(g,Tb),Ke(R,Mb),Ke(R,mg)),oe.svgFilters===!0&&(Ke(g,_b),Ke(R,Mb),Ke(R,mg)),oe.mathMl===!0&&(Ke(g,xb),Ke(R,_O),Ke(R,mg))),B.ADD_TAGS&&(g===w&&(g=Vl(g)),Ke(g,B.ADD_TAGS,Pn)),B.ADD_ATTR&&(R===P&&(R=Vl(R)),Ke(R,B.ADD_ATTR,Pn)),B.ADD_URI_SAFE_ATTR&&Ke(It,B.ADD_URI_SAFE_ATTR,Pn),B.FORBID_CONTENTS&&(pe===le&&(pe=Vl(pe)),Ke(pe,B.FORBID_CONTENTS,Pn)),G&&(g["#text"]=!0),E&&Ke(g,["html","head","body"]),g.table&&(Ke(g,["tbody"]),delete z.tbody),B.TRUSTED_TYPES_POLICY){if(typeof B.TRUSTED_TYPES_POLICY.createHTML!="function")throw vh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof B.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw vh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');b=B.TRUSTED_TYPES_POLICY,H=b.createHTML("")}else b===void 0&&(b=j2(f,i)),b!==null&&typeof H=="string"&&(H=b.createHTML(""));vr&&vr(B),Tu=B}},EM=Ke({},[...Tb,..._b,...A2]),TM=Ke({},[...xb,...H2]),FB=function(B){let ie=O(B);(!ie||!ie.tagName)&&(ie={namespaceURI:ze,tagName:"template"});const Te=ep(B.tagName),Bt=ep(ie.tagName);return je[B.namespaceURI]?B.namespaceURI===Pt?ie.namespaceURI===Nt?Te==="svg":ie.namespaceURI===Ct?Te==="svg"&&(Bt==="annotation-xml"||Ja[Bt]):!!EM[Te]:B.namespaceURI===Ct?ie.namespaceURI===Nt?Te==="math":ie.namespaceURI===Pt?Te==="math"&&ug[Bt]:!!TM[Te]:B.namespaceURI===Nt?ie.namespaceURI===Pt&&!ug[Bt]||ie.namespaceURI===Ct&&!Ja[Bt]?!1:!TM[Te]&&(NB[Te]||!EM[Te]):!!(fh==="application/xhtml+xml"&&je[B.namespaceURI]):!1},os=function(B){Ch(e.removed,{element:B});try{O(B).removeChild(B)}catch{C(B)}},cg=function(B,ie){try{Ch(e.removed,{attribute:ie.getAttributeNode(B),from:ie})}catch{Ch(e.removed,{attribute:null,from:ie})}if(ie.removeAttribute(B),B==="is")if(M||A)try{os(ie)}catch{}else try{ie.setAttribute(B,"")}catch{}},_M=function(B){let ie=null,Te=null;if(N)B="<remove></remove>"+B;else{const kn=SO(B,/^[\r\n\t ]+/);Te=kn&&kn[0]}fh==="application/xhtml+xml"&&ze===Nt&&(B='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+B+"</body></html>");const Bt=b?b.createHTML(B):B;if(ze===Nt)try{ie=new d().parseFromString(Bt,fh)}catch{}if(!ie||!ie.documentElement){ie=k.createDocument(ze,"template",null);try{ie.documentElement.innerHTML=Fe?H:Bt}catch{}}const Bn=ie.body||ie.documentElement;return B&&Te&&Bn.insertBefore(n.createTextNode(Te),Bn.childNodes[0]||null),ze===Nt?Z.call(ie,E?"html":"body")[0]:E?ie.documentElement:Bn},xM=function(B){return V.call(B.ownerDocument||B,B,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},GC=function(B){return B instanceof h&&(typeof B.nodeName!="string"||typeof B.textContent!="string"||typeof B.removeChild!="function"||!(B.attributes instanceof c)||typeof B.removeAttribute!="function"||typeof B.setAttribute!="function"||typeof B.namespaceURI!="string"||typeof B.insertBefore!="function"||typeof B.hasChildNodes!="function")},MM=function(B){return typeof a=="function"&&B instanceof a};function eo(Ie,B,ie){gg(Ie,Te=>{Te.call(e,B,ie,Tu)})}const IM=function(B){let ie=null;if(eo(Q.beforeSanitizeElements,B,null),GC(B))return os(B),!0;const Te=Pn(B.nodeName);if(eo(Q.uponSanitizeElement,B,{tagName:Te,allowedTags:g}),B.hasChildNodes()&&!MM(B.firstElementChild)&&lr(/<[/\w]/g,B.innerHTML)&&lr(/<[/\w]/g,B.textContent)||B.nodeType===Sh.progressingInstruction||v&&B.nodeType===Sh.comment&&lr(/<[/\w]/g,B.data))return os(B),!0;if(!g[Te]||z[Te]){if(!z[Te]&&OM(Te)&&(W.tagNameCheck instanceof RegExp&&lr(W.tagNameCheck,Te)||W.tagNameCheck instanceof Function&&W.tagNameCheck(Te)))return!1;if(G&&!pe[Te]){const Bt=O(B)||B.parentNode,Bn=x(B)||B.childNodes;if(Bn&&Bt){const kn=Bn.length;for(let Sr=kn-1;Sr>=0;--Sr){const as=y(Bn[Sr],!0);as.__removalCount=(B.__removalCount||0)+1,Bt.insertBefore(as,T(B))}}}return os(B),!0}return B instanceof l&&!FB(B)||(Te==="noscript"||Te==="noembed"||Te==="noframes")&&lr(/<\/no(script|embed|frames)/i,B.innerHTML)?(os(B),!0):(p&&B.nodeType===Sh.text&&(ie=B.textContent,gg([ne,ce,ae],Bt=>{ie=yh(ie,Bt," ")}),B.textContent!==ie&&(Ch(e.removed,{element:B.cloneNode()}),B.textContent=ie)),eo(Q.afterSanitizeElements,B,null),!1)},PM=function(B,ie,Te){if(D&&(ie==="id"||ie==="name")&&(Te in n||Te in kB))return!1;if(!(fe&&!J[ie]&&lr(ye,ie))){if(!(X&&lr(Le,ie))){if(!R[ie]||J[ie]){if(!(OM(B)&&(W.tagNameCheck instanceof RegExp&&lr(W.tagNameCheck,B)||W.tagNameCheck instanceof Function&&W.tagNameCheck(B))&&(W.attributeNameCheck instanceof RegExp&&lr(W.attributeNameCheck,ie)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(ie))||ie==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&lr(W.tagNameCheck,Te)||W.tagNameCheck instanceof Function&&W.tagNameCheck(Te))))return!1}else if(!It[ie]){if(!lr(Ht,yh(Te,be,""))){if(!((ie==="src"||ie==="xlink:href"||ie==="href")&&B!=="script"&&M2(Te,"data:")===0&&de[B])){if(!(S&&!lr(me,yh(Te,be,"")))){if(Te)return!1}}}}}}return!0},OM=function(B){return B!=="annotation-xml"&&SO(B,st)},AM=function(B){eo(Q.beforeSanitizeAttributes,B,null);const{attributes:ie}=B;if(!ie||GC(B))return;const Te={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:R,forceKeepAttr:void 0};let Bt=ie.length;for(;Bt--;){const Bn=ie[Bt],{name:kn,namespaceURI:Sr,value:as}=Bn,gh=Pn(kn);let ar=kn==="value"?as:I2(as);if(Te.attrName=gh,Te.attrValue=ar,Te.keepAttr=!0,Te.forceKeepAttr=void 0,eo(Q.uponSanitizeAttribute,B,Te),ar=Te.attrValue,$&&(gh==="id"||gh==="name")&&(cg(kn,B),ar=q+ar),v&&lr(/((--!?|])>)|<\/(style|title)/i,ar)){cg(kn,B);continue}if(Te.forceKeepAttr||(cg(kn,B),!Te.keepAttr))continue;if(!_&&lr(/\/>/i,ar)){cg(kn,B);continue}p&&gg([ne,ce,ae],NM=>{ar=yh(ar,NM," ")});const HM=Pn(B.nodeName);if(PM(HM,gh,ar)){if(b&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Sr)switch(f.getAttributeType(HM,gh)){case"TrustedHTML":{ar=b.createHTML(ar);break}case"TrustedScriptURL":{ar=b.createScriptURL(ar);break}}try{Sr?B.setAttributeNS(Sr,kn,ar):B.setAttribute(kn,ar),GC(B)?os(B):bO(e.removed)}catch{}}}eo(Q.afterSanitizeAttributes,B,null)},$B=function Ie(B){let ie=null;const Te=xM(B);for(eo(Q.beforeSanitizeShadowDOM,B,null);ie=Te.nextNode();)eo(Q.uponSanitizeShadowNode,ie,null),IM(ie),AM(ie),ie.content instanceof s&&Ie(ie.content);eo(Q.afterSanitizeShadowDOM,B,null)};return e.sanitize=function(Ie){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie=null,Te=null,Bt=null,Bn=null;if(Fe=!Ie,Fe&&(Ie="<!-->"),typeof Ie!="string"&&!MM(Ie))if(typeof Ie.toString=="function"){if(Ie=Ie.toString(),typeof Ie!="string")throw vh("dirty is not a string, aborting")}else throw vh("toString is not a function");if(!e.isSupported)return Ie;if(I||YC(B),e.removed=[],typeof Ie=="string"&&(te=!1),te){if(Ie.nodeName){const as=Pn(Ie.nodeName);if(!g[as]||z[as])throw vh("root node is forbidden and cannot be sanitized in-place")}}else if(Ie instanceof a)ie=_M("<!---->"),Te=ie.ownerDocument.importNode(Ie,!0),Te.nodeType===Sh.element&&Te.nodeName==="BODY"||Te.nodeName==="HTML"?ie=Te:ie.appendChild(Te);else{if(!M&&!p&&!E&&Ie.indexOf("<")===-1)return b&&L?b.createHTML(Ie):Ie;if(ie=_M(Ie),!ie)return M?null:L?H:""}ie&&N&&os(ie.firstChild);const kn=xM(te?Ie:ie);for(;Bt=kn.nextNode();)IM(Bt),AM(Bt),Bt.content instanceof s&&$B(Bt.content);if(te)return Ie;if(M){if(A)for(Bn=U.call(ie.ownerDocument);ie.firstChild;)Bn.appendChild(ie.firstChild);else Bn=ie;return(R.shadowroot||R.shadowrootmode)&&(Bn=Y.call(r,Bn,!0)),Bn}let Sr=E?ie.outerHTML:ie.innerHTML;return E&&g["!doctype"]&&ie.ownerDocument&&ie.ownerDocument.doctype&&ie.ownerDocument.doctype.name&&lr(xk,ie.ownerDocument.doctype.name)&&(Sr="<!DOCTYPE "+ie.ownerDocument.doctype.name+`>
`+Sr),p&&gg([ne,ce,ae],as=>{Sr=yh(Sr,as," ")}),b&&L?b.createHTML(Sr):Sr},e.setConfig=function(){let Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};YC(Ie),I=!0},e.clearConfig=function(){Tu=null,I=!1},e.isValidAttribute=function(Ie,B,ie){Tu||YC({});const Te=Pn(Ie),Bt=Pn(B);return PM(Te,Bt,ie)},e.addHook=function(Ie,B){typeof B=="function"&&Ch(Q[Ie],B)},e.removeHook=function(Ie){return bO(Q[Ie])},e.removeHooks=function(Ie){Q[Ie]=[]},e.removeAllHooks=function(){Q=MO()},e}var U2=Mk();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Ik;function ee(){return Ik.apply(null,arguments)}function z2(t){Ik=t}function Zi(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ru(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function at(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function U0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(at(t,e))return!1;return!0}function Ir(t){return t===void 0}function Wo(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function $f(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function Pk(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function _a(t,e){for(var n in e)at(e,n)&&(t[n]=e[n]);return at(e,"toString")&&(t.toString=e.toString),at(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Xs(t,e,n,r){return Qk(t,e,n,r,!0).utc()}function Y2(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function $e(t){return t._pf==null&&(t._pf=Y2()),t._pf}var uE;Array.prototype.some?uE=Array.prototype.some:uE=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function z0(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=$e(t),n=uE.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function qw(t){var e=Xs(NaN);return t!=null?_a($e(e),t):$e(e).userInvalidated=!0,e}var IO=ee.momentProperties=[],Ib=!1;function Y0(t,e){var n,r,i,s=IO.length;if(Ir(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Ir(e._i)||(t._i=e._i),Ir(e._f)||(t._f=e._f),Ir(e._l)||(t._l=e._l),Ir(e._strict)||(t._strict=e._strict),Ir(e._tzm)||(t._tzm=e._tzm),Ir(e._isUTC)||(t._isUTC=e._isUTC),Ir(e._offset)||(t._offset=e._offset),Ir(e._pf)||(t._pf=$e(e)),Ir(e._locale)||(t._locale=e._locale),s>0)for(n=0;n<s;n++)r=IO[n],i=e[r],Ir(i)||(t[r]=i);return t}function Vf(t){Y0(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Ib===!1&&(Ib=!0,ee.updateOffset(this),Ib=!1)}function Ji(t){return t instanceof Vf||t!=null&&t._isAMomentObject!=null}function Ok(t){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Ei(t,e){var n=!0;return _a(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,t),n){var r=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])at(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];r.push(i)}Ok(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var PO={};function Ak(t,e){ee.deprecationHandler!=null&&ee.deprecationHandler(t,e),PO[t]||(Ok(e),PO[t]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function Zs(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function G2(t){var e,n;for(n in t)at(t,n)&&(e=t[n],Zs(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function cE(t,e){var n=_a({},t),r;for(r in e)at(e,r)&&(ru(t[r])&&ru(e[r])?(n[r]={},_a(n[r],t[r]),_a(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)at(t,r)&&!at(e,r)&&ru(t[r])&&(n[r]=_a({},n[r]));return n}function G0(t){t!=null&&this.set(t)}var hE;Object.keys?hE=Object.keys:hE=function(t){var e,n=[];for(e in t)at(t,e)&&n.push(e);return n};var q2={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function K2(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Zs(r)?r.call(e,n):r}function Gs(t,e,n){var r=""+Math.abs(t),i=e-r.length,s=t>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var q0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,pg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Pb={},Oc={};function xe(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Oc[t]=i),e&&(Oc[e[0]]=function(){return Gs(i.apply(this,arguments),e[1],e[2])}),n&&(Oc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function X2(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Z2(t){var e=t.match(q0),n,r;for(n=0,r=e.length;n<r;n++)Oc[e[n]]?e[n]=Oc[e[n]]:e[n]=X2(e[n]);return function(i){var s="",o;for(o=0;o<r;o++)s+=Zs(e[o])?e[o].call(i,t):e[o];return s}}function tp(t,e){return t.isValid()?(e=Hk(e,t.localeData()),Pb[e]=Pb[e]||Z2(e),Pb[e](t)):t.localeData().invalidDate()}function Hk(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(pg.lastIndex=0;n>=0&&pg.test(t);)t=t.replace(pg,r),pg.lastIndex=0,n-=1;return t}var J2={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Q2(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(q0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var eY="Invalid date";function tY(){return this._invalidDate}var nY="%d",rY=/\d{1,2}/;function iY(t){return this._ordinal.replace("%d",t)}var sY={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function oY(t,e,n,r){var i=this._relativeTime[n];return Zs(i)?i(t,e,n,r):i.replace(/%d/i,t)}function aY(t,e){var n=this._relativeTime[t>0?"future":"past"];return Zs(n)?n(e):n.replace(/%s/i,e)}var OO={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ti(t){return typeof t=="string"?OO[t]||OO[t.toLowerCase()]:void 0}function K0(t){var e={},n,r;for(r in t)at(t,r)&&(n=Ti(r),n&&(e[n]=t[r]));return e}var lY={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function uY(t){var e=[],n;for(n in t)at(t,n)&&e.push({unit:n,priority:lY[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var Nk=/\d/,Qr=/\d\d/,Dk=/\d{3}/,X0=/\d{4}/,Kw=/[+-]?\d{6}/,Wt=/\d\d?/,Lk=/\d\d\d\d?/,kk=/\d\d\d\d\d\d?/,Xw=/\d{1,3}/,Z0=/\d{1,4}/,Zw=/[+-]?\d{1,6}/,nh=/\d+/,Jw=/[+-]?\d+/,cY=/Z|[+-]\d\d:?\d\d/gi,Qw=/Z|[+-]\d\d(?::?\d\d)?/gi,hY=/[+-]?\d+(\.\d{1,3})?/,Wf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,rh=/^[1-9]\d?/,J0=/^([1-9]\d|\d)/,Hp;Hp={};function Ce(t,e,n){Hp[t]=Zs(e)?e:function(r,i){return r&&n?n:e}}function dY(t,e){return at(Hp,t)?Hp[t](e._strict,e._locale):new RegExp(fY(t))}function fY(t){return $o(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,s){return n||r||i||s}))}function $o(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function mi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function et(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=mi(e)),n}var dE={};function Et(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Wo(e)&&(r=function(s,o){o[e]=et(s)}),i=t.length,n=0;n<i;n++)dE[t[n]]=r}function Bf(t,e){Et(t,function(n,r,i,s){i._w=i._w||{},e(n,i._w,i,s)})}function gY(t,e,n){e!=null&&at(dE,t)&&dE[t](e,n._a,n,t)}function eC(t){return t%4===0&&t%100!==0||t%400===0}var nr=0,Oo=1,Fs=2,Mn=3,zi=4,Ao=5,Gl=6,mY=7,pY=8;xe("Y",0,0,function(){var t=this.year();return t<=9999?Gs(t,4):"+"+t});xe(0,["YY",2],0,function(){return this.year()%100});xe(0,["YYYY",4],0,"year");xe(0,["YYYYY",5],0,"year");xe(0,["YYYYYY",6,!0],0,"year");Ce("Y",Jw);Ce("YY",Wt,Qr);Ce("YYYY",Z0,X0);Ce("YYYYY",Zw,Kw);Ce("YYYYYY",Zw,Kw);Et(["YYYYY","YYYYYY"],nr);Et("YYYY",function(t,e){e[nr]=t.length===2?ee.parseTwoDigitYear(t):et(t)});Et("YY",function(t,e){e[nr]=ee.parseTwoDigitYear(t)});Et("Y",function(t,e){e[nr]=parseInt(t,10)});function Hd(t){return eC(t)?366:365}ee.parseTwoDigitYear=function(t){return et(t)+(et(t)>68?1900:2e3)};var Fk=ih("FullYear",!0);function wY(){return eC(this.year())}function ih(t,e){return function(n){return n!=null?($k(this,t,n),ee.updateOffset(this,e),this):lf(this,t)}}function lf(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function $k(t,e,n){var r,i,s,o,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}s=n,o=t.month(),a=t.date(),a=a===29&&o===1&&!eC(s)?28:a,i?r.setUTCFullYear(s,o,a):r.setFullYear(s,o,a)}}function CY(t){return t=Ti(t),Zs(this[t])?this[t]():this}function yY(t,e){if(typeof t=="object"){t=K0(t);var n=uY(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Ti(t),Zs(this[t]))return this[t](e);return this}function vY(t,e){return(t%e+e)%e}var hn;Array.prototype.indexOf?hn=Array.prototype.indexOf:hn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Q0(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=vY(e,12);return t+=(e-n)/12,n===1?eC(t)?29:28:31-n%7%2}xe("M",["MM",2],"Mo",function(){return this.month()+1});xe("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});xe("MMMM",0,0,function(t){return this.localeData().months(this,t)});Ce("M",Wt,rh);Ce("MM",Wt,Qr);Ce("MMM",function(t,e){return e.monthsShortRegex(t)});Ce("MMMM",function(t,e){return e.monthsRegex(t)});Et(["M","MM"],function(t,e){e[Oo]=et(t)-1});Et(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Oo]=i:$e(n).invalidMonth=t});var bY="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Vk="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Wk=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,SY=Wf,RY=Wf;function EY(t,e){return t?Zi(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Wk).test(e)?"format":"standalone"][t.month()]:Zi(this._months)?this._months:this._months.standalone}function TY(t,e){return t?Zi(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Wk.test(e)?"format":"standalone"][t.month()]:Zi(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function _Y(t,e,n){var r,i,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)s=Xs([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase();return n?e==="MMM"?(i=hn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=hn.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=hn.call(this._shortMonthsParse,o),i!==-1?i:(i=hn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=hn.call(this._longMonthsParse,o),i!==-1?i:(i=hn.call(this._shortMonthsParse,o),i!==-1?i:null))}function xY(t,e,n){var r,i,s;if(this._monthsParseExact)return _Y.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Xs([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function Bk(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=et(e);else if(e=t.localeData().monthsParse(e),!Wo(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,Q0(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function jk(t){return t!=null?(Bk(this,t),ee.updateOffset(this,!0),this):lf(this,"Month")}function MY(){return Q0(this.year(),this.month())}function IY(t){return this._monthsParseExact?(at(this,"_monthsRegex")||Uk.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=SY),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function PY(t){return this._monthsParseExact?(at(this,"_monthsRegex")||Uk.call(this),t?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=RY),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Uk(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,s,o,a;for(i=0;i<12;i++)s=Xs([2e3,i]),o=$o(this.monthsShort(s,"")),a=$o(this.months(s,"")),e.push(o),n.push(a),r.push(a),r.push(o);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function OY(t,e,n,r,i,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,s,o),a}function uf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Np(t,e,n){var r=7+e-n,i=(7+uf(t,0,r).getUTCDay()-e)%7;return-i+r-1}function zk(t,e,n,r,i){var s=(7+n-r)%7,o=Np(t,r,i),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=t-1,u=Hd(l)+a):a>Hd(t)?(l=t+1,u=a-Hd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function cf(t,e,n){var r=Np(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,s,o;return i<1?(o=t.year()-1,s=i+Vo(o,e,n)):i>Vo(t.year(),e,n)?(s=i-Vo(t.year(),e,n),o=t.year()+1):(o=t.year(),s=i),{week:s,year:o}}function Vo(t,e,n){var r=Np(t,e,n),i=Np(t+1,e,n);return(Hd(t)-r+i)/7}xe("w",["ww",2],"wo","week");xe("W",["WW",2],"Wo","isoWeek");Ce("w",Wt,rh);Ce("ww",Wt,Qr);Ce("W",Wt,rh);Ce("WW",Wt,Qr);Bf(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=et(t)});function AY(t){return cf(t,this._week.dow,this._week.doy).week}var HY={dow:0,doy:6};function NY(){return this._week.dow}function DY(){return this._week.doy}function LY(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function kY(t){var e=cf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}xe("d",0,"do","day");xe("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});xe("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});xe("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});xe("e",0,0,"weekday");xe("E",0,0,"isoWeekday");Ce("d",Wt);Ce("e",Wt);Ce("E",Wt);Ce("dd",function(t,e){return e.weekdaysMinRegex(t)});Ce("ddd",function(t,e){return e.weekdaysShortRegex(t)});Ce("dddd",function(t,e){return e.weekdaysRegex(t)});Bf(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:$e(n).invalidWeekday=t});Bf(["d","e","E"],function(t,e,n,r){e[r]=et(t)});function FY(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function $Y(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function eT(t,e){return t.slice(e,7).concat(t.slice(0,e))}var VY="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Yk="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),WY="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),BY=Wf,jY=Wf,UY=Wf;function zY(t,e){var n=Zi(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?eT(n,this._week.dow):t?n[t.day()]:n}function YY(t){return t===!0?eT(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function GY(t){return t===!0?eT(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function qY(t,e,n){var r,i,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)s=Xs([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase();return n?e==="dddd"?(i=hn.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=hn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=hn.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=hn.call(this._weekdaysParse,o),i!==-1||(i=hn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=hn.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=hn.call(this._shortWeekdaysParse,o),i!==-1||(i=hn.call(this._weekdaysParse,o),i!==-1)?i:(i=hn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=hn.call(this._minWeekdaysParse,o),i!==-1||(i=hn.call(this._weekdaysParse,o),i!==-1)?i:(i=hn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function KY(t,e,n){var r,i,s;if(this._weekdaysParseExact)return qY.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Xs([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function XY(t){if(!this.isValid())return t!=null?this:NaN;var e=lf(this,"Day");return t!=null?(t=FY(t,this.localeData()),this.add(t-e,"d")):e}function ZY(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function JY(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=$Y(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function QY(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||tT.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=BY),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function eG(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||tT.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=jY),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function tG(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||tT.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=UY),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function tT(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],s,o,a,l,u;for(s=0;s<7;s++)o=Xs([2e3,1]).day(s),a=$o(this.weekdaysMin(o,"")),l=$o(this.weekdaysShort(o,"")),u=$o(this.weekdays(o,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function nT(){return this.hours()%12||12}function nG(){return this.hours()||24}xe("H",["HH",2],0,"hour");xe("h",["hh",2],0,nT);xe("k",["kk",2],0,nG);xe("hmm",0,0,function(){return""+nT.apply(this)+Gs(this.minutes(),2)});xe("hmmss",0,0,function(){return""+nT.apply(this)+Gs(this.minutes(),2)+Gs(this.seconds(),2)});xe("Hmm",0,0,function(){return""+this.hours()+Gs(this.minutes(),2)});xe("Hmmss",0,0,function(){return""+this.hours()+Gs(this.minutes(),2)+Gs(this.seconds(),2)});function Gk(t,e){xe(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Gk("a",!0);Gk("A",!1);function qk(t,e){return e._meridiemParse}Ce("a",qk);Ce("A",qk);Ce("H",Wt,J0);Ce("h",Wt,rh);Ce("k",Wt,rh);Ce("HH",Wt,Qr);Ce("hh",Wt,Qr);Ce("kk",Wt,Qr);Ce("hmm",Lk);Ce("hmmss",kk);Ce("Hmm",Lk);Ce("Hmmss",kk);Et(["H","HH"],Mn);Et(["k","kk"],function(t,e,n){var r=et(t);e[Mn]=r===24?0:r});Et(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});Et(["h","hh"],function(t,e,n){e[Mn]=et(t),$e(n).bigHour=!0});Et("hmm",function(t,e,n){var r=t.length-2;e[Mn]=et(t.substr(0,r)),e[zi]=et(t.substr(r)),$e(n).bigHour=!0});Et("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Mn]=et(t.substr(0,r)),e[zi]=et(t.substr(r,2)),e[Ao]=et(t.substr(i)),$e(n).bigHour=!0});Et("Hmm",function(t,e,n){var r=t.length-2;e[Mn]=et(t.substr(0,r)),e[zi]=et(t.substr(r))});Et("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Mn]=et(t.substr(0,r)),e[zi]=et(t.substr(r,2)),e[Ao]=et(t.substr(i))});function rG(t){return(t+"").toLowerCase().charAt(0)==="p"}var iG=/[ap]\.?m?\.?/i,sG=ih("Hours",!0);function oG(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var Kk={calendar:q2,longDateFormat:J2,invalidDate:eY,ordinal:nY,dayOfMonthOrdinalParse:rY,relativeTime:sY,months:bY,monthsShort:Vk,week:HY,weekdays:VY,weekdaysMin:WY,weekdaysShort:Yk,meridiemParse:iG},Ut={},Rh={},hf;function aG(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function AO(t){return t&&t.toLowerCase().replace("_","-")}function lG(t){for(var e=0,n,r,i,s;e<t.length;){for(s=AO(t[e]).split("-"),n=s.length,r=AO(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=tC(s.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&aG(s,r)>=n-1)break;n--}e++}return hf}function uG(t){return!!(t&&t.match("^[^/\\\\]*$"))}function tC(t){var e=null,n;if(Ut[t]===void 0&&typeof Sp<"u"&&Sp&&Sp.exports&&uG(t))try{e=hf._abbr,n=require,n("./locale/"+t),Ha(e)}catch{Ut[t]=null}return Ut[t]}function Ha(t,e){var n;return t&&(Ir(e)?n=Go(t):n=rT(t,e),n?hf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),hf._abbr}function rT(t,e){if(e!==null){var n,r=Kk;if(e.abbr=t,Ut[t]!=null)Ak("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ut[t]._config;else if(e.parentLocale!=null)if(Ut[e.parentLocale]!=null)r=Ut[e.parentLocale]._config;else if(n=tC(e.parentLocale),n!=null)r=n._config;else return Rh[e.parentLocale]||(Rh[e.parentLocale]=[]),Rh[e.parentLocale].push({name:t,config:e}),null;return Ut[t]=new G0(cE(r,e)),Rh[t]&&Rh[t].forEach(function(i){rT(i.name,i.config)}),Ha(t),Ut[t]}else return delete Ut[t],null}function cG(t,e){if(e!=null){var n,r,i=Kk;Ut[t]!=null&&Ut[t].parentLocale!=null?Ut[t].set(cE(Ut[t]._config,e)):(r=tC(t),r!=null&&(i=r._config),e=cE(i,e),r==null&&(e.abbr=t),n=new G0(e),n.parentLocale=Ut[t],Ut[t]=n),Ha(t)}else Ut[t]!=null&&(Ut[t].parentLocale!=null?(Ut[t]=Ut[t].parentLocale,t===Ha()&&Ha(t)):Ut[t]!=null&&delete Ut[t]);return Ut[t]}function Go(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return hf;if(!Zi(t)){if(e=tC(t),e)return e;t=[t]}return lG(t)}function hG(){return hE(Ut)}function iT(t){var e,n=t._a;return n&&$e(t).overflow===-2&&(e=n[Oo]<0||n[Oo]>11?Oo:n[Fs]<1||n[Fs]>Q0(n[nr],n[Oo])?Fs:n[Mn]<0||n[Mn]>24||n[Mn]===24&&(n[zi]!==0||n[Ao]!==0||n[Gl]!==0)?Mn:n[zi]<0||n[zi]>59?zi:n[Ao]<0||n[Ao]>59?Ao:n[Gl]<0||n[Gl]>999?Gl:-1,$e(t)._overflowDayOfYear&&(e<nr||e>Fs)&&(e=Fs),$e(t)._overflowWeeks&&e===-1&&(e=mY),$e(t)._overflowWeekday&&e===-1&&(e=pY),$e(t).overflow=e),t}var dG=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,fG=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gG=/Z|[+-]\d\d(?::?\d\d)?/,wg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ob=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],mG=/^\/?Date\((-?\d+)/i,pG=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,wG={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Xk(t){var e,n,r=t._i,i=dG.exec(r)||fG.exec(r),s,o,a,l,u=wg.length,c=Ob.length;if(i){for($e(t).iso=!0,e=0,n=u;e<n;e++)if(wg[e][1].exec(i[1])){o=wg[e][0],s=wg[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Ob[e][1].exec(i[3])){a=(i[2]||" ")+Ob[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(i[4])if(gG.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),oT(t)}else t._isValid=!1}function CG(t,e,n,r,i,s){var o=[yG(t),Vk.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function yG(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function vG(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function bG(t,e,n){if(t){var r=Yk.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return $e(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function SG(t,e,n){if(t)return wG[t];if(e)return 0;var r=parseInt(n,10),i=r%100,s=(r-i)/100;return s*60+i}function Zk(t){var e=pG.exec(vG(t._i)),n;if(e){if(n=CG(e[4],e[3],e[2],e[5],e[6],e[7]),!bG(e[1],n,t))return;t._a=n,t._tzm=SG(e[8],e[9],e[10]),t._d=uf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),$e(t).rfc2822=!0}else t._isValid=!1}function RG(t){var e=mG.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(Xk(t),t._isValid===!1)delete t._isValid;else return;if(Zk(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:ee.createFromInputFallback(t)}ee.createFromInputFallback=Ei("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function cc(t,e,n){return t??e??n}function EG(t){var e=new Date(ee.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function sT(t){var e,n,r=[],i,s,o;if(!t._d){for(i=EG(t),t._w&&t._a[Fs]==null&&t._a[Oo]==null&&TG(t),t._dayOfYear!=null&&(o=cc(t._a[nr],i[nr]),(t._dayOfYear>Hd(o)||t._dayOfYear===0)&&($e(t)._overflowDayOfYear=!0),n=uf(o,0,t._dayOfYear),t._a[Oo]=n.getUTCMonth(),t._a[Fs]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Mn]===24&&t._a[zi]===0&&t._a[Ao]===0&&t._a[Gl]===0&&(t._nextDay=!0,t._a[Mn]=0),t._d=(t._useUTC?uf:OY).apply(null,r),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Mn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&($e(t).weekdayMismatch=!0)}}function TG(t){var e,n,r,i,s,o,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,n=cc(e.GG,t._a[nr],cf(Vt(),1,4).year),r=cc(e.W,1),i=cc(e.E,1),(i<1||i>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,u=cf(Vt(),s,o),n=cc(e.gg,t._a[nr],u.year),r=cc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),r<1||r>Vo(n,s,o)?$e(t)._overflowWeeks=!0:l!=null?$e(t)._overflowWeekday=!0:(a=zk(n,r,i,s,o),t._a[nr]=a.year,t._dayOfYear=a.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function oT(t){if(t._f===ee.ISO_8601){Xk(t);return}if(t._f===ee.RFC_2822){Zk(t);return}t._a=[],$e(t).empty=!0;var e=""+t._i,n,r,i,s,o,a=e.length,l=0,u,c;for(i=Hk(t._f,t._locale).match(q0)||[],c=i.length,n=0;n<c;n++)s=i[n],r=(e.match(dY(s,t))||[])[0],r&&(o=e.substr(0,e.indexOf(r)),o.length>0&&$e(t).unusedInput.push(o),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Oc[s]?(r?$e(t).empty=!1:$e(t).unusedTokens.push(s),gY(s,r,t)):t._strict&&!r&&$e(t).unusedTokens.push(s);$e(t).charsLeftOver=a-l,e.length>0&&$e(t).unusedInput.push(e),t._a[Mn]<=12&&$e(t).bigHour===!0&&t._a[Mn]>0&&($e(t).bigHour=void 0),$e(t).parsedDateParts=t._a.slice(0),$e(t).meridiem=t._meridiem,t._a[Mn]=_G(t._locale,t._a[Mn],t._meridiem),u=$e(t).era,u!==null&&(t._a[nr]=t._locale.erasConvertYear(u,t._a[nr])),sT(t),iT(t)}function _G(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function xG(t){var e,n,r,i,s,o,a=!1,l=t._f.length;if(l===0){$e(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=Y0({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],oT(e),z0(e)&&(o=!0),s+=$e(e).charsLeftOver,s+=$e(e).unusedTokens.length*10,$e(e).score=s,a?s<r&&(r=s,n=e):(r==null||s<r||o)&&(r=s,n=e,o&&(a=!0));_a(t,n||e)}function MG(t){if(!t._d){var e=K0(t._i),n=e.day===void 0?e.date:e.day;t._a=Pk([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),sT(t)}}function IG(t){var e=new Vf(iT(Jk(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Jk(t){var e=t._i,n=t._f;return t._locale=t._locale||Go(t._l),e===null||n===void 0&&e===""?qw({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Ji(e)?new Vf(iT(e)):($f(e)?t._d=e:Zi(n)?xG(t):n?oT(t):PG(t),z0(t)||(t._d=null),t))}function PG(t){var e=t._i;Ir(e)?t._d=new Date(ee.now()):$f(e)?t._d=new Date(e.valueOf()):typeof e=="string"?RG(t):Zi(e)?(t._a=Pk(e.slice(0),function(n){return parseInt(n,10)}),sT(t)):ru(e)?MG(t):Wo(e)?t._d=new Date(e):ee.createFromInputFallback(t)}function Qk(t,e,n,r,i){var s={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ru(t)&&U0(t)||Zi(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=n,s._i=t,s._f=e,s._strict=r,IG(s)}function Vt(t,e,n,r){return Qk(t,e,n,r,!1)}var OG=Ei("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Vt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:qw()}),AG=Ei("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Vt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:qw()});function eF(t,e){var n,r;if(e.length===1&&Zi(e[0])&&(e=e[0]),!e.length)return Vt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function HG(){var t=[].slice.call(arguments,0);return eF("isBefore",t)}function NG(){var t=[].slice.call(arguments,0);return eF("isAfter",t)}var DG=function(){return Date.now?Date.now():+new Date},Eh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function LG(t){var e,n=!1,r,i=Eh.length;for(e in t)if(at(t,e)&&!(hn.call(Eh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Eh[r]]){if(n)return!1;parseFloat(t[Eh[r]])!==et(t[Eh[r]])&&(n=!0)}return!0}function kG(){return this._isValid}function FG(){return rs(NaN)}function nC(t){var e=K0(t),n=e.year||0,r=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=LG(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+r*3+n*12,this._data={},this._locale=Go(),this._bubble()}function np(t){return t instanceof nC}function fE(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function $G(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,o;for(o=0;o<r;o++)et(t[o])!==et(e[o])&&s++;return s+i}function tF(t,e){xe(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Gs(~~(n/60),2)+e+Gs(~~n%60,2)})}tF("Z",":");tF("ZZ","");Ce("Z",Qw);Ce("ZZ",Qw);Et(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=aT(Qw,t)});var VG=/([\+\-]|\d\d)/gi;function aT(t,e){var n=(e||"").match(t),r,i,s;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(VG)||["-",0,0],s=+(i[1]*60)+et(i[2]),s===0?0:i[0]==="+"?s:-s)}function lT(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Ji(t)||$f(t)?t.valueOf():Vt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),ee.updateOffset(n,!1),n):Vt(t).local()}function gE(t){return-Math.round(t._d.getTimezoneOffset())}ee.updateOffset=function(){};function WG(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=aT(Qw,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=gE(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?iF(this,rs(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:gE(this)}function BG(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function jG(t){return this.utcOffset(0,t)}function UG(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(gE(this),"m")),this}function zG(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=aT(cY,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function YG(t){return this.isValid()?(t=t?Vt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function GG(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qG(){if(!Ir(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Y0(t,this),t=Jk(t),t._a?(e=t._isUTC?Xs(t._a):Vt(t._a),this._isDSTShifted=this.isValid()&&$G(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function KG(){return this.isValid()?!this._isUTC:!1}function XG(){return this.isValid()?this._isUTC:!1}function nF(){return this.isValid()?this._isUTC&&this._offset===0:!1}var ZG=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,JG=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function rs(t,e){var n=t,r=null,i,s,o;return np(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Wo(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=ZG.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:et(r[Fs])*i,h:et(r[Mn])*i,m:et(r[zi])*i,s:et(r[Ao])*i,ms:et(fE(r[Gl]*1e3))*i}):(r=JG.exec(t))?(i=r[1]==="-"?-1:1,n={y:tl(r[2],i),M:tl(r[3],i),w:tl(r[4],i),d:tl(r[5],i),h:tl(r[6],i),m:tl(r[7],i),s:tl(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(o=QG(Vt(n.from),Vt(n.to)),n={},n.ms=o.milliseconds,n.M=o.months),s=new nC(n),np(t)&&at(t,"_locale")&&(s._locale=t._locale),np(t)&&at(t,"_isValid")&&(s._isValid=t._isValid),s}rs.fn=nC.prototype;rs.invalid=FG;function tl(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function HO(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function QG(t,e){var n;return t.isValid()&&e.isValid()?(e=lT(e,t),t.isBefore(e)?n=HO(t,e):(n=HO(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function rF(t,e){return function(n,r){var i,s;return r!==null&&!isNaN(+r)&&(Ak(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=r,r=s),i=rs(n,r),iF(this,i,t),this}}function iF(t,e,n,r){var i=e._milliseconds,s=fE(e._days),o=fE(e._months);t.isValid()&&(r=r??!0,o&&Bk(t,lf(t,"Month")+o*n),s&&$k(t,"Date",lf(t,"Date")+s*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&ee.updateOffset(t,s||o))}var eq=rF(1,"add"),tq=rF(-1,"subtract");function sF(t){return typeof t=="string"||t instanceof String}function nq(t){return Ji(t)||$f(t)||sF(t)||Wo(t)||iq(t)||rq(t)||t===null||t===void 0}function rq(t){var e=ru(t)&&!U0(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=r.length;for(i=0;i<o;i+=1)s=r[i],n=n||at(t,s);return e&&n}function iq(t){var e=Zi(t),n=!1;return e&&(n=t.filter(function(r){return!Wo(r)&&sF(t)}).length===0),e&&n}function sq(t){var e=ru(t)&&!U0(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<r.length;i+=1)s=r[i],n=n||at(t,s);return e&&n}function oq(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function aq(t,e){arguments.length===1&&(arguments[0]?nq(arguments[0])?(t=arguments[0],e=void 0):sq(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Vt(),r=lT(n,this).startOf("day"),i=ee.calendarFormat(this,r)||"sameElse",s=e&&(Zs(e[i])?e[i].call(this,n):e[i]);return this.format(s||this.localeData().calendar(i,this,Vt(n)))}function lq(){return new Vf(this)}function uq(t,e){var n=Ji(t)?t:Vt(t);return this.isValid()&&n.isValid()?(e=Ti(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function cq(t,e){var n=Ji(t)?t:Vt(t);return this.isValid()&&n.isValid()?(e=Ti(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function hq(t,e,n,r){var i=Ji(t)?t:Vt(t),s=Ji(e)?e:Vt(e);return this.isValid()&&i.isValid()&&s.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(s,n):!this.isAfter(s,n))):!1}function dq(t,e){var n=Ji(t)?t:Vt(t),r;return this.isValid()&&n.isValid()?(e=Ti(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function fq(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function gq(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function mq(t,e,n){var r,i,s;if(!this.isValid())return NaN;if(r=lT(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Ti(e),e){case"year":s=rp(this,r)/12;break;case"month":s=rp(this,r);break;case"quarter":s=rp(this,r)/3;break;case"second":s=(this-r)/1e3;break;case"minute":s=(this-r)/6e4;break;case"hour":s=(this-r)/36e5;break;case"day":s=(this-r-i)/864e5;break;case"week":s=(this-r-i)/6048e5;break;default:s=this-r}return n?s:mi(s)}function rp(t,e){if(t.date()<e.date())return-rp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,s;return e-r<0?(i=t.clone().add(n-1,"months"),s=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),s=(e-r)/(i-r)),-(n+s)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function pq(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function wq(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?tp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Zs(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",tp(n,"Z")):tp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Cq(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(n+r+i+s)}function yq(t){t||(t=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var e=tp(this,t);return this.localeData().postformat(e)}function vq(t,e){return this.isValid()&&(Ji(t)&&t.isValid()||Vt(t).isValid())?rs({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function bq(t){return this.from(Vt(),t)}function Sq(t,e){return this.isValid()&&(Ji(t)&&t.isValid()||Vt(t).isValid())?rs({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Rq(t){return this.to(Vt(),t)}function oF(t){var e;return t===void 0?this._locale._abbr:(e=Go(t),e!=null&&(this._locale=e),this)}var aF=Ei("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function lF(){return this._locale}var Dp=1e3,Ac=60*Dp,Lp=60*Ac,uF=(365*400+97)*24*Lp;function Hc(t,e){return(t%e+e)%e}function cF(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-uF:new Date(t,e,n).valueOf()}function hF(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-uF:Date.UTC(t,e,n)}function Eq(t){var e,n;if(t=Ti(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?hF:cF,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Hc(e+(this._isUTC?0:this.utcOffset()*Ac),Lp);break;case"minute":e=this._d.valueOf(),e-=Hc(e,Ac);break;case"second":e=this._d.valueOf(),e-=Hc(e,Dp);break}return this._d.setTime(e),ee.updateOffset(this,!0),this}function Tq(t){var e,n;if(t=Ti(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?hF:cF,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Lp-Hc(e+(this._isUTC?0:this.utcOffset()*Ac),Lp)-1;break;case"minute":e=this._d.valueOf(),e+=Ac-Hc(e,Ac)-1;break;case"second":e=this._d.valueOf(),e+=Dp-Hc(e,Dp)-1;break}return this._d.setTime(e),ee.updateOffset(this,!0),this}function _q(){return this._d.valueOf()-(this._offset||0)*6e4}function xq(){return Math.floor(this.valueOf()/1e3)}function Mq(){return new Date(this.valueOf())}function Iq(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Pq(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Oq(){return this.isValid()?this.toISOString():null}function Aq(){return z0(this)}function Hq(){return _a({},$e(this))}function Nq(){return $e(this).overflow}function Dq(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}xe("N",0,0,"eraAbbr");xe("NN",0,0,"eraAbbr");xe("NNN",0,0,"eraAbbr");xe("NNNN",0,0,"eraName");xe("NNNNN",0,0,"eraNarrow");xe("y",["y",1],"yo","eraYear");xe("y",["yy",2],0,"eraYear");xe("y",["yyy",3],0,"eraYear");xe("y",["yyyy",4],0,"eraYear");Ce("N",uT);Ce("NN",uT);Ce("NNN",uT);Ce("NNNN",Yq);Ce("NNNNN",Gq);Et(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?$e(n).era=i:$e(n).invalidEra=t});Ce("y",nh);Ce("yy",nh);Ce("yyy",nh);Ce("yyyy",nh);Ce("yo",qq);Et(["y","yy","yyy","yyyy"],nr);Et(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[nr]=n._locale.eraYearOrdinalParse(t,i):e[nr]=parseInt(t,10)});function Lq(t,e){var n,r,i,s=this._eras||Go("en")._eras;for(n=0,r=s.length;n<r;++n){switch(typeof s[n].since){case"string":i=ee(s[n].since).startOf("day"),s[n].since=i.valueOf();break}switch(typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":i=ee(s[n].until).startOf("day").valueOf(),s[n].until=i.valueOf();break}}return s}function kq(t,e,n){var r,i,s=this.eras(),o,a,l;for(t=t.toUpperCase(),r=0,i=s.length;r<i;++r)if(o=s[r].name.toUpperCase(),a=s[r].abbr.toUpperCase(),l=s[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[r];break;case"NNNN":if(o===t)return s[r];break;case"NNNNN":if(l===t)return s[r];break}else if([o,a,l].indexOf(t)>=0)return s[r]}function Fq(t,e){var n=t.since<=t.until?1:-1;return e===void 0?ee(t.since).year():ee(t.since).year()+(e-t.offset)*n}function $q(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function Vq(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function Wq(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function Bq(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-ee(i[t].since).year())*n+i[t].offset;return this.year()}function jq(t){return at(this,"_erasNameRegex")||cT.call(this),t?this._erasNameRegex:this._erasRegex}function Uq(t){return at(this,"_erasAbbrRegex")||cT.call(this),t?this._erasAbbrRegex:this._erasRegex}function zq(t){return at(this,"_erasNarrowRegex")||cT.call(this),t?this._erasNarrowRegex:this._erasRegex}function uT(t,e){return e.erasAbbrRegex(t)}function Yq(t,e){return e.erasNameRegex(t)}function Gq(t,e){return e.erasNarrowRegex(t)}function qq(t,e){return e._eraYearOrdinalRegex||nh}function cT(){var t=[],e=[],n=[],r=[],i,s,o,a,l,u=this.eras();for(i=0,s=u.length;i<s;++i)o=$o(u[i].name),a=$o(u[i].abbr),l=$o(u[i].narrow),e.push(o),t.push(a),n.push(l),r.push(o),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}xe(0,["gg",2],0,function(){return this.weekYear()%100});xe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function rC(t,e){xe(0,[t,t.length],0,e)}rC("gggg","weekYear");rC("ggggg","weekYear");rC("GGGG","isoWeekYear");rC("GGGGG","isoWeekYear");Ce("G",Jw);Ce("g",Jw);Ce("GG",Wt,Qr);Ce("gg",Wt,Qr);Ce("GGGG",Z0,X0);Ce("gggg",Z0,X0);Ce("GGGGG",Zw,Kw);Ce("ggggg",Zw,Kw);Bf(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=et(t)});Bf(["gg","GG"],function(t,e,n,r){e[r]=ee.parseTwoDigitYear(t)});function Kq(t){return dF.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Xq(t){return dF.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Zq(){return Vo(this.year(),1,4)}function Jq(){return Vo(this.isoWeekYear(),1,4)}function Qq(){var t=this.localeData()._week;return Vo(this.year(),t.dow,t.doy)}function eK(){var t=this.localeData()._week;return Vo(this.weekYear(),t.dow,t.doy)}function dF(t,e,n,r,i){var s;return t==null?cf(this,r,i).year:(s=Vo(t,r,i),e>s&&(e=s),tK.call(this,t,e,n,r,i))}function tK(t,e,n,r,i){var s=zk(t,e,n,r,i),o=uf(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}xe("Q",0,"Qo","quarter");Ce("Q",Nk);Et("Q",function(t,e){e[Oo]=(et(t)-1)*3});function nK(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}xe("D",["DD",2],"Do","date");Ce("D",Wt,rh);Ce("DD",Wt,Qr);Ce("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Et(["D","DD"],Fs);Et("Do",function(t,e){e[Fs]=et(t.match(Wt)[0])});var fF=ih("Date",!0);xe("DDD",["DDDD",3],"DDDo","dayOfYear");Ce("DDD",Xw);Ce("DDDD",Dk);Et(["DDD","DDDD"],function(t,e,n){n._dayOfYear=et(t)});function rK(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}xe("m",["mm",2],0,"minute");Ce("m",Wt,J0);Ce("mm",Wt,Qr);Et(["m","mm"],zi);var iK=ih("Minutes",!1);xe("s",["ss",2],0,"second");Ce("s",Wt,J0);Ce("ss",Wt,Qr);Et(["s","ss"],Ao);var sK=ih("Seconds",!1);xe("S",0,0,function(){return~~(this.millisecond()/100)});xe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});xe(0,["SSS",3],0,"millisecond");xe(0,["SSSS",4],0,function(){return this.millisecond()*10});xe(0,["SSSSS",5],0,function(){return this.millisecond()*100});xe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});xe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});xe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});xe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Ce("S",Xw,Nk);Ce("SS",Xw,Qr);Ce("SSS",Xw,Dk);var xa,gF;for(xa="SSSS";xa.length<=9;xa+="S")Ce(xa,nh);function oK(t,e){e[Gl]=et(("0."+t)*1e3)}for(xa="S";xa.length<=9;xa+="S")Et(xa,oK);gF=ih("Milliseconds",!1);xe("z",0,0,"zoneAbbr");xe("zz",0,0,"zoneName");function aK(){return this._isUTC?"UTC":""}function lK(){return this._isUTC?"Coordinated Universal Time":""}var re=Vf.prototype;re.add=eq;re.calendar=aq;re.clone=lq;re.diff=mq;re.endOf=Tq;re.format=yq;re.from=vq;re.fromNow=bq;re.to=Sq;re.toNow=Rq;re.get=CY;re.invalidAt=Nq;re.isAfter=uq;re.isBefore=cq;re.isBetween=hq;re.isSame=dq;re.isSameOrAfter=fq;re.isSameOrBefore=gq;re.isValid=Aq;re.lang=aF;re.locale=oF;re.localeData=lF;re.max=AG;re.min=OG;re.parsingFlags=Hq;re.set=yY;re.startOf=Eq;re.subtract=tq;re.toArray=Iq;re.toObject=Pq;re.toDate=Mq;re.toISOString=wq;re.inspect=Cq;typeof Symbol<"u"&&Symbol.for!=null&&(re[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});re.toJSON=Oq;re.toString=pq;re.unix=xq;re.valueOf=_q;re.creationData=Dq;re.eraName=$q;re.eraNarrow=Vq;re.eraAbbr=Wq;re.eraYear=Bq;re.year=Fk;re.isLeapYear=wY;re.weekYear=Kq;re.isoWeekYear=Xq;re.quarter=re.quarters=nK;re.month=jk;re.daysInMonth=MY;re.week=re.weeks=LY;re.isoWeek=re.isoWeeks=kY;re.weeksInYear=Qq;re.weeksInWeekYear=eK;re.isoWeeksInYear=Zq;re.isoWeeksInISOWeekYear=Jq;re.date=fF;re.day=re.days=XY;re.weekday=ZY;re.isoWeekday=JY;re.dayOfYear=rK;re.hour=re.hours=sG;re.minute=re.minutes=iK;re.second=re.seconds=sK;re.millisecond=re.milliseconds=gF;re.utcOffset=WG;re.utc=jG;re.local=UG;re.parseZone=zG;re.hasAlignedHourOffset=YG;re.isDST=GG;re.isLocal=KG;re.isUtcOffset=XG;re.isUtc=nF;re.isUTC=nF;re.zoneAbbr=aK;re.zoneName=lK;re.dates=Ei("dates accessor is deprecated. Use date instead.",fF);re.months=Ei("months accessor is deprecated. Use month instead",jk);re.years=Ei("years accessor is deprecated. Use year instead",Fk);re.zone=Ei("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",BG);re.isDSTShifted=Ei("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",qG);function uK(t){return Vt(t*1e3)}function cK(){return Vt.apply(null,arguments).parseZone()}function mF(t){return t}var lt=G0.prototype;lt.calendar=K2;lt.longDateFormat=Q2;lt.invalidDate=tY;lt.ordinal=iY;lt.preparse=mF;lt.postformat=mF;lt.relativeTime=oY;lt.pastFuture=aY;lt.set=G2;lt.eras=Lq;lt.erasParse=kq;lt.erasConvertYear=Fq;lt.erasAbbrRegex=Uq;lt.erasNameRegex=jq;lt.erasNarrowRegex=zq;lt.months=EY;lt.monthsShort=TY;lt.monthsParse=xY;lt.monthsRegex=PY;lt.monthsShortRegex=IY;lt.week=AY;lt.firstDayOfYear=DY;lt.firstDayOfWeek=NY;lt.weekdays=zY;lt.weekdaysMin=GY;lt.weekdaysShort=YY;lt.weekdaysParse=KY;lt.weekdaysRegex=QY;lt.weekdaysShortRegex=eG;lt.weekdaysMinRegex=tG;lt.isPM=rG;lt.meridiem=oG;function kp(t,e,n,r){var i=Go(),s=Xs().set(r,e);return i[n](s,t)}function pF(t,e,n){if(Wo(t)&&(e=t,t=void 0),t=t||"",e!=null)return kp(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=kp(t,r,n,"month");return i}function hT(t,e,n,r){typeof t=="boolean"?(Wo(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Wo(e)&&(n=e,e=void 0),e=e||"");var i=Go(),s=t?i._week.dow:0,o,a=[];if(n!=null)return kp(e,(n+s)%7,r,"day");for(o=0;o<7;o++)a[o]=kp(e,(o+s)%7,r,"day");return a}function hK(t,e){return pF(t,e,"months")}function dK(t,e){return pF(t,e,"monthsShort")}function fK(t,e,n){return hT(t,e,n,"weekdays")}function gK(t,e,n){return hT(t,e,n,"weekdaysShort")}function mK(t,e,n){return hT(t,e,n,"weekdaysMin")}Ha("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=et(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});ee.lang=Ei("moment.lang is deprecated. Use moment.locale instead.",Ha);ee.langData=Ei("moment.langData is deprecated. Use moment.localeData instead.",Go);var no=Math.abs;function pK(){var t=this._data;return this._milliseconds=no(this._milliseconds),this._days=no(this._days),this._months=no(this._months),t.milliseconds=no(t.milliseconds),t.seconds=no(t.seconds),t.minutes=no(t.minutes),t.hours=no(t.hours),t.months=no(t.months),t.years=no(t.years),this}function wF(t,e,n,r){var i=rs(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function wK(t,e){return wF(this,t,e,1)}function CK(t,e){return wF(this,t,e,-1)}function NO(t){return t<0?Math.floor(t):Math.ceil(t)}function yK(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,s,o,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=NO(mE(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=mi(t/1e3),r.seconds=i%60,s=mi(i/60),r.minutes=s%60,o=mi(s/60),r.hours=o%24,e+=mi(o/24),l=mi(CF(e)),n+=l,e-=NO(mE(l)),a=mi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function CF(t){return t*4800/146097}function mE(t){return t*146097/4800}function vK(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Ti(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+CF(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(mE(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function qo(t){return function(){return this.as(t)}}var yF=qo("ms"),bK=qo("s"),SK=qo("m"),RK=qo("h"),EK=qo("d"),TK=qo("w"),_K=qo("M"),xK=qo("Q"),MK=qo("y"),IK=yF;function PK(){return rs(this)}function OK(t){return t=Ti(t),this.isValid()?this[t+"s"]():NaN}function vu(t){return function(){return this.isValid()?this._data[t]:NaN}}var AK=vu("milliseconds"),HK=vu("seconds"),NK=vu("minutes"),DK=vu("hours"),LK=vu("days"),kK=vu("months"),FK=vu("years");function $K(){return mi(this.days()/7)}var So=Math.round,Cc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function VK(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function WK(t,e,n,r){var i=rs(t).abs(),s=So(i.as("s")),o=So(i.as("m")),a=So(i.as("h")),l=So(i.as("d")),u=So(i.as("M")),c=So(i.as("w")),h=So(i.as("y")),d=s<=n.ss&&["s",s]||s<n.s&&["ss",s]||o<=1&&["m"]||o<n.m&&["mm",o]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,VK.apply(null,d)}function BK(t){return t===void 0?So:typeof t=="function"?(So=t,!0):!1}function jK(t,e){return Cc[t]===void 0?!1:e===void 0?Cc[t]:(Cc[t]=e,t==="s"&&(Cc.ss=e-1),!0)}function UK(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Cc,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Cc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),s=WK(this,!n,r,i),n&&(s=i.pastFuture(+this,s)),i.postformat(s)}var Ab=Math.abs;function xu(t){return(t>0)-(t<0)||+t}function iC(){if(!this.isValid())return this.localeData().invalidDate();var t=Ab(this._milliseconds)/1e3,e=Ab(this._days),n=Ab(this._months),r,i,s,o,a=this.asSeconds(),l,u,c,h;return a?(r=mi(t/60),i=mi(r/60),t%=60,r%=60,s=mi(n/12),n%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=xu(this._months)!==xu(a)?"-":"",c=xu(this._days)!==xu(a)?"-":"",h=xu(this._milliseconds)!==xu(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+o+"S":"")):"P0D"}var it=nC.prototype;it.isValid=kG;it.abs=pK;it.add=wK;it.subtract=CK;it.as=vK;it.asMilliseconds=yF;it.asSeconds=bK;it.asMinutes=SK;it.asHours=RK;it.asDays=EK;it.asWeeks=TK;it.asMonths=_K;it.asQuarters=xK;it.asYears=MK;it.valueOf=IK;it._bubble=yK;it.clone=PK;it.get=OK;it.milliseconds=AK;it.seconds=HK;it.minutes=NK;it.hours=DK;it.days=LK;it.weeks=$K;it.months=kK;it.years=FK;it.humanize=UK;it.toISOString=iC;it.toString=iC;it.toJSON=iC;it.locale=oF;it.localeData=lF;it.toIsoString=Ei("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",iC);it.lang=aF;xe("X",0,0,"unix");xe("x",0,0,"valueOf");Ce("x",Jw);Ce("X",hY);Et("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});Et("x",function(t,e,n){n._d=new Date(et(t))});//! moment.js
ee.version="2.30.1";z2(Vt);ee.fn=re;ee.min=HG;ee.max=NG;ee.now=DG;ee.utc=Xs;ee.unix=uK;ee.months=hK;ee.isDate=$f;ee.locale=Ha;ee.invalid=qw;ee.duration=rs;ee.isMoment=Ji;ee.weekdays=fK;ee.parseZone=cK;ee.localeData=Go;ee.isDuration=np;ee.monthsShort=dK;ee.weekdaysMin=mK;ee.defineLocale=rT;ee.updateLocale=cG;ee.locales=hG;ee.weekdaysShort=gK;ee.normalizeUnits=Ti;ee.relativeTimeRounding=BK;ee.relativeTimeThreshold=jK;ee.calendarFormat=oq;ee.prototype=re;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function vF(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function pE(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Nd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let s=0;s<r;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function mn(t,e,n,r){let i=-1,s=t,o=n;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(r&&a&&(i+=1,o=s[i]),i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function Bo(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,s=[];let o=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(o+=1,s[o]=a),n+=1}return s}function qe(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,s=[];let o=-1;for(;n<i;){const a=r[n];o+=1,s[o]=e(a,n,r),n+=1}return s}function F(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function bF(t){return mn(t,(e,n)=>e+n,0)}function zK(t){return mn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function YK(t){return mn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function GK(t){return t.length?bF(t)/t.length:0}function SF(t){return mn(t,(e,n)=>e.concat(Array.isArray(n)?SF(n):n),[])}function dT(t){const e=[];return F(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function wE(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let s=r;return F(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function qK(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let s=r;return F(i,o=>{s=s.filter(a=>o.includes(a))}),s}function KK(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],s=new Set(r);return F(i,o=>{F(o,a=>{s.has(a)||s.add(a)})}),Array.from(s)}function CE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const XK=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:GK,arrayEach:F,arrayFilter:Bo,arrayFlatten:SF,arrayMap:qe,arrayMax:zK,arrayMin:YK,arrayReduce:mn,arraySum:bF,arrayUnique:dT,extendArray:pE,getDifferenceOfArrays:wE,getIntersectionOfArrays:qK,getUnionOfArrays:KK,pivot:Nd,stringToArray:CE,to2dArray:vF},Symbol.toStringTag,{value:"Module"}));function pt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return mn(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return s+l+u},"").trim()}function Jt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function we(t){return typeof t<"u"}function Ft(t){return typeof t>"u"}function Qt(t){return t===null||t===""||Ft(t)}function RF(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const vd="length",Dd=t=>parseInt(t,16),DO=t=>parseInt(t,10),Fp=(t,e,n)=>t.substr(e,n),Ld=t=>t.codePointAt(0)-65,yE=t=>`${t}`.replace(/\-/g,""),ZK=t=>Dd(Fp(yE(t),Dd("12"),Ld("F")))/(Dd(Fp(yE(t),Ld("B"),~~![][vd]))||9),JK=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let LO=!1;const kO={invalid:()=>pt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return pt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>pt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},FO={invalid:()=>pt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return pt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>pt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function EF(t,e){const n=!Qt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.0.0";let s,o="invalid",a="invalid";t=yE(t||"");const l=QK(t);if(n||r||l)if(l){const u=ee("16/12/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=ZK(t);s=ee((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(o="expired",a="expired"):(o="valid",a="valid")}else r?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(JK()&&(o="valid",a="valid"),!LO&&o!=="valid"&&(kO[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](kO[o]({keyValidityDate:s,hotVersion:i})),LO=!0),a!=="valid"&&e.parentNode&&FO[a]({keyValidityDate:s,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=FO[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function QK(t){let e=[][vd],n=e;if(t[vd]!==Ld("Z"))return!1;for(let r="",i="B<H4P+".split(""),s=Ld(i.shift());s;s=Ld(i.shift()||"A"))--s<""[vd]?n=n|(DO(`${DO(Dd(r)+(Dd(Fp(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Fp(t,s,s?i[vd]===1?9:8:6);return n===e}const e3=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:EF,isDefined:we,isEmpty:Qt,isRegExp:RF,isUndefined:Ft,stringify:Jt},Symbol.toStringTag,{value:"Module"}));function ir(t){return t[0].toUpperCase()+t.substr(1)}function t3(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const s=Jt(n[i]).toLowerCase();t.indexOf(s)===-1&&t.push(s)}return t.length===1}function fT(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function gT(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function mT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function vE(t){return sC(`${t}`,{ALLOWED_TAGS:[]})}function sC(t,e){return U2.sanitize(t,e)}const n3=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:t3,isPercentValue:gT,randomString:fT,sanitize:sC,stripTags:vE,substitute:mT,toUpperCaseFirst:ir},Symbol.toStringTag,{value:"Module"})),sh=t=>["tabindex",t],r3=()=>["role","treegrid"],Bs=()=>["role","presentation"],i3=()=>["role","gridcell"],s3=()=>["role","rowheader"],TF=()=>["role","rowgroup"],o3=()=>["role","columnheader"],bE=()=>["role","row"],a3=()=>["role","menu"],l3=()=>["role","menuitem"],u3=()=>["role","menuitemcheckbox"],c3=()=>["role","combobox"],_F=()=>["role","listbox"],h3=()=>["role","option"],d3=()=>["role","checkbox"],f3=()=>["scope","col"],g3=()=>["scope","row"],m3=()=>["type","text"],$p=t=>["aria-label",t],Ka=()=>["aria-hidden","true"],p3=()=>["aria-disabled","true"],w3=()=>["aria-multiselectable","true"],xF=t=>["aria-haspopup",t],MF=t=>["aria-rowcount",t],oC=t=>["aria-colcount",t],IF=t=>["aria-rowindex",t],pT=t=>["aria-colindex",t],yi=t=>["aria-expanded",t],C3=t=>["aria-sort",t],$O=()=>["aria-readonly","true"],VO=()=>["aria-invalid","true"],PF=t=>["aria-checked",t],wT=()=>["aria-selected","true"],y3=()=>["aria-autocomplete","list"],v3=t=>["aria-controls",t],b3=t=>["aria-activedescendant",t],S3=t=>["aria-live",t],R3=t=>["aria-relevant",t],E3=t=>["aria-setsize",t],T3=t=>["aria-posinset",t];function OF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function AF(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function HF(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function su(t){return HF(t)&&t.parent}function _3(t){return!!Object.getPrototypeOf(t.parent)}function Va(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==n;){const{nodeType:o,nodeName:a}=s;if(o===r&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function bd(t,e,n){const r=[];let i=t;for(;i&&(i=Va(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=r.length;return s?r[s-1]:null}function NF(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(s=>e.test(s));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Na(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function DF(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function da(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function LF(t){return!t||!t.length?[]:t.filter(e=>!!e)}function kF(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&n.push(i),!s})),{regexFree:r,regexes:n}}function Me(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function K(t,e){typeof e=="string"&&(e=e.split(" ")),e=LF(e),e.length>0&&t.classList.add(...e)}function _e(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=kF(e,!0);n=LF(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function Pe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function bu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=kF(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function CT(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)CT(e[n])}}function Qi(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const FF=/(<(.*)>|&(.*);)/;function Su(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;FF.test(e)?t.innerHTML=n?sC(e):e:Wa(t,e)}function Wa(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Qi(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ou(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return ou(r.host.impl);if(r.host)return ou(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function xn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=n.pageXOffset||r.scrollLeft,o+=n.pageYOffset||r.scrollTop),{left:s,top:o}}function yT(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function aC(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function lC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?yT(e):t.scrollTop}function vT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?aC(e):t.scrollLeft}function df(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=n.getComputedStyle(i),r.includes(s)||r.includes(o)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(s))||i.clientWidth<=i.scrollWidth+1&&(r.includes(o)||r.includes(s)))return i;i=i.parentNode}return n}function $F(t){return t.scrollHeight-t.clientHeight}function VF(t){return t.scrollWidth-t.clientWidth}function au(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return r;r=r.parentNode}return n}function ff(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function x3(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function ln(t){return t.offsetWidth}function en(t){return t.offsetHeight}function Nc(t){return t.clientHeight||t.innerHeight}function bT(t){return t.clientWidth||t.innerWidth}function M3(t,e,n){t.addEventListener(e,n,!1)}function I3(t,e,n){t.removeEventListener(e,n,!1)}function ST(t){return t.selectionStart?t.selectionStart:0}function WF(t){return t.selectionEnd?t.selectionEnd:0}function P3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function SE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function jf(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=s}}}let Hb;function O3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Ln(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Hb===void 0&&(Hb=O3(t)),Hb}function BF(t){return t.offsetWidth!==t.clientWidth}function jF(t){return t.offsetHeight!==t.clientHeight}function uC(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function A3(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Uf(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function kd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function cC(t){return kd(t)&&t.hasAttribute("data-hot-input")===!1}function H3(t){const e=t.ownerDocument.activeElement;cC(e)||t.select()}function RT(t){return!t.parentNode}function UF(t,e){new IntersectionObserver((r,i)=>{r.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function ET(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),s=r.defaultView.getSelection();Pe(t,"contenteditable",!0),n&&Pe(t,...Ka()),e&&K(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function TT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&_e(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function zF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;ET(t,n),e(),TT(t,n)}const N3=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:FF,addClass:K,addEvent:M3,clearTextSelection:SE,closest:Va,closestDown:bd,empty:Qi,fastInnerHTML:Su,fastInnerText:Wa,findFirstParentWithClass:NF,getCaretPosition:ST,getCssTransform:A3,getFrameElement:HF,getMaximumScrollLeft:VF,getMaximumScrollTop:$F,getParent:OF,getParentWindow:su,getScrollLeft:vT,getScrollTop:lC,getScrollableElement:df,getScrollbarWidth:Ln,getSelectionEndPosition:WF,getSelectionText:P3,getStyle:ff,getTrimmingContainer:au,getWindowScrollLeft:aC,getWindowScrollTop:yT,hasAccessToParentWindow:_3,hasClass:Me,hasHorizontalScrollbar:jF,hasVerticalScrollbar:BF,index:DF,innerHeight:Nc,innerWidth:bT,isChildOf:Na,isDetached:RT,isInput:kd,isOutsideInput:cC,isThisHotChild:AF,isVisible:ou,makeElementContentEditableAndSelectItsContent:ET,matchesCSSRules:x3,observeVisibilityChangeOnce:UF,offset:xn,outerHeight:en,outerWidth:ln,overlayContainsElement:da,removeAttribute:bu,removeClass:_e,removeContentEditableFromElementAndDeselect:TT,removeEvent:I3,removeTextNodes:CT,resetCssTransform:Uf,runWithSelectedContendEditableElement:zF,selectElementIfAllowed:H3,setAttribute:Pe,setCaretPosition:jf,setOverlayPosition:uC},Symbol.toStringTag,{value:"Module"}));function Tt(t){return typeof t=="function"}function YF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return s}function D3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=YF(t,e);let i=n;function s(){i=n}function o(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return o.clearHits=s,o}function hC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,o)},e),r}return i}function L3(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return mn(i,(u,c)=>c(u),r.apply(this,a))}}function _T(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,n.concat(o))}}function GF(t){const e=t.length;function n(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function k3(t){const e=t.length;function n(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Vp(t,e,n,r,i,s,o,a){return we(a)?t.call(e,n,r,i,s,o,a):we(o)?t.call(e,n,r,i,s,o):we(s)?t.call(e,n,r,i,s):we(i)?t.call(e,n,r,i):we(r)?t.call(e,n,r):we(n)?t.call(e,n):t.call(e)}const F3=Object.freeze(Object.defineProperty({__proto__:null,curry:GF,curryRight:k3,debounce:hC,fastCall:Vp,isFunction:Tt,partial:_T,pipe:L3,throttle:YF,throttleAfterHits:D3},Symbol.toStringTag,{value:"Module"}));var WO={},Nb,BO;function $3(){if(BO)return Nb;BO=1;var t=gn(),e=hk(),n=vn(),r=mu(),i=Gw(),s=t([].push);return Nb=function(o){if(n(o))return o;if(e(o)){for(var a=o.length,l=[],u=0;u<a;u++){var c=o[u];typeof c=="string"?s(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&s(l,i(c))}var h=l.length,d=!0;return function(f,m){if(d)return d=!1,m;if(e(this))return m;for(var y=0;y<h;y++)if(l[y]===f)return m}}},Nb}var jO;function V3(){if(jO)return WO;jO=1;var t=Mt(),e=Xc(),n=Yw(),r=or(),i=gn(),s=Vn(),o=vn(),a=O0(),l=j0(),u=$3(),c=P0(),h=String,d=e("JSON","stringify"),f=i(/./.exec),m=i("".charAt),y=i("".charCodeAt),C=i("".replace),T=i(1 .toString),x=/[\uD800-\uDFFF]/g,O=/^[\uD800-\uDBFF]$/,b=/^[\uDC00-\uDFFF]$/,H=!c||s(function(){var Z=e("Symbol")("stringify detection");return d([Z])!=="[null]"||d({a:Z})!=="{}"||d(Object(Z))!=="{}"}),k=s(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),V=function(Z,Y){var Q=l(arguments),ne=u(Y);if(!(!o(ne)&&(Z===void 0||a(Z))))return Q[1]=function(ce,ae){if(o(ne)&&(ae=r(ne,this,h(ce),ae)),!a(ae))return ae},n(d,null,Q)},U=function(Z,Y,Q){var ne=m(Q,Y-1),ce=m(Q,Y+1);return f(O,Z)&&!f(b,ce)||f(b,Z)&&!f(O,ne)?"\\u"+T(y(Z,0),16):Z};return d&&t({target:"JSON",stat:!0,arity:3,forced:H||k},{stringify:function(Y,Q,ne){var ce=l(arguments),ae=n(H?V:d,null,ce);return k&&typeof ae=="string"?C(ae,x,U):ae}}),WO}V3();function Uc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Be(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Uc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Uc(n[0])]:e[r]=[]:e[r]=null)})),e}function is(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function fn(t,e,n){const r=Array.isArray(n);return Be(e,(i,s)=>{(r===!1||n.includes(s))&&(t[s]=i)}),t}function zf(t,e){Be(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),zf(t[r],e[r])):t[r]=e[r]})}function sr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function es(t){const e={};return Be(t,(n,r)=>{e[r]=n}),e}function wt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return F(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Be(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(c,h){const d=`_${c}`,f=m=>{let y=m;return(Array.isArray(y)||We(y))&&(y=sr(y)),y};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function dC(t,e){return JSON.stringify(t)===JSON.stringify(e)}function We(t){return Object.prototype.toString.call(t)==="[object Object]"}function Js(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Be(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function qF(t,e){const n=e.split(".");let r=t;return Be(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function ip(t,e,n){const r=e.split(".");let i=t;r.forEach((s,o)=>{o!==r.length-1?(dn(i,s)||(i[s]={}),i=i[s]):i[s]=n})}function fC(t){if(!We(t))return 0;const e=function(n){let r=0;return We(n)?Be(n,(i,s)=>{s!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Lr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const W3=Object.freeze(Object.defineProperty({__proto__:null,clone:es,createObjectPropListener:Lr,deepClone:sr,deepExtend:zf,deepObjectSize:fC,defineGetter:Js,duckSchema:Uc,extend:fn,getProperty:qF,hasOwnProperty:dn,inherit:is,isObject:We,isObjectEqual:dC,mixin:wt,objectEach:Be,setProperty:ip},Symbol.toStringTag,{value:"Module"}));function gf(t){return window.requestAnimationFrame(t)}function mf(t){window.cancelAnimationFrame(t)}function xT(){return"ontouchstart"in window}function KF(){return typeof window<"u"}let Mu;function XF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Mu||(typeof Intl=="object"?Mu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Mu=(n,r)=>`${n}`.localeCompare(r):Mu=(n,r)=>n===r?0:n>r?-1:1,Mu)}const B3=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:mf,getComparisonFunction:XF,isCSR:KF,isTouchSupported:xT,requestAnimationFrame:gf},Symbol.toStringTag,{value:"Module"})),ci=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Ko={chrome:ci((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:ci(t=>/CriOS/.test(t)),edge:ci(t=>/Edge/.test(t)),edgeWebKit:ci(t=>/EdgiOS/.test(t)),firefox:ci(t=>/Firefox/.test(t)),firefoxWebKit:ci(t=>/FxiOS/.test(t)),mobile:ci(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:ci((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},oh={mac:ci(t=>/^Mac/.test(t)),win:ci(t=>/^Win/.test(t)),linux:ci(t=>/^Linux/.test(t)),ios:ci(t=>/iPhone|iPad|iPod/i.test(t))};function ZF(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(Ko,n=>{let{test:r}=n;return void r(t,e)})}function JF(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(oh,e=>{let{test:n}=e;return void n(t)})}KF()&&(ZF(),JF());function MT(){return Ko.chrome.value}function QF(){return Ko.chromeWebKit.value}function sp(){return Ko.firefox.value}function e$(){return Ko.firefoxWebKit.value}function IT(){return Ko.safari.value}function t$(){return Ko.edge.value}function j3(){return Ko.edgeWebKit.value}function Ho(){return Ko.mobile.value}function PT(){return oh.ios.value}function OT(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&oh.mac.value}function RE(){return oh.win.value}function Wp(){return oh.mac.value}function U3(){return oh.linux.value}const z3=Object.freeze(Object.defineProperty({__proto__:null,isChrome:MT,isChromeWebKit:QF,isEdge:t$,isEdgeWebKit:j3,isFirefox:sp,isFirefoxWebKit:e$,isIOS:PT,isIpadOS:OT,isLinuxOS:U3,isMacOS:Wp,isMobileBrowser:Ho,isSafari:IT,isWindowsOS:RE,setBrowserMeta:ZF,setPlatformMeta:JF},Symbol.toStringTag,{value:"Module"})),Se={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:sp()?182:174,AUDIO_MUTE:sp()?181:173,AUDIO_UP:sp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Y3=[Se.ALT,Se.ARROW_DOWN,Se.ARROW_LEFT,Se.ARROW_RIGHT,Se.ARROW_UP,Se.AUDIO_DOWN,Se.AUDIO_MUTE,Se.AUDIO_UP,Se.BACKSPACE,Se.CAPS_LOCK,Se.DELETE,Se.END,Se.ENTER,Se.ESCAPE,Se.F1,Se.F2,Se.F3,Se.F4,Se.F5,Se.F6,Se.F7,Se.F8,Se.F9,Se.F10,Se.F11,Se.F12,Se.F13,Se.F14,Se.F15,Se.F16,Se.F17,Se.F18,Se.F19,Se.HOME,Se.INSERT,Se.MEDIA_NEXT,Se.MEDIA_PLAY_PAUSE,Se.MEDIA_PREV,Se.MEDIA_STOP,Se.NULL,Se.NUM_LOCK,Se.PAGE_DOWN,Se.PAGE_UP,Se.PAUSE,Se.SCROLL_LOCK,Se.SHIFT,Se.TAB];function n$(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function AT(t){return Y3.includes(t)}function G3(t){const e=[];return Wp()?e.push(Se.COMMAND_LEFT,Se.COMMAND_RIGHT,Se.COMMAND_FIREFOX):e.push(Se.CONTROL),e.includes(t)}function r$(t){return[Se.CONTROL,Se.COMMAND_LEFT,Se.COMMAND_RIGHT,Se.COMMAND_FIREFOX].includes(t)}function ah(t,e){const n=e.split("|");let r=!1;return F(n,i=>{if(t===Se[i])return r=!0,!1}),r}const q3=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Se,isCtrlKey:G3,isCtrlMetaKey:r$,isFunctionKey:AT,isKey:ah,isPrintableChar:n$},Symbol.toStringTag,{value:"Module"}));function _i(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Sa(t){return t.isImmediatePropagationEnabled===!1}function Ba(t){return t.button===2}function gC(t){return t.button===0}function i$(t){return t instanceof TouchEvent}function s$(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const K3=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Sa,isLeftClick:gC,isRightClick:Ba,isTouchEvent:i$,offsetRelativeTo:s$,stopImmediatePropagation:_i},Symbol.toStringTag,{value:"Module"}));function ht(){we(console)&&console.warn(...arguments)}function HT(){we(console)&&console.error(...arguments)}const zl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Db=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Lb=new Map([[]]);var UO={},kb,zO;function X3(){if(zO)return kb;zO=1;var t=Qc();return kb=function(e,n,r){for(var i=0,s=arguments.length>2?r:t(n),o=new e(s);s>i;)o[i]=n[i++];return o},kb}var Fb,YO;function Z3(){if(YO)return Fb;YO=1;var t=In();return Fb=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},Fb}var $b,GO;function mC(){if(GO)return $b;GO=1;var t=ns(),e=V0(),n=qa().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),$b=function(s){i[r][s]=!0},$b}var qO;function J3(){if(qO)return UO;qO=1;var t=Mt(),e=gn(),n=kr(),r=Hf(),i=X3(),s=Z3(),o=mC(),a=Array,l=e(s("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),o("toSorted"),UO}J3();var KO={},XO={},ZO;function Q3(){if(ZO)return XO;ZO=1;var t=Mt(),e=th(),n=kr(),r=bn(),i=Ks();return t({target:"Iterator",proto:!0,real:!0},{find:function(o){r(this),n(o);var a=i(this),l=0;return e(a,function(u,c){if(o(u,l++))return c(u)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),XO}var JO;function e6(){return JO||(JO=1,Q3()),KO}e6();function t6(t,e){o$(t,e),e.add(t)}function Vb(t,e,n){o$(t,e),e.set(t,n)}function o$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QO(t,e,n){return t.set(Bp(t,e),n),n}function $n(t,e){return t.get(Bp(t,e))}function Bp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const n6=100;var Wr=new WeakMap,hc=new WeakMap,Wb=new WeakMap,Bb=new WeakSet;class eA{constructor(){t6(this,Bb),Vb(this,Wr,new Map),Vb(this,hc,new Map),Vb(this,Wb,new Set),zl.forEach(e=>Bp(Bb,this,tA).call(this,e))}getHooks(e){var n;return(n=$n(Wr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};$n(Wr,this).has(e)||(Bp(Bb,this,tA).call(this,e),zl.push(e));const i=$n(Wr,this).get(e);if(i.find(u=>u.callback===n))return;const s=Number.isInteger(r.orderIndex)?r.orderIndex:0,o=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:s,runOnce:o,initialHook:a,skip:!1});let u=$n(Wb,this).has(e);!u&&s!==0&&(u=!0,$n(Wb,this).add(e)),u&&i.length>1&&$n(Wr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return $n(Wr,this).has(e)&&$n(Wr,this).get(e).length>0}remove(e,n){if(!$n(Wr,this).has(e))return!1;const r=$n(Wr,this).get(e),i=r.find(s=>s.callback===n);if(i){let s=$n(hc,this).get(e);return i.skip=!0,s+=1,s>n6&&($n(Wr,this).set(e,r.filter(o=>!o.skip)),s=0),$n(hc,this).set(e,s),!0}return!1}destroy(){$n(Wr,this).clear(),$n(hc,this).clear(),QO(Wr,this,null),QO(hc,this,null)}}function tA(t){$n(Wr,this).set(t,[]),$n(hc,this).set(t,0)}function r6(t,e,n){return(e=i6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i6(t){var e=s6(t,"string");return typeof e=="symbol"?e:e+""}function s6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const o6=pt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ge{constructor(){r6(this,"globalBucket",new eA)}static getSingleton(){return l6()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new eA),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?F(n,s=>this.add(e,s,r)):(Db.has(e)&&ht(mT(o6,{hookName:e,removedInVersion:Db.get(e)})),Lb.has(e)&&ht(Lb.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?F(n,s=>this.once(e,s,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?F(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,s,o,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Vp(u[h].callback,e,r,i,s,o,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Vp(u[h].callback,e,r,i,s,o,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||zl.push(e)}deregister(e){this.isRegistered(e)&&zl.splice(zl.indexOf(e),1)}isDeprecated(e){return Lb.has(e)||Db.has(e)}isRegistered(e){return zl.indexOf(e)>=0}getRegistered(){return zl}}const a6=new ge;function l6(){return a6}const jb=new Map;function ss(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";jb.has(t)||jb.set(t,new Map);const e=jb.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:s,getValues:o}}const EE=new WeakMap,{register:u6,getItem:a$,hasItem:l$,getNames:c6,getValues:jme}=ss("editors");function h6(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ge.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function u$(t,e){let n;if(typeof t=="function")EE.get(t)||Pr(null,t),n=EE.get(t);else if(typeof t=="string")n=a$(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function jp(t){if(typeof t=="function")return t;if(!l$(t))throw Error(`No registered editor found under "${t}" name`);return a$(t).getConstructor()}function Pr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new h6(e);typeof t=="string"&&u6(t,n),EE.set(e,n)}function d6(t,e,n){return(e=f6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f6(t){var e=g6(t,"string");return typeof e=="symbol"?e:e+""}function g6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let op=0;class bi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;d6(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){r.call(this,m6(o))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(n,s,i),op+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===n&&o.element===e){if(r&&r!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),op-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),op-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const s={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;r.createEvent?(o=r.createEvent("MouseEvents"),o.initMouseEvent(n,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,r.body.parentNode)):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${n}`,o)}}function m6(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),_i(this)},t}function p6(){return op}function w6(t,e){C6(t,e),e.add(t)}function C6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,n){return(e=y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y6(t){var e=v6(t,"string");return typeof e=="symbol"?e:e+""}function v6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ub=new WeakSet;class TE{constructor(e,n,r){w6(this,Ub),nl(this,"hot",void 0),nl(this,"tableMeta",void 0),nl(this,"selection",void 0),nl(this,"eventManager",void 0),nl(this,"destroyed",!1),nl(this,"activeEditor",void 0),nl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new bi(e),this.hot.addHook("afterDocumentKeyDown",i=>nA(Ub,this,b6).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>nA(Ub,this,S6).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,s=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let o=r,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=u$(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(r))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function b6(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Sa(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!AT(n)&&!r$(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function S6(t,e){e.isCell()&&this.openEditor(null,t,!0)}const rA=new WeakMap;TE.getInstance=function(t,e,n){let r=rA.get(t);return r||(r=new TE(t,e,n),rA.set(t,r)),r};function R6(t,e){c$(t,e),e.add(t)}function Th(t,e,n){c$(t,e),e.set(t,n)}function c$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jt(t,e){return t.get(Io(t,e))}function _h(t,e,n){return t.set(Io(t,e),n),n}function Io(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Dc=Object.freeze({CELL:"cell",MIXED:"mixed"});var Nn=new WeakMap,Cg=new WeakMap,yg=new WeakMap,vg=new WeakMap,bg=new WeakMap,wa=new WeakSet;class E6{constructor(e){var n=this;R6(this,wa),Th(this,Nn,void 0),Th(this,Cg,void 0),Th(this,yg,1),Th(this,vg,null),Th(this,bg,new Map);const r=e.getSettings();_h(Nn,this,e),_h(Cg,this,r.imeFastEdit?Dc.MIXED:Dc.CELL),jt(Nn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Io(wa,n,_6).call(n,...s)}),jt(Nn,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Io(wa,n,iA).call(n,...s)}),jt(Nn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Io(wa,n,iA).call(n,...s)}),jt(Nn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Io(wa,n,T6).call(n,...s)})}getFocusMode(){return jt(Cg,this)}setFocusMode(e){Object.values(Dc).includes(e)?_h(Cg,this,e):ht(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return jt(yg,this)}setRefocusDelay(e){_h(yg,this,e)}setRefocusElementGetter(e){_h(vg,this,e)}getRefocusElement(){var e;return typeof jt(vg,this)=="function"?jt(vg,this).call(this):(e=jt(Nn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,s;const o=(i=jt(Nn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=jt(Nn,this).runHooks("modifyFocusedElement",o.row,o.col,r);a instanceof HTMLElement||(a=r),a&&!((s=jt(Nn,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Io(wa,this,NT).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jt(yg,this);jt(Nn,this).getSettings().imeFastEdit&&!((e=jt(Nn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&(jt(bg,this).has(n)||jt(bg,this).set(n,hC(()=>{var r;(r=this.getRefocusElement())===null||r===void 0||r.select()},n)),jt(bg,this).get(n)())}}function NT(t){var e;const n=(e=jt(Nn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!jt(Nn,this).selection.isCellVisible(n)){t(null);return}const r=jt(Nn,this).getCell(n.row,n.col,!0);r===null?jt(Nn,this).addHookOnce("afterScroll",()=>{t(jt(Nn,this).getCell(n.row,n.col,!0))}):t(r)}function iA(){Io(wa,this,NT).call(this,t=>{const{activeElement:e}=jt(Nn,this).rootDocument;e&&cC(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function T6(){Io(wa,this,NT).call(this,t=>{this.getFocusMode()===Dc.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function _6(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Dc.MIXED:Dc.CELL)}var sA={},zb,oA;function x6(){if(oA)return zb;oA=1;var t=ts(),e=mu(),n=ns(),r=n("match");return zb=function(i){var s;return t(i)&&((s=i[r])!==void 0?!!s:e(i)==="RegExp")},zb}var Yb,aA;function M6(){if(aA)return Yb;aA=1;var t=bn();return Yb=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},Yb}var Gb,lA;function I6(){if(lA)return Gb;lA=1;var t=or(),e=Ri(),n=Nf(),r=M6(),i=RegExp.prototype;return Gb=function(s){var o=s.flags;return o===void 0&&!("flags"in i)&&!e(s,"flags")&&n(i,s)?t(r,s):o},Gb}var qb,uA;function P6(){if(uA)return qb;uA=1;var t=gn(),e=Zc(),n=Math.floor,r=t("".charAt),i=t("".replace),s=t("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return qb=function(l,u,c,h,d,f){var m=c+l.length,y=h.length,C=a;return d!==void 0&&(d=e(d),C=o),i(f,C,function(T,x){var O;switch(r(x,0)){case"$":return"$";case"&":return l;case"`":return s(u,0,c);case"'":return s(u,m);case"<":O=d[s(x,1,-1)];break;default:var b=+x;if(b===0)return T;if(b>y){var H=n(b/10);return H===0?T:H<=y?h[H-1]===void 0?r(x,1):h[H-1]+r(x,1):T}O=h[b-1]}return O===void 0?"":O})},qb}var cA;function O6(){if(cA)return sA;cA=1;var t=Mt(),e=or(),n=gn(),r=Af(),i=vn(),s=jw(),o=x6(),a=Gw(),l=Df(),u=I6(),c=P6(),h=ns(),d=Ga(),f=h("replace"),m=TypeError,y=n("".indexOf),C=n("".replace),T=n("".slice),x=Math.max;return t({target:"String",proto:!0},{replaceAll:function(b,H){var k=r(this),V,U,Z,Y,Q,ne,ce,ae,ye,Le,me=0,be="";if(!s(b)){if(V=o(b),V&&(U=a(r(u(b))),!~y(U,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(Z=l(b,f),Z)return e(Z,b,k,H);if(d&&V)return C(a(k),b,H)}for(Y=a(k),Q=a(b),ne=i(H),ne||(H=a(H)),ce=Q.length,ae=x(1,ce),ye=y(Y,Q);ye!==-1;)Le=ne?a(H(Q,ye,Y)):c(Q,Y,ye,[],void 0,H),be+=T(Y,me,ye)+Le,me=ye+ce,ye=ye+ae>Y.length?-1:y(Y,Q,ye+ae);return me<Y.length&&(be+=T(Y,me)),be}}),sA}O6();var hA={},dA={},fA;function A6(){if(fA)return dA;fA=1;var t=Mt(),e=th(),n=kr(),r=bn(),i=Ks(),s=TypeError;return t({target:"Iterator",proto:!0,real:!0},{reduce:function(a){r(this),n(a);var l=i(this),u=arguments.length<2,c=u?void 0:arguments[1],h=0;if(e(l,function(d){u?(u=!1,c=d):c=a(c,d,h),h++},{IS_RECORD:!0}),u)throw new s("Reduce of empty iterator with no initial value");return c}}),dA}var gA;function H6(){return gA||(gA=1,A6()),hA}H6();const h$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},N6=new RegExp(Object.keys(h$).map(t=>`(${t})`).join("|"),"gi");function D6(t){return(t&&t.nodeName||"")==="TABLE"}function _E(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,m=[];for(let C=0;C<o;C+=1){const T=!f&&n&&C===0;let x="";if(f)x=`<th>${t.getColHeader(C-c)}</th>`;else if(T)x=`<th>${t.getRowHeader(d-h)}</th>`;else{const O=i[d][C],{hidden:b,rowspan:H,colspan:k}=t.getCellMeta(d-h,C-c);if(!b){const V=[];if(H&&V.push(`rowspan="${H}"`),k&&V.push(`colspan="${k}"`),Qt(O))x=`<td ${V.join(" ")}></td>`;else{const U=O.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");x=`<td ${V.join(" ")}>${U}</td>`}}}m.push(x)}const y=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,y):u.splice(-1,0,y)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function xE(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],s=i.length,o=[];r===0&&n.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],u=Qt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}n.push("<tr>",...o,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function d$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let s=t;if(typeof s=="string"){const O=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,b=>{const H=b.match(/<td\b[^>]*?>/g)[0],k=/<p.*?>/g,V=b.substring(H.length,b.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(k,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${H}${V}</td>`});i.insertAdjacentHTML("afterbegin",`${O}`),s=i.querySelector("table")}if(!s||!D6(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((O,b)=>O+b.colSpan,0)-(a?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(s.tHead){const O=Array.from(s.tHead.rows).filter(b=>{const H=b.querySelector("td")!==null;return H&&h.push(b),!H});f=O.length,d=f>0,f>1?n.nestedHeaders=Array.from(O).reduce((b,H)=>{const k=Array.from(H.cells).reduce((V,U,Z)=>{if(a&&Z===0)return V;const{colSpan:Y,innerHTML:Q}=U,ne=Y>1?{label:Q,colspan:Y}:Q;return V.push(ne),V},[]);return b.push(k),b},[]):d&&(n.colHeaders=Array.from(O[0].children).reduce((b,H,k)=>(a&&k===0||b.push(H.innerHTML),b),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const y=[...h,...Array.from(s.tBodies).reduce((O,b)=>(O.push(...Array.from(b.rows)),O),[]),...c];m=y.length;const C=new Array(m);for(let O=0;O<m;O++)C[O]=new Array(u);const T=[],x=[];for(let O=0;O<m;O++){const b=y[O],H=Array.from(b.cells),k=H.length;for(let V=0;V<k;V++){const U=H[V],{nodeName:Z,innerHTML:Y,rowSpan:Q,colSpan:ne}=U,ce=C[O].findIndex(ae=>ae===void 0);if(Z==="TD"){if(Q>1||ne>1){for(let me=O;me<O+Q;me++)if(me<m)for(let be=ce;be<ce+ne;be++)C[me][be]=null;const ye=U.getAttribute("style");ye&&ye.includes("mso-ignore:colspan")||T.push({col:ce,row:O,rowspan:Q,colspan:ne})}let ae="";o&&/excel/gi.test(o.content)?ae=Y.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ae=Y.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[O][ce]=ae.replace(N6,ye=>h$[ye])}else x.push(Y)}}return T.length&&(n.mergeCells=T),x.length&&(n.rowHeaders=x),C.length&&(n.data=C),n}const L6=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:xE,htmlToGridSettings:d$,instanceToHTML:_E},Symbol.toStringTag,{value:"Module"}));function Jn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function f$(t){return Jn(t,[","])}function Re(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function ME(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function DT(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Je(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const k6=Object.freeze(Object.defineProperty({__proto__:null,clamp:Je,isNumeric:Jn,isNumericLike:f$,rangeEach:Re,rangeEachReverse:ME,valueAccordingPercent:DT},Symbol.toStringTag,{value:"Module"})),IE="asc",F6="desc",mA=new Map([[IE,[-1,1]],[F6,[1,-1]]]),$6=t=>`The priority '${t}' is already declared in a map.`,V6=t=>`The priority '${t}' is not a number.`;function W6(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Tt(t)?t:$6,e=Tt(e)?e:V6;function r(s,o){if(!Jn(s))throw new Error(e(s));if(n.has(s))throw new Error(t(s));n.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:IE;const[o,a]=mA.get(s)||mA.get(IE);return[...n].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:r,getItems:i}}const B6=t=>`The id '${t}' is already declared in a map.`;function pC(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Tt(t)?t:B6;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function s(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:r}}const j6=t=>`'${t}' value is already declared in a unique set.`;function U6(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Tt(t)?t:j6;function n(s){if(e.has(s))throw new Error(t(s));e.add(s)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const LT=t=>`There is already registered "${t}" plugin.`,z6=t=>`There is already registered plugin on priority "${t}".`,Y6=t=>`The priority "${t}" is not a number.`,g$=W6({errorPriorityExists:z6,errorPriorityNaN:Y6}),m$=U6({errorItemExists:LT}),PE=pC({errorIdExists:LT});function kT(){return[...g$.getItems(),...m$.getItems()]}function Yf(t){const e=ir(t);return PE.getItem(e)}function G6(t){return!!Yf(t)}function tt(t,e,n){[t,e,n]=K6(t,e,n),Yf(t)===void 0&&q6(t,e,n)}function q6(t,e,n){const r=ir(t);if(PE.hasItem(r))throw new Error(LT(r));n===void 0?m$.addItem(r):g$.addItem(n,r),PE.addItem(r,e)}function K6(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:X6,getItem:Z6,hasItem:p$,getNames:J6,getValues:Ume}=ss("renderers");function Up(t){if(typeof t=="function")return t;if(!p$(t))throw Error(`No registered renderer found under "${t}" name`);return Z6(t)}function Ur(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),X6(t,e)}const{register:Q6,getItem:e4,hasItem:w$,getNames:t4,getValues:zme}=ss("validators");function FT(t){if(typeof t=="function")return t;if(!w$(t))throw Error(`No registered validator found under "${t}" name`);return e4(t)}function Yl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Q6(t,e)}var pA={},wA;function n4(){if(wA)return pA;wA=1;var t=Mt(),e=Zc(),n=Qc(),r=Lf(),i=mC();return t({target:"Array",proto:!0},{at:function(o){var a=e(this),l=n(a),u=r(o),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),pA}n4();var CA={},yA;function r4(){if(yA)return CA;yA=1;var t=Mt(),e=gn(),n=Af(),r=Lf(),i=Gw(),s=Vn(),o=e("".charAt),a=s(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:o(c,f)}}),CA}r4();function xh(t,e,n){return(e=i4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i4(t){var e=s4(t,"string");return typeof e=="symbol"?e:e+""}function s4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o4{constructor(){xh(this,"count",0),xh(this,"startColumn",null),xh(this,"endColumn",null),xh(this,"startPosition",null),xh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=n,a=i>0?s+1:s;r>=i&&r+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Mh(t,e,n){return(e=a4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a4(t){var e=l4(t,"string");return typeof e=="symbol"?e:e+""}function l4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u4{constructor(){Mh(this,"count",0),Mh(this,"startRow",null),Mh(this,"endRow",null),Mh(this,"startPosition",null),Mh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=n;r>=i&&r+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-s&&(this.startRow-=1),d>=i-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ih(t,e,n){return(e=c4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c4(t){var e=h4(t,"string");return typeof e=="symbol"?e:e+""}function h4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C${constructor(){Ih(this,"count",0),Ih(this,"startColumn",null),Ih(this,"endColumn",null),Ih(this,"startPosition",null),Ih(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s}=n;r<=i&&(this.startColumn=e);const o=i>0?s+1:s;r>=i&&r<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?i+1:i;r+i-h<-1*s||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ph(t,e,n){return(e=d4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d4(t){var e=f4(t,"string");return typeof e=="symbol"?e:e+""}function f4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y${constructor(){Ph(this,"count",0),Ph(this,"startRow",null),Ph(this,"endRow",null),Ph(this,"startPosition",null),Ph(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s}=n;r<=i&&(this.startRow=e),r>=i&&r<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-s<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Oh(t,e,n){return(e=g4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g4(t){var e=m4(t,"string");return typeof e=="symbol"?e:e+""}function m4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p4{constructor(){Oh(this,"count",0),Oh(this,"startColumn",0),Oh(this,"endColumn",0),Oh(this,"startPosition",0),Oh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Ah(t,e,n){return(e=w4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w4(t){var e=C4(t,"string");return typeof e=="symbol"?e:e+""}function C4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y4{constructor(){Ah(this,"count",0),Ah(this,"startRow",0),Ah(this,"endRow",0),Ah(this,"startPosition",0),Ah(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function vA(t,e,n){return(e=v4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v4(t){var e=b4(t,"string");return typeof e=="symbol"?e:e+""}function b4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S4 extends C${constructor(){super(...arguments),vA(this,"columnStartOffset",0),vA(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof r=="function"){const o=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=s[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function bA(t,e,n){return(e=R4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R4(t){var e=E4(t,"string");return typeof e=="symbol"?e:e+""}function E4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T4 extends y${constructor(){super(...arguments),bA(this,"rowStartOffset",0),bA(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof r=="function"){const o=this.startRow,a=this.endRow;r(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=s[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function SA(t,e,n){return(e=_4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _4(t){var e=x4(t,"string");return typeof e=="symbol"?e:e+""}function x4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v${constructor(e){SA(this,"calculationTypes",[]),SA(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function xi(t,e,n){return(e=M4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M4(t){var e=I4(t,"string");return typeof e=="symbol"?e:e+""}function I4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const zc=50;class P4 extends v${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(n),xi(this,"viewportWidth",0),xi(this,"scrollOffset",0),xi(this,"zeroBasedScrollOffset",0),xi(this,"totalColumns",0),xi(this,"columnWidthFn",null),xi(this,"columnWidth",0),xi(this,"overrideFn",null),xi(this,"inlineStartOffset",0),xi(this,"totalCalculatedWidth",0),xi(this,"startPositions",[]),xi(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?zc:n}}function ei(t,e,n){return(e=O4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O4(t){var e=A4(t,"string");return typeof e=="symbol"?e:e+""}function A4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H4 extends v${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),ei(this,"viewportHeight",0),ei(this,"scrollOffset",0),ei(this,"zeroBasedScrollOffset",0),ei(this,"totalRows",0),ei(this,"rowHeightFn",null),ei(this,"rowHeight",0),ei(this,"overrideFn",null),ei(this,"horizontalScrollbarHeight",0),ei(this,"innerViewportHeight",0),ei(this,"totalCalculatedHeight",0),ei(this,"startPositions",[]),ei(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function N4(t,e,n){D4(t,e),e.set(t,n)}function D4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RA(t,e,n){return(e=L4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L4(t){var e=k4(t,"string");return typeof e=="symbol"?e:e+""}function k4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Iu(t,e){return t.get(b$(t,e))}function EA(t,e,n){return t.set(b$(t,e),n),n}function b$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ro=new WeakMap;class lu{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;RA(this,"row",null),RA(this,"col",null),N4(this,ro,!1),EA(ro,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Iu(ro,this)}isSouthEastOf(e){return this.row>=e.row&&(Iu(ro,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Iu(ro,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Iu(ro,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Iu(ro,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof lu&&EA(ro,this,e.isRtl()),this}clone(){return new lu(this.row,this.col,Iu(ro,this))}toObject(){return{row:this.row,col:this.col}}}function F4(t,e,n){$4(t,e),e.set(t,n)}function $4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kb(t,e,n){return(e=V4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V4(t){var e=W4(t,"string");return typeof e=="symbol"?e:e+""}function W4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ti(t,e){return t.get(S$(t,e))}function B4(t,e,n){return t.set(S$(t,e),n),n}function S$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rr=new WeakMap;class Gf{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Kb(this,"highlight",null),Kb(this,"from",null),Kb(this,"to",null),F4(this,Rr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),B4(Rr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=n&&s.row>=n&&i.col<=r&&s.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,o.row),u=Math.min(r.col,o.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(s),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ti(Rr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ti(Rr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ti(Rr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ti(Rr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ti(Rr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ti(Rr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ti(Rr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ti(Rr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof lu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(ti(Rr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(ti(Rr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let s=e.col;s<=n.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&r.push(this._createCellCoords(i,s));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let s=e.col;s<=n.col;s++)e.row===i&&e.col===s?r.push(e):n.row===i&&n.col===s?r.push(n):r.push(this._createCellCoords(i,s));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let s=n.col;s<=r.col;s++)if(e(i,s)===!1)return}clone(){return new Gf(this.highlight,this.from,this.to,ti(Rr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new lu(e,n,ti(Rr,this))}}function us(t,e,n){j4(t,e),e.set(t,n)}function j4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ee(t,e){return t.get(R$(t,e))}function Jo(t,e,n){return t.set(R$(t,e),n),n}function R$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ni=new WeakMap,Xb=new WeakMap,On=new WeakMap,Pu=new WeakMap,Sg=new WeakMap,Mi=new WeakMap,Zb=new WeakMap,Hh=new WeakMap,rl=new WeakMap,cs=new WeakMap;let E$=class{constructor(e,n,r,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;us(this,ni,void 0),us(this,Xb,void 0),us(this,On,void 0),us(this,Pu,void 0),us(this,Sg,void 0),us(this,Mi,void 0),us(this,Zb,void 0),us(this,Hh,void 0),us(this,rl,[null,null]),us(this,cs,[null,null]),Jo(ni,this,r),Jo(Xb,this,n),Jo(On,this,s),Jo(Pu,this,o),Jo(Sg,this,a),Jo(Mi,this,i),Jo(Zb,this,e),this.registerEvents()}registerEvents(){Ee(Mi,this).addEventListener(Ee(On,this).holder,"contextmenu",r=>this.onContextMenu(r)),Ee(Mi,this).addEventListener(Ee(On,this).TABLE,"mouseover",r=>this.onMouseOver(r)),Ee(Mi,this).addEventListener(Ee(On,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Ee(Mi,this).addEventListener(Ee(On,this).holder,"touchstart",r=>this.onTouchStart(r)),Ee(Mi,this).addEventListener(Ee(On,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Ee(Mi,this).addEventListener(Ee(On,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ee(ni,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ee(ni,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Ee(Mi,this).addEventListener(Ee(On,this).holder,"mouseup",r=>this.onMouseUp(r)),Ee(Mi,this).addEventListener(Ee(On,this).holder,"mousedown",r=>this.onMouseDown(r))};Ho()?e():(xT()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Ee(Hh,this)&&r){const[i,s]=[r.row,Ee(Hh,this).from.row],[o,a]=[r.col,Ee(Hh,this).from.col];return i===s&&o===a}return!1}parentCell(e){const n={},r=Ee(On,this).TABLE,i=bd(e,["TD","TH"],r);return i?(n.coords=Ee(On,this).getCoords(i),n.TD=i):Me(e,"wtBorder")&&Me(e,"current")?(n.coords=Ee(Pu,this).getFocusSelection().cellRange.highlight,n.TD=Ee(On,this).getCell(n.coords)):Me(e,"wtBorder")&&Me(e,"area")&&Ee(Pu,this).getAreaSelection().cellRange&&(n.coords=Ee(Pu,this).getAreaSelection().cellRange.to,n.TD=Ee(On,this).getCell(n.coords)),n}onMouseDown(e){const n=Ee(Xb,this).rootDocument.activeElement,r=_T(OF,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const s=this.parentCell(i);Me(i,"corner")?Ee(ni,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&Ee(ni,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Ee(cs,this)[0]=s.TD,clearTimeout(Ee(rl,this)[0]),Ee(rl,this)[0]=setTimeout(()=>{Ee(cs,this)[0]=null},1e3))}onContextMenu(e){if(Ee(ni,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Ee(ni,this).has("onCellMouseOver"))return;const n=Ee(On,this).TABLE,r=bd(e.target,["TD","TH"],n),i=Ee(Sg,this)||this;r&&r!==i.lastMouseOver&&Na(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Ee(On,this).getCoords(r),r))}onMouseOut(e){if(!Ee(ni,this).has("onCellMouseOut"))return;const n=Ee(On,this).TABLE,r=bd(e.target,["TD","TH"],n),i=bd(e.relatedTarget,["TD","TH"],n),s=Ee(Sg,this)||this;r&&r!==i&&Na(r,n)&&(this.callListener("onCellMouseOut",e,Ee(On,this).getCoords(r),r),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Ee(ni,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Ee(cs,this)[0]&&n.TD===Ee(cs,this)[1]?(Me(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Ee(cs,this)[0]=null,Ee(cs,this)[1]=null):n.TD===Ee(cs,this)[0]&&(Ee(cs,this)[1]=n.TD,clearTimeout(Ee(rl,this)[1]),Ee(rl,this)[1]=setTimeout(()=>{Ee(cs,this)[1]=null},500)))}onTouchStart(e){Jo(Hh,this,Ee(Pu,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,s=we(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&Ee(ni,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];PT()&&(QF()||e$())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const s=Ee(ni,this).getSettingPure(e);s&&s(n,r,i,Ee(Zb,this).call(this))}destroy(){clearTimeout(Ee(rl,this)[0]),clearTimeout(Ee(rl,this)[1]),Ee(Mi,this).destroy()}};function Jb(t,e,n){return(e=U4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U4(t){var e=z4(t,"string");return typeof e=="symbol"?e:e+""}function z4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y4{constructor(e,n,r){Jb(this,"offset",void 0),Jb(this,"total",void 0),Jb(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Qb(t,e,n){return(e=G4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G4(t){var e=q4(t,"string");return typeof e=="symbol"?e:e+""}function q4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K4{constructor(e,n,r){Qb(this,"offset",void 0),Qb(this,"total",void 0),Qb(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const X4=0,zp=1,Yp=2;function Rg(t,e,n){return(e=Z4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z4(t){var e=J4(t,"string");return typeof e=="symbol"?e:e+""}function J4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TA{constructor(){Rg(this,"currentSize",0),Rg(this,"nextSize",0),Rg(this,"currentOffset",0),Rg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function eS(t,e,n){return(e=Q4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q4(t){var e=e5(t,"string");return typeof e=="symbol"?e:e+""}function e5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class t5{constructor(){eS(this,"size",new TA),eS(this,"workingSpace",X4),eS(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof TA}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=zp,e.workingSpace=Yp,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Yp,e.workingSpace=zp,this.sharedSize=e.getViewSize()}}function Ou(t,e,n){return(e=n5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n5(t){var e=r5(t,"string");return typeof e=="symbol"?e:e+""}function r5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T${constructor(e,n,r){Ou(this,"rootNode",void 0),Ou(this,"nodesPool",void 0),Ou(this,"sizeSet",new t5),Ou(this,"childNodeType",void 0),Ou(this,"visualIndex",0),Ou(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(zp))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Yp)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=r&&n.isPlaceOn(zp);for(;s>i;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Yp)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class _$ extends T${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function i5(t,e,n){return(e=s5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s5(t){var e=o5(t,"string");return typeof e=="symbol"?e:e+""}function o5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a5{constructor(e){i5(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Nh(t,e,n){return(e=l5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l5(t){var e=u5(t,"string");return typeof e=="symbol"?e:e+""}function u5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qf{constructor(e,n){Nh(this,"nodesPool",null),Nh(this,"nodeType",void 0),Nh(this,"rootNode",void 0),Nh(this,"table",null),Nh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new a5(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function _A(t,e,n){return(e=c5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c5(t){var e=h5(t,"string");return typeof e=="symbol"?e:e+""}function h5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d5 extends qf{constructor(){super("TH"),_A(this,"orderViews",new WeakMap),_A(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new _$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=s.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),bu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Pe(d,[s3(),g3(),pT(h+1),sh(-1)]),n[h](a,d,h)}u.end()}}}class f5 extends qf{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<s;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)r.removeChild(r.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Qi(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Pe(this.rootNode,[TF()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Pe(o,[bE(),IF(n+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),bu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Pe(u,[pT(a+1+this.table.rowHeadersCount),sh(-1),o3(),...a>=0?[f3()]:[bE()]]),r[n](l,u,n)}}}}let xA=!1;class g5 extends qf{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!xA&&e>1e3&&(xA=!0,ht(pt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+n].style.width=`${o}px`}const r=this.rootNode.firstChild;r&&K(r,"rowHeader")}}function m5(t,e,n){return(e=p5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p5(t){var e=w5(t,"string");return typeof e=="symbol"?e:e+""}function w5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Eg={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let MA=!1;class C5 extends qf{constructor(e){super("TR",e),m5(this,"orderView",void 0),this.orderView=new T$(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!MA&&e>1e3&&(MA=!0,ht(pt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Pe(this.rootNode,[TF()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Pe(s,[bE(),IF(o+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}_e(s,[Eg.rowEven,Eg.rowOdd]),(o+1)%2===0?K(s,Eg.rowEven):K(s,Eg.rowOdd)}this.orderView.end()}}function IA(t,e,n){return(e=y5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y5(t){var e=v5(t,"string");return typeof e=="symbol"?e:e+""}function v5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b5 extends qf{constructor(){super("TD"),IA(this,"orderViews",new WeakMap),IA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new _$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<n;d++){c.render();const f=c.getCurrentNode(),m=this.table.renderedColumnToSource(d);if(Me(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),bu(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,m,f),this.table.isAriaEnabled()){var s,o;Pe(f,[...f.hasAttribute("role")?[]:[i3()],sh(-1),pT(m+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}c.end()}}}function wn(t,e,n){return(e=S5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S5(t){var e=R5(t,"string");return typeof e=="symbol"?e:e+""}function R5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E5{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};wn(this,"rootNode",void 0),wn(this,"rootDocument",void 0),wn(this,"rowHeaders",null),wn(this,"columnHeaders",null),wn(this,"colGroup",null),wn(this,"rows",null),wn(this,"cells",null),wn(this,"rowFilter",null),wn(this,"columnFilter",null),wn(this,"rowUtils",null),wn(this,"columnUtils",null),wn(this,"rowsToRender",0),wn(this,"columnsToRender",0),wn(this,"rowHeaderFunctions",[]),wn(this,"rowHeadersCount",0),wn(this,"columnHeaderFunctions",[]),wn(this,"columnHeadersCount",0),wn(this,"cellRenderer",void 0),wn(this,"activeOverlayName",void 0),wn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),s=this.rowUtils;if(i.firstChild){const o=this.renderedRowToSource(r),a=s.getHeightByOverlayName(o,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class T5{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new E5(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new d5,columnHeaders:new f5(n),colGroup:new g5(r),rows:new C5(i),cells:new b5}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function tS(t,e,n){return(e=_5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _5(t){var e=x5(t,"string");return typeof e=="symbol"?e:e+""}function x5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M5{constructor(e,n){tS(this,"dataAccessObject",void 0),tS(this,"wtSettings",void 0),tS(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<r;s++){let o=Array.isArray(n)?n[s]:n;o=o??i,this.headerWidths.set(s,o)}}}}function PA(t,e,n){return(e=I5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I5(t){var e=P5(t,"string");return typeof e=="symbol"?e:e+""}function P5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O5{constructor(e,n){PA(this,"dataAccessObject",void 0),PA(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function hs(t,e,n){return(e=A5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A5(t){var e=H5(t,"string");return typeof e=="symbol"?e:e+""}function H5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lh{constructor(e,n,r,i,s){hs(this,"wtSettings",null),hs(this,"domBindings",void 0),hs(this,"TBODY",null),hs(this,"THEAD",null),hs(this,"COLGROUP",null),hs(this,"hasTableHeight",!0),hs(this,"hasTableWidth",!0),hs(this,"isTableVisible",!1),hs(this,"tableOffset",0),hs(this,"holderOffset",0),this.domBindings=r,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,CT(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new O5(this.dataAccessObject,this.wtSettings),this.columnUtils=new M5(this.dataAccessObject,this.wtSettings),this.tableRenderer=new T5({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Me(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Pe(r,[Bs()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Me(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Pe(r,[Bs()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Me(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Pe(r.parentNode,[Bs()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Pe(r,[Bs()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,s=n.getSetting("totalRows"),o=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=xn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=xn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=s>0?this.getFirstRenderedRow():0,m=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new K4(f,s,c),this.columnFilter=new Y4(m,o,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),y=C.skipRender!==!0}y&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is($s)||this.is(Da))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is($s))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is($s)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,s=this.getColumnHeaderHeight(r),o=this.getColumnHeader(n,r),o&&(a=Nc(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(r[s]){if(!n[s]||n[s].childNodes.length===0)return;n[s].childNodes[0].style.height=`${r[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is($s))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const s=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[s]&&(n.oversizedRows[s]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!o&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var s;n=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[r];s&&n.push(s)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&n.push(o)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Va(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let s=DF(r),o=n.cellIndex;da(hu,n,this.wtRootElement)||da(uu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):da(Da,n,this.wtRootElement)||da($s,n,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),da(hu,n,this.wtRootElement)||da(cu,n,this.wtRootElement)||da(Da,n,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o);const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=Nc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),s=i?en:Nc,o=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=s(d):u=s(h)-o,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ln(this.TABLE)}getHeight(){return en(this.TABLE)}getTotalWidth(){const e=ln(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=en(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ou(this.TABLE)}_modifyRowHeaderWidth(e){let n=Tt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const N5="stickyRowsBottom",$T={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Js($T,"MIXIN_NAME",N5,{writable:!1,enumerable:!1});const D5="stickyColumnsStart",wC={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Js(wC,"MIXIN_NAME",D5,{writable:!1,enumerable:!1});class VT extends lh{constructor(e,n,r,i){super(e,n,r,i,Da)}}wt(VT,$T);wt(VT,wC);const uu="top",$s="bottom",cu="inline_start",hu="top_inline_start_corner",Da="bottom_inline_start_corner",x$=[uu,$s,cu,hu,Da],L5=new Map([[uu,`ht_clone_${uu}`],[$s,`ht_clone_${$s}`],[cu,`ht_clone_${cu} ht_clone_left`],[hu,`ht_clone_${hu} ht_clone_top_left_corner`],[Da,`ht_clone_${Da} ht_clone_bottom_left_corner`]]);function k5(t,e){F5(t,e),e.add(t)}function F5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $5(t,e,n){return(e=V5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V5(t){var e=W5(t,"string");return typeof e=="symbol"?e:e+""}function W5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Dh=new WeakSet;class B5{constructor(e){k5(this,Dh),$5(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),s=this.scrollViewportVertically(e.row,r);return i||s}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const s=Lr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;n=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<o)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const s=Lr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;n=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-o-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Tg(Dh,this,AA).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Tg(Dh,this,AA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Tg(Dh,this,OA).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Tg(Dh,this,OA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function OA(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(n.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=xn(r.wtRootElement).left;const u=Math.abs(vT(o,o));if(l>u){const c=bT(o);let h=i.getRowHeaderWidth();for(let d=1;d<=s;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function AA(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=xn(n.wtRootElement),a=lC(s,s);if(o.top>a){const l=Nc(s);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),o.top+u-a>=l){t=c-2;break}}}return t}function ri(t,e,n){return(e=j5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j5(t){var e=U5(t,"string");return typeof e=="symbol"?e:e+""}function U5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WT{get eventManager(){return new bi(this)}constructor(e,n){ri(this,"wtTable",void 0),ri(this,"wtScroll",void 0),ri(this,"wtViewport",void 0),ri(this,"wtOverlays",void 0),ri(this,"selectionManager",void 0),ri(this,"wtEvent",void 0),ri(this,"guid",`wt_${fT()}`),ri(this,"drawInterrupted",!1),ri(this,"drawn",!1),ri(this,"activeOverlayName","master"),ri(this,"domBindings",void 0),ri(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new B5(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Wa(r,e[n])}])}}createCellCoords(e,n){return new lu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new Gf(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=r-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function HA(t,e,n){return(e=z5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z5(t){var e=Y5(t,"string");return typeof e=="symbol"?e:e+""}function Y5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G5 extends WT{constructor(e,n,r){super(e,n),HA(this,"cloneSource",void 0),HA(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new E$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function q5(t,e,n){return(e=K5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K5(t){var e=X5(t,"string");return typeof e=="symbol"?e:e+""}function X5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kf{constructor(e,n,r,i,s){q5(this,"wtSettings",null),Js(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=n,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=au(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=au(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=df(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){ht(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=r<this.wtSettings.getSetting("fixedColumnsStart"),o=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(o,s,c,u):h=this.getRelativeCellPositionWithinHolder(o,a,s,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!n)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Ln())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:r.start+o,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=o.horizontal-s.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(x$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=r.createElement("div"),o=r.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${L5.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,n.getSetting("ariaTags")&&Pe(s,[Bs()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===uu||u==="vertical"&&this.type===cu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=df(e.TABLE),new G5(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,s=e.parentNode.style;[r,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class Z5 extends Kf{constructor(e,n,r,i,s,o){super(e,n,Da,r,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new VT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${s}px`,n.style.bottom=`${o}px`}else Uf(n),this.repositionOverlay();let r=en(this.clone.wtTable.TABLE);const i=ln(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Ln(r)),i.style.bottom=`${s}px`}}const J5="calculatedColumns",CC={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Js(CC,"MIXIN_NAME",J5,{writable:!1,enumerable:!1});class BT extends lh{constructor(e,n,r,i){super(e,n,r,i,$s)}}wt(BT,$T);wt(BT,CC);function Q5(t,e,n){return(e=eX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eX(t){var e=tX(t,"string");return typeof e=="symbol"?e:e+""}function tX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nX extends Kf{constructor(e,n,r,i){super(e,n,$s,r,i),Q5(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new BT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Ln(r)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(aC(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,s=i.getDefaultRowHeight();let o=e,a=0;for(;o<n;){const l=r.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Ln(r)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;n&&s.offsetHeight!==s.clientHeight&&(o=Ln(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=o,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return lC(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((r||n===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=Me(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(K(o,"innerBorderBottom"),s=!a):(_e(o,"innerBorderBottom"),s=a)}return s}}const rX="calculatedRows",jT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Js(jT,"MIXIN_NAME",rX,{writable:!1,enumerable:!1});class UT extends lh{constructor(e,n,r,i){super(e,n,r,i,cu)}}wt(UT,jT);wt(UT,wC);const iX="localHooks",Wn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Vp(this._localHooks[t][l],this,e,n,r,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};Js(Wn,"MIXIN_NAME",iX,{writable:!1,enumerable:!1});let M$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};wt(M$,Wn);const I$="active-header",zT="header",YT="area",Gp="focus",sX="fill",oX="row",aX="column",lX="custom-selection",GT=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var NA={},DA;function uX(){if(DA)return NA;DA=1;var t=mC();return t("flat"),NA}uX();function cX(t,e){P$(t,e),e.add(t)}function LA(t,e,n){P$(t,e),e.set(t,n)}function P$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e){return t.get(Fd(t,e))}function kA(t,e,n){return t.set(Fd(t,e),n),n}function Fd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Di=new WeakMap,Yn=new WeakMap,_g=new WeakSet;class hX{constructor(){cX(this,_g),LA(this,Di,void 0),LA(this,Yn,void 0)}setActiveOverlay(e){return kA(Yn,this,e),this}setActiveSelection(e){return kA(Di,this,e),this}scan(){const e=qt(Di,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,s]=qt(Di,this).getCorners(),{wtTable:o}=qt(Yn,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let c=-o.getRowHeadersCount();c<a;c++){const h=o.columnFilter.renderedToSource(c);if(!(h<r||h>s)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let m=o.getColumnHeader(h,f);const y=qt(Yn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:qt(Di,this).settings.selectionType,columnCursor:u,selectionWidth:s-r+1});y!==null&&(y!==h&&(m=o.getColumnHeader(y,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,s]=qt(Di,this).getCorners(),{wtTable:o}=qt(Yn,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const h=o.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>s)continue;const f=d+l;let m=o.getRowHeader(h,f);const y=qt(Yn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:qt(Di,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});y!==null&&(y!==h&&(m=o.getRowHeader(y,f)),e(m))}u+=1}}}scanCellsRange(e){const{wtTable:n}=qt(Yn,this);Fd(_g,this,dX).call(this,(r,i)=>{const s=n.getCell(qt(Yn,this).createCellCoords(r,i)),o=qt(Yn,this).getSetting("onAfterDrawSelection",r,i,qt(Di,this).settings.layerLevel);typeof o=="string"&&K(s,o),e(s)})}scanRowsInCellsRange(e){const[n,,r]=qt(Di,this).getCorners(),{wtTable:i}=qt(Yn,this);Fd(_g,this,FA).call(this,(s,o)=>{if(s>=n&&s<=r){const a=i.getCell(qt(Yn,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=qt(Di,this).getCorners(),{wtTable:i}=qt(Yn,this);Fd(_g,this,FA).call(this,(s,o)=>{if(o>=n&&o<=r){const a=i.getCell(qt(Yn,this).createCellCoords(s,o));e(a)}})}}function dX(t){let[e,n,r,i]=qt(Di,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:s}=qt(Yn,this),o=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),o){if(n=Math.max(n,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),r=Math.min(r,s.getLastRenderedRow()),i<n||r<e)return}else if(!(s.getCell(qt(Yn,this).createCellCoords(e,n))instanceof HTMLElement))return;for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function FA(t){const{wtTable:e}=qt(Yn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<r;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class $A{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=GT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),_i(e);const r=this,i=this.wot.rootDocument.body,s=n.getBoundingClientRect();n.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ho()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=n.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Be(i,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Be(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),y=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(r-y/4*3,10)}px`,c[l]=`${parseInt(i-y/4*3,10)}px`;const x=Math.min(parseInt(i+s,10),C-m-f*2),O=Math.min(parseInt(i+s-y/4,10),C-y-f*2);h[l]=`${x}px`,d[l]=`${O}px`;const b=Math.min(parseInt(r+o,10),T-m-f*2),H=Math.min(parseInt(r+o-y/4,10),T-y-f*2);h.top=`${b}px`,d.top=`${H}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,s]=e;if(n<0&&i<0||r<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==s,c=o.getFirstRenderedRow(),h=o.getLastRenderedRow(),d=o.getFirstRenderedColumn(),f=o.getLastRenderedColumn();let m;if(u){if(r=Math.max(r,d),s=Math.min(s,f),n=Math.max(n,c),i=Math.min(i,h),s<r||i<n){this.disappear();return}m=o.getCell(this.wot.createCellCoords(n,r))}else if(m=o.getCell(this.wot.createCellCoords(n,r)),!(m instanceof HTMLElement)){this.disappear();return}const y=u?o.getCell(this.wot.createCellCoords(i,s)):m,C=xn(m),T=u?xn(y):C,x=xn(o.TABLE),O=C.top,b=C.left,H=this.wot.wtSettings.getSetting("rtlMode");let k=0,V=0;if(H){const me=ln(o.TABLE),be=ln(m),st=l.innerWidth-x.left-me;V=b+be-T.left,k=l.innerWidth-b-be-st-1}else V=T.left+ln(y)-b,k=b-x.left-1;if(this.isEntireColumnSelected(n,i)){const me=n,be=this.getDimensionsFromHeader("columns",r,s,me,x);let st=null;be&&([st,k,V]=be),st&&(m=st)}let U=O-x.top-1,Z=T.top+en(y)-O;if(this.isEntireRowSelected(r,s)){const me=r,be=this.getDimensionsFromHeader("rows",n,i,me,x);let st=null;be&&([st,U,Z]=be),st&&(m=st)}const Y=l.getComputedStyle(m);parseInt(Y.borderTopWidth,10)>0&&(U+=1,Z=Z>0?Z-1:0),parseInt(Y[H?"borderRightWidth":"borderLeftWidth"],10)>0&&(k+=1,V=V>0?V-1:0);const Q=H?"right":"left";this.topStyle.top=`${U}px`,this.topStyle[Q]=`${k}px`,this.topStyle.width=`${V}px`,this.topStyle.display="block",this.startStyle.top=`${U}px`,this.startStyle[Q]=`${k}px`,this.startStyle.height=`${Z}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${U+Z-ne}px`,this.bottomStyle[Q]=`${k}px`,this.bottomStyle.width=`${V}px`,this.bottomStyle.display="block",this.endStyle.top=`${U}px`,this.endStyle[Q]=`${k+V-ne}px`,this.endStyle.height=`${Z+1}px`,this.endStyle.display="block";let ce=this.settings.border.cornerVisible;ce=typeof ce=="function"?ce(this.settings.layerLevel):ce;const ae=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render");let[ye,Le]=[i,s];if(ae&&Array.isArray(ae)&&([,,ye,Le]=ae),Ho()||!ce||this.isPartRange(ye,Le))this.cornerStyle.display="none";else{this.cornerStyle.top=`${U+Z+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Q]=`${k+V+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let me=au(o.TABLE);const be=me===l;be&&(me=a.documentElement);const st=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Ht=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),g=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const w=be?y.getBoundingClientRect().left:y.offsetLeft;let R=!1,P=0;H?(P=w-parseInt(this.cornerDefaultStyle.width,10)/2,R=P<0):(P=w+ln(y)+parseInt(this.cornerDefaultStyle.width,10)/2,R=P>=bT(me)),R&&(this.cornerStyle[Q]=`${Math.floor(k+V+this.cornerCenterPointOffset-Ht-st)}px`,this.cornerStyle[H?"borderLeftWidth":"borderRightWidth"]=0)}i===this.wot.getSetting("totalRows")-1&&(be?y.getBoundingClientRect().top:y.offsetTop)+en(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=Nc(me)&&(this.cornerStyle.top=`${Math.floor(U+Z+this.cornerCenterPointOffset-g-st)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Ho()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,U,k,V,Z)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,y=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return en(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return ln(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(m=l(n,C-i),y=l(r,C-i),!m||!y)return!1;const T=xn(m),x=xn(y);return m&&y&&(h=T[f]-s[f]-1,d=x[f]+u(y)-T[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?K(this[e],"hidden"):(Me(this[e],"hidden")&&_e(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?K(this[e],"hidden"):_e(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ho()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function fX(t,e){O$(t,e),e.add(t)}function Au(t,e,n){O$(t,e),e.set(t,n)}function O$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ue(t,e){return t.get(qT(t,e))}function VA(t,e,n){return t.set(qT(t,e),n),n}function qT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gn=new WeakMap,Or=new WeakMap,nS=new WeakMap,Sd=new WeakMap,rS=new WeakMap,il=new WeakMap,WA=new WeakSet;class gX{constructor(e){fX(this,WA),Au(this,Gn,void 0),Au(this,Or,void 0),Au(this,nS,new hX),Au(this,Sd,new WeakMap),Au(this,rS,new WeakSet),Au(this,il,new Map),VA(Or,this,e)}setActiveOverlay(e){return VA(Gn,this,e),Ue(nS,this).setActiveOverlay(Ue(Gn,this)),Ue(Sd,this).has(Ue(Gn,this))||Ue(Sd,this).set(Ue(Gn,this),new Set),this}getFocusSelection(){return Ue(Or,this)!==null?Ue(Or,this).getFocus():null}getAreaSelection(){return Ue(Or,this)!==null?Ue(Or,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ue(il,this).has(e)){const r=Ue(il,this).get(e);if(r.has(Ue(Gn,this)))return r.get(Ue(Gn,this));const i=new $A(Ue(Gn,this),e.settings);return r.set(Ue(Gn,this),i),i}const n=new $A(Ue(Gn,this),e.settings);return Ue(il,this).set(e,new Map([[Ue(Gn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Ue(il,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Ue(il,this).get(e).forEach(n=>n.destroy()),Ue(il,this).delete(e)}render(e){if(Ue(Or,this)===null)return;e&&qT(WA,this,mX).call(this);const n=Array.from(Ue(Or,this)),r=new Map,i=new Map;for(let s=0;s<n.length;s++){const o=n[s],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=o.settings;Ue(rS,this).has(o)||(Ue(rS,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h==null||h.disappear();continue}a&&Ue(nS,this).setActiveSelection(o).scan().forEach(m=>{if(r.has(m)){const y=r.get(m);y.has(a)&&u===!0?y.set(a,y.get(a)+1):y.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=o.getCorners();Ue(Gn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Ue(Sd,this).get(Ue(Gn,this)).add(u)),K(o,l),o.nodeName==="TD"&&Array.isArray((a=Ue(Or,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Pe(o,Ue(Or,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{Pe(s,[...i.get(s)])})}}function mX(){const t=Ue(Sd,this).get(Ue(Gn,this)),e=Ue(Gn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const s=Ue(Gn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let o=[];Array.isArray((r=Ue(Or,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(o=Ue(Or,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Ue(Or,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...Ue(Or,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)_e(s[a],n),bu(s[a],o)}),t.clear()}class pX extends Kf{constructor(e,n,r,i){super(e,n,cu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new UT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),uC(r,`${s}px`,"0px")):(s=this.getScrollPosition(),Uf(r));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,yT(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<n;)s+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=Ln(r)),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=ln(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=GT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!Me(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Ln(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,VF(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(vT(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),o=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";o?_e(r,"emptyRows"):K(r,"emptyRows");let l=!1;if(!a){if(s&&!i.length)K(r,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=Me(r,"innerBorderInlineStart");e?(K(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(_e(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const wX="stickyRowsTop",KT={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Js(KT,"MIXIN_NAME",wX,{writable:!1,enumerable:!1});class XT extends lh{constructor(e,n,r,i){super(e,n,r,i,hu)}}wt(XT,KT);wt(XT,wC);function BA(t,e,n){return(e=CX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CX(t){var e=yX(t,"string");return typeof e=="symbol"?e:e+""}function yX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vX extends Kf{constructor(e,n,r,i,s,o){super(e,n,hu,r,i),BA(this,"topOverlay",void 0),BA(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new XT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();uC(e,`${i}px`,`${s}px`)}else Uf(e);let n=en(this.clone.wtTable.TABLE);const r=ln(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class ZT extends lh{constructor(e,n,r,i){super(e,n,r,i,uu)}}wt(ZT,KT);wt(ZT,CC);function bX(t,e,n){return(e=SX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SX(t){var e=RX(t,"string");return typeof e=="symbol"?e:e+""}function RX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EX extends Kf{constructor(e,n,r,i){super(e,n,uu,r,i),bX(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new ZT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;s=u===c,i=this.getOverlayOffset(),uC(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Uf(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(aC(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,s=0;for(;i<n;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?r:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Ln(r)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=GT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,o=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Me(o.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&o.offsetHeight!==o.clientHeight&&(h=Ln(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,$F(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return lC(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,s=r.getSetting("totalColumns"),o=r.getSetting("preventOverflow")==="horizontal";s?_e(i,"emptyColumns"):K(i,"emptyColumns");let a=!1;if(!n&&!o){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Me(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(K(i,"innerBorderTop"),a=!h):(_e(i,"innerBorderTop"),a=h)}}return a}}function xg(t,e,n){TX(t,e),e.set(t,n)}function TX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function io(t,e,n){return(e=_X(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _X(t){var e=xX(t,"string");return typeof e=="symbol"?e:e+""}function xX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sl(t,e,n){return t.set(A$(t,e),n),n}function so(t,e){return t.get(A$(t,e))}function A$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hu=new WeakMap,Mg=new WeakMap,Nu=new WeakMap,Ig=new WeakMap;class MX{constructor(e,n,r,i,s,o){io(this,"wot",null),xg(this,Hu,[]),io(this,"topOverlay",null),io(this,"bottomOverlay",null),io(this,"inlineStartOverlay",null),io(this,"topInlineStartCornerOverlay",null),io(this,"bottomInlineStartCornerOverlay",null),io(this,"browserLineHeight",void 0),io(this,"wtSettings",null),xg(this,Mg,!1),xg(this,Nu,0),xg(this,Ig,null),io(this,"resizeObserver",new ResizeObserver(c=>{gf(()=>{!Array.isArray(c)||!c.length||(sl(Nu,this,so(Nu,this)+1),so(Nu,this)===100&&(ht("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),so(Ig,this)!==null&&clearTimeout(so(Ig,this)),sl(Ig,this,setTimeout(()=>{sl(Nu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=Ln(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:df(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...so(Hu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),s=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new EX(...e),this.bottomOverlay=new nX(...e),this.inlineStartOverlay=new pX(...e),this.topInlineStartCornerOverlay=new vX(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Z5(...e,this.bottomOverlay,this.inlineStartOverlay),sl(Hu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){sl(Mg,this,so(Hu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),so(Hu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),so(Hu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=n.devicePixelRatio&&n.devicePixelRatio>1,o=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!MT())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{gf(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{sl(Nu,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==n&&s!==n&&!e.target.contains(i)||r!==n&&s!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==r&&o!==r&&!o.contains(s),l=i!==r&&o!==r&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=ah(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),s=this.scrollHorizontally(r);return i||s}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!so(Mg,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),sl(Mg,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=df(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,s),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),m=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),y=f()?1:0,C=m()?1:0;d.width=`${c+C}px`,d.height=`${u+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return F(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];F(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function jA(t,e,n){return(e=IX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IX(t){var e=PX(t,"string");return typeof e=="symbol"?e:e+""}function PX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OX{constructor(e){jA(this,"settings",{}),jA(this,"defaults",Object.freeze(this.getDefaults())),Be(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Wa(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Be(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,s){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,s):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class JT extends lh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=au(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=ff(e,"height",n),s=ff(e,"overflow",n),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),o.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ou(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",s=e.getSetting("columnHeaders").length;if(s&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}wt(JT,jT);wt(JT,CC);class AX{constructor(e,n,r,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new y4:new T4],["fullyVisible",()=>new u4],["partiallyVisible",()=>new y$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new p4:new S4],["fullyVisible",()=>new o4],["partiallyVisible",()=>new C$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=en(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return xn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=en(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=n.length;i<s;i++)r?(this.rowHeaderWidth+=ln(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=o),r.holder.clientHeight===r.holder.offsetHeight?s=0:s=Ln(this.domBindings.rootDocument),new H4({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=n.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Ln(this.domBindings.rootDocument)),new P4({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const s=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!n.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s,rowStartOffset:o,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(o,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(o/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>s||r===s&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s,columnStartOffset:o,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(o,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(o/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>s||r===s&&r<l)}resetHasOversizedColumnHeadersMarked(){Be(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function HX(t,e){H$(t,e),e.add(t)}function ol(t,e,n){H$(t,e),e.set(t,n)}function H$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(ji(t,e))}function Bi(t,e,n){return t.set(ji(t,e),n),n}function ji(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const UA=23;var _s=new WeakMap,Po=new WeakMap,QT=new WeakMap,OE=new WeakMap,fa=new WeakMap,Rd=new WeakMap,pf=new WeakMap,Ps=new WeakSet;class NX{constructor(e){HX(this,Ps),ol(this,_s,void 0),ol(this,Po,void 0),ol(this,QT,void 0),ol(this,OE,void 0),ol(this,fa,!0),ol(this,Rd,{}),ol(this,pf,{}),Bi(Po,this,e.rootTable.parentElement.parentElement),Bi(OE,this,e.rootDocument)}isClassicTheme(){return kt(fa,this)}getCSSVariableValue(e){var n;if(kt(fa,this))return null;if(kt(Rd,this)[`--ht-${e}`])return kt(Rd,this)[`--ht-${e}`];const r=(n=ji(Ps,this,FX).call(this,`--ht-${e}`))!==null&&n!==void 0?n:ji(Ps,this,N$).call(this,`--ht-${e}`);if(r!==null)return kt(Rd,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=kt(pf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(kt(fa,this))return UA;const e=ji(Ps,this,DX).call(this);return!e&&Me(kt(Po,this),"ht-wrapper")?(ht(`The "${kt(_s,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Bi(fa,this,!0),this.useTheme(),UA):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){ji(Ps,this,zA).call(this),Bi(fa,this,!0),Bi(_s,this,e||void 0);return}e&&e!==kt(_s,this)&&(kt(_s,this)&&ji(Ps,this,$X).call(this),Bi(_s,this,e),Bi(fa,this,!1),ji(Ps,this,LX).call(this),ji(Ps,this,zA).call(this))}getThemeName(){return kt(_s,this)}removeClassNames(){Me(kt(Po,this),kt(_s,this))&&_e(kt(Po,this),kt(_s,this))}}function DX(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function LX(){_e(kt(Po,this),/ht-theme-.*/g),K(kt(Po,this),kt(_s,this))}function zA(){this.isClassicTheme()||Bi(QT,this,getComputedStyle(kt(Po,this)));const t=ji(Ps,this,kX).call(this,["box-sizing","border-bottom-width"]);kt(pf,this).td={...kt(pf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function kX(t){const e=kt(OE,this),n=kt(Po,this),r=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),i.appendChild(s),i.appendChild(o),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function FX(t){const e=Math.ceil(parseFloat(ji(Ps,this,N$).call(this,t)));return Number.isNaN(e)?null:e}function N$(t){const e=kt(QT,this).getPropertyValue(t);return e===""?null:e}function $X(){Bi(pf,this,{}),Bi(Rd,this,{}),Bi(fa,this,!0)}class VX extends WT{constructor(e,n){super(e,new OX(n)),this.stylesHandler=new NX(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new JT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new AX(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new gX(this.wtSettings.getSetting("selections")),this.wtEvent=new E$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new MX(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Be(e,(i,s)=>{this.wtSettings.getSetting(s).length&&r.push(i),n.push(i)}),_e(this.wtTable.wtRootElement.parentNode,n),K(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!x$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class e_{constructor(e){e instanceof WT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new e_(n);return()=>r},this._wot=new VX(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,s){return this._wot.wtSettings.getSetting(e,n,r,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function YA(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!s.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!o.column?d&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?d&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?d&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function WX(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:s}=t;if(!e)return;const o=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(s(u-1,n.col)):o&&!i.row?r.setRangeEnd(s(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const BX=new Map([["mousedown",YA],["mouseover",WX],["touchstart",YA]]);function GA(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:s}=e;BX.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:gC(t)||t.type==="touchstart",isRightClick:Ba(t)})}const D$=new WeakMap,t_=Symbol("rootInstance");function jX(t){D$.set(t,!0)}function UX(t){return t===t_}function ap(t){return D$.has(t)}function zX(t,e){L$(t,e),e.add(t)}function al(t,e,n){L$(t,e),e.set(t,n)}function L$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qo(t,e,n){return(e=YX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YX(t){var e=GX(t,"string");return typeof e=="symbol"?e:e+""}function GX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function An(t,e){return t.get(Lc(t,e))}function ii(t,e,n){return t.set(Lc(t,e),n),n}function Lc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var iS=new WeakMap,Pg=new WeakMap,Og=new WeakMap,oo=new WeakMap,Ii=new WeakMap,sS=new WeakMap,oS=new WeakMap,Ed=new WeakSet;class qX{constructor(e){zX(this,Ed),Qo(this,"hot",void 0),Qo(this,"eventManager",void 0),Qo(this,"settings",void 0),Qo(this,"THEAD",void 0),Qo(this,"TBODY",void 0),Qo(this,"_wt",void 0),Qo(this,"activeWt",void 0),al(this,iS,0),al(this,Pg,0),Qo(this,"postponedAdjustElementsSize",!1),al(this,Og,!1),al(this,oo,void 0),al(this,Ii,void 0),al(this,sS,0),al(this,oS,0),this.hot=e,this.eventManager=new bi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),Lc(Ed,this,XX).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),K(e,"handsontable"),ii(Ii,this,n.createElement("TABLE")),K(An(Ii,this),"htCore"),this.hot.getSettings().tableClassName&&K(An(Ii,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Pe(An(Ii,this),[Bs()]),Pe(e,[r3(),MF(-1),oC(this.hot.countCols()),w3()])),this.THEAD=n.createElement("THEAD"),An(Ii,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),An(Ii,this).appendChild(this.TBODY),this.hot.table=An(Ii,this),this.hot.container.insertBefore(An(Ii,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,s=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{ii(Og,this,!0),this.isTextSelectionAllowed(a.target)||(SE(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{ii(Og,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{An(Og,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&SE(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{r.isInProgress()&&gC(a)&&r.finish(),ii(oo,this,!1);const l=cC(n.activeElement);kd(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Ba(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{r.isInProgress()&&Ba(a)&&(r.finish(),ii(oo,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{r.isInProgress()&&r.finish(),ii(oo,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(An(oo,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const m=Ln(n);if(n.elementFromPoint(u+m,c)!==d||n.elementFromPoint(u,c+m)!==d)return}else for(;h!==s;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=su(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=su(o);this.eventManager.addEventListener(An(Ii,this),"selectstart",a=>{this.settings.fragmentSelection||kd(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const s=r.getNearestNotHiddenIndex(e,n),o=r.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return n<0?a=o+1:n>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&K(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&_e(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:An(Ii,this),isDataViewInstance:()=>ap(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),ii(Pg,this,s.length),this.hot.getSettings().ariaTags&&Lc(Ed,this,k$).call(this)===this.hot.countCols()&&Lc(Ed,this,KX).call(this,An(Pg,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),ii(iS,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let y=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,y,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,y,f),this.hot.runHooks("afterRenderer",a,l,u,m,y,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ou(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,ii(oo,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,c),!Sa(s)&&(GA(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,ii(oo,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!Sa(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!Sa(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,c),!Sa(s)&&(An(oo,this)&&GA(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt)},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(Sa(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollVertically",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,c]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=o>=0?c.getVisualFromRenderableIndex(o):o,d=s>=0?u.getVisualFromRenderableIndex(s):s,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[m,y,C,T]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,1)):y,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,T>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=o>=0?l.getVisualFromRenderableIndex(o):o,c=s>=0?a.getVisualFromRenderableIndex(s):s,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const c=Math.max(1,Math.ceil(u/a*12));s.startRow=Math.max(l-c,0),s.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const c=Math.max(1,Math.ceil(u/a*6));s.startColumn=Math.max(l-c,0),s.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new e_(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(kd(e))return!0;const n=Na(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return An(oo,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Me(r,"relative")){Qi(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,s=r.createElement("div"),o=r.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),n.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(n.firstChild){const o=n.firstChild;Me(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,r,i),o.className="",K(o,["relative",...s()])):(Qi(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Pe(a,...Bs()),Pe(l,...Bs())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=n;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Me(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(n):Me(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(n))),s>-1?Su(e,r(n,i)):(Wa(e," "),K(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){ii(sS,this,e),ii(oS,this,n)}getLastSize(){return{width:An(sS,this),height:An(oS,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return An(iS,this)}getRowHeadersCount(){return An(Pg,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function k$(){return parseInt(this.hot.rootElement.getAttribute(oC()[0]),10)}function KX(t){const e=Lc(Ed,this,k$).call(this)+t;Pe(this.hot.rootElement,...oC(e))}function XX(){const t=this.hot.rootElement;this.hasVerticalScroll()?K(t,"htHasScrollY"):_e(t,"htHasScrollY"),this.hasHorizontalScroll()?K(t,"htHasScrollX"):_e(t,"htHasScrollX")}var qA={},KA={},XA;function ZX(){if(XA)return KA;XA=1;var t=Mt(),e=th(),n=kr(),r=bn(),i=Ks();return t({target:"Iterator",proto:!0,real:!0},{every:function(o){r(this),n(o);var a=i(this),l=0;return!e(a,function(u,c){if(!o(u,l++))return c()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),KA}var ZA;function JX(){return ZA||(ZA=1,ZX()),qA}JX();const F$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",AE=F$.length;function yC(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%AE,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/AE,10);return n}function QX(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=AE**r*(F$.indexOf(t[n])+1);return e-=1,e}function e9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const s=[];for(i=0;i<e;i++)s.push(yC(i)+(r+1));n.push(s)}return n}function t9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const s={};for(i=0;i<e;i++)s[`prop${i}`]=yC(i)+(r+1);n.push(s)}return n}function n9(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let s=0;s<e;s++)r.push("");n.push(r)}return n}function n_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{r.push([s+e,a,o])}):Object.keys(i).forEach(o=>{r.push([s+e,o,i[o]])})}),r}function r_(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&We(t[0])&&(e=fC(t[0]))),e}function $$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function V$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const r9=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:r_,createEmptySpreadsheetData:n9,createSpreadsheetData:e9,createSpreadsheetObjectData:t9,dataRowToChangesArray:n_,isArrayOfArrays:$$,isArrayOfObjects:V$,spreadsheetColumnIndex:QX,spreadsheetColumnLabel:yC},Symbol.toStringTag,{value:"Module"}));function Lh(t,e,n){return(e=i9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i9(t){var e=s9(t,"string");return typeof e=="symbol"?e:e+""}function s9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o9{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Lh(this,"hot",void 0),Lh(this,"data",void 0),Lh(this,"dataType","array"),Lh(this,"colToProp",()=>{}),Lh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return F(this.data,(r,i)=>{const s=this.getAtCell(i,e);n.push(s)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=n===void 0&&r===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Re(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(We(a)||Tt(a))if(i?l=[]:l={},!s||i){const c=this.countFirstRowKeys()-1;Re(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):o?ip(l,d,f):l[d]=f}})}else Be(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);o?ip(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Lr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:ip(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?qF(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const s=Lr(i);this.hot.runHooks("modifySourceData",e,n,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||n===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,n.row),o=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return Re(s,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,o,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return r_(this.data)}destroy(){this.data=null,this.hot=null}}var JA={},QA={},eH;function a9(){if(eH)return QA;eH=1;var t=Mt(),e=th(),n=kr(),r=bn(),i=Ks();return t({target:"Iterator",proto:!0,real:!0},{some:function(o){r(this),n(o);var a=i(this),l=0;return e(a,function(u,c){if(o(u,l++))return c()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),QA}var tH;function l9(){return tH||(tH=1,a9()),JA}l9();function nH(t,e,n){return(e=u9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u9(t){var e=c9(t,"string");return typeof e=="symbol"?e:e+""}function c9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ru{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;nH(this,"indexedValues",[]),nH(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Tt(this.initValueOrFn)?Re(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):Re(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}wt(Ru,Wn);function i_(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((s,o)=>Tt(r)?r(s,o):r),...i===void 0?[]:t.slice(i)]}function s_(t,e){return Bo(t,(n,r)=>e.includes(r)===!1)}class Xa extends Ru{insert(e,n){this.indexedValues=i_(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=s_(this.indexedValues,e),super.remove(e)}}class vC extends Xa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return mn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function o_(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function wf(t,e){return Bo(t,n=>e.includes(n)===!1)}function a_(t,e){return qe(t,n=>n-e.filter(r=>r<n).length)}function l_(t,e){const n=e[0],r=e.length;return qe(t,i=>i>=n?i+r:i)}function h9(t,e,n){return(e=d9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d9(t){var e=f9(t,"string");return typeof e=="symbol"?e:e+""}function f9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bC extends Ru{constructor(){super(...arguments),h9(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=wf(this.orderOfIndexes,[e]),Tt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=i_(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=l_(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=s_(this.indexedValues,e),this.orderOfIndexes=wf(this.orderOfIndexes,e),this.orderOfIndexes=a_(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Xf extends Xa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return mn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const rH=new Map([["indexesSequence",{getListWithInsertedItems:o_,getListWithRemovedItems:wf}],["physicallyIndexed",{getListWithInsertedItems:i_,getListWithRemovedItems:s_}]]),W$=t=>{if(rH.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return rH.get(t)};class B$ extends Ru{constructor(){super(e=>e)}insert(e,n){const r=l_(this.indexedValues,n);this.indexedValues=o_(r,e,n),super.insert(e,n)}remove(e){const n=wf(this.indexedValues,e);this.indexedValues=a_(n,e),super.remove(e)}}const iH=new Map([["hiding",vC],["index",Ru],["linkedPhysicalIndexToValue",bC],["physicalIndexToValue",Xa],["trimming",Xf]]);function g9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!iH.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(iH.get(t))(e)}function m9(t,e,n){return(e=p9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p9(t){var e=w9(t,"string");return typeof e=="symbol"?e:e+""}function w9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let HE=0;class u_{constructor(){m9(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),HE+=1)}unregister(e){const n=this.collection.get(e);we(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),HE-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ft(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}wt(u_,Wn);function C9(){return HE}function aS(t,e,n){return(e=y9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y9(t){var e=v9(t,"string");return typeof e=="symbol"?e:e+""}function v9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sH extends u_{constructor(e,n){super(),aS(this,"mergedValuesCache",[]),aS(this,"aggregationFunction",void 0),aS(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=qe(this.get(),s=>s.getValues()),r=[],i=we(n[0])&&n[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(n[a][s]);r.push(o)}return qe(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return we(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function b9(t,e,n){S9(t,e),e.set(t,n)}function S9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function R9(t,e,n){return t.set(j$(t,e),n),n}function E9(t,e){return t.get(j$(t,e))}function j$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lS=new WeakMap;class U${constructor(){b9(this,lS,[])}subscribe(e){return this.addLocalHook("change",e),this._write(E9(lS,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){R9(lS,this,e)}}wt(U$,Wn);function oH(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function kh(t,e,n){T9(t,e),e.set(t,n)}function T9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function si(t,e){return t.get(z$(t,e))}function Ag(t,e,n){return t.set(z$(t,e),n),n}function z$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hg=new WeakMap,Fh=new WeakMap,Ng=new WeakMap,Dg=new WeakMap,Lg=new WeakMap;class _9{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};kh(this,Hg,new Set),kh(this,Fh,[]),kh(this,Ng,[]),kh(this,Dg,!1),kh(this,Lg,!1),Ag(Lg,this,e??!1)}createObserver(){const e=new U$;return si(Hg,this).add(e),e.addLocalHook("unsubscribe",()=>{si(Hg,this).delete(e)}),e._writeInitialChanges(oH(si(Fh,this),si(Ng,this))),e}emit(e){let n=si(Ng,this);(!si(Dg,this)||si(Fh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(si(Lg,this)):Ag(Fh,this,new Array(e.length).fill(si(Lg,this))),si(Dg,this)||(Ag(Dg,this,!0),n=si(Fh,this)));const r=oH(n,e);si(Hg,this).forEach(i=>i._write(r)),Ag(Ng,this,e)}}function ur(t,e,n){return(e=x9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x9(t){var e=M9(t,"string");return typeof e=="symbol"?e:e+""}function M9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NE{constructor(){ur(this,"indexesSequence",new B$),ur(this,"trimmingMapsCollection",new sH(e=>e.some(n=>n===!0),!1)),ur(this,"hidingMapsCollection",new sH(e=>e.some(n=>n===!0),!1)),ur(this,"variousMapsCollection",new u_),ur(this,"hidingChangesObservable",new _9({initialIndexValue:!1})),ur(this,"notTrimmedIndexesCache",[]),ur(this,"notHiddenIndexesCache",[]),ur(this,"isBatched",!1),ur(this,"indexesSequenceChanged",!1),ur(this,"indexesChangeSource",void 0),ur(this,"trimmedIndexesChanged",!1),ur(this,"hiddenIndexesChanged",!1),ur(this,"renderablePhysicalIndexesCache",[]),ur(this,"fromPhysicalToVisualIndexesCache",new Map),ur(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,g9(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Xf?this.trimmingMapsCollection.register(e,n):n instanceof vC?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return we(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return we(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return we(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return we(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return n>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=qe(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=wf(this.getIndexesSequence(),r),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(n+s<i){const u=a[n];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(o_(o,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=we(r)?r:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),o=qe(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}wt(NE,Wn);function I9(t,e){return Be(e,(n,r)=>{Ft(t[r])&&(t[r]=n)}),t}function Y$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function G$(t){we(t)&&HT(pt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function P9(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:O9,getValues:A9}=ss("phraseFormatters");function H9(t,e){O9(t,e)}function N9(){return A9()}H9("pluralize",P9);const q$="ContextMenu:items",De=q$,c_=`${De}.noItems`,h_=`${De}.insertRowAbove`,d_=`${De}.insertRowBelow`,f_=`${De}.insertColumnOnTheLeft`,g_=`${De}.insertColumnOnTheRight`,m_=`${De}.removeRow`,p_=`${De}.removeColumn`,w_=`${De}.undo`,C_=`${De}.redo`,qp=`${De}.readOnly`,y_=`${De}.clearColumn`,v_=`${De}.copy`,b_=`${De}.copyWithHeaders`,S_=`${De}.copyWithGroupHeaders`,R_=`${De}.copyHeadersOnly`,E_=`${De}.cut`,T_=`${De}.freezeColumn`,__=`${De}.unfreezeColumn`,x_=`${De}.mergeCells`,M_=`${De}.unmergeCells`,I_=`${De}.addComment`,P_=`${De}.editComment`,O_=`${De}.removeComment`,A_=`${De}.readOnlyComment`,H_=`${De}.align`,N_=`${De}.align.left`,D_=`${De}.align.center`,L_=`${De}.align.right`,k_=`${De}.align.justify`,F_=`${De}.align.top`,$_=`${De}.align.middle`,V_=`${De}.align.bottom`,W_=`${De}.borders`,B_=`${De}.borders.top`,j_=`${De}.borders.right`,U_=`${De}.borders.bottom`,z_=`${De}.borders.left`,Y_=`${De}.borders.remove`,G_=`${De}.nestedHeaders.insertChildRow`,q_=`${De}.nestedHeaders.detachFromParent`,K_=`${De}.hideColumn`,X_=`${De}.showColumn`,Z_=`${De}.hideRow`,J_=`${De}.showRow`,br="Filters:",tn=`${br}conditions`,SC=`${tn}.none`,Q_=`${tn}.isEmpty`,ex=`${tn}.isNotEmpty`,tx=`${tn}.isEqualTo`,nx=`${tn}.isNotEqualTo`,rx=`${tn}.beginsWith`,ix=`${tn}.endsWith`,sx=`${tn}.contains`,ox=`${tn}.doesNotContain`,D9=`${tn}.byValue`,ax=`${tn}.greaterThan`,lx=`${tn}.greaterThanOrEqualTo`,ux=`${tn}.lessThan`,cx=`${tn}.lessThanOrEqualTo`,hx=`${tn}.isBetween`,dx=`${tn}.isNotBetween`,fx=`${tn}.after`,gx=`${tn}.before`,mx=`${tn}.today`,px=`${tn}.tomorrow`,wx=`${tn}.yesterday`,Cx=`${br}labels.filterByCondition`,yx=`${br}labels.filterByValue`,vx=`${br}labels.conjunction`,RC=`${br}labels.disjunction`,Kp=`${br}values.blankCells`,bx=`${br}buttons.selectAll`,Sx=`${br}buttons.clear`,Rx=`${br}buttons.ok`,Ex=`${br}buttons.cancel`,Tx=`${br}buttons.placeholder.search`,_x=`${br}buttons.placeholder.value`,xx=`${br}buttons.placeholder.secondValue`,Mx="CheckboxRenderer:",Ix=`${Mx}checked`,Px=`${Mx}unchecked`,L9=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:Ix,CHECKBOX_RENDERER_NAMESPACE:Mx,CHECKBOX_UNCHECKED:Px,CONTEXTMENU_ITEMS_ADD_COMMENT:I_,CONTEXTMENU_ITEMS_ALIGNMENT:H_,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:V_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:D_,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:k_,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:N_,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:$_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:L_,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:F_,CONTEXTMENU_ITEMS_BORDERS:W_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:U_,CONTEXTMENU_ITEMS_BORDERS_LEFT:z_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:j_,CONTEXTMENU_ITEMS_BORDERS_TOP:B_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:y_,CONTEXTMENU_ITEMS_COPY:v_,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:R_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:S_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:b_,CONTEXTMENU_ITEMS_CUT:E_,CONTEXTMENU_ITEMS_EDIT_COMMENT:P_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:T_,CONTEXTMENU_ITEMS_HIDE_COLUMN:K_,CONTEXTMENU_ITEMS_HIDE_ROW:Z_,CONTEXTMENU_ITEMS_INSERT_LEFT:f_,CONTEXTMENU_ITEMS_INSERT_RIGHT:g_,CONTEXTMENU_ITEMS_MERGE_CELLS:x_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:q_,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:G_,CONTEXTMENU_ITEMS_NO_ITEMS:c_,CONTEXTMENU_ITEMS_READ_ONLY:qp,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:A_,CONTEXTMENU_ITEMS_REDO:C_,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Y_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:p_,CONTEXTMENU_ITEMS_REMOVE_COMMENT:O_,CONTEXTMENU_ITEMS_REMOVE_ROW:m_,CONTEXTMENU_ITEMS_ROW_ABOVE:h_,CONTEXTMENU_ITEMS_ROW_BELOW:d_,CONTEXTMENU_ITEMS_SHOW_COLUMN:X_,CONTEXTMENU_ITEMS_SHOW_ROW:J_,CONTEXTMENU_ITEMS_UNDO:w_,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:__,CONTEXTMENU_ITEMS_UNMERGE_CELLS:M_,CONTEXT_MENU_ITEMS_NAMESPACE:q$,FILTERS_BUTTONS_CANCEL:Ex,FILTERS_BUTTONS_CLEAR:Sx,FILTERS_BUTTONS_OK:Rx,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Tx,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:xx,FILTERS_BUTTONS_PLACEHOLDER_VALUE:_x,FILTERS_BUTTONS_SELECT_ALL:bx,FILTERS_CONDITIONS_AFTER:fx,FILTERS_CONDITIONS_BEFORE:gx,FILTERS_CONDITIONS_BEGINS_WITH:rx,FILTERS_CONDITIONS_BETWEEN:hx,FILTERS_CONDITIONS_BY_VALUE:D9,FILTERS_CONDITIONS_CONTAINS:sx,FILTERS_CONDITIONS_EMPTY:Q_,FILTERS_CONDITIONS_ENDS_WITH:ix,FILTERS_CONDITIONS_EQUAL:tx,FILTERS_CONDITIONS_GREATER_THAN:ax,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:lx,FILTERS_CONDITIONS_LESS_THAN:ux,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:cx,FILTERS_CONDITIONS_NAMESPACE:tn,FILTERS_CONDITIONS_NONE:SC,FILTERS_CONDITIONS_NOT_BETWEEN:dx,FILTERS_CONDITIONS_NOT_CONTAIN:ox,FILTERS_CONDITIONS_NOT_EMPTY:ex,FILTERS_CONDITIONS_NOT_EQUAL:nx,FILTERS_CONDITIONS_TODAY:mx,FILTERS_CONDITIONS_TOMORROW:px,FILTERS_CONDITIONS_YESTERDAY:wx,FILTERS_DIVS_FILTER_BY_CONDITION:Cx,FILTERS_DIVS_FILTER_BY_VALUE:yx,FILTERS_LABELS_CONJUNCTION:vx,FILTERS_LABELS_DISJUNCTION:RC,FILTERS_NAMESPACE:br,FILTERS_VALUES_BLANK_CELLS:Kp},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const K$={languageCode:"en-US",[c_]:"No available options",[h_]:"Insert row above",[d_]:"Insert row below",[f_]:"Insert column left",[g_]:"Insert column right",[m_]:["Remove row","Remove rows"],[p_]:["Remove column","Remove columns"],[w_]:"Undo",[C_]:"Redo",[qp]:"Read only",[y_]:"Clear column",[H_]:"Alignment",[N_]:"Left",[D_]:"Center",[L_]:"Right",[k_]:"Justify",[F_]:"Top",[$_]:"Middle",[V_]:"Bottom",[T_]:"Freeze column",[__]:"Unfreeze column",[W_]:"Borders",[B_]:"Top",[j_]:"Right",[U_]:"Bottom",[z_]:"Left",[Y_]:"Remove border(s)",[I_]:"Add comment",[P_]:"Edit comment",[O_]:"Delete comment",[A_]:"Read-only comment",[x_]:"Merge cells",[M_]:"Unmerge cells",[v_]:"Copy",[b_]:["Copy with header","Copy with headers"],[S_]:["Copy with group header","Copy with group headers"],[R_]:["Copy header only","Copy headers only"],[E_]:"Cut",[G_]:"Insert child row",[q_]:"Detach from parent",[K_]:["Hide column","Hide columns"],[X_]:["Show column","Show columns"],[Z_]:["Hide row","Hide rows"],[J_]:["Show row","Show rows"],[SC]:"None",[Q_]:"Is empty",[ex]:"Is not empty",[tx]:"Is equal to",[nx]:"Is not equal to",[rx]:"Begins with",[ix]:"Ends with",[sx]:"Contains",[ox]:"Does not contain",[ax]:"Greater than",[lx]:"Greater than or equal to",[ux]:"Less than",[cx]:"Less than or equal to",[hx]:"Is between",[dx]:"Is not between",[fx]:"After",[gx]:"Before",[mx]:"Today",[px]:"Tomorrow",[wx]:"Yesterday",[Kp]:"Blank cells",[Cx]:"Filter by condition",[yx]:"Filter by value",[vx]:"And",[RC]:"Or",[bx]:"Select all",[Sx]:"Clear",[Rx]:"OK",[Ex]:"Cancel",[Tx]:"Search",[_x]:"Value",[xx]:"Second value",[Ix]:"Checked",[Px]:"Unchecked"},k9=L9,DE=K$.languageCode,{register:F9,getItem:X$,hasItem:$9,getValues:V9}=ss("languagesDictionaries");Z$(K$);function Z$(t,e){let n=t,r=e;return We(t)&&(r=t,n=r.languageCode),W9(n,r),F9(n,sr(r)),sr(r)}function W9(t,e){t!==DE&&I9(e,X$(DE))}function J$(t){return Ox(t)?sr(X$(t)):null}function Ox(t){return $9(t)}function B9(){return V9()}function Q$(t,e,n){const r=J$(t);if(r===null)return null;const i=r[e];if(Ft(i))return null;const s=j9(i,n);return Array.isArray(s)?s[0]:s}function j9(t,e){let n=t;return F(N9(),r=>{n=r(t,e)}),n}function U9(t){let e=Y$(t);return Ox(e)||(e=DE,G$(t)),e}function z9(t,e,n){return(e=Y9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y9(t){var e=G9(t,"string");return typeof e=="symbol"?e:e+""}function G9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xo extends M${constructor(e,n){super(e,null),z9(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),s=this.getNearestNotHiddenCoords(r,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=n,s=r),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(n,r,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function uS(t){let{activeHeaderClassName:e,...n}=t;return new Xo({className:e,...n,selectionType:I$})}function q9(t){let{areaCornerVisible:e,...n}=t;return new Xo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:YT})}function K9(t){let{...e}=t;return new Xo({className:"highlight",...e,selectionType:YT})}function X9(t){let{columnClassName:e,...n}=t;return new Xo({className:e,...n,selectionType:aX})}function Z9(t){let{cellCornerVisible:e,...n}=t;return new Xo({className:"current",headerAttributes:[wT()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Gp})}function J9(t){let{border:e,visualCellRange:n,...r}=t;return new Xo({...e,...r,selectionType:lX},n)}function Q9(t){let{...e}=t;return new Xo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:sX})}function aH(t){let{headerClassName:e,...n}=t;return new Xo({className:e,...n,selectionType:zT})}function e8(t){let{rowClassName:e,...n}=t;return new Xo({className:e,...n,selectionType:oX})}function t8(t,e){n8(t,e),e.add(t)}function n8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Er(t,e,n){return(e=r8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r8(t){var e=i8(t,"string");return typeof e=="symbol"?e:e+""}function i8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ao(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ds=new WeakSet;class s8{constructor(e){t8(this,ds),Er(this,"options",void 0),Er(this,"layerLevel",0),Er(this,"focus",void 0),Er(this,"fill",void 0),Er(this,"layeredAreas",new Map),Er(this,"areas",new Map),Er(this,"rowHeaders",new Map),Er(this,"columnHeaders",new Map),Er(this,"activeRowHeaders",new Map),Er(this,"activeColumnHeaders",new Map),Er(this,"activeCornerHeaders",new Map),Er(this,"rowHighlights",new Map),Er(this,"columnHighlights",new Map),Er(this,"customSelections",[]),this.options=e,this.focus=Z9(e),this.fill=Q9(e)}isEnabledFor(e,n){let r=e;e===Gp&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return ao(ds,this,lo).call(this,this.layeredAreas,q9)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return ao(ds,this,lo).call(this,this.areas,K9)}getAreas(){return[...this.areas.values()]}createRowHeader(){return ao(ds,this,lo).call(this,this.rowHeaders,aH)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return ao(ds,this,lo).call(this,this.columnHeaders,aH)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return ao(ds,this,lo).call(this,this.activeRowHeaders,uS)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return ao(ds,this,lo).call(this,this.activeColumnHeaders,uS)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return ao(ds,this,lo).call(this,this.activeCornerHeaders,uS)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return ao(ds,this,lo).call(this,this.rowHighlights,e8)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return ao(ds,this,lo).call(this,this.columnHighlights,X9)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(J9({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),F(this.areas.values(),e=>void e.clear()),F(this.layeredAreas.values(),e=>void e.clear()),F(this.rowHeaders.values(),e=>void e.clear()),F(this.columnHeaders.values(),e=>void e.clear()),F(this.activeRowHeaders.values(),e=>void e.clear()),F(this.activeColumnHeaders.values(),e=>void e.clear()),F(this.activeCornerHeaders.values(),e=>void e.clear()),F(this.rowHighlights.values(),e=>void e.clear()),F(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function lo(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function lH(t,e,n){return(e=o8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o8(t){var e=a8(t,"string");return typeof e=="symbol"?e:e+""}function a8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l8{constructor(e){lH(this,"ranges",[]),lH(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function u8(t,e){eV(t,e),e.add(t)}function cS(t,e,n){eV(t,e),e.set(t,n)}function eV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nt(t,e){return t.get(Cn(t,e))}function kg(t,e,n){return t.set(Cn(t,e),n),n}function Cn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fg=new WeakMap,Ot=new WeakMap,qi=new WeakMap,Rn=new WeakSet;class LE{constructor(e,n){u8(this,Rn),cS(this,Fg,void 0),cS(this,Ot,void 0),cS(this,qi,{x:0,y:0}),kg(Fg,this,e),kg(Ot,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=nt(Ot,this).createCellCoords(e,n);let s=nt(Fg,this).current().highlight;const o=nt(Ot,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:u,height:c}=Cn(Rn,this,tV).call(this),{row:h,col:d}=Cn(Rn,this,cH).call(this,s),f=nt(Ot,this).fixedRowsBottom(),m=nt(Ot,this).minSpareRows(),y=nt(Ot,this).minSpareCols(),C=nt(Ot,this).autoWrapRow(),T=nt(Ot,this).autoWrapCol(),x=nt(Ot,this).createCellCoords(h+i.row,d+i.col);if(x.row>=c){const H=Lr(r&&m>0&&f===0),k=x.col+1,V=nt(Ot,this).createCellCoords(x.row-c,k>=u?k-u:k);this.runLocalHooks("beforeColumnWrap",H,Cn(Rn,this,Du).call(this,V),k>=u),H.value?this.runLocalHooks("insertRowRequire",nt(Ot,this).countRenderableRows()):T&&x.assign(V)}else if(x.row<0){const H=Lr(T),k=x.col-1,V=nt(Ot,this).createCellCoords(c+x.row,k<0?u+k:k);this.runLocalHooks("beforeColumnWrap",H,Cn(Rn,this,Du).call(this,V),k<0),T&&x.assign(V)}if(x.col>=u){const H=Lr(r&&y>0),k=x.row+1,V=nt(Ot,this).createCellCoords(k>=c?k-c:k,x.col-u);this.runLocalHooks("beforeRowWrap",H,Cn(Rn,this,Du).call(this,V),k>=c),H.value?this.runLocalHooks("insertColRequire",nt(Ot,this).countRenderableColumns()):C&&x.assign(V)}else if(x.col<0){const H=Lr(C),k=x.row-1,V=nt(Ot,this).createCellCoords(k<0?c+k:k,u+x.col);this.runLocalHooks("beforeRowWrap",H,Cn(Rn,this,Du).call(this,V),k<0),C&&x.assign(V)}const{rowDir:O,colDir:b}=Cn(Rn,this,uH).call(this,x);a=O,l=b,s=Cn(Rn,this,Du).call(this,x)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,n){const r=nt(Ot,this).createCellCoords(e,n),i=nt(Fg,this).current(),s=nt(Ot,this).visualToRenderableCoords(i.highlight),o=Cn(Rn,this,hS).call(this,i.to.row,i.from.row),a=Cn(Rn,this,dS).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:d}=Cn(Rn,this,cH).call(this,i.highlight),f=nt(Ot,this).createCellCoords(o+r.row,a+r.col),m=i.getTopStartCorner(),y=i.getTopEndCorner(),C=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const b=f.col-d;f.col=Cn(Rn,this,dS).call(this,m.col,y.col)+b}else if(r.col>0&&a<=d&&f.col>d){const b=Cn(Rn,this,dS).call(this,y.col,m.col),H=Math.max(f.col-b,1);f.col=b+H}if(r.row<0&&o>=h&&f.row<h){const b=f.row-h;f.row=Cn(Rn,this,hS).call(this,m.row,C.row)+b}else if(r.row>0&&o<=h&&f.row>h){const b=Cn(Rn,this,hS).call(this,C.row,m.row),H=Math.max(f.row-b,1);f.row=b+H}const{rowDir:T,colDir:x}=Cn(Rn,this,uH).call(this,f);u=T,c=x;const O=Cn(Rn,this,Du).call(this,f);r.row===0&&r.col!==0?l.col=O.col:r.row!==0&&r.col===0?l.row=O.row:(l.row=O.row,l.col=O.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;kg(qi,this,{x:n,y:r})}resetOffsetSize(){kg(qi,this,{x:0,y:0})}}function uH(t){const{width:e,height:n}=Cn(Rn,this,tV).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function tV(){return{width:nt(qi,this).x+nt(Ot,this).countRenderableColumns(),height:nt(qi,this).y+nt(Ot,this).countRenderableRows()}}function hS(t,e){const n=nt(Ot,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:nt(qi,this).y+n}function dS(t,e){const n=nt(Ot,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:nt(qi,this).x+n}function cH(t){const{row:e,col:n}=nt(Ot,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return nt(Ot,this).createCellCoords(nt(qi,this).y+e,nt(qi,this).x+n)}function Du(t){const e=t.clone();return e.col=t.col-nt(qi,this).x,e.row=t.row-nt(qi,this).y,nt(Ot,this).renderableToVisualCoords(e)}wt(LE,Wn);const EC=0,TC=1,nV=2,Ax=3,c8=[Ax,nV],h8=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],fS=Symbol("root"),hH=Symbol("child");function Yc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fS;if(e!==fS&&e!==hH)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===fS;let i=EC;if(n){const s=t[0];t.length===0?i=TC:r&&s instanceof Gf?i=Ax:r&&Array.isArray(s)?i=Yc(s,hH):t.length>=2&&t.length<=4&&!t.some((a,l)=>!h8[l].includes(typeof a))&&(i=nV)}return i}function Cf(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!c8.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===Ax;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],c=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ft(u)&&(u=a),Ft(c)&&(c=l),!r){const f=a,m=l,y=u,C=c;a=Math.min(f,y),l=Math.min(m,C),u=Math.max(f,y),c=Math.max(m,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function d8(t){const e=Yc(t.getSelected());if(e===EC||e===TC)return[];const n=Cf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;F(t.getSelected(),o=>{const{from:a,to:l}=n(o),u=Math.max(a.col,0),c=l.col-u+1;F(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((o,a)=>o-a);return mn(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function f8(t){const e=Yc(t.getSelected());if(e===EC||e===TC)return[];const n=Cf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;F(t.getSelected(),o=>{const{from:a,to:l}=n(o),u=Math.max(a.row,0),c=l.row-u+1;F(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((o,a)=>o-a);return mn(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function Lu(t,e,n){g8(t,e),e.set(t,n)}function g8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ll(t,e,n){return(e=m8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m8(t){var e=p8(t,"string");return typeof e=="symbol"?e:e+""}function p8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dt(t,e){return t.get(rV(t,e))}function fs(t,e,n){return t.set(rV(t,e),n),n}function rV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jn=new WeakMap,ul=new WeakMap,$g=new WeakMap,$h=new WeakMap,Vg=new WeakMap,Vh=new WeakMap;class iV{constructor(e,n){var r=this;ll(this,"settings",void 0),ll(this,"tableProps",void 0),ll(this,"inProgress",!1),ll(this,"selectedRange",new l8((i,s,o)=>this.tableProps.createCellRange(i,s,o))),ll(this,"highlight",void 0),Lu(this,jn,void 0),Lu(this,ul,void 0),ll(this,"selectedByRowHeader",new Set),ll(this,"selectedByColumnHeader",new Set),Lu(this,$g,!1),Lu(this,$h,!1),Lu(this,Vg,"unknown"),Lu(this,Vh,-1),this.settings=e,this.tableProps=n,this.highlight=new s8({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[wT()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),fs(jn,this,new LE(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),fs(ul,this,new LE(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Dt(jn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformStart",...s)}),Dt(jn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformStart",...s)}),Dt(jn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformEnd",...s)}),Dt(jn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformEnd",...s)}),Dt(jn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertRowRequire",...s)}),Dt(jn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertColRequire",...s)}),Dt(jn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeRowWrap",...s)}),Dt(jn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeColumnWrap",...s)}),Dt(ul,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformFocus",...s)}),Dt(ul,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){fs(Vg,this,e)}markEndSource(){fs(Vg,this,"unknown")}getSelectionSource(){return Dt(Vg,this)}setExpectedLayers(e){fs(Vh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,fs(Vh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=Ft(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();fs($g,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!s||s&&!o&&Ft(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!s||i===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),c=this.isMultiple();o.setTo(n),c&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),c&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Dt(Vh,this)===-1||this.selectedRange.size()===Dt(Vh,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(F(this.highlight.getAreas(),m=>void m.clear()),F(this.highlight.getLayeredAreas(),m=>void m.clear()),F(this.highlight.getRowHeaders(),m=>void m.clear()),F(this.highlight.getColumnHeaders(),m=>void m.clear()),F(this.highlight.getActiveRowHeaders(),m=>void m.clear()),F(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),F(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),F(this.highlight.getRowHighlights(),m=>void m.clear()),F(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(n);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(YT,e.highlight)&&(this.isMultiple()||n>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(zT,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),x=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),O=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(x).commit(),d.add(C).commit(),f.add(x).commit()):(a.add(C).add(T).commit(),l.add(x).add(O).commit(),d.add(C).add(T).commit(),f.add(x).add(O).commit())}const m=!Dt($h,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),y=!Dt($h,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),y&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&y&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Gp,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(fs($g,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Dt(jn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Dt(jn,this).resetOffsetSize(),this.setRangeStart(Dt(jn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?Dt(jn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Dt(jn,this).resetOffsetSize(),this.setRangeEnd(Dt(jn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:s}=r.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?Dt(ul,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):Dt(ul,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=Dt(ul,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Je(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Je(s.row+n,c,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Je(o.row+n,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Je(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(s.row,Je(s.col+n,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,Je(o.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Lr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Dt($g,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(s===0||o===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;fs($h,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Je(d.row,u,s-1),Je(d.col,c,o-1)));const m=this.tableProps.createCellCoords(u,c),y=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),fs($h,this,!1)}selectCells(e){var n=this;const r=Yc(e);if(r===TC)return!1;if(r===EC)throw new Error(pt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Cf(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(o);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),F(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof n=="string"?this.tableProps.propToCol(n):n,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Je(r.row,u,o-1),m=Je(r.col,Math.min(i,s),Math.max(i,s))):(f=Je(r,u,o-1),m=i);const y=this.tableProps.createCellCoords(f,m),C=l===0?0:Je(y.row,u,-1),T=o-1,x=this.tableProps.createCellCoords(C,i),O=this.tableProps.createCellCoords(T,s);this.runLocalHooks("beforeSelectColumns",x,O,y),x.row=C,O.row=T,this.setRangeStartOnly(x,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(O),this.runLocalHooks("afterSelectColumns",x,O,y),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,s-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Je(r.row,Math.min(e,n),Math.max(e,n)),d=Je(r.col,a,s-1)):(h=e,d=Je(r,a,s-1));const f=this.tableProps.createCellCoords(h,d),m=o===0?0:Je(f.col,a,-1),y=s-1,C=this.tableProps.createCellCoords(e,m),T=this.tableProps.createCellCoords(n,y);this.runLocalHooks("beforeSelectRows",C,T,f),C.col=m,T.col=y,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",C,T,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:s,highlight:o}=r;this.clear(),o.assign({row:Je(o.row,-1/0,e-1),col:Je(o.col,-1/0,n-1)}),i.assign({row:Je(i.row,-1/0,e-1),col:Je(i.col,-1/0,n-1)}),s.assign({row:Je(s.row,0,e-1),col:Je(s.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(o).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Gp,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}wt(iV,Wn);const dH=/^(\r\n|\n\r|\r|\n)/,w8=/^[^\t\r\n]+/,fH=/^\t/;function C8(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(fH))t=t.replace(fH,""),n+=1,e[r][n]="";else if(t.match(dH))t=t.replace(dH,""),n=0,r+=1,e[r]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(w8);s=o?o[0]:"",t=t.slice(s.length)}e[r][n]=s}return e}function $d(t){let e,n,r,i,s="",o;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(s+="	"),o=t[e][r],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==n-1&&(s+=`
`)}return s}function cl(t,e,n){return(e=y8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y8(t){var e=v8(t,"string");return typeof e=="symbol"?e:e+""}function v8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){cl(this,"hot",void 0),cl(this,"metaManager",void 0),cl(this,"tableMeta",void 0),cl(this,"dataSource",void 0),cl(this,"duckSchema",void 0),cl(this,"colToPropCache",void 0),cl(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,s=0,o=!1;if(typeof n=="function"){const a=fC(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=o?n(r):n[r];if(We(a)){if(typeof a.data<"u"){const l=o?s:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return r_(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,s=r,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&Be(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&we(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(we(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Uc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||o===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&s+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=sr(this.getSchema()):(m=[],Re(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},zf(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(o,n)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,m=c;i==="end"&&(m=Math.min(m+1,a));const y=m;for(;f<n&&d<o;){if(typeof l!="number"||l>=d)if(h>0)for(let T=0;T<h;T+=1)typeof s[T]>"u"&&(s[T]=[]),s[T].push(null);else s.push([null]);else for(let T=0;T<h;T++)s[T].splice(m,0,null);f+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(y,n));const C=this.hot.toVisualColumn(y);return this.hot.runHooks("afterCreateCol",C,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:y}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const s=this.visualRowsToPhysical(i,n),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,r)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const c=we(this.tableMeta.columns)||we(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,n),o=s.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,s,r)===!1)return!1;let l=!0;const u=o.length,c=this.dataSource;for(let h=0;h<u;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(s[0],n),h===0&&this.metaManager.removeColumn(s[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(o[f],1),h===0&&this.metaManager.removeColumn(o[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,s,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),s=i.slice(n,n+r),o=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];pE(l,o);let c=0;for(;c<r;)l.push(null),c+=1;return vF(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),s}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),s=i.slice(n,n+r),o=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];pE(l,o);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),s}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const s=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>r.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const s=this.hot.runHooks("modifyRowData",r);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&dn(i,n))a=i[n];else if(o&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Lr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let s=r,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=Lr(s);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&dn(o,n))o[n]=s;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=o,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++)typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]];u[d[c]]=s}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],s):o[n]=s}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let s=(r+e)%r,o=n,a;for(;s<r&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let s=(r+e)%r,o=n;for(;s<r&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,yc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===yc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(s=Math.min(e.row,n.row);s<=h;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,n.col);o<=d&&f!==null;o++)a.push(c.call(this,s,this.colToProp(o)));f!==null&&i.push(a)}return i}getText(e,n){return $d(this.getRange(e,n,yc.DESTINATION_RENDERER))}getCopyableText(e,n){return $d(this.getRange(e,n,yc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:b8,getItem:S8,hasItem:sV,getNames:R8,getValues:qme}=ss("cellTypes");function Hx(t){if(!sV(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return S8(t)}function oi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Pr(t,n),r&&Ur(t,r),i&&Yl(t,i),b8(t,e)}function E8(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!dn(e,t)}function _C(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Hx(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Be(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!We(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Be(r,(s,o)=>{if(E8(o,n)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),fn(t,i)}function T8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}is(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function lp(t){return Number.isInteger(t)&&t>=0}function up(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Wg(t){return t==null}const oV=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Qt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Qt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),dC(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function gH(t,e,n){return(e=_8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _8(t){var e=x8(t,"string");return typeof e=="symbol"?e:e+""}function x8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function M8(){return class{}}class I8{constructor(e){gH(this,"metaCtor",M8()),gH(this,"meta",void 0),this.meta=this.metaCtor.prototype,fn(this.meta,oV()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;fn(this.meta,e),_C(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function P8(t,e,n){return(e=O8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O8(t){var e=A8(t,"string");return typeof e=="symbol"?e:e+""}function A8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H8{constructor(e){P8(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){fn(this.meta,e),_C(this.meta,e,e)}}function Bg(t,e,n){return(e=N8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N8(t){var e=D8(t,"string");return typeof e=="symbol"?e:e+""}function D8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xp{constructor(e){Bg(this,"valueFactory",void 0),Bg(this,"data",[]),Bg(this,"index",[]),Bg(this,"holes",new Set),this.valueFactory=e}obtain(e){up(()=>lp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;up(()=>lp(e)||Wg(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let o=0;o<n;o++)r.push(i+o),this.data.push(void 0);const s=Wg(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...r,...this.index.slice(s)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;up(()=>lp(e)||Wg(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Wg(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const s=r[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return Bo(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function mH(t,e,n){return(e=L8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L8(t){var e=k8(t,"string");return typeof e=="symbol"?e:e+""}function k8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const F8=["data","width"];class $8{constructor(e){mH(this,"globalMeta",void 0),mH(this,"metas",new Xp(()=>this._createMeta())),this.globalMeta=e,this.metas=new Xp(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);fn(r,n),_C(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return T8(this.globalMeta.getMetaConstructor(),F8).prototype}}function pH(t,e,n){return(e=V8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V8(t){var e=W8(t,"string");return typeof e=="symbol"?e:e+""}function W8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B8{constructor(e){pH(this,"columnMeta",void 0),pH(this,"metas",new Xp(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);fn(i,r),_C(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var s;const o=this.metas.obtain(e).obtain(n);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(r),o[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)we(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){up(()=>lp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Xp(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class aV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new I8(e),this.tableMeta=new H8(this.globalMeta),this.columnMeta=new $8(this.globalMeta),this.cellMeta=new B8(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:s}=r;const o=this.cellMeta.getMeta(e,n);return o.visualRow=i,o.visualCol=s,o.row=e,o.col=n,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}wt(aV,Wn);function wH(t,e,n,r){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=ir(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Tt(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new yc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let y,C=0,T=0;for(C=0,T=d.startRows;C<T;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)y=sr(m),t.push(y);else if(i.dataType==="array")y=sr(m[0]),t.push(y);else{y=[];for(let x=0,O=d.startCols;x<O;x++)y.push(null);t.push(y)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Pe(i.rootElement,[MF(-1),oC(i.countCols()+(i.view?i.countRowHeaders():0))])}function CH(t,e,n){return(e=j8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j8(t){var e=U8(t,"string");return typeof e=="symbol"?e:e+""}function U8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z8{constructor(e){CH(this,"metaManager",void 0),CH(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),ge.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=dn(e,"type")?e.type:null;let c=Tt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Y8(t,e,n){G8(t,e),e.set(t,n)}function G8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gS(t,e,n){return(e=q8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q8(t){var e=K8(t,"string");return typeof e=="symbol"?e:e+""}function K8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X8(t,e){return t.get(Z8(t,e))}function Z8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yH=new WeakMap;class J8{constructor(e){gS(this,"metaManager",void 0),gS(this,"usageTracker",new Set),gS(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Y8(this,yH,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(n,l,s),o&&this.installPropWatcher(i,l,s)):r&&(this.installPropWatcher(n,l,X8(yH,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,s,o),this[n]=s},enumerable:!0,configurable:!0})}}const lV="gridDefault",Za="editorManager.handlingEditor",Q8={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},e7="hooksRefRegisterer",uV={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){F(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Be(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Js(uV,"MIXIN_NAME",e7,{writable:!1,enumerable:!1});function Pi(t,e,n){return(e=t7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t7(t){var e=n7(t,"string");return typeof e=="symbol"?e:e+""}function n7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const r7="base",on=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class uh{static get EDITOR_TYPE(){return r7}constructor(e){Pi(this,"hot",void 0),Pi(this,"state",on.VIRGIN),Pi(this,"_opened",!1),Pi(this,"_fullEditMode",!1),Pi(this,"_closeCallback",null),Pi(this,"TD",null),Pi(this,"row",null),Pi(this,"col",null),Pi(this,"prop",null),Pi(this,"originalValue",null),Pi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,s,o){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:on.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,s,o;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[r,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,s,o,"edit")}beginEditing(e,n){if(this.state!==on.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=on.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Jt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),r.view.scrollViewport(r._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,n,r){let i;if(r){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),r(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===on.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===on.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=on.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=on.FINISHED,this.discardEditor(o)}):(this.state=on.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=on.FINISHED,this.discardEditor()}discardEditor(e){this.state===on.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=on.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=on.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===on.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=xn(n),a=ln(n),l=xn(this.hot.rootElement),u=ln(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==s?c.scrollTop:0,f=h!==s?h.scrollLeft:0,m=s.innerWidth-l.left-u,{wtTable:y}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=y.name,T=["master","inline_start"].includes(C)?d:0,x=["master","top","bottom"].includes(C)?f:0,O=o.top===l.top?0:1;let b=o.top-l.top-O-T,H=0;this.hot.isRtl()?H=s.innerWidth-o.left-a-m-1+x:H=o.left-l.left-1-x,["top","top_inline_start_corner"].includes(C)&&(b+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(H+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const k=this.hot.hasColHeaders(),V=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),U=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Y=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(k&&V<=0||V===Y)&&(b+=1),U<=0&&(H+=1);const Q=i.rowsRenderCalculator.startPosition,ne=i.columnsRenderCalculator.startPosition,ce=Math.abs(r.inlineStartOverlay.getScrollPosition()),ae=r.topOverlay.getScrollPosition(),ye=Ln(this.hot.rootDocument);let Le=n.offsetTop;if(["inline_start","master"].includes(C)&&(Le+=Q-ae),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:X,wtTable:fe}=r.bottomOverlay.clone;Le+=X.getWorkspaceHeight()-fe.getHeight()-ye}let me=n.offsetLeft;this.hot.isRtl()?(me>=0?me=y.getWidth()-n.offsetLeft:me=Math.abs(me),me+=ne-ce-a):["top","master","bottom"].includes(C)&&(me+=ne-ce);const be=s.getComputedStyle(this.TD),st=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Ht=parseInt(be[st],10)>0?0:1,g=parseInt(be.borderTopWidth,10)>0?0:1,w=ln(n)+Ht,R=en(n)+g,P=BF(c)?ye:0,W=jF(h)?ye:0,z=this.hot.view.maximumVisibleElementWidth(me)-P+Ht,J=Math.max(this.hot.view.maximumVisibleElementHeight(Le)-W+g,this.hot.view.getDefaultRowHeight());return{top:b,start:H,height:R,maxHeight:J,width:w,maxWidth:z}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}wt(uh,uV);const i7={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===on.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},s7={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},o7={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},a7={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},l7={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:s}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),_i(e))}};function u7(){return[Q8,i7,s7,o7,a7,l7]}const c7={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},h7={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),s=e.row-t.getFirstFullyVisibleRow(),o=Math.min(i.row-s,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},d7={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},f7={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},g7={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e)}},m7={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast(),o=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},p7={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){const o=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(s.row,o))}}},w7={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},C7={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast(),o=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},y7={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast(),o=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},v7={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast(),o=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},b7={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e)}},S7={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},R7={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),s=e.row-t.getFirstFullyVisibleRow(),o=Math.max(i.row-s,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function E7(){return[c7,h7,d7,f7,g7,m7,p7,w7,C7,y7,v7,b7,S7,R7]}const T7={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},_7={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},x7={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=t.getSelectedRangeLast(),i=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},M7={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=t.getSelectedRangeLast(),i=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},I7={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},P7={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},O7={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},A7={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),o=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(s,o))}},H7={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},N7={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,s))}},D7={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},L7={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},k7={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},F7={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(s,1);e.setRangeStart(t._createCellCoords(o,a))}},$7={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},V7={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function W7(){return[T7,_7,x7,M7,I7,P7,O7,A7,H7,N7,D7,L7,k7,F7,$7,V7]}const B7={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},j7={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(n,r),a=t._createCellCoords(i,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},U7={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},z7={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},Y7={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(s.values()))}},G7=[...u7(),...E7(),...W7(),B7,j7,U7,z7,Y7];function cV(t){const e={};return G7.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(t,...o)}}),e}function q7(t){const e=t.getShortcutManager().addContext("editor"),n=cV(t),r={group:Za};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>n.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>n.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,s)=>n.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>n.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function K7(t){const e=t.getShortcutManager().addContext("grid"),n=cV(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return we(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:lV};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>n.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Za,runOnlyIf:()=>we(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function X7(t){[K7,q7].forEach(e=>e(t))}function Z7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=vH(t),i=vH(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function vH(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Pe(n,[Bs(),Ka()]),n}function J7(t){const e=Q7(t);let n;const{activate:r,deactivate:i}=Z7(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:kE(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:FE(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,m,y)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,y.value=!0),o){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{s.wrapped=!0,s.flipped=f});function u(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:lV,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,o=!0,!d||!t.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(n=h.shiftKey?kE(t):FE(t)),u(),!1;h.preventDefault()},position:"after"}])}function kE(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,s=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=n.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function FE(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let o=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function Q7(t){return e=>{if(!e)return null;const n=kE(t),r=FE(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function eZ(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}function tZ(){return()=>{}}function nZ(t){return e=>{t.scrollViewportTo(e.toObject())}}function rZ(t){return e=>{t.scrollViewportTo(e.toObject())}}function iZ(t){return e=>{t.scrollViewportTo(e.toObject())}}function sZ(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}function oZ(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e;if(r<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&r>=0)t.scrollViewportTo({row:r});else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i})}}}function aZ(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var s;if(n||r){n=!1;return}let o;e.isFocusSelectionChanged()?o=nZ(t):e.isSelectedByCorner()?o=tZ():e.isSelectedByRowHeader()?o=sZ(t):e.isSelectedByColumnHeader()?o=eZ(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=rZ(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=oZ(t):e.getSelectedRange().size()>1&&(o=iZ(t)),(s=o)===null||s===void 0||s(i)}}}const bH=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),jg=t=>t.map(e=>{const n=e.toLowerCase();return bH.has(n)?bH.get(n):n}).sort().join("+"),lZ=t=>t.split("+"),SH=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),mS=t=>{let{which:e,key:n}=t;if(SH.has(e))return SH.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},hV=Symbol("shortcut-context");function dV(t){return We(t)&&t.__kindOf===hV}const uZ=t=>{const e=pC({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:y,position:C,forwardToContext:T}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ft(c))throw new Error("You need to define the shortcut's group.");if(Tt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(pt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const x={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};we(y)&&(x.relativeToGroup=y,x.position=C),dV(T)&&(x.forwardToContext=T),l.forEach(O=>{const b=jg(O);if(e.hasItem(b)){const k=e.getItem(b);let V=k.findIndex(U=>U.group===y);V!==-1?C==="before"?V-=1:V+=1:V=k.length,k.splice(V,0,x)}else e.addItem(b,[x])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Be(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=jg(l);e.removeItem(u)};return{__kindOf:hV,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=jg(l),c=e.getItem(u);return we(c)?c.slice():[]},hasShortcut:l=>{const u=jg(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(m=>m.group!==l);f.length===0?i(lZ(h)):(d.length=0,d.push(...f))})}}};function cZ(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const hZ=["meta","alt","shift","control"],Wh=cZ(),Bh=[];let Ug=0;function dZ(t,e,n,r,i){const s=f=>hZ.includes(f),o=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return f.altKey&&y.push("alt"),m&&(f.ctrlKey||f.metaKey)?y.push("control/meta"):(f.ctrlKey&&y.push("control"),f.metaKey&&y.push("meta")),f.shiftKey&&y.push("shift"),y},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Sa(f))return;const y=mS(f);let C=[];s(y)||(C=o(f));const T=[y].concat(C);!i(f,T)&&(Wp()&&C.includes("meta")||!Wp()&&C.includes("control"))&&i(f,[y].concat(o(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const m=mS(f);s(m)&&Wh.press(m)}},u=f=>{if(typeof f.key=="string"){const m=mS(f);s(m)&&Wh.release(m)}},c=()=>{Wh.releaseAll()};return{mount:()=>{let f=t;for(Ug+=1;f;)Ug===1&&(f.document.documentElement.addEventListener("keydown",l),Bh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Bh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=su(f)},unmount:()=>{let f=t;for(Ug-=1;f;){if(Ug===0){for(let m=0;m<Bh.length;m++){const{event:y,listener:C}=Bh[m];f.document.documentElement.removeEventListener(y,C)}Bh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=su(f)}},isPressed:f=>Wh.isPressed(f),releasePressedKeys:()=>Wh.releaseAll()}}const fZ=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const s=pC({errorIdExists:m=>`The "${m}" context name is already registered.`});let o="grid";const a=m=>{const y=uZ(m);return s.addItem(m,y),y},l=()=>o,u=m=>s.getItem(m),c=m=>{if(!s.hasItem(m))throw new Error(pt`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=m};let h=!1;const d=function(m,y){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const T=dV(C)?C:u(C);let x=!1;if(!T.hasShortcut(y))return x;const O=T.getShortcuts(y);for(let b=0;b<O.length;b++){const{callback:H,runOnlyIf:k,preventDefault:V,stopPropagation:U,captureCtrl:Z,forwardToContext:Y}=O[b];if(k(m)===!0){if(h=Z,x=H(m,y)===!1,h=!1,V&&m.preventDefault(),U&&(_i(m),m.stopPropagation()),x)break;Y&&d(m,y,Y)}}return x},f=dZ(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function RH(t){const{classNames:e}=NF(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let pS=null;const wS=new Map;function fV(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new bi(s);let a,l,u,c,h,d,f=!0;UX(i)&&jX(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",y=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=U9(e.language);const C=new aV(s,e,[z8,J8]),T=C.getTableMeta(),x=C.getGlobalMeta(),O=pC();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),ap(this)&&(EF(e.licenseKey,t),K(t,"ht-wrapper")),this.guid=`ht_${fT()}`,wS.set(this.guid,this),this.columnIndexMapper=new NE,this.rowIndexMapper=new NE,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),l=new o9(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const b=g=>{const{row:w,col:R}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getRenderableFromVisualIndex(w):w,R>=0?s.columnIndexMapper.getRenderableFromVisualIndex(R):R)},H=g=>{const{row:w,col:R}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getVisualFromRenderableIndex(w):w,R>=0?s.columnIndexMapper.getVisualFromRenderableIndex(R):R)},k=(g,w)=>{const R=w>g?1:-1,P=Math.min(g,w),W=Math.max(g,w),z=s.rowIndexMapper.getNearestNotHiddenIndex(g,R);return z===null||R===1&&z>W||R===-1&&z<P?null:z>=0?s.rowIndexMapper.getRenderableFromVisualIndex(z):z},V=(g,w)=>{const R=w>g?1:-1,P=Math.min(g,w),W=Math.max(g,w),z=s.columnIndexMapper.getNearestNotHiddenIndex(g,R);return z===null||R===1&&z>W||R===-1&&z<P?null:z>=0?s.columnIndexMapper.getRenderableFromVisualIndex(z):z};let U=new iV(T,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>a.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,w)=>s._createCellCoords(g,w),createCellRange:(g,w,R)=>s._createCellRange(g,w,R),visualToRenderableCoords:b,renderableToVisualCoords:H,findFirstNonHiddenRenderableRow:k,findFirstNonHiddenRenderableColumn:V,isDisabledCellSelection:(g,w)=>g<0||w<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,w).disableVisualSelection});this.selection=U;const Z=g=>{let{hiddenIndexesChanged:w}=g;w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Z),this.rowIndexMapper.addLocalHook("cacheUpdated",Z),this.selection.addLocalHook("afterSetRangeEnd",(g,w)=>{const R=Lr(!1),P=this.selection.getSelectedRange(),{from:W,to:z}=P.current(),J=P.size()-1;this.runHooks("afterSelection",W.row,W.col,z.row,z.col,R,J),this.runHooks("afterSelectionByProp",W.row,s.colToProp(W.col),z.row,s.colToProp(z.col),R,J),w&&(!R.isTouched()||R.isTouched()&&!R.value)&&d.scrollTo(g);const X=U.isSelectedByRowHeader(),fe=U.isSelectedByColumnHeader();X&&fe?K(this.rootElement,["ht__selection--rows","ht__selection--columns"]):X?(_e(this.rootElement,"ht__selection--columns"),K(this.rootElement,"ht__selection--rows")):fe?(_e(this.rootElement,"ht__selection--rows"),K(this.rootElement,"ht__selection--columns")):_e(this.rootElement,["ht__selection--rows","ht__selection--columns"]),U.getSelectionSource()!=="shift"&&c.closeEditor(null),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const w=Lr(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(g),c.closeEditor(),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const w=g.length-1,{from:R,to:P}=g[w];this.runHooks("afterSelectionEnd",R.row,R.col,P.row,P.col,w),this.runHooks("afterSelectionEndByProp",R.row,s.colToProp(R.col),P.row,s.colToProp(P.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const w=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),s.view.render(),_e(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,w=new Array(g),R=0;R<g;R++)w[R]=arguments[R];return r.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),u={alter(g,w){var R,P;let W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,z=arguments.length>3?arguments[3]:void 0,J=arguments.length>4?arguments[4]:void 0;const X=fe=>{if(fe.length===0)return[];const S=[...fe];return S.sort((p,v)=>{let[E]=p,[I]=v;return E===I?0:E>I?1:-1}),mn(S,(p,v)=>{let[E,I]=v;const N=p[p.length-1],[M,A]=N,L=M+A;if(E<=L){const D=Math.max(I-(L-E),0);N[1]+=D}else p.push([E,I]);return p},[S[0]])};switch(g){case"insert_row_below":case"insert_row_above":const fe=s.countSourceRows();if(T.maxRows===fe)return;const S=g==="insert_row_below"?"below":"above";w=(R=w)!==null&&R!==void 0?R:S==="below"?fe:0;const{delta:_,startPhysicalIndex:p}=a.createRow(w,W,{source:z,mode:S});U.shiftRows(s.toVisualRow(p),_);break;case"insert_col_start":case"insert_col_end":const v=g==="insert_col_end"?"end":"start";w=(P=w)!==null&&P!==void 0?P:v==="end"?s.countSourceCols():0;const{delta:E,startPhysicalIndex:I}=a.createCol(w,W,{source:z,mode:v});if(E){if(Array.isArray(T.colHeaders)){const A=[s.toVisualColumn(I),0];A.length+=E,Array.prototype.splice.apply(T.colHeaders,A)}U.shiftColumns(s.toVisualColumn(I),E)}break;case"remove_row":const N=A=>{let L=0;F(A,D=>{let[$,q]=D;const G=Qt($)?s.countRows()-1:Math.max($-L,0);if(Number.isInteger($)&&($=Math.max($-L,0)),!a.removeRow($,q,z))return;if(U.isSelected()){const{row:de}=s.getSelectedRangeLast().highlight;de>=$&&de<=$+q-1&&c.closeEditor(!0)}const oe=s.countRows();oe===0?U.deselect():z==="ContextMenu.removeRow"?U.refresh():U.shiftRows($,-q);const pe=T.fixedRowsTop;pe>=G+1&&(T.fixedRowsTop-=Math.min(q,pe-G));const le=T.fixedRowsBottom;le&&G>=oe-le&&(T.fixedRowsBottom-=Math.min(q,le)),L+=q})};Array.isArray(w)?N(X(w)):N([[w,W]]);break;case"remove_col":const M=A=>{let L=0;F(A,D=>{let[$,q]=D;const G=Qt($)?s.countCols()-1:Math.max($-L,0);let te=s.toPhysicalColumn(G);if(Number.isInteger($)&&($=Math.max($-L,0)),!a.removeCol($,q,z))return;if(U.isSelected()){const{col:de}=s.getSelectedRangeLast().highlight;de>=$&&de<=$+q-1&&c.closeEditor(!0)}s.countCols()===0?U.deselect():z==="ContextMenu.removeColumn"?U.refresh():U.shiftColumns($,-q);const le=T.fixedColumnsStart;le>=G+1&&(T.fixedColumnsStart-=Math.min(q,le-G)),Array.isArray(T.colHeaders)&&(typeof te>"u"&&(te=-1),T.colHeaders.splice(te,q)),L+=q})};Array.isArray(w)?M(X(w)):M([[w,W]]);break;default:throw new Error(`There is no such action "${g}"`)}s.view.render(),J||u.adjustRowsAndCols()},adjustRowsAndCols(){const g=T.minRows,w=T.minSpareRows,R=T.minCols,P=T.minSpareCols;if(g){const W=s.countRows();W<g&&a.createRow(W,g-W,{source:"auto"})}if(w){const W=s.countEmptyRows(!0);if(W<w){const z=w-W,J=Math.min(z,T.maxRows-s.countSourceRows());a.createRow(s.countRows(),J,{source:"auto"})}}{let W;(R||P)&&(W=s.countEmptyCols(!0));let z=s.countCols();if(R&&!T.columns&&z<R){const J=R-z;W+=J,a.createCol(z,J,{source:"auto"})}if(P&&!T.columns&&s.dataType==="array"&&W<P){z=s.countCols();const J=P-W,X=Math.min(J,T.maxCols-z);a.createCol(z,X,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(g,w,R,P,W){let z,J,X,fe;const S=[],_={},p=[],v=g.row,E=g.col;if(J=w.length,J===0)return!1;let I=0,N=0;switch(We(R)&&(I=R.col-E+1,N=R.row-v+1),W){case"shift_down":const M=Nd(w),A=M.length,L=Math.max(A,I),D=s.getData().slice(v),$=Nd(D).slice(E,E+L);for(X=0;X<L;X+=1)if(X<A){for(z=0,J=M[X].length;z<N-J;z+=1)M[X].push(M[X][z%J]);X<$.length?p.push(M[X].concat($[X])):p.push(M[X].concat(new Array(D.length).fill(null)))}else p.push(M[X%A].concat($[X]));s.populateFromArray(v,E,Nd(p));break;case"shift_right":const q=w.length,G=Math.max(q,N),te=s.getData().slice(v).map(Ct=>Ct.slice(E));for(z=0;z<G;z+=1)if(z<q){for(X=0,fe=w[z].length;X<I-fe;X+=1)w[z].push(w[z][X%fe]);if(z<te.length)for(let Ct=0;Ct<te[z].length;Ct+=1)w[z].push(te[z][Ct]);else w[z].push(...new Array(te[0].length).fill(null))}else w.push(w[z%J].slice(0,G).concat(te[z]));s.populateFromArray(v,E,w);break;case"overwrite":default:_.row=g.row,_.col=g.col;let oe=0,pe=0,le=!0,de;const Ze=function(Pt){let Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const ze=w[Pt%w.length];return Nt!==null?ze[Nt%ze.length]:ze},It=w.length,cn=R?R.row-g.row+1:0;for(R?J=cn:J=Math.max(It,cn),z=0;z<J&&!(R&&_.row>R.row&&cn>It||!T.allowInsertRow&&_.row>s.countRows()-1||_.row>=T.maxRows);z++){const Ct=z-oe,Pt=Ze(Ct).length,Nt=R?R.col-g.col+1:0;if(R?fe=Nt:fe=Math.max(Pt,Nt),_.col=g.col,de=s.getCellMeta(_.row,_.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&de.skipRowOnPaste){oe+=1,_.row+=1,J+=1;continue}for(pe=0,X=0;X<fe&&!(R&&_.col>R.col&&Nt>Pt||!T.allowInsertColumn&&_.col>s.countCols()-1||_.col>=T.maxCols);X++){if(de=s.getCellMeta(_.row,_.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&de.skipColumnOnPaste){pe+=1,_.col+=1,fe+=1;continue}if(de.readOnly&&P!=="UndoRedo.undo"){_.col+=1;continue}const ze=X-pe;let Fe=Ze(Ct,ze),je=s.getDataAtCell(_.row,_.col);if(Fe!==null&&typeof Fe=="object")if(Array.isArray(Fe)&&je===null&&(je=[]),je===null||typeof je!="object")le=!1;else{const lg=Uc(Array.isArray(je)?je:je[0]||je),Ja=Uc(Array.isArray(Fe)?Fe:Fe[0]||Fe);dC(lg,Ja)||Array.isArray(lg)&&Array.isArray(Ja)?Fe=sr(Fe):le=!1}else je!==null&&typeof je=="object"&&(le=!1);le&&S.push([_.row,_.col,Fe]),le=!0,_.col+=1}_.row+=1}s.setDataAtCell(S,null,null,P||"populateFromArray");break}}};function Y(g){const w=Y$(g);Ox(w)?(s.runHooks("beforeLanguageChange",w),x.language=w,s.runHooks("afterLanguageChange",w)):G$(g)}function Q(g,w){const R=g==="className"?s.rootElement:s.table;if(f)K(R,w);else{let P=[],W=[];x[g]&&(P=Array.isArray(x[g])?x[g]:CE(x[g])),w&&(W=Array.isArray(w)?w:CE(w));const z=wE(P,W),J=wE(W,P);z.length&&_e(R,z),J.length&&K(R,J)}x[g]=w}this.init=function(){l.setData(T.data),s.runHooks("beforeInit"),(Ho()||OT())&&K(s.rootElement,"mobile"),this.updateSettings(T,!0),this.view=new qX(this);const g=T.themeName||RH(s.rootElement);s.useTheme(g),s.view.addClassNameToLicenseElement(s.getCurrentThemeName()),c=TE.getInstance(s,T,U),d=aZ(s),h=new E6(s),ap(this)&&J7(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&UF(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function ne(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function ce(g){const w=g.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):g}function ae(g,w,R){if(!g.length){R();return}const P=s.getActiveEditor(),W=new ne;let z=!0;W.onQueueEmpty=()=>{P&&z&&P.cancelChanges(),R()};for(let J=g.length-1;J>=0;J--){const[X,fe,,S]=g[J],_=a.propToCol(fe);let p;Number.isInteger(_)?p=s.getCellMeta(X,_):p={...Object.getPrototypeOf(T),...T},p.type==="numeric"&&typeof S=="string"&&f$(S)&&(g[J][3]=ce(S)),s.getCellValidator(p)&&(W.addValidatorToQueue(),s.validateCell(g[J][3],p,function(v,E){return function(I){if(typeof I!="boolean")throw new Error("Validation error: result is not boolean");I===!1&&E.allowInvalid===!1&&(z=!1,g.splice(v,1),E.valid=!0),W.removeValidatorFormQueue()}}(J,p),w))}W.checkIfQueueIsEmpty()}function ye(g,w){for(let P=g.length-1;P>=0;P--){let W=!1;if(g[P]===null){g.splice(P,1);continue}if(!((g[P][2]===null||g[P][2]===void 0)&&(g[P][3]===null||g[P][3]===void 0))){if(T.allowInsertRow)for(;g[P][0]>s.countRows()-1;){const{delta:z}=a.createRow(void 0,void 0,{source:w});if(z===0){W=!0;break}}if(s.dataType==="array"&&(!T.columns||T.columns.length===0)&&T.allowInsertColumn)for(;a.propToCol(g[P][1])>s.countCols()-1;){const{delta:z}=a.createCol(void 0,void 0,{source:w});if(z===0){W=!0;break}}W||a.set(g[P][0],g[P][1],g[P][3])}}const R=g.length>0;if(s.forceFullRender=!0,R){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,w),c.closeEditor(),s.view.render(),c.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",g,w||"edit");const P=s.getActiveEditor();P&&we(P.refreshValue)&&P.refreshValue()}else s.view.render()}this._createCellCoords=function(g,w){return s.view._wt.createCellCoords(g,w)},this._createCellRange=function(g,w,R){return s.view._wt.createCellRange(g,w,R)},this.validateCell=function(g,w,R,P){let W=s.getCellValidator(w);function z(J){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){R(J);return}const fe=w.visualCol,S=w.visualRow,_=s.getCell(S,fe,!0);if(_&&_.nodeName!=="TH"){const p=s.rowIndexMapper.getRenderableFromVisualIndex(S),v=s.columnIndexMapper.getRenderableFromVisualIndex(fe);s.view._wt.getSetting("cellRenderer",p,v,_)}R(J)}RF(W)&&(W=function(J){return function(X,fe){fe(J.test(X))}}(W)),Tt(W)?(g=s.runHooks("beforeValidate",g,w.visualRow,w.prop,P),s._registerImmediate(()=>{W.call(w,g,J=>{s&&(J=s.runHooks("afterValidate",J,g,w.visualRow,w.prop,P),w.valid=J,z(J),s.runHooks("postAfterValidate",J,g,w.visualRow,w.prop,P))})})):s._registerImmediate(()=>{w.valid=!0,z(w.valid,!1)})};function Le(g,w,R){return Array.isArray(g)?g:[[g,w,R]]}function me(g,w){const R=s.getActiveEditor(),P=s.runHooks("beforeChange",g,w||"edit"),W=g.filter(z=>z!==null);return P===!1||W.length===0?(R&&R.cancelChanges(),[]):W}this.setDataAtCell=function(g,w,R,P){const W=Le(g,w,R),z=[];let J=P,X,fe,S;for(X=0,fe=W.length;X<fe;X++){if(typeof W[X]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof W[X][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");W[X][1]>=this.countCols()?S=W[X][1]:S=a.colToProp(W[X][1]),z.push([W[X][0],S,l.getAtCell(this.toPhysicalRow(W[X][0]),W[X][1]),W[X][2]])}!J&&typeof g=="object"&&(J=w);const _=me(z,J);s.runHooks("afterSetDataAtCell",_,J),ae(_,J,()=>{ye(_,J)})},this.setDataAtRowProp=function(g,w,R,P){const W=Le(g,w,R),z=[];let J=P,X,fe;for(X=0,fe=W.length;X<fe;X++)z.push([W[X][0],W[X][1],l.getAtCell(this.toPhysicalRow(W[X][0]),W[X][1]),W[X][2]]);!J&&typeof g=="object"&&(J=w);const S=me(z,P);s.runHooks("afterSetDataAtRowProp",S,J),ae(S,J,()=>{ye(S,J)})},this.listen=function(){s&&!s.isListening()&&(wS.forEach(g=>{s!==g&&g.unlisten()}),pS=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(pS=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return pS===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(g),s.view.render(),w&&U.isSelected()&&c.prepareEditor()},this.populateFromArray=function(g,w,R,P,W,z,J){if(!(typeof R=="object"&&typeof R[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const X=typeof P=="number"?s._createCellCoords(P,W):null;return u.populateFromArray(s._createCellCoords(g,w),R,X,z,J)},this.spliceCol=function(g,w,R){for(var P=arguments.length,W=new Array(P>3?P-3:0),z=3;z<P;z++)W[z-3]=arguments[z];return a.spliceCol(g,w,R,...W)},this.spliceRow=function(g,w,R){for(var P=arguments.length,W=new Array(P>3?P-3:0),z=3;z<P;z++)W[z-3]=arguments[z];return a.spliceRow(g,w,R,...W)},this.getSelected=function(){if(U.isSelected())return qe(U.getSelectedRange(),g=>{let{from:w,to:R}=g;return[w.row,w.col,R.row,R.col]})},this.getSelectedLast=function(){const g=this.getSelected();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.emptySelectedCells=function(g){if(!U.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];F(U.getSelectedRange(),R=>{if(R.isSingleHeader())return;const P=R.getTopStartCorner(),W=R.getBottomEndCorner();Re(P.row,W.row,z=>{Re(P.col,W.col,J=>{this.getCellMeta(z,J).readOnly||w.push([z,J,null])})})}),w.length>0&&this.setDataAtCell(w,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(g){this.suspendRender();const w=g();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const R=g();return this.resumeExecution(w),R},this.batch=function(g){this.suspendRender(),this.suspendExecution();const w=g();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!s.view)return;const{width:g,height:w}=s.view.getLastSize(),{width:R,height:P}=s.rootElement.getBoundingClientRect(),W=R!==g||P!==w;s.runHooks("beforeRefreshDimensions",{width:g,height:w},{width:R,height:P},W)!==!1&&((W||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(R,P),s.render()),s.runHooks("afterRefreshDimensions",{width:g,height:w},{width:R,height:P},W))},this.updateData=function(g,w){wH(g,R=>{a=R},R=>{a=R,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),U.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:w,metaManager:C,firstRun:f})},this.loadData=function(g,w){wH(g,R=>{a=R},()=>{C.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),U.refresh(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:w,metaManager:C,firstRun:f})},this.getInitialColumnCount=function(){const g=T.columns;let w=0;if(Array.isArray(g))w=g.length;else if(Tt(g))if(s.dataType==="array"){const R=this.countSourceCols();for(let P=0;P<R;P+=1)g(P)&&(w+=1)}else(s.dataType==="object"||s.dataType==="function")&&(w=a.colToPropCache.length);else if(we(T.dataSchema)){const R=a.getSchema();w=Array.isArray(R)?R.length:fC(R)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,w,R,P){return Ft(g)?a.getAll():a.getRange(s._createCellCoords(g,w),s._createCellCoords(R,P),a.DESTINATION_RENDERER)},this.getCopyableText=function(g,w,R,P){return a.getCopyableText(s._createCellCoords(g,w),s._createCellCoords(R,P))},this.getCopyableData=function(g,w){return a.getCopyable(g,a.colToProp(w))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const R=(f?s.loadData:s.updateData).bind(this);let P=!1,W,z;if(we(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(we(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(we(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(W in g)W==="data"||(W==="language"?Y(g.language):W==="className"?Q("className",g.className):W==="tableClassName"&&s.table?(Q("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(W)||ge.getSingleton().isDeprecated(W)?Tt(g[W])?ge.getSingleton().addAsFixed(W,g[W],s):Array.isArray(g[W])&&ge.getSingleton().add(W,g[W],s):!w&&dn(g,W)&&(x[W]=g[W]));g.data===void 0&&T.data===void 0?R(null,"updateSettings"):g.data!==void 0?R(g.data,"updateSettings"):g.columns!==void 0&&(a.createMap(),s.initIndexMappers());const J=s.countCols(),X=T.columns;if(X&&Tt(X)&&(P=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&C.clearCache(),J>0)for(W=0,z=0;W<J;W++){if(X){const _=P?X(W):X[z];_&&C.updateColumnMeta(z,_)}z+=1}we(g.cell)&&Be(g.cell,_=>{s.setCellMetaObject(_.row,_.col,_)}),s.runHooks("afterCellMetaReset");let fe=s.rootElement.style.height;fe!==""&&(fe=parseInt(s.rootElement.style.height,10));let S=g.height;if(Tt(S)&&(S=S()),w&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),S===null){const _=s.rootElement.getAttribute("data-initialstyle");_&&(_.indexOf("height")>-1||_.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",_):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else S!==void 0&&(s.rootElement.style.height=isNaN(S)?`${S}`:`${S}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let _=g.width;Tt(_)&&(_=_()),s.rootElement.style.width=isNaN(_)?`${_}`:`${_}px`}if(!w){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const _=s.getCurrentThemeName(),p=dn(g,"themeName");_&&p&&(s.view.getStylesHandler().removeClassNames(),s.view.removeClassNameFromLicenseElement(_));const v=p&&g.themeName||RH(s.rootElement);s.useTheme(v),s.view.addClassNameToLicenseElement(s.getCurrentThemeName())}s.runHooks("afterUpdateSettings",g)}u.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!w&&s.view&&(fe===""||S===""||S===void 0)&&fe!==S&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedLast();if(T.getValue){if(Tt(T.getValue))return T.getValue.call(s);if(g)return s.getData()[g[0][0]][T.getValue]}else if(g)return s.getDataAtCell(g[0],g[1])},this.getSettings=function(){return T},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,w,R,P,W){u.alter(g,w,R,P,W)},this.getCell=function(g,w){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=w,W=g;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;P=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;W=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return W===null||P===null||W===void 0||P===void 0?null:s.view.getCellAtCoords(s._createCellCoords(W,P),R)},this.getCoords=function(g){const w=this.view._wt.wtTable.getCoords(g);if(w===null)return null;const{row:R,col:P}=w;let W=R,z=P;return R>=0&&(W=this.rowIndexMapper.getVisualFromRenderableIndex(R)),P>=0&&(z=this.columnIndexMapper.getVisualFromRenderableIndex(P)),s._createCellCoords(W,z)},this.colToProp=function(g){return a.colToProp(g)},this.propToCol=function(g){return a.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,w){return a.get(g,a.colToProp(w))},this.getDataAtRowProp=function(g,w){return a.get(g,w)},this.getDataAtCol=function(g){const w=[],R=a.getRange(s._createCellCoords(0,g),s._createCellCoords(T.data.length-1,g),a.DESTINATION_RENDERER);for(let P=0;P<R.length;P+=1)for(let W=0;W<R[P].length;W+=1)w.push(R[P][W]);return w},this.getDataAtProp=function(g){const w=[],R=a.getRange(s._createCellCoords(0,a.propToCol(g)),s._createCellCoords(T.data.length-1,a.propToCol(g)),a.DESTINATION_RENDERER);for(let P=0;P<R.length;P+=1)for(let W=0;W<R[P].length;W+=1)w.push(R[P][W]);return w},this.getSourceData=function(g,w,R,P){let W;return g===void 0?W=l.getData():W=l.getByRange(s._createCellCoords(g,w),s._createCellCoords(R,P)),W},this.getSourceDataArray=function(g,w,R,P){let W;return g===void 0?W=l.getData(!0):W=l.getByRange(s._createCellCoords(g,w),s._createCellCoords(R,P),!0),W},this.getSourceDataAtCol=function(g){return l.getAtColumn(g)},this.setSourceDataAtCell=function(g,w,R,P){const W=Le(g,w,R),z=this.hasHook("afterSetSourceDataAtCell"),J=[];z&&F(W,fe=>{let[S,_,p]=fe;J.push([S,_,l.getAtCell(S,_),p])}),F(W,fe=>{let[S,_,p]=fe;l.setAtCell(S,_,p)}),z&&this.runHooks("afterSetSourceDataAtCell",J,P),this.render();const X=s.getActiveEditor();X&&we(X.refreshValue)&&X.refreshValue()},this.getSourceDataAtRow=function(g){return l.getAtRow(g)},this.getSourceDataAtCell=function(g,w){return l.getAtCell(g,w)},this.getDataAtRow=function(g){return a.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,w,R,P){const W=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,w,R,P],[z,J]=W;let[,,X,fe]=W,S=null,_=null;X===void 0&&(X=z),fe===void 0&&(fe=J);let p="mixed";return Re(Math.max(Math.min(z,X),0),Math.max(z,X),v=>{let E=!0;return Re(Math.max(Math.min(J,fe),0),Math.max(J,fe),I=>(_=this.getCellMeta(v,I).type,S?E=S===_:S=_,E)),p=E?_:"mixed",E}),p},this.removeCellMeta=function(g,w,R){const[P,W]=[this.toPhysicalRow(g),this.toPhysicalColumn(w)];let z=C.getCellMetaKeyValue(P,W,R);s.runHooks("beforeRemoveCellMeta",g,w,R,z)!==!1&&(C.removeCellMeta(P,W,R),s.runHooks("afterRemoveCellMeta",g,w,R,z)),z=null},this.spliceCellsMeta=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var R=arguments.length,P=new Array(R>2?R-2:0),W=2;W<R;W++)P[W-2]=arguments[W];if(P.length>0&&!Array.isArray(P[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&C.removeRow(this.toPhysicalRow(g),w),P.length>0&&F(P.reverse(),z=>{C.createRow(this.toPhysicalRow(g)),F(z,(J,X)=>this.setCellMetaObject(g,X,J))}),s.render()},this.setCellMetaObject=function(g,w,R){typeof R=="object"&&Be(R,(P,W)=>{this.setCellMeta(g,w,W,P)})},this.setCellMeta=function(g,w,R,P){if(s.runHooks("beforeSetCellMeta",g,w,R,P)===!1)return;let z=g,J=w;g<this.countRows()&&(z=this.toPhysicalRow(g)),w<this.countCols()&&(J=this.toPhysicalColumn(w)),C.setCellMeta(z,J,R,P),s.runHooks("afterSetCellMeta",g,w,R,P)},this.getCellsMeta=function(){return C.getCellsMeta()},this.getCellMeta=function(g,w){let R=this.toPhysicalRow(g),P=this.toPhysicalColumn(w);return R===null&&(R=g),P===null&&(P=w),C.getCellMeta(R,P,{visualRow:g,visualColumn:w})},this.getColumnMeta=function(g){return C.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return C.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||T.columns)},this.getCellRenderer=function(g,w){const R=typeof g=="number"?s.getCellMeta(g,w).renderer:g.renderer;return typeof R=="string"?Up(R):Ft(R)?Up("text"):R},this.getCellEditor=function(g,w){const R=typeof g=="number"?s.getCellMeta(g,w).editor:g.editor;return typeof R=="string"?jp(R):Ft(R)?jp("text"):R},this.getCellValidator=function(g,w){const R=typeof g=="number"?s.getCellMeta(g,w).validator:g.validator;return typeof R=="string"?FT(R):R},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,w){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,g)},this.validateColumns=function(g,w){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,g)},this._validateCells=function(g,w,R){const P=new ne;g&&(P.onQueueEmpty=g);let W=s.countRows()-1;for(;W>=0;){if(w!==void 0&&w.indexOf(W)===-1){W-=1;continue}let z=s.countCols()-1;for(;z>=0;){if(R!==void 0&&R.indexOf(z)===-1){z-=1;continue}P.addValidatorToQueue(),s.validateCell(s.getDataAtCell(W,z),s.getCellMeta(W,z),J=>{if(typeof J!="boolean")throw new Error("Validation error: result is not boolean");J===!1&&(P.valid=!1),P.removeValidatorFormQueue()},"validateCells"),z-=1}W-=1}P.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let w=T.rowHeaders,R=g;return R!==void 0&&(R=s.runHooks("modifyRowHeader",R)),R===void 0?(w=[],Re(s.countRows()-1,P=>{w.push(s.getRowHeader(P))})):Array.isArray(w)&&w[R]!==void 0?w=w[R]:Tt(w)?w=w(R):w&&typeof w!="string"&&typeof w!="number"&&(w=R+1),w},this.hasRowHeaders=function(){return!!T.rowHeaders},this.hasColHeaders=function(){if(T.colHeaders!==void 0&&T.colHeaders!==null)return!!T.colHeaders;for(let g=0,w=s.countCols();g<w;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const R=s.runHooks("modifyColHeader",g);if(R===void 0){const X=[],fe=s.countCols();for(let S=0;S<fe;S++)X.push(s.getColHeader(S));return X}let P=T.colHeaders;const W=function(X){const fe=[],S=s.countCols();let _=0;for(;_<S;_++)Tt(T.columns)&&T.columns(_)&&fe.push(_);return fe[X]},z=s.toPhysicalColumn(R),J=W(z);return T.colHeaders===!1?P=null:T.columns&&Tt(T.columns)&&T.columns(J)&&T.columns(J).title?P=T.columns(J).title:T.columns&&T.columns[z]&&T.columns[z].title?P=T.columns[z].title:Array.isArray(T.colHeaders)&&T.colHeaders[z]!==void 0?P=T.colHeaders[z]:Tt(T.colHeaders)?P=T.colHeaders(z):T.colHeaders&&typeof T.colHeaders!="string"&&typeof T.colHeaders!="number"&&(P=yC(R)),P=s.runHooks("modifyColumnHeaderValue",P,g,w),P},this._getColWidthFromSettings=function(g){let w;if(g>=0&&(w=s.getCellMeta(0,g).width),(w===void 0||w===T.width)&&(w=T.colWidths),w!=null){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(g,w){let R=s._getColWidthFromSettings(g);return R=s.runHooks("modifyColWidth",R,g,w),R===void 0&&(R=zc),R},this._getRowHeightFromSettings=function(g){let w=T.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getRowHeight=function(g,w){let R=s._getRowHeightFromSettings(g);return R=s.runHooks("modifyRowHeight",R,g,w),R},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const g=T.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,w)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return ME(s.countRows()-1,R=>{if(s.isEmptyRow(R))w+=1;else if(g===!0)return!1}),w},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return ME(s.countCols()-1,R=>{if(s.isEmptyCol(R))w+=1;else if(g===!0)return!1}),w},this.isEmptyRow=function(g){return T.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return T.isEmptyCol.call(s,g)},this.selectCell=function(g,w,R,P){let W=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,z=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ft(g)||Ft(w)?!1:this.selectCells([[g,w,R,P]],W,z)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&d.suspend();const P=U.selectCells(g);return P&&R&&s.listen(),d.resume(),P},this.selectColumns=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,R=arguments.length>2?arguments[2]:void 0;return U.selectColumns(g,w,R)},this.selectRows=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,R=arguments.length>2?arguments[2]:void 0;return U.selectRows(g,w,R)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,R=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),U.selectAll(g,w,R)};const be=(g,w)=>g.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(g){var w;if(typeof g=="number"){var R;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(R=arguments[4])!==null&&R!==void 0?R:!0}}const{row:P,col:W,considerHiddenIndexes:z}=(w=g)!==null&&w!==void 0?w:{};let J=P,X=W;if(z===void 0||z){const _=Number.isInteger(P)&&P>=0,p=Number.isInteger(W)&&W>=0,v=_?be(this.rowIndexMapper,P):void 0,E=p?be(this.columnIndexMapper,W):void 0;if(v===null||E===null)return!1;J=_?s.rowIndexMapper.getRenderableFromVisualIndex(v):P,X=p?s.columnIndexMapper.getRenderableFromVisualIndex(E):W}const fe=Number.isInteger(J),S=Number.isInteger(X);return fe&&J>=0&&S&&X>=0?s.view.scrollViewport(s._createCellCoords(J,X),g.horizontalSnap,g.verticalSnap):fe&&J>=0&&(S&&X<0||!S)?s.view.scrollViewportVertically(J,g.verticalSnap):S&&X>=0&&(fe&&J<0||!fe)?s.view.scrollViewportHorizontally(X,g.horizontalSnap):!1},this.scrollToFocusedCell=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",g);const{highlight:w}=this.getSelectedRangeLast();this.scrollViewportTo(w.toObject())?this.view.render():(this.removeHook("afterScroll",g),this._registerImmediate(()=>g()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),C.clearCache(),wS.delete(this.guid),ap(s)){const g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}Qi(s.rootElement),o.destroy(),c&&c.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),O.getItems().forEach(g=>{let[,w]=g;w.destroy()}),O.clear(),s.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(s),Be(s,(g,w,R)=>{Tt(g)?R[w]=st(w):w!=="guid"&&(R[w]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,U=null,c=null,s=null};function st(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){const w=ir(g);return w==="UndoRedo"?this.undoRedo:O.getItem(w)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:O.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,w,R){ge.getSingleton().add(g,w,s,R)},this.hasHook=function(g){return ge.getSingleton().has(g,s)||ge.getSingleton().has(g)},this.addHookOnce=function(g,w,R){ge.getSingleton().once(g,w,s,R)},this.removeHook=function(g,w){ge.getSingleton().remove(g,w,s)},this.runHooks=function(g,w,R,P,W,z,J){return ge.getSingleton().run(s,g,w,R,P,W,z,J)},this.getTranslatedPhrase=function(g,w){return Q$(T.language,g,w)},this.toHTML=()=>_E(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",_E(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{this.view.getStylesHandler().useTheme(g),this.runHooks("afterSetTheme",g,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,R=g;typeof R=="function"&&(R=setTimeout(R,w)),this.timeouts.push(R)},this._clearTimeouts=function(){F(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){F(this.immediates,g=>{clearImmediate(g)})},this._getEditorManager=function(){return c},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const Ht=fZ({handleEvent(){return s.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&Ht.releasePressedKeys()}),this.getShortcutManager=function(){return Ht},this.getFocusManager=function(){return h},kT().forEach(g=>{const w=Yf(g);O.addItem(g,new w(this))}),X7(s),Ht.setActiveContextName("grid"),ge.getSingleton().run(s,"construct")}function EH(t,e,n){t.addEventListener(e,n,!1)}function TH(t,e,n){t.removeEventListener(e,n,!1)}function zg(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function gV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),s=t.createElement("span");let o;function a(){var h,d;i.textContent=n.textContent(o),s.style.position="absolute",s.style.fontSize=zg(o).fontSize,s.style.fontFamily=zg(o).fontFamily,s.style.whiteSpace="pre",r.appendChild(s);const f=parseInt(((h=zg(o))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),m=parseInt(((d=zg(o))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),y=s.clientWidth+2+f+m;r.removeChild(s);const C=o.style;C.height=`${n.minHeight}px`,n.minWidth>y?C.width=`${n.minWidth}px`:y>n.maxWidth?C.width=`${n.maxWidth}px`:C.width=`${y}px`;const T=o.scrollHeight?o.scrollHeight-1:0;n.minHeight>T?C.height=`${n.minHeight}px`:n.maxHeight<T?(C.height=`${n.maxHeight}px`,C.overflowY="visible"):C.height=`${T}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=o.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=o.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=o.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=o.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=h,u(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${n.minHeight}px`,o.style.minWidth=`${n.minWidth}px`,o.style.maxWidth=`${n.maxWidth}px`,o.style.overflowY="hidden"),f&&(EH(o,"input",a),EH(o,"keydown",l)),a()}return{init:c,resize:a,unObserve(){TH(o,"input",a),TH(o,"keydown",l)}}}function _H(t,e){const n=ST(e),r=e.value.split(`
`);let i=n,s=0;for(let o=0;o<r.length;o++){const a=r[o];o!==0&&(s+=r[o-1].length+1);const l=s+a.length;if(t==="home"?i=s:t==="end"&&(i=l),n<=l)break}jf(e,i)}function hl(t,e,n){return(e=gZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gZ(t){var e=mZ(t,"string");return typeof e=="symbol"?e:e+""}function mZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pZ="ht_editor_visible",Yg="ht_editor_hidden",xH="textEditor",wZ="text";class Eu extends uh{static get EDITOR_TYPE(){return wZ}constructor(e){super(e),hl(this,"eventManager",new bi(this)),hl(this,"autoResize",gV(this.hot.rootDocument)),hl(this,"TEXTAREA",void 0),hl(this,"textareaStyle",void 0),hl(this,"TEXTAREA_PARENT",void 0),hl(this,"textareaParentStyle",void 0),hl(this,"layerClass",void 0),this.eventManager=new bi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),AF(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,s,o){const a=this.state;if(super.prepare(e,n,r,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==on.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===on.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),jf(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Pe(this.TEXTAREA,[["data-hot-input",""],sh(-1)]),K(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),K(this.TEXTAREA_PARENT,"handsontableInputHolder"),Me(this.TEXTAREA_PARENT,this.layerClass)&&_e(this.TEXTAREA_PARENT,this.layerClass),K(this.TEXTAREA_PARENT,Yg),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){t$()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",_e(this.TEXTAREA_PARENT,this.layerClass),K(this.TEXTAREA_PARENT,Yg)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;Re(e.length-1,r=>{const i=e[r];if(Me(i,"handsontableEditor"))return n=!0,!1}),Me(this.TEXTAREA_PARENT,Yg)&&_e(this.TEXTAREA_PARENT,Yg),n?(this.layerClass=pZ,K(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),K(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==on.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){PT()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===on.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===on.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>we(this.hot.getSelected()),group:xH},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;_H(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;_H(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(xH)}}const CZ="base";function Zf(t,e,n,r,i,s,o){const a=o.ariaTags,l=[],u=[],c=[],h=[];o.className&&K(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push($O())):a&&c.push($O()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(VO())):(u.push(o.invalidCellClassName),a&&c.push(VO()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),_e(e,u),K(e,l),bu(e,c),Pe(e,h)}Zf.RENDERER_TYPE=CZ;const yZ="text";function Zo(t,e,n,r,i,s,o){Zf.apply(this,[t,e,n,r,i,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=Jt(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){Qi(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else Wa(e,a)}Zo.RENDERER_TYPE=yZ;const vZ="text",mV={CELL_TYPE:vZ,editor:Eu,renderer:Zo};oi(mV);Oe.editors={BaseEditor:uh};function Oe(t,e){const n=new fV(t,e||{},t_);return n.init(),n}Oe.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new fV(t,e,t_)};Oe.DefaultSettings=oV();Oe.hooks=ge.getSingleton();Oe.CellCoords=lu;Oe.CellRange=Gf;Oe.packageName="handsontable";Oe.buildDate="16/12/2024 13:19:38";Oe.version="15.0.0";Oe.languages={dictionaryKeys:k9,getLanguageDictionary:J$,getLanguagesDictionaries:B9,registerLanguageDictionary:Z$,getTranslatedPhrase:Q$};function bZ(t,e,n){return(e=EZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MH(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function SZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?MH(Object(n),!0).forEach(function(r){bZ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):MH(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function RZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EZ(t){var e=RZ(t,"string");return typeof e=="symbol"?e:e+""}function Vd(t){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vd(t)}var kc=Symbol("unassigned"),TZ="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function Zp(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function pV(t){var e=Oe.hooks.getRegistered(),n={};Object.assign(n,Oe.DefaultSettings);for(var r in n)n[r]={default:kc};for(var i=0;i<e.length;i++)n[e[i]]={default:kc};return n.settings={default:kc},t==="HotTable"&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function wV(t){var e={},n=t.settings;if(n!==kc)for(var r in n)Zp(n,r)&&n[r]!==kc&&(e[r]=n[r]);for(var i in t)Zp(t,i)&&i!=="settings"&&t[i]!==kc&&(e[i]=t[i]);return e}function IH(t,e){var n=wV(t),r=t.settings?t.settings:n,i=t.settings?n:null,s={};for(var o in r)Zp(r,o)&&r[o]!==void 0&&(!(e&&o!=="data")||!PH(e[o],r[o]))&&(s[o]=r[o]);for(var a in i)Zp(i,a)&&a!=="id"&&a!=="settings"&&i[a]!==void 0&&(!(e&&a!=="data")||!PH(e[a],i[a]))&&(s[a]=i[a]);return s}function PH(t,e){var n=function(i){var s=function(){var o=new WeakSet;return function(a,l){if(Vd(l)==="object"&&l!==null){if(o.has(l))return;o.add(l)}return l}}();return JSON.stringify(i,s)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():Vd(t)!==Vd(e)?!1:n(t)===n(e)}var _Z="15.0.0",Nx=SL({name:"HotTable",props:pV("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var n=IH(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||n===void 0||(n.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete n.data),Object.keys(n).length?this.hotInstance.updateSettings(n):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(TZ),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=IH(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=fL(new Oe.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var n=this.hotInstance.getSourceData(),r=[],i=[],s=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),o=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==s&&n.length<s)for(var l=n.length;l<s;l++)r.push(l);if(o){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&((u=n[0])===null||u===void 0?void 0:u.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)i.push(c)}this.hotInstance.batch(function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(s-1,n.length-s),o&&n.length!==0&&(i.length>0?e.hotInstance.columnIndexMapper.removeIndexes(i):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:_Z}),xZ=["id"];function MZ(t,e,n,r,i,s){return Xe(),mt("div",{id:t.id},[Gj(t.$slots,"default")],8,xZ)}Nx.render=MZ;Nx.__file="src/HotTable.vue";var IZ=SL({name:"HotColumn",props:pV("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=wV(this.$props),n=SZ({},e);e.renderer&&(n.renderer=e.renderer),e.editor&&(n.editor=e.editor),this.columnsCache.set(this,n)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});IZ.__file="src/HotColumn.vue";const OH="handsontableEditor",PZ="handsontable";class Dx extends Eu{static get EDITOR_TYPE(){return PZ}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),jf(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&fn(l,o.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.htEditor.useTheme(e)})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:OH,relativeToGroup:Za,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),_i(o),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,s)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(OH)}}function OZ(t,e,n){AZ(t,e),e.set(t,n)}function AZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gg(t,e,n){return(e=HZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HZ(t){var e=NZ(t,"string");return typeof e=="symbol"?e:e+""}function NZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AH(t,e){return t.get(DZ(t,e))}function DZ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const LZ="autocomplete";var CS=new WeakMap;class Lx extends Dx{constructor(){super(...arguments),Gg(this,"query",null),Gg(this,"strippedChoices",[]),Gg(this,"rawChoices",[]),OZ(this,CS,this.hot.guid.slice(0,9)),Gg(this,"sortByRelevance",function(e,n,r){const i=[],s=[],o=e.length;let a=n.length,l,u,c,h;if(o===0){for(c=0;c<a;c++)s.push(c);return s}for(c=0;c<a;c++){if(u=vE(Jt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-o,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)s.push(i[c].baseIndex);return s})}static get EDITOR_TYPE(){return LZ}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return we(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),K(this.htContainer,"autocompleteEditor"),K(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[m3(),c3(),xF("listbox"),y3()])}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[yi("false"),v3(`${AH(CS,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:s,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.updateSettings({colWidths:e?[ln(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(a,l,u,c,h,d,f)=>{Zo(a,l,u,c,h,d,f);const{filteringCaseSensitive:m,allowHtml:y,locale:C}=this.cellProperties,T=this.query;let x=Jt(d),O,b;x&&!y&&(O=m===!0?x.indexOf(T):x.toLocaleLowerCase(C).indexOf(T.toLocaleLowerCase(C)),O!==-1&&(b=x.substr(O,T.length),x=x.replace(b,`<strong>${b}</strong>`))),n&&Pe(l,[h3(),...r?[E3(i)]:[],...r?[T3(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=x},afterSelectionEnd:(a,l)=>{if(n){const u=this.htEditor.getCell(a,l,!0);Pe(u,[wT()]),Pe(this.TEXTAREA,...b3(u.id))}}}),n&&(Pe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Bs()),Pe(this.htEditor.rootElement,[_F(),S3("polite"),R3("text"),["id",`${AH(CS,this)}-listbox-${s}-${o}`]]),Pe(this.TEXTAREA,...yi("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[yi("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=ST(this.TEXTAREA),r=WF(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[o[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Nd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),jf(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=au(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=xn(this.TEXTAREA),s=en(this.TEXTAREA),o=this.getHeight(),a=e.scrollTop,l=en(this.hot.view._wt.wtTable.THEAD),u=xn(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-s,d=o>h&&c>h;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,o),d}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,s=0,o=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=s,i+=1;while(r<e);o=r-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-s)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+Ln(this.hot.rootDocument)}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(s,o)=>o).reduce((s,o)=>s+this.htEditor.getRowHeight(o),0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=qe(e,s=>Jt(s));return qe(r,s=>n?s:vE(s))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===Se.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===Se.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(n$(e.keyCode)||e.keyCode===Se.BACKSPACE||e.keyCode===Se.DELETE||e.keyCode===Se.INSERT){let n=10;if(e.keyCode===Se.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const kZ="checkbox";class CV extends uh{static get EDITOR_TYPE(){return kZ}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');Me(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ma=()=>window,gi=()=>window.document,$E=(t,e)=>window.setTimeout(t,e),xs=function(t,e,n,r){t.addEventListener(e,n,!!r)},uo=function(t,e,n,r){t.removeEventListener(e,n,!!r)},FZ=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Br=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},yS=function(t,e){Br(t,e)||(t.className=t.className===""?e:t.className+" "+e)},vS=function(t,e){t.className=FZ((" "+t.className+" ").replace(" "+e+" "," "))},kx=function(t){return/Array/.test(Object.prototype.toString.call(t))},Gr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},$Z=function(t){let e=t.getDay();return e===0||e===6},VZ=function(t){return t%4===0&&t%100!==0||t%400===0},HH=function(t,e){return[31,VZ(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},qg=function(t){Gr(t)&&t.setHours(0,0,0,0)},Kg=function(t,e){return t.getTime()===e.getTime()},Jp=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Gr(e[r])?n&&(t[r]=new Date(e[r].getTime())):kx(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Jp({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},NH=function(t,e,n){let r=gi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Jp(r,n),t.dispatchEvent(r)},DH=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},gs={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},LH=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},WZ=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},BZ=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,s=i-1,o=7,a=function(d){return(d+o-1)%o};t.setDate(n+s-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-s+a(l.getDay()))/o)},jZ=function(t,e,n,r,i){let s=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():BZ(s,i))+"</td>"},UZ=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},zZ=function(t){return"<tbody>"+t.join("")+"</tbody>"},YZ=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+LH(t,e)+'">'+LH(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},GZ=function(t,e,n,r,i,s){let o,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,m,y=!0,C=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(n===i?o-e:12+o-e)+'"'+(o===r?' selected="selected"':"")+(c&&o<u.minMonth||h&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",kx(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=n-u.yearRange,a=1+n+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===n?' selected="selected"':"")+">"+o+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(r===0||u.minMonth>=r)&&(y=!1),h&&(r===11||u.maxMonth<=r)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(y?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},qZ=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+YZ(t)+zZ(e)+"</table>"};function VE(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Ma().event;let s=i.target||i.srcElement;if(s)if(Br(s,"is-disabled")||(Br(s,"pika-button")&&!Br(s,"is-empty")&&!Br(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),n.bound&&$E(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Br(s,"pika-prev")?e.prevMonth():Br(s,"pika-next")&&e.nextMonth()),Br(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Ma().event;let s=i.target||i.srcElement;s&&(Br(s,"pika-select-month")?e.gotoMonth(s.value):Br(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||Ma().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),Gr(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=gi().activeElement;do if(Br(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=$E(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Ma().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&Br(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),xs(s,"change",e._onChange)));do if(Br(o,"pika-single")||o===n.trigger)return;while(o=o.parentNode);e._v&&s!==n.trigger&&o!==n.trigger&&e.hide()}},e.el=gi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),xs(e.el,"mousedown",e._onMouseDown,!0),xs(e.el,"touchend",e._onMouseDown,!0),xs(e.el,"change",e._onChange),n.keyboardInput&&xs(gi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?gi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),xs(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Gr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",xs(n.trigger,"click",e._onInputClick),xs(n.trigger,"focus",e._onInputFocus),xs(n.trigger,"blur",e._onInputBlur)):this.show()}VE.prototype={config:function(t){this._o||(this._o=Jp({},gs,!0));let e=Jp(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Gr(e.minDate)||(e.minDate=!1),Gr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),kx(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||gs.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Gr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Gr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",NH(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Gr(t))return;let n=this._o.minDate,r=this._o.maxDate;Gr(n)&&t<n?t=n:Gr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),qg(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),NH(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Gr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=DH(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=DH({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(qg(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=gs.minDate,this._o.minYear=gs.minYear,this._o.minMonth=gs.minMonth,this._o.startRange=gs.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(qg(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=gs.maxDate,this._o.maxYear=gs.maxYear,this._o.maxMonth=gs.maxMonth,this._o.endRange=gs.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+GZ(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&$E(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,s,o,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Ma().innerWidth||gi().documentElement.clientWidth,i=Ma().innerHeight||gi().documentElement.clientHeight,s=gi().body.scrollTop||gi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),o=l.left+Ma().pageXOffset,a=l.bottom+Ma().pageYOffset,(this._o.reposition&&o+e>r||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+s||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",yS(this.el,u?"left-aligned":"right-aligned"),yS(this.el,c?"bottom-aligned":"top-aligned"),vS(this.el,u?"right-aligned":"left-aligned"),vS(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,s=HH(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];qg(i),r.firstDay>0&&(o-=r.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=HH(h,u),m=s+o,y=m;for(;y>7;)y-=7;m+=7-y;let C=!1;for(let T=0,x=0;T<m;T++){let O=new Date(t,e,1+(T-o)),b=Gr(this._d)?Kg(O,this._d):!1,H=Kg(O,i),k=r.events.indexOf(O.toDateString())!==-1,V=T<o||T>=s+o,U=1+(T-o),Z=e,Y=t,Q=r.startRange&&Kg(r.startRange,O),ne=r.endRange&&Kg(r.endRange,O),ce=r.startRange&&r.endRange&&r.startRange<O&&O<r.endRange,ae=r.minDate&&O<r.minDate||r.maxDate&&O>r.maxDate||r.disableWeekends&&$Z(O)||r.disableDayFn&&r.disableDayFn(O);V&&(T<o?(U=f+U,Z=u,Y=h):(U=U-s,Z=c,Y=d));let ye={day:U,month:Z,year:Y,hasEvent:k,isSelected:b,isToday:H,isDisabled:ae,isEmpty:V,isStartRange:Q,isEndRange:ne,isInRange:ce,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&b&&(C=!0),l.push(WZ(ye)),++x===7&&(r.showWeekNumber&&l.unshift(jZ(this,T-o,e,t,r.firstWeekOfYearMinDays)),a.push(UZ(l,r.isRTL,r.pickWholeWeek,C)),l=[],x=0,C=!1)}return qZ(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),vS(this.el,"is-hidden"),this._o.bound&&(xs(gi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&uo(gi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),yS(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),uo(this.el,"mousedown",this._onMouseDown,!0),uo(this.el,"touchend",this._onMouseDown,!0),uo(this.el,"change",this._onChange),t.keyboardInput&&uo(gi(),"keydown",this._onKeyChange),t.field&&(uo(t.field,"change",this._onInputChange),t.bound&&(uo(t.trigger,"click",this._onInputClick),uo(t.trigger,"focus",this._onInputFocus),uo(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function bS(t,e,n){return(e=KZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KZ(t){var e=XZ(t,"string");return typeof e=="symbol"?e:e+""}function XZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yV="date",kH="dateEditor";class vV extends Eu{constructor(){super(...arguments),bS(this,"defaultDateFormat","DD/MM/YYYY"),bS(this,"parentDestroyed",!1),bS(this,"$datePicker",null)}static get EDITOR_TYPE(){return yV}init(){if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof VE!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(_e(this.datePicker,/ht-theme-.*/g),K(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),K(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();_e(this.datePicker,/ht-theme-.*/g),K(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{Me(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:kH})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(kH),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.hot.view.isMouseDown(),i=e?AT(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new VE(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(ee),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,ee(s,n,!0).isValid()&&this.$datePicker.setMoment(ee(s,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,ee(s,n,!0).isValid()&&this.$datePicker.setMoment(ee(s,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&zf(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=ee(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==on.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(n=s.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+en(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-ln(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const ZZ="dropdown";class Fx extends Lx{static get EDITOR_TYPE(){return ZZ}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}ge.getSingleton().add("beforeValidate",function(t,e,n){const r=this.propToCol(n);if(Number.isInteger(r)){const i=this.getCellMeta(e,r);i.editor===Fx&&i.strict===void 0&&(i.filter=!1,i.strict=!0)}});const JZ="numeric";class bV extends Eu{static get EDITOR_TYPE(){return JZ}}function QZ(t,e,n){return(e=eJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eJ(t){var e=tJ(t,"string");return typeof e=="symbol"?e:e+""}function tJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nJ="password";class SV extends Eu{constructor(){super(...arguments),QZ(this,"autoResize",gV(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return nJ}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Qi(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const SS="ht_editor_visible",FH="selectEditor",rJ="select";class RV extends uh{static get EDITOR_TYPE(){return rJ}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Ka()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),K(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Me(this.selectWrapper,SS)&&_e(this.selectWrapper,SS),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Qi(this.select),Be(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Su(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==on.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${i}px`,s.width=`${r}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${n}px`,s.margin="0px",K(this.selectWrapper,SS)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:FH};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(FH)}}const iJ="time";class EV extends Eu{static get EDITOR_TYPE(){return iJ}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o),this.TEXTAREA.dir="ltr"}}function sJ(){Pr(uh),Pr(Lx),Pr(CV),Pr(vV),Pr(Fx),Pr(Dx),Pr(bV),Pr(SV),Pr(RV),Pr(Eu),Pr(EV)}const oJ="html";function $x(t,e,n,r,i,s,o){Zf.apply(this,[t,e,n,r,i,s,o]),Su(e,s??"",!1)}$x.RENDERER_TYPE=oJ;const aJ="autocomplete";function ch(t,e,n,r,i,s,o){const{rootDocument:a}=t,l=o.allowHtml?$x:Zo,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Ka()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,s,o]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),K(e,"htAutocomplete"),!t.acArrowListener){const h=new bi(t);t.acArrowListener=function(d){Me(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}ch.RENDERER_TYPE=aJ;const lJ="dropdown";function Vx(t,e,n,r,i,s,o){ch.apply(this,[t,e,n,r,i,s,o])}Vx.RENDERER_TYPE=lJ;const $H=new WeakMap,VH=new WeakMap,uJ="htBadValue",Gc="data-row",qc="data-col",cJ="checkboxRenderer",TV="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:s,column:o,prop:a}=e;if(i===TV){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(s,o,a,n):l;else if(u){const h=this.getDataAtRowProp(s,u);c=h!==null?h:n}t=c}return t}});function Wx(t,e,n,r,i,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Zf.apply(this,[t,e,n,r,i,s,o]),hJ(t);let u=dJ(a);const c=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Qi(e),s===o.checkedTemplate||Jt(s).toLocaleLowerCase(o.locale)===Jt(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||Jt(s).toLocaleLowerCase(o.locale)===Jt(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:Qt(s)?K(u,"noValue"):(u.style.display="none",K(u,uJ),h=!0),Pe(u,[[Gc,n],[qc,r]]),l&&Pe(u,[$p(u.checked?t.getTranslatedPhrase(Ix):t.getTranslatedPhrase(Px)),PF(u.checked),d3()]),!h&&c){let y="";if(c.value)y=typeof c.value=="function"?c.value.call(this,n,r,i,s):c.value;else if(c.property){const T=t.getDataAtRowProp(n,c.property);y=T!==null?T:""}const C=fJ(a,y,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),$H.has(t)||($H.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),T={group:cJ,relativeToGroup:Za,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var x;return(x=t.getSelectedRangeLast())===null||x===void 0?void 0:x.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const x=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(x==null?void 0:x.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var x;return(x=t.getSelectedRangeLast())===null||x===void 0?void 0:x.highlight.isCell()}}],T)}function f(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),T=[],x=new Map;let O=[],b=0;if(C){for(let H=0;H<C.length;H++){const{row:k,col:V}=C[H].getTopStartCorner(),{row:U,col:Z}=C[H].getBottomEndCorner();for(let Y=k;Y<=U;Y+=1)for(let Q=V;Q<=Z;Q+=1){const ne=t.getCellMeta(Y,Q);if(ne.hidden)continue;const ce={checkedTemplate:ne.checkedTemplate,uncheckedTemplate:ne.uncheckedTemplate};if(ne.type!=="checkbox"){y===!0&&!ne.readOnly&&(x.has(T.length)?x.set(T.length,[...x.get(T.length),[Y,Q,null]]):x.set(T.length,[[Y,Q,null]]));continue}if(ne.readOnly===!0)continue;typeof ne.checkedTemplate>"u"&&(ne.checkedTemplate=!0),typeof ne.uncheckedTemplate>"u"&&(ne.uncheckedTemplate=!1);const ae=t.getDataAtCell(Y,Q);y===!1?[ne.checkedTemplate,ne.checkedTemplate.toString()].includes(ae)?O.push([Y,Q,ne.uncheckedTemplate,ce]):[ne.uncheckedTemplate,ne.uncheckedTemplate.toString(),null,void 0].includes(ae)&&O.push([Y,Q,ne.checkedTemplate,ce]):O.push([Y,Q,ne.uncheckedTemplate,ce]),b+=1}T.push(b),b=0}O.every(H=>{let[,,k]=H;return k===O[0][2]})?O=O.map(H=>{let[k,V,U]=H;return[k,V,U]}):O=O.map(H=>{let[k,V,,U]=H;return[k,V,U.checkedTemplate]}),O.length>0&&T.forEach((H,k)=>{let V=O.splice(0,H);x.size&&x.has(k)&&(V=[...V,...x.get(k)]),t.setDataAtCell(V)})}}function m(){const y=t.getSelectedRange();if(y){for(let C=0;C<y.length;C++){const T=y[C].getTopStartCorner(),x=y[C].getBottomEndCorner();for(let O=T.row;O<=x.row;O++)for(let b=T.col;b<=x.col;b++){if(t.getCellMeta(O,b).readOnly)continue;const k=t.getCell(O,b);if(k instanceof HTMLElement&&k.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}Wx.RENDERER_TYPE=TV;function hJ(t){let e=VH.get(t);if(!e){const{rootElement:n}=t;e=new bi(t),e.addEventListener(n,"click",r=>mJ(r,t)),e.addEventListener(n,"mouseup",r=>gJ(r,t)),e.addEventListener(n,"change",r=>pJ(r,t)),VH.set(t,e)}return e}function dJ(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function fJ(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function gJ(t,e){const{target:n}=t;Bx(n)&&(!n.hasAttribute(Gc)||!n.hasAttribute(qc)||setTimeout(e.listen,10))}function mJ(t,e){const{target:n}=t;if(!Bx(n)||!n.hasAttribute(Gc)||!n.hasAttribute(qc))return;const r=parseInt(n.getAttribute(Gc),10),i=parseInt(n.getAttribute(qc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function pJ(t,e){const{target:n}=t;if(!Bx(n)||!n.hasAttribute(Gc)||!n.hasAttribute(qc))return;const r=parseInt(n.getAttribute(Gc),10),i=parseInt(n.getAttribute(qc),10),s=e.getCellMeta(r,i);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(r,i,o)}}function Bx(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const wJ="handsontable";function jx(t,e,n,r,i,s,o){ch.apply(this,[t,e,n,r,i,s,o])}jx.RENDERER_TYPE=wJ;var CJ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yJ(t){return t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var RS,WH;function vJ(){return WH||(WH=1,RS={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),RS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ES,BH;function _V(){if(BH)return ES;BH=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,m){if(!isNaN(+l))return+l;let y="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*n(C,u,c,h,d,f);for(let k=0;k<t.length;k++){let V=t[k];if(y=l.replace(RegExp(`([0-9 ])(${V.key})$`),"$1"),y!==l)return n(y,u,c,h,d,f)*V.factor}if(y=l.replace("%",""),y!==l)return n(y,u,c,h,d,f)/100;let T=parseFloat(l);if(isNaN(T))return;let x=h(T);if(x&&x!=="."&&(y=l.replace(new RegExp(`${e(x)}$`),""),y!==l))return n(y,u,c,h,d,f);let O={};Object.keys(f).forEach(k=>{O[f[k]]=k});let b=Object.keys(O).sort().reverse(),H=b.length;for(let k=0;k<H;k++){let V=b[k],U=O[V];if(y=l.replace(V,""),y!==l){let Z;switch(U){case"thousand":Z=Math.pow(10,3);break;case"million":Z=Math.pow(10,6);break;case"billion":Z=Math.pow(10,9);break;case"trillion":Z=Math.pow(10,12);break}return n(y,u,c,h,d,f)*Z}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,m){if(l==="")return;if(l===d)return 0;let y=r(l,u,c);return n(y,u,c,h,d,f)}function s(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],m=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(m)}function o(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=Yx();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),m=c.getZeroFormat(),y=c.currentAbbreviations(),C;if(typeof l=="string")s(l,h)?C=o(l):C=i(l,h,d,f,m,y);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return ES={unformat:a},ES}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var TS,jH;function Ux(){if(jH)return TS;jH=1;let t=_V();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],s=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,T)=>T.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,T)=>T.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,T)=>!T.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,T)=>T.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,T){let x=d(C),O=m(T);return x&&O}function d(C){return t.unformat(C)!==void 0}function f(C,T,x,O=!1){let b=Object.keys(C).map(H=>{if(!T[H])return console.error(`${x} Invalid key: ${H}`),!1;let k=C[H],V=T[H];if(typeof V=="string"&&(V={type:V}),V.type==="format"){if(!f(k,u,`[Validate ${H}]`,!0))return!1}else if(typeof k!==V.type)return console.error(`${x} ${H} type mismatched: "${V.type}" expected, "${typeof k}" provided`),!1;if(V.restrictions&&V.restrictions.length){let U=V.restrictions.length;for(let Z=0;Z<U;Z++){let{restriction:Y,message:Q}=V.restrictions[Z];if(!Y(k,C))return console.error(`${x} ${H} invalid value: ${Q}`),!1}}return V.restriction&&!V.restriction(k,C)?(console.error(`${x} ${H} invalid value: ${V.message}`),!1):V.validValues&&V.validValues.indexOf(k)===-1?(console.error(`${x} ${H} invalid value: must be among ${JSON.stringify(V.validValues)}, "${k}" provided`),!1):!(V.children&&!f(k,V.children,`[Validate ${H}]`))});return O||b.push(...Object.keys(T).map(H=>{let k=T[H];if(typeof k=="string"&&(k={type:k}),k.mandatory){let V=k.mandatory;if(typeof V=="function"&&(V=V(C)),V&&C[H]===void 0)return console.error(`${x} Missing mandatory key "${H}"`),!1}return!0})),b.reduce((H,k)=>H&&k,!0)}function m(C){return f(C,u,"[Validate format]")}function y(C){return f(C,c,"[Validate language]")}return TS={validate:h,validateFormat:m,validateInput:d,validateLanguage:y},TS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function bJ(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function SJ(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function RJ(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function EJ(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function TJ(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function _J(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function xJ(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function MJ(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function IJ(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function PJ(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function OJ(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function AJ(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function HJ(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function NJ(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function DJ(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function LJ(t,e={}){return typeof t!="string"?t:(t=bJ(t,e),t=SJ(t,e),RJ(t,e),_J(t,e),xJ(t,e),HJ(t,e),PJ(t,e),OJ(t,e),MJ(t,e),AJ(t,e),IJ(t,e),EJ(t,e),TJ(t,e),NJ(t,e),DJ(t,e),e)}var zx={parseFormat:LJ};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var _S,UH;function Yx(){if(UH)return _S;UH=1;const t=vJ(),e=Ux(),n=zx;let r={},i,s={},o=null,a={};function l(c){i=c}function u(){return s[i]}return r.languages=()=>Object.assign({},s),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>o,r.setZeroFormat=c=>o=typeof c=="string"?c:null,r.hasZeroFormat=()=>o!==null,r.languageData=c=>{if(c){if(s[c])return s[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");s[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!s[c]){let d=c.split("-")[0],f=Object.keys(s).find(m=>m.split("-")[0]===d);if(!s[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,_S=r,_S}function kJ(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function FJ(t,e){t.forEach(n=>{let r;try{r=kJ(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var $J=t=>({loadLanguagesInNode:e=>FJ(e,t)}),xV={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function m(k){var V,U,Z,Y=P.prototype={constructor:P,toString:null,valueOf:null},Q=new P(1),ne=20,ce=4,ae=-7,ye=21,Le=-1e7,me=1e7,be=!1,st=1,Ht=0,g={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},w="0123456789abcdefghijklmnopqrstuvwxyz",R=!0;function P(S,_){var p,v,E,I,N,M,A,L,D=this;if(!(D instanceof P))return new P(S,_);if(_==null){if(S&&S._isBigNumber===!0){D.s=S.s,!S.c||S.e>me?D.c=D.e=null:S.e<Le?D.c=[D.e=0]:(D.e=S.e,D.c=S.c.slice());return}if((M=typeof S=="number")&&S*0==0){if(D.s=1/S<0?(S=-S,-1):1,S===~~S){for(I=0,N=S;N>=10;N/=10,I++);I>me?D.c=D.e=null:(D.e=I,D.c=[S]);return}L=String(S)}else{if(!r.test(L=String(S)))return Z(D,L,M);D.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}(I=L.indexOf("."))>-1&&(L=L.replace(".","")),(N=L.search(/e/i))>0?(I<0&&(I=N),I+=+L.slice(N+1),L=L.substring(0,N)):I<0&&(I=L.length)}else{if(x(_,2,w.length,"Base"),_==10&&R)return D=new P(S),X(D,ne+D.e+1,ce);if(L=String(S),M=typeof S=="number"){if(S*0!=0)return Z(D,L,M,_);if(D.s=1/S<0?(L=L.slice(1),-1):1,P.DEBUG&&L.replace(/^0\.0*|\./,"").length>15)throw Error(a+S)}else D.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(p=w.slice(0,_),I=N=0,A=L.length;N<A;N++)if(p.indexOf(v=L.charAt(N))<0){if(v=="."){if(N>I){I=A;continue}}else if(!E&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){E=!0,N=-1,I=0;continue}return Z(D,String(S),M,_)}M=!1,L=U(L,_,10,D.s),(I=L.indexOf("."))>-1?L=L.replace(".",""):I=L.length}for(N=0;L.charCodeAt(N)===48;N++);for(A=L.length;L.charCodeAt(--A)===48;);if(L=L.slice(N,++A)){if(A-=N,M&&P.DEBUG&&A>15&&(S>c||S!==s(S)))throw Error(a+D.s*S);if((I=I-N-1)>me)D.c=D.e=null;else if(I<Le)D.c=[D.e=0];else{if(D.e=I,D.c=[],N=(I+1)%u,I<0&&(N+=u),N<A){for(N&&D.c.push(+L.slice(0,N)),A-=u;N<A;)D.c.push(+L.slice(N,N+=u));N=u-(L=L.slice(N)).length}else N-=A;for(;N--;L+="0");D.c.push(+L)}}else D.c=[D.e=0]}P.clone=m,P.ROUND_UP=0,P.ROUND_DOWN=1,P.ROUND_CEIL=2,P.ROUND_FLOOR=3,P.ROUND_HALF_UP=4,P.ROUND_HALF_DOWN=5,P.ROUND_HALF_EVEN=6,P.ROUND_HALF_CEIL=7,P.ROUND_HALF_FLOOR=8,P.EUCLID=9,P.config=P.set=function(S){var _,p;if(S!=null)if(typeof S=="object"){if(S.hasOwnProperty(_="DECIMAL_PLACES")&&(p=S[_],x(p,0,f,_),ne=p),S.hasOwnProperty(_="ROUNDING_MODE")&&(p=S[_],x(p,0,8,_),ce=p),S.hasOwnProperty(_="EXPONENTIAL_AT")&&(p=S[_],p&&p.pop?(x(p[0],-1e9,0,_),x(p[1],0,f,_),ae=p[0],ye=p[1]):(x(p,-1e9,f,_),ae=-(ye=p<0?-p:p))),S.hasOwnProperty(_="RANGE"))if(p=S[_],p&&p.pop)x(p[0],-1e9,-1,_),x(p[1],1,f,_),Le=p[0],me=p[1];else if(x(p,-1e9,f,_),p)Le=-(me=p<0?-p:p);else throw Error(o+_+" cannot be zero: "+p);if(S.hasOwnProperty(_="CRYPTO"))if(p=S[_],p===!!p)if(p)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))be=p;else throw be=!p,Error(o+"crypto unavailable");else be=p;else throw Error(o+_+" not true or false: "+p);if(S.hasOwnProperty(_="MODULO_MODE")&&(p=S[_],x(p,0,9,_),st=p),S.hasOwnProperty(_="POW_PRECISION")&&(p=S[_],x(p,0,f,_),Ht=p),S.hasOwnProperty(_="FORMAT"))if(p=S[_],typeof p=="object")g=p;else throw Error(o+_+" not an object: "+p);if(S.hasOwnProperty(_="ALPHABET"))if(p=S[_],typeof p=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(p))R=p.slice(0,10)=="0123456789",w=p;else throw Error(o+_+" invalid: "+p)}else throw Error(o+"Object expected: "+S);return{DECIMAL_PLACES:ne,ROUNDING_MODE:ce,EXPONENTIAL_AT:[ae,ye],RANGE:[Le,me],CRYPTO:be,MODULO_MODE:st,POW_PRECISION:Ht,FORMAT:g,ALPHABET:w}},P.isBigNumber=function(S){if(!S||S._isBigNumber!==!0)return!1;if(!P.DEBUG)return!0;var _,p,v=S.c,E=S.e,I=S.s;e:if({}.toString.call(v)=="[object Array]"){if((I===1||I===-1)&&E>=-1e9&&E<=f&&E===s(E)){if(v[0]===0){if(E===0&&v.length===1)return!0;break e}if(_=(E+1)%u,_<1&&(_+=u),String(v[0]).length==_){for(_=0;_<v.length;_++)if(p=v[_],p<0||p>=l||p!==s(p))break e;if(p!==0)return!0}}}else if(v===null&&E===null&&(I===null||I===1||I===-1))return!0;throw Error(o+"Invalid BigNumber: "+S)},P.maximum=P.max=function(){return z(arguments,-1)},P.minimum=P.min=function(){return z(arguments,1)},P.random=function(){var S=9007199254740992,_=Math.random()*S&2097151?function(){return s(Math.random()*S)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(p){var v,E,I,N,M,A=0,L=[],D=new P(Q);if(p==null?p=ne:x(p,0,f),N=i(p/u),be)if(crypto.getRandomValues){for(v=crypto.getRandomValues(new Uint32Array(N*=2));A<N;)M=v[A]*131072+(v[A+1]>>>11),M>=9e15?(E=crypto.getRandomValues(new Uint32Array(2)),v[A]=E[0],v[A+1]=E[1]):(L.push(M%1e14),A+=2);A=N/2}else if(crypto.randomBytes){for(v=crypto.randomBytes(N*=7);A<N;)M=(v[A]&31)*281474976710656+v[A+1]*1099511627776+v[A+2]*4294967296+v[A+3]*16777216+(v[A+4]<<16)+(v[A+5]<<8)+v[A+6],M>=9e15?crypto.randomBytes(7).copy(v,A):(L.push(M%1e14),A+=7);A=N/7}else throw be=!1,Error(o+"crypto unavailable");if(!be)for(;A<N;)M=_(),M<9e15&&(L[A++]=M%1e14);for(N=L[--A],p%=u,N&&p&&(M=h[u-p],L[A]=s(N/M)*M);L[A]===0;L.pop(),A--);if(A<0)L=[I=0];else{for(I=-1;L[0]===0;L.splice(0,1),I-=u);for(A=1,M=L[0];M>=10;M/=10,A++);A<u&&(I-=u-A)}return D.e=I,D.c=L,D}}(),P.sum=function(){for(var S=1,_=arguments,p=new P(_[0]);S<_.length;)p=p.plus(_[S++]);return p},U=function(){var S="0123456789";function _(p,v,E,I){for(var N,M=[0],A,L=0,D=p.length;L<D;){for(A=M.length;A--;M[A]*=v);for(M[0]+=I.indexOf(p.charAt(L++)),N=0;N<M.length;N++)M[N]>E-1&&(M[N+1]==null&&(M[N+1]=0),M[N+1]+=M[N]/E|0,M[N]%=E)}return M.reverse()}return function(p,v,E,I,N){var M,A,L,D,$,q,G,te,oe=p.indexOf("."),pe=ne,le=ce;for(oe>=0&&(D=Ht,Ht=0,p=p.replace(".",""),te=new P(v),q=te.pow(p.length-oe),Ht=D,te.c=_(H(C(q.c),q.e,"0"),10,E,S),te.e=te.c.length),G=_(p,v,E,N?(M=w,S):(M=S,w)),L=D=G.length;G[--D]==0;G.pop());if(!G[0])return M.charAt(0);if(oe<0?--L:(q.c=G,q.e=L,q.s=I,q=V(q,te,pe,le,E),G=q.c,$=q.r,L=q.e),A=L+pe+1,oe=G[A],D=E/2,$=$||A<0||G[A+1]!=null,$=le<4?(oe!=null||$)&&(le==0||le==(q.s<0?3:2)):oe>D||oe==D&&(le==4||$||le==6&&G[A-1]&1||le==(q.s<0?8:7)),A<1||!G[0])p=$?H(M.charAt(1),-pe,M.charAt(0)):M.charAt(0);else{if(G.length=A,$)for(--E;++G[--A]>E;)G[A]=0,A||(++L,G=[1].concat(G));for(D=G.length;!G[--D];);for(oe=0,p="";oe<=D;p+=M.charAt(G[oe++]));p=H(p,L,M.charAt(0))}return p}}(),V=function(){function S(v,E,I){var N,M,A,L,D=0,$=v.length,q=E%d,G=E/d|0;for(v=v.slice();$--;)A=v[$]%d,L=v[$]/d|0,N=G*A+L*q,M=q*A+N%d*d+D,D=(M/I|0)+(N/d|0)+G*L,v[$]=M%I;return D&&(v=[D].concat(v)),v}function _(v,E,I,N){var M,A;if(I!=N)A=I>N?1:-1;else for(M=A=0;M<I;M++)if(v[M]!=E[M]){A=v[M]>E[M]?1:-1;break}return A}function p(v,E,I,N){for(var M=0;I--;)v[I]-=M,M=v[I]<E[I]?1:0,v[I]=M*N+v[I]-E[I];for(;!v[0]&&v.length>1;v.splice(0,1));}return function(v,E,I,N,M){var A,L,D,$,q,G,te,oe,pe,le,de,Ze,It,cn,Ct,Pt,Nt,ze=v.s==E.s?1:-1,Fe=v.c,je=E.c;if(!Fe||!Fe[0]||!je||!je[0])return new P(!v.s||!E.s||(Fe?je&&Fe[0]==je[0]:!je)?NaN:Fe&&Fe[0]==0||!je?ze*0:ze/0);for(oe=new P(ze),pe=oe.c=[],L=v.e-E.e,ze=I+L+1,M||(M=l,L=y(v.e/u)-y(E.e/u),ze=ze/u|0),D=0;je[D]==(Fe[D]||0);D++);if(je[D]>(Fe[D]||0)&&L--,ze<0)pe.push(1),$=!0;else{for(cn=Fe.length,Pt=je.length,D=0,ze+=2,q=s(M/(je[0]+1)),q>1&&(je=S(je,q,M),Fe=S(Fe,q,M),Pt=je.length,cn=Fe.length),It=Pt,le=Fe.slice(0,Pt),de=le.length;de<Pt;le[de++]=0);Nt=je.slice(),Nt=[0].concat(Nt),Ct=je[0],je[1]>=M/2&&Ct++;do{if(q=0,A=_(je,le,Pt,de),A<0){if(Ze=le[0],Pt!=de&&(Ze=Ze*M+(le[1]||0)),q=s(Ze/Ct),q>1)for(q>=M&&(q=M-1),G=S(je,q,M),te=G.length,de=le.length;_(G,le,te,de)==1;)q--,p(G,Pt<te?Nt:je,te,M),te=G.length,A=1;else q==0&&(A=q=1),G=je.slice(),te=G.length;if(te<de&&(G=[0].concat(G)),p(le,G,de,M),de=le.length,A==-1)for(;_(je,le,Pt,de)<1;)q++,p(le,Pt<de?Nt:je,de,M),de=le.length}else A===0&&(q++,le=[0]);pe[D++]=q,le[0]?le[de++]=Fe[It]||0:(le=[Fe[It]],de=1)}while((It++<cn||le[0]!=null)&&ze--);$=le[0]!=null,pe[0]||pe.splice(0,1)}if(M==l){for(D=1,ze=pe[0];ze>=10;ze/=10,D++);X(oe,I+(oe.e=D+L*u-1)+1,N,$)}else oe.e=L,oe.r=+$;return oe}}();function W(S,_,p,v){var E,I,N,M,A;if(p==null?p=ce:x(p,0,8),!S.c)return S.toString();if(E=S.c[0],N=S.e,_==null)A=C(S.c),A=v==1||v==2&&(N<=ae||N>=ye)?b(A,N):H(A,N,"0");else if(S=X(new P(S),_,p),I=S.e,A=C(S.c),M=A.length,v==1||v==2&&(_<=I||I<=ae)){for(;M<_;A+="0",M++);A=b(A,I)}else if(_-=N,A=H(A,I,"0"),I+1>M){if(--_>0)for(A+=".";_--;A+="0");}else if(_+=I-M,_>0)for(I+1==M&&(A+=".");_--;A+="0");return S.s<0&&E?"-"+A:A}function z(S,_){for(var p,v,E=1,I=new P(S[0]);E<S.length;E++)v=new P(S[E]),(!v.s||(p=T(I,v))===_||p===0&&I.s===_)&&(I=v);return I}function J(S,_,p){for(var v=1,E=_.length;!_[--E];_.pop());for(E=_[0];E>=10;E/=10,v++);return(p=v+p*u-1)>me?S.c=S.e=null:p<Le?S.c=[S.e=0]:(S.e=p,S.c=_),S}Z=function(){var S=/^(-?)0([xbo])(?=\w[\w.]*$)/i,_=/^([^.]+)\.$/,p=/^\.([^.]+)$/,v=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(I,N,M,A){var L,D=M?N:N.replace(E,"");if(v.test(D))I.s=isNaN(D)?null:D<0?-1:1;else{if(!M&&(D=D.replace(S,function($,q,G){return L=(G=G.toLowerCase())=="x"?16:G=="b"?2:8,!A||A==L?q:$}),A&&(L=A,D=D.replace(_,"$1").replace(p,"0.$1")),N!=D))return new P(D,L);if(P.DEBUG)throw Error(o+"Not a"+(A?" base "+A:"")+" number: "+N);I.s=null}I.c=I.e=null}}();function X(S,_,p,v){var E,I,N,M,A,L,D,$=S.c,q=h;if($){e:{for(E=1,M=$[0];M>=10;M/=10,E++);if(I=_-E,I<0)I+=u,N=_,A=$[L=0],D=s(A/q[E-N-1]%10);else if(L=i((I+1)/u),L>=$.length)if(v){for(;$.length<=L;$.push(0));A=D=0,E=1,I%=u,N=I-u+1}else break e;else{for(A=M=$[L],E=1;M>=10;M/=10,E++);I%=u,N=I-u+E,D=N<0?0:s(A/q[E-N-1]%10)}if(v=v||_<0||$[L+1]!=null||(N<0?A:A%q[E-N-1]),v=p<4?(D||v)&&(p==0||p==(S.s<0?3:2)):D>5||D==5&&(p==4||v||p==6&&(I>0?N>0?A/q[E-N]:0:$[L-1])%10&1||p==(S.s<0?8:7)),_<1||!$[0])return $.length=0,v?(_-=S.e+1,$[0]=q[(u-_%u)%u],S.e=-_||0):$[0]=S.e=0,S;if(I==0?($.length=L,M=1,L--):($.length=L+1,M=q[u-I],$[L]=N>0?s(A/q[E-N]%q[N])*M:0),v)for(;;)if(L==0){for(I=1,N=$[0];N>=10;N/=10,I++);for(N=$[0]+=M,M=1;N>=10;N/=10,M++);I!=M&&(S.e++,$[0]==l&&($[0]=1));break}else{if($[L]+=M,$[L]!=l)break;$[L--]=0,M=1}for(I=$.length;$[--I]===0;$.pop());}S.e>me?S.c=S.e=null:S.e<Le&&(S.c=[S.e=0])}return S}function fe(S){var _,p=S.e;return p===null?S.toString():(_=C(S.c),_=p<=ae||p>=ye?b(_,p):H(_,p,"0"),S.s<0?"-"+_:_)}return Y.absoluteValue=Y.abs=function(){var S=new P(this);return S.s<0&&(S.s=1),S},Y.comparedTo=function(S,_){return T(this,new P(S,_))},Y.decimalPlaces=Y.dp=function(S,_){var p,v,E,I=this;if(S!=null)return x(S,0,f),_==null?_=ce:x(_,0,8),X(new P(I),S+I.e+1,_);if(!(p=I.c))return null;if(v=((E=p.length-1)-y(this.e/u))*u,E=p[E])for(;E%10==0;E/=10,v--);return v<0&&(v=0),v},Y.dividedBy=Y.div=function(S,_){return V(this,new P(S,_),ne,ce)},Y.dividedToIntegerBy=Y.idiv=function(S,_){return V(this,new P(S,_),0,1)},Y.exponentiatedBy=Y.pow=function(S,_){var p,v,E,I,N,M,A,L,D,$=this;if(S=new P(S),S.c&&!S.isInteger())throw Error(o+"Exponent not an integer: "+fe(S));if(_!=null&&(_=new P(_)),M=S.e>14,!$.c||!$.c[0]||$.c[0]==1&&!$.e&&$.c.length==1||!S.c||!S.c[0])return D=new P(Math.pow(+fe($),M?S.s*(2-O(S)):+fe(S))),_?D.mod(_):D;if(A=S.s<0,_){if(_.c?!_.c[0]:!_.s)return new P(NaN);v=!A&&$.isInteger()&&_.isInteger(),v&&($=$.mod(_))}else{if(S.e>9&&($.e>0||$.e<-1||($.e==0?$.c[0]>1||M&&$.c[1]>=24e7:$.c[0]<8e13||M&&$.c[0]<=9999975e7)))return I=$.s<0&&O(S)?-0:0,$.e>-1&&(I=1/I),new P(A?1/I:I);Ht&&(I=i(Ht/u+2))}for(M?(p=new P(.5),A&&(S.s=1),L=O(S)):(E=Math.abs(+fe(S)),L=E%2),D=new P(Q);;){if(L){if(D=D.times($),!D.c)break;I?D.c.length>I&&(D.c.length=I):v&&(D=D.mod(_))}if(E){if(E=s(E/2),E===0)break;L=E%2}else if(S=S.times(p),X(S,S.e+1,1),S.e>14)L=O(S);else{if(E=+fe(S),E===0)break;L=E%2}$=$.times($),I?$.c&&$.c.length>I&&($.c.length=I):v&&($=$.mod(_))}return v?D:(A&&(D=Q.div(D)),_?D.mod(_):I?X(D,Ht,ce,N):D)},Y.integerValue=function(S){var _=new P(this);return S==null?S=ce:x(S,0,8),X(_,_.e+1,S)},Y.isEqualTo=Y.eq=function(S,_){return T(this,new P(S,_))===0},Y.isFinite=function(){return!!this.c},Y.isGreaterThan=Y.gt=function(S,_){return T(this,new P(S,_))>0},Y.isGreaterThanOrEqualTo=Y.gte=function(S,_){return(_=T(this,new P(S,_)))===1||_===0},Y.isInteger=function(){return!!this.c&&y(this.e/u)>this.c.length-2},Y.isLessThan=Y.lt=function(S,_){return T(this,new P(S,_))<0},Y.isLessThanOrEqualTo=Y.lte=function(S,_){return(_=T(this,new P(S,_)))===-1||_===0},Y.isNaN=function(){return!this.s},Y.isNegative=function(){return this.s<0},Y.isPositive=function(){return this.s>0},Y.isZero=function(){return!!this.c&&this.c[0]==0},Y.minus=function(S,_){var p,v,E,I,N=this,M=N.s;if(S=new P(S,_),_=S.s,!M||!_)return new P(NaN);if(M!=_)return S.s=-_,N.plus(S);var A=N.e/u,L=S.e/u,D=N.c,$=S.c;if(!A||!L){if(!D||!$)return D?(S.s=-_,S):new P($?N:NaN);if(!D[0]||!$[0])return $[0]?(S.s=-_,S):new P(D[0]?N:ce==3?-0:0)}if(A=y(A),L=y(L),D=D.slice(),M=A-L){for((I=M<0)?(M=-M,E=D):(L=A,E=$),E.reverse(),_=M;_--;E.push(0));E.reverse()}else for(v=(I=(M=D.length)<(_=$.length))?M:_,M=_=0;_<v;_++)if(D[_]!=$[_]){I=D[_]<$[_];break}if(I&&(E=D,D=$,$=E,S.s=-S.s),_=(v=$.length)-(p=D.length),_>0)for(;_--;D[p++]=0);for(_=l-1;v>M;){if(D[--v]<$[v]){for(p=v;p&&!D[--p];D[p]=_);--D[p],D[v]+=l}D[v]-=$[v]}for(;D[0]==0;D.splice(0,1),--L);return D[0]?J(S,D,L):(S.s=ce==3?-1:1,S.c=[S.e=0],S)},Y.modulo=Y.mod=function(S,_){var p,v,E=this;return S=new P(S,_),!E.c||!S.s||S.c&&!S.c[0]?new P(NaN):!S.c||E.c&&!E.c[0]?new P(E):(st==9?(v=S.s,S.s=1,p=V(E,S,0,3),S.s=v,p.s*=v):p=V(E,S,0,st),S=E.minus(p.times(S)),!S.c[0]&&st==1&&(S.s=E.s),S)},Y.multipliedBy=Y.times=function(S,_){var p,v,E,I,N,M,A,L,D,$,q,G,te,oe,pe,le=this,de=le.c,Ze=(S=new P(S,_)).c;if(!de||!Ze||!de[0]||!Ze[0])return!le.s||!S.s||de&&!de[0]&&!Ze||Ze&&!Ze[0]&&!de?S.c=S.e=S.s=null:(S.s*=le.s,!de||!Ze?S.c=S.e=null:(S.c=[0],S.e=0)),S;for(v=y(le.e/u)+y(S.e/u),S.s*=le.s,A=de.length,$=Ze.length,A<$&&(te=de,de=Ze,Ze=te,E=A,A=$,$=E),E=A+$,te=[];E--;te.push(0));for(oe=l,pe=d,E=$;--E>=0;){for(p=0,q=Ze[E]%pe,G=Ze[E]/pe|0,N=A,I=E+N;I>E;)L=de[--N]%pe,D=de[N]/pe|0,M=G*L+D*q,L=q*L+M%pe*pe+te[I]+p,p=(L/oe|0)+(M/pe|0)+G*D,te[I--]=L%oe;te[I]=p}return p?++v:te.splice(0,1),J(S,te,v)},Y.negated=function(){var S=new P(this);return S.s=-S.s||null,S},Y.plus=function(S,_){var p,v=this,E=v.s;if(S=new P(S,_),_=S.s,!E||!_)return new P(NaN);if(E!=_)return S.s=-_,v.minus(S);var I=v.e/u,N=S.e/u,M=v.c,A=S.c;if(!I||!N){if(!M||!A)return new P(E/0);if(!M[0]||!A[0])return A[0]?S:new P(M[0]?v:E*0)}if(I=y(I),N=y(N),M=M.slice(),E=I-N){for(E>0?(N=I,p=A):(E=-E,p=M),p.reverse();E--;p.push(0));p.reverse()}for(E=M.length,_=A.length,E-_<0&&(p=A,A=M,M=p,_=E),E=0;_;)E=(M[--_]=M[_]+A[_]+E)/l|0,M[_]=l===M[_]?0:M[_]%l;return E&&(M=[E].concat(M),++N),J(S,M,N)},Y.precision=Y.sd=function(S,_){var p,v,E,I=this;if(S!=null&&S!==!!S)return x(S,1,f),_==null?_=ce:x(_,0,8),X(new P(I),S,_);if(!(p=I.c))return null;if(E=p.length-1,v=E*u+1,E=p[E]){for(;E%10==0;E/=10,v--);for(E=p[0];E>=10;E/=10,v++);}return S&&I.e+1>v&&(v=I.e+1),v},Y.shiftedBy=function(S){return x(S,-9007199254740991,c),this.times("1e"+S)},Y.squareRoot=Y.sqrt=function(){var S,_,p,v,E,I=this,N=I.c,M=I.s,A=I.e,L=ne+4,D=new P("0.5");if(M!==1||!N||!N[0])return new P(!M||M<0&&(!N||N[0])?NaN:N?I:1/0);if(M=Math.sqrt(+fe(I)),M==0||M==1/0?(_=C(N),(_.length+A)%2==0&&(_+="0"),M=Math.sqrt(+_),A=y((A+1)/2)-(A<0||A%2),M==1/0?_="5e"+A:(_=M.toExponential(),_=_.slice(0,_.indexOf("e")+1)+A),p=new P(_)):p=new P(M+""),p.c[0]){for(A=p.e,M=A+L,M<3&&(M=0);;)if(E=p,p=D.times(E.plus(V(I,E,L,1))),C(E.c).slice(0,M)===(_=C(p.c)).slice(0,M))if(p.e<A&&--M,_=_.slice(M-3,M+1),_=="9999"||!v&&_=="4999"){if(!v&&(X(E,E.e+ne+2,0),E.times(E).eq(I))){p=E;break}L+=4,M+=4,v=1}else{(!+_||!+_.slice(1)&&_.charAt(0)=="5")&&(X(p,p.e+ne+2,1),S=!p.times(p).eq(I));break}}return X(p,p.e+ne+1,ce,S)},Y.toExponential=function(S,_){return S!=null&&(x(S,0,f),S++),W(this,S,_,1)},Y.toFixed=function(S,_){return S!=null&&(x(S,0,f),S=S+this.e+1),W(this,S,_)},Y.toFormat=function(S,_,p){var v,E=this;if(p==null)S!=null&&_&&typeof _=="object"?(p=_,_=null):S&&typeof S=="object"?(p=S,S=_=null):p=g;else if(typeof p!="object")throw Error(o+"Argument not an object: "+p);if(v=E.toFixed(S,_),E.c){var I,N=v.split("."),M=+p.groupSize,A=+p.secondaryGroupSize,L=p.groupSeparator||"",D=N[0],$=N[1],q=E.s<0,G=q?D.slice(1):D,te=G.length;if(A&&(I=M,M=A,A=I,te-=I),M>0&&te>0){for(I=te%M||M,D=G.substr(0,I);I<te;I+=M)D+=L+G.substr(I,M);A>0&&(D+=L+G.slice(I)),q&&(D="-"+D)}v=$?D+(p.decimalSeparator||"")+((A=+p.fractionGroupSize)?$.replace(new RegExp("\\d{"+A+"}\\B","g"),"$&"+(p.fractionGroupSeparator||"")):$):D}return(p.prefix||"")+v+(p.suffix||"")},Y.toFraction=function(S){var _,p,v,E,I,N,M,A,L,D,$,q,G=this,te=G.c;if(S!=null&&(M=new P(S),!M.isInteger()&&(M.c||M.s!==1)||M.lt(Q)))throw Error(o+"Argument "+(M.isInteger()?"out of range: ":"not an integer: ")+fe(M));if(!te)return new P(G);for(_=new P(Q),L=p=new P(Q),v=A=new P(Q),q=C(te),I=_.e=q.length-G.e-1,_.c[0]=h[(N=I%u)<0?u+N:N],S=!S||M.comparedTo(_)>0?I>0?_:L:M,N=me,me=1/0,M=new P(q),A.c[0]=0;D=V(M,_,0,1),E=p.plus(D.times(v)),E.comparedTo(S)!=1;)p=v,v=E,L=A.plus(D.times(E=L)),A=E,_=M.minus(D.times(E=_)),M=E;return E=V(S.minus(p),v,0,1),A=A.plus(E.times(L)),p=p.plus(E.times(v)),A.s=L.s=G.s,I=I*2,$=V(L,v,I,ce).minus(G).abs().comparedTo(V(A,p,I,ce).minus(G).abs())<1?[L,v]:[A,p],me=N,$},Y.toNumber=function(){return+fe(this)},Y.toPrecision=function(S,_){return S!=null&&x(S,1,f),W(this,S,_,2)},Y.toString=function(S){var _,p=this,v=p.s,E=p.e;return E===null?v?(_="Infinity",v<0&&(_="-"+_)):_="NaN":(S==null?_=E<=ae||E>=ye?b(C(p.c),E):H(C(p.c),E,"0"):S===10&&R?(p=X(new P(p),ne+E+1,ce),_=H(C(p.c),p.e,"0")):(x(S,2,w.length,"Base"),_=U(H(C(p.c),E,"0"),10,S,v,!0)),v<0&&p.c[0]&&(_="-"+_)),_},Y.valueOf=Y.toJSON=function(){return fe(this)},Y._isBigNumber=!0,k!=null&&P.set(k),P}function y(k){var V=k|0;return k>0||k===V?V:V-1}function C(k){for(var V,U,Z=1,Y=k.length,Q=k[0]+"";Z<Y;){for(V=k[Z++]+"",U=u-V.length;U--;V="0"+V);Q+=V}for(Y=Q.length;Q.charCodeAt(--Y)===48;);return Q.slice(0,Y+1||1)}function T(k,V){var U,Z,Y=k.c,Q=V.c,ne=k.s,ce=V.s,ae=k.e,ye=V.e;if(!ne||!ce)return null;if(U=Y&&!Y[0],Z=Q&&!Q[0],U||Z)return U?Z?0:-ce:ne;if(ne!=ce)return ne;if(U=ne<0,Z=ae==ye,!Y||!Q)return Z?0:!Y^U?1:-1;if(!Z)return ae>ye^U?1:-1;for(ce=(ae=Y.length)<(ye=Q.length)?ae:ye,ne=0;ne<ce;ne++)if(Y[ne]!=Q[ne])return Y[ne]>Q[ne]^U?1:-1;return ae==ye?0:ae>ye^U?1:-1}function x(k,V,U,Z){if(k<V||k>U||k!==s(k))throw Error(o+(Z||"Argument")+(typeof k=="number"?k<V||k>U?" out of range: ":" not an integer: ":" not a primitive number: ")+String(k))}function O(k){var V=k.c.length-1;return y(k.e/u)==V&&k.c[V]%2!=0}function b(k,V){return(k.length>1?k.charAt(0)+"."+k.slice(1):k)+(V<0?"e":"e+")+V}function H(k,V,U){var Z,Y;if(V<0){for(Y=U+".";++V;Y+=U);k=Y+k}else if(Z=k.length,++V>Z){for(Y=U,V-=Z;--V;Y+=U);k+=Y}else V<Z&&(k=k.slice(0,V)+"."+k.slice(V));return k}n=m(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(CJ)})(xV);var MV=xV.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Fi=Yx(),VJ=Ux(),WJ=zx,BJ=MV,Fn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Jf={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:IV,decimalSuffixes:Qp}=Fi.currentBytes(),Gx={general:{scale:1024,suffixes:Qp,marker:"bd"},binary:{scale:1024,suffixes:IV,marker:"b"},decimal:{scale:1e3,suffixes:Qp,marker:"d"}};function jJ(t,e={},n){if(typeof e=="string"&&(e=WJ.parseFormat(e)),!VJ.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",s=e.postfix||"",o=UJ(t,e,n);return o=uQ(o,i),o=cQ(o,s),o}function UJ(t,e,n){switch(e.output){case"currency":return e=dc(e,Fi.currentCurrencyDefaultFormat()),JJ(t,e,Fi);case"percent":return e=dc(e,Fi.currentPercentageDefaultFormat()),ZJ(t,e,Fi,n);case"byte":return e=dc(e,Fi.currentByteDefaultFormat()),qJ(t,e,Fi,n);case"time":return e=dc(e,Fi.currentTimeDefaultFormat()),XJ(t);case"ordinal":return e=dc(e,Fi.currentOrdinalDefaultFormat()),KJ(t,e,Fi);case"number":default:return Qf({instance:t,providedFormat:e,numbro:n})}}function zJ(t){let e=Gx.decimal;return xC(t._value,e.suffixes,e.scale).suffix}function YJ(t){let e=Gx.binary;return xC(t._value,e.suffixes,e.scale).suffix}function GJ(t){let e=Gx.general;return xC(t._value,e.suffixes,e.scale).suffix}function xC(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let s=1;s<e.length;++s){let o=Math.pow(n,s),a=Math.pow(n,s+1);if(i>=o&&i<a){r=e[s],t=t/o;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function qJ(t,e,n,r){let i=e.base||"binary",s=Object.assign({},Jf,e);const{binarySuffixes:o,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Qp,marker:"bd"},binary:{scale:1024,suffixes:o||IV,marker:"b"},decimal:{scale:1e3,suffixes:a||Qp,marker:"d"}}[i],{value:c,suffix:h}=xC(t._value,u.suffixes,u.scale);return`${Qf({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${h}`}function KJ(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Jf,e),s=Qf({instance:t,providedFormat:e,state:n}),o=r(t._value);return`${s}${i.spaceSeparated?" ":""}${o}`}function XJ(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function ZJ(t,e,n,r){let i=e.prefixSymbol,s=Qf({instance:r(t._value*100),providedFormat:e,state:n}),o=Object.assign({},Jf,e);return i?`%${o.spaceSeparated?" ":""}${s}`:`${s}${o.spaceSeparated?" ":""}%`}function JJ(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),s=Object.assign({},Jf,i),o,a="",l=!!s.totalLength||!!s.forceAverage||s.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(o=a+c+a);let d=Qf({instance:t,providedFormat:i,state:n,decimalSeparator:o});return u==="prefix"&&(t._value<0&&s.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&s.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!s.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function QJ({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:s=0,roundingFunction:o=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Fn[e]?(a=r[e],t=t/Fn[e]):l>=Fn.trillion||n&&o(l/Fn.trillion)===1?(a=r.trillion,t=t/Fn.trillion):l<Fn.trillion&&l>=Fn.billion||n&&o(l/Fn.billion)===1?(a=r.billion,t=t/Fn.billion):l<Fn.billion&&l>=Fn.million||n&&o(l/Fn.million)===1?(a=r.million,t=t/Fn.million):(l<Fn.million&&l>=Fn.thousand||n&&o(l/Fn.thousand)===1)&&(a=r.thousand,t=t/Fn.thousand),a&&(a=(i?" ":"")+a),s){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(s-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function eQ({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let s=1;return s<e&&(i=i*Math.pow(10,e-s),r=+r-(e-s),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function Xg(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function tQ(t,e){let n=t.toString(),[r,i]=n.split("e"),[s,o=""]=r.split(".");if(+i>0)n=s+o+Xg(i-o.length);else{let a=".";+s<0?a=`-0${a}`:a=`0${a}`;let l=(Xg(-i-1)+Math.abs(s)+o).substr(0,e);l.length<e&&(l+=Xg(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${Xg(e)}`),n}function nQ(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?tQ(t,e):new BJ(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function rQ(t,e,n,r,i,s){if(r===-1)return t;let o=nQ(e,r,s),[a,l=""]=o.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:o.toString()}function iQ(t,e,n,r){let i=t,[s,o]=i.toString().split(".");if(s.match(/^-?0$/)&&n)return o?`${s.replace("0","")}.${o}`:s.replace("0","");const a=e<0&&s.indexOf("-")===0;if(a&&(s=s.slice(1),i=i.slice(1)),s.length<r){let l=r-s.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function sQ(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function oQ(t,e,n,r,i){let s=r.currentDelimiters(),o=s.thousands;i=i||s.decimal;let a=s.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),sQ(u.length,a).forEach((f,m)=>{u=u.slice(0,f+m)+o+u.slice(f+m)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function aQ(t,e){return t+e}function lQ(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function uQ(t,e){return e+t}function cQ(t,e){return t+e}function Qf({instance:t,providedFormat:e,state:n=Fi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let s=t._value;if(s===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(s))return s.toString();let o=Object.assign({},Jf,i,e),a=o.totalLength,l=a?0:o.characteristic,u=o.optionalCharacteristic,c=o.forceAverage,h=o.lowPrecision,d=!!a||!!c||o.average,f=a?-1:d&&e.mantissa===void 0?0:o.mantissa,m=a?!1:e.optionalMantissa===void 0?f===-1:o.optionalMantissa,y=o.trimMantissa,C=o.thousandSeparated,T=o.spaceSeparated,x=o.negative,O=o.forceSign,b=o.exponential,H=o.roundingFunction,k="";if(d){let U=QJ({value:s,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:T,roundingFunction:H,totalLength:a});s=U.value,k+=U.abbreviation,a&&(f=U.mantissaPrecision)}if(b){let U=eQ({value:s,characteristicPrecision:l});s=U.value,k=U.abbreviation+k}let V=rQ(s.toString(),s,m,f,y,H);return V=iQ(V,s,u,l),V=oQ(V,s,C,n,r),(d||b)&&(V=aQ(V,k)),(O||s<0)&&(V=lQ(V,s,x)),V}function dc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var hQ=t=>({format:(...e)=>jJ(...e,t),getByteUnit:(...e)=>GJ(...e,t),getBinaryByteUnit:(...e)=>YJ(...e,t),getDecimalByteUnit:(...e)=>zJ(...e,t),formatOrDefault:dc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const jo=MV;function dQ(t,e,n){let r=new jo(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new jo(i),t._value=r.plus(i).toNumber(),t}function PV(t,e,n){let r=new jo(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new jo(i),t._value=r.minus(i).toNumber(),t}function fQ(t,e,n){let r=new jo(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new jo(i),t._value=r.times(i).toNumber(),t}function gQ(t,e,n){let r=new jo(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new jo(i),t._value=r.dividedBy(i).toNumber(),t}function mQ(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function pQ(t,e,n){let r=n(t._value);return PV(r,e,n),Math.abs(r._value)}var wQ=t=>({add:(e,n)=>dQ(e,n,t),subtract:(e,n)=>PV(e,n,t),multiply:(e,n)=>fQ(e,n,t),divide:(e,n)=>gQ(e,n,t),set:(e,n)=>mQ(e,n,t),difference:(e,n)=>pQ(e,n,t),BigNumber:jo});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const CQ="2.5.0",Qs=Yx(),yQ=Ux(),vQ=$J(un),bQ=_V();let dl=hQ(un),Wl=wQ(un);const SQ=zx;class OV{constructor(e){this._value=e}clone(){return un(this._value)}format(e={}){return dl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=SQ.parseFormat(e)),e=dl.formatOrDefault(e,Qs.currentCurrencyDefaultFormat()),e.output="currency",dl.format(this,e)}formatTime(e={}){return e.output="time",dl.format(this,e)}binaryByteUnits(){return dl.getBinaryByteUnit(this)}decimalByteUnits(){return dl.getDecimalByteUnit(this)}byteUnits(){return dl.getByteUnit(this)}difference(e){return Wl.difference(this,e)}add(e){return Wl.add(this,e)}subtract(e){return Wl.subtract(this,e)}multiply(e){return Wl.multiply(this,e)}divide(e){return Wl.divide(this,e)}set(e){return Wl.set(this,AV(e))}value(){return this._value}valueOf(){return this._value}}function AV(t){let e=t;return un.isNumbro(t)?e=t._value:typeof t=="string"?e=un.unformat(t):isNaN(t)&&(e=NaN),e}function un(t){return new OV(AV(t))}un.version=CQ;un.isNumbro=function(t){return t instanceof OV};un.language=Qs.currentLanguage;un.registerLanguage=Qs.registerLanguage;un.setLanguage=Qs.setLanguage;un.languages=Qs.languages;un.languageData=Qs.languageData;un.zeroFormat=Qs.setZeroFormat;un.defaultFormat=Qs.currentDefaults;un.setDefaults=Qs.setDefaults;un.defaultCurrencyFormat=Qs.currentCurrencyDefaultFormat;un.validate=yQ.validate;un.loadLanguagesInNode=vQ.loadLanguagesInNode;un.unformat=bQ.unformat;un.BigNumber=Wl.BigNumber;var RQ=un,fl=yJ(RQ);const EQ="numeric";function HV(t,e){if(Jn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!fl.languages()[r]){const s=r.replace("-",""),o=fl.allLanguages?fl.allLanguages[r]:fl[s];o&&fl.registerLanguage(o)}fl.setLanguage(r),t=fl(t).format(i||"0")}return t}function qx(t,e,n,r,i,s,o){let a=s;if(Jn(a)){const l=o.className||"",u=l.length?l.split(" "):[];a=HV(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}Zo(t,e,n,r,i,a,o)}qx.RENDERER_TYPE=EQ;const TQ="password";function Kx(t,e,n,r,i,s,o){Zo.apply(this,[t,e,n,r,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";Re(a-1,()=>{u+=l}),Su(e,u)}Kx.RENDERER_TYPE=TQ;const _Q="select";function Xx(t,e,n,r,i,s,o){Zo.apply(this,[t,e,n,r,i,s,o])}Xx.RENDERER_TYPE=_Q;const xQ="time";function Zx(t,e,n,r,i,s,o){Zo.apply(this,[t,e,n,r,i,s,o]),e.dir="ltr"}Zx.RENDERER_TYPE=xQ;function MQ(){Ur(ch),Ur(Zf),Ur(Wx),Ur(Vx),Ur(jx),Ur($x),Ur(qx),Ur(Kx),Ur(Xx),Ur(Zo),Ur(Zx)}const IQ="autocomplete";function MC(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,zH(n,e)):zH(n,e)(this.source):e(!0)}MC.VALIDATOR_TYPE=IQ;function zH(t,e){const n=t;return function(r){let i=!1;for(let s=0,o=r.length;s<o;s++)if(n===r[s]){i=!0;break}e(i)}}function NV(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const PQ=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:NV},Symbol.toStringTag,{value:"Module"})),OQ="date";function Jx(t,e){const n=u$(yV,this.instance);let r=t,i=!0;r==null&&(r="");let s=ee(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),o=ee(new Date(r)).isValid()||s;if(this.allowEmpty&&r===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=AQ(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}Jx.VALIDATOR_TYPE=OQ;function AQ(t,e){const n=ee(NV(t)),r=ee(t,e),i=t.search(/[A-z]/g)>-1;let s;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?s=n:s=r,s.format(e)}const HQ="dropdown";function Qx(t,e){MC.apply(this,[t,e])}Qx.VALIDATOR_TYPE=HQ;const NQ="numeric";function eM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Jn(t))}eM.VALIDATOR_TYPE=NQ;const DQ=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],LQ="time";function tM(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=ee(i,DQ,!0).isValid()?ee(i):ee(i,n);let a=o.isValid(),l=ee(i,n,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}tM.VALIDATOR_TYPE=LQ;function kQ(){Yl(MC),Yl(Qx),Yl(Jx),Yl(eM),Yl(tM)}const FQ="autocomplete",$Q={CELL_TYPE:FQ,editor:Lx,renderer:ch,validator:MC},VQ="checkbox",WQ={CELL_TYPE:VQ,editor:CV,renderer:Wx},BQ="date";function DV(t,e,n,r,i,s,o){ch.apply(this,[t,e,n,r,i,s,o])}DV.RENDERER_TYPE=BQ;const jQ="date",UQ={CELL_TYPE:jQ,editor:vV,renderer:DV,validator:Jx},zQ="dropdown",YQ={CELL_TYPE:zQ,editor:Fx,renderer:Vx,validator:Qx},GQ="handsontable",qQ={CELL_TYPE:GQ,editor:Dx,renderer:jx},KQ="numeric",XQ={CELL_TYPE:KQ,editor:bV,renderer:qx,validator:eM,dataType:"number"},ZQ="password",JQ={CELL_TYPE:ZQ,editor:SV,renderer:Kx,copyable:!1},QQ="select",eee={CELL_TYPE:QQ,editor:RV,renderer:Xx},tee="time",nee={CELL_TYPE:tee,editor:EV,renderer:Zx,validator:tM};function ree(){oi($Q),oi(WQ),oi(UQ),oi(YQ),oi(qQ),oi(XQ),oi(JQ),oi(eee),oi(mV),oi(nee)}function iee(t,e){LV(t,e),e.add(t)}function see(t,e,n){LV(t,e),e.set(t,n)}function LV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ku(t,e,n){return(e=oee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=aee(t,"string");return typeof e=="symbol"?e:e+""}function aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fu(t,e){return t.get(kV(t,e))}function kV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const YH=new Map([["plugin",G6],["cell-type",sV],["editor",l$],["renderer",p$],["validator",w$]]),FV=Symbol("mainSetting"),lee="base",Zg=[];let ms=null;var gl=new WeakMap,GH=new WeakSet;class rt{static get PLUGIN_KEY(){return lee}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){iee(this,GH),ku(this,"eventManager",new bi(this)),ku(this,"pluginName",null),ku(this,"pluginsInitializedCallbacks",[]),ku(this,"isPluginsReady",!1),ku(this,"enabled",!1),ku(this,"initialized",!1),see(this,gl,{}),Js(this,"hot",e,{writable:!1}),ms=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(s=>{const[o,a]=s.split(":");if(!YH.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);YH.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Zg.push(s)}}if(ms||(ms=kT()),ms.indexOf("UndoRedo")>=0&&ms.splice(ms.indexOf("UndoRedo"),1),ms.indexOf(this.pluginName)>=0&&ms.splice(ms.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ms.length===0){if(Zg.length>0){const i=[`${Zg.join(`
`)}
`,"You have to import and register them manually."].join("");throw Zg.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||We(n))&&r[FV]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(We(n)){var s;return(s=n[e])!==null&&s!==void 0?s:r[e]}return r[e]}addHook(e,n,r){Fu(gl,this)[e]=Fu(gl,this)[e]||[];const i=Fu(gl,this)[e];this.hot.addHook(e,n,r),i.push(n),Fu(gl,this)[e]=i}removeHooks(e){F(Fu(gl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Fu(gl,this);Be(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){F(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=kV(GH,this,uee).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Be(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function uee(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ml(t,e,n){return(e=cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cee(t){var e=hee(t,"string");return typeof e=="symbol"?e:e+""}function hee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let nM=class{constructor(e){ml(this,"hot",null),ml(this,"container",null),ml(this,"injected",!1),ml(this,"rows",[]),ml(this,"columns",[]),ml(this,"samples",null),ml(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),F(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),F(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{F(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(s=>{F(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),o.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{F(i.strings,s=>{const o=s.col,a=e.createElement("th");r.push([o,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),F(r,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{F(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return r.style.width=`${s}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),s=n.createElement("thead"),o=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),K(i,e),r.appendChild(i),{fragment:r,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return K(i,s),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Jg(t,e,n){return(e=dee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dee(t){var e=fee(t,"string");return typeof e=="symbol"?e:e+""}function fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IC{static get SAMPLE_COUNT(){return 3}constructor(e){Jg(this,"samples",null),Jg(this,"dataFactory",null),Jg(this,"customSampleCount",null),Jg(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:IC.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:s,to:o}=typeof r=="number"?{from:r,to:r}:r;return Re(s,o,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return Re(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:We(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Jt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[s]:a}),o.push(u),f.needed-=1)}),i}}function gee(t,e){$V(t,e),e.add(t)}function qH(t,e,n){$V(t,e),e.set(t,n)}function $V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jh(t,e,n){return(e=mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mee(t){var e=pee(t,"string");return typeof e=="symbol"?e:e+""}function pee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ql(t,e){return t.get(Ns(t,e))}function rM(t,e,n){return t.set(Ns(t,e),n),n}function Ns(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("modifyAutoColumnSizeSeed");const xS="autoColumnSize",wee=10,Cee="autoColumnSize";var fc=new WeakMap,Kc=new WeakMap,po=new WeakSet;class Wd extends rt{static get PLUGIN_KEY(){return xS}static get PLUGIN_PRIORITY(){return wee}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),gee(this,po),jh(this,"ghostTable",new nM(this.hot)),jh(this,"samplesGenerator",new IC((n,r)=>{const i=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(n,r);let a="";o.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),jh(this,"inProgress",!1),jh(this,"measuredColumns",0),jh(this,"columnWidthsMap",new Xa),qH(this,fc,[]),qH(this,Kc,[]),this.hot.columnIndexMapper.registerMap(Cee,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Ns(po,this,KH).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[xS]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ns(po,e,bee).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ns(po,e,See).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ns(po,e,Eee).call(e,...i)}),this.addHook("beforeRender",()=>Ns(po,this,vee).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>Ns(po,this,Ree).call(this)),super.enablePlugin()}updatePlugin(){rM(Kc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Ns(po,this,KH).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;Re(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(o,s).forEach((u,c)=>this.ghostTable.addColumn(c,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){mf(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Wd.CALCULATION_STEP,i)},e,n),r=r+Wd.CALCULATION_STEP+1,r<i?s=gf(o):(mf(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[xS];let n=Wd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return We(e)&&(n=e.syncLimit,gT(n)?n=DT(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,zc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,s)=>{const o=ql(fc,this).length;return(o-1<s||ql(fc,this)[s]!==i)&&r.push(this.hot.toVisualColumn(s)),o-1<s?ql(fc,this).push(i):ql(fc,this)[s]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function yee(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||this.samplesGenerator.generateColumnSamples(n,e).forEach((s,o)=>this.ghostTable.addColumn(o,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,r)=>{const i=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function vee(){this.calculateVisibleColumnsWidth(),this.inProgress||(Ns(po,this,yee).call(this,ql(Kc,this)),rM(Kc,this,[]))}function bee(t,e){e||this.recalculateAllColumnsWidth()}function See(t){const e=t.reduce((n,r)=>{let[,i]=r;const s=this.hot.propToCol(i);return Number.isInteger(s)&&n.indexOf(s)===-1&&n.push(s),n},[]);ql(Kc,this).push(...e)}function KH(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function Ree(){rM(fc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function Eee(t){const e=t.reduce((n,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);ql(Kc,this).push(...e)}const Kl={horizontal:"horizontal",vertical:"vertical"};function Tee(t,e,n){let r,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:r,endOfDragCoords:i}}function _ee(t){const e={};return t===!0?(e.directions=Object.keys(Kl),e.autoInsertRow=!0):We(t)?(we(t.autoInsertRow)?t.direction===Kl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,we(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Kl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function xee(t,e){Mee(t,e),e.add(t)}function Mee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $u(t,e,n){return(e=Iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iee(t){var e=Pee(t,"string");return typeof e=="symbol"?e:e+""}function Pee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");const XH="autofill",Oee=20,Aee=["fillHandle"],Hee="insert_row_below",Nee=200;var Vu=new WeakSet;class Dee extends rt{constructor(){super(...arguments),xee(this,Vu),$u(this,"addingStarted",!1),$u(this,"mouseDownOnCellCorner",!1),$u(this,"mouseDragOutside",!1),$u(this,"handleDraggedCells",0),$u(this,"directions",[]),$u(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return XH}static get PLUGIN_PRIORITY(){return Oee}static get SETTING_KEYS(){return[XH,...Aee]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Uh(Vu,this,kee).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Uh(Vu,this,Lee).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Uh(Vu,this,Fee).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:s}]),a=[],l=[],u=[];return F(o,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),F(a,c=>{const h=[];F(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=Tee(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=s.clone(),y=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",f,m,y,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let T=C;const x=C;if(["up","left"].indexOf(c)>-1&&!(x.length===1&&x[0].length===0))if(T=[],c==="up"){const O=d.row-h.row+1,b=O%x.length;for(let H=0;H<O;H++)T.push(x[(H+(x.length-b))%x.length])}else{const O=d.col-h.col+1,b=O%x[0].length;for(let H=0;H<x.length;H++){T.push([]);for(let k=0;k<O;k++)T[H].push(x[H][(k+(x[H].length-b))%x[H].length])}}this.hot.populateFromArray(h.row,h.col,T,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",T,m,y,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Kl.vertical)&&this.directions.includes(Kl.horizontal)){const s=n.getTopStartCorner();(r.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Kl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Kl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Hee,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Nee)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let s=e[2]+1;s<r;s++){for(let l=e[1];l<=e[3];l++){const u=n[s][l];if(!Qt(u))return-1}const o=n[s][e[1]-1],a=n[s][e[3]+1];(!Qt(o)||!Qt(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...qe(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=xn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+en(this.hot.table),i=xn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+ln(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Uh(Vu,this,$ee).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Uh(Vu,this,Vee).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=_ee(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Lee(){this.selectAdjacent()&&this.fillIn()}function kee(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Fee(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function $ee(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Vee(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Wee(t,e){VV(t,e),e.add(t)}function Bee(t,e,n){VV(t,e),e.set(t,n)}function VV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wu(t,e,n){return(e=jee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jee(t){var e=Uee(t,"string");return typeof e=="symbol"?e:e+""}function Uee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zee(t,e,n){return t.set(Ds(t,e),n),n}function iM(t,e){return t.get(Ds(t,e))}function Ds(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const MS="autoRowSize",Yee=40,Gee="autoRowSize";var yf=new WeakMap,wo=new WeakSet;class Bd extends rt{static get PLUGIN_KEY(){return MS}static get PLUGIN_PRIORITY(){return Yee}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Wee(this,wo),Wu(this,"headerHeight",null),Wu(this,"ghostTable",new nM(this.hot)),Wu(this,"samplesGenerator",new IC((n,r)=>{const i=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,r):n===-1&&(o=this.hot.getColHeader(r)),{value:o}})),Wu(this,"inProgress",!1),Wu(this,"measuredRows",0),Wu(this,"rowHeightsMap",new Xa),Bee(this,yf,[]),this.hot.rowIndexMapper.registerMap(Gee,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Ds(wo,this,ZH).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[MS];return e===!0||We(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ds(wo,e,Xee).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ds(wo,e,Zee).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ds(wo,e,Qee).call(e,...i)}),this.addHook("beforeRender",()=>Ds(wo,this,Kee).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>Ds(wo,this,Jee).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Ds(wo,this,ZH).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.renderCall;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}Re(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){mf(s),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Bd.CALCULATION_STEP,i)},e,n),r=r+Bd.CALCULATION_STEP+1,r<i?s=gf(o):(mf(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[MS];let n=Bd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return We(e)&&(n=e.syncLimit,gT(n)?n=DT(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Re(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function qee(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function Kee(){this.calculateVisibleRowsHeight(),this.inProgress||(Ds(wo,this,qee).call(this,iM(yf,this)),zee(yf,this,[]))}function ZH(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Xee(t,e){e||this.recalculateAllRowsHeight()}function Zee(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);iM(yf,this).push(...e)}function Jee(){this.recalculateAllRowsHeight()}function Qee(t){const e=t.reduce((n,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);iM(yf,this).push(...e)}const{getListWithInsertedItems:ete,getListWithRemovedItems:tte}=W$("physicallyIndexed");class nte extends Ru{constructor(){super(e=>e)}insert(e,n){const r=l_(this.indexedValues,n);this.indexedValues=ete(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=tte(this.indexedValues,e);this.indexedValues=a_(n,e),super.remove(e)}}const{getListWithInsertedItems:rte,getListWithRemovedItems:ite}=W$("physicallyIndexed");class ste extends Ru{constructor(){super(e=>e)}insert(e,n){this.indexedValues=rte(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=ite(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function ote(t,e){ate(t,e),e.add(t)}function ate(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lte(t,e,n){return(e=ute(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ute(t){var e=cte(t,"string");return typeof e=="symbol"?e:e+""}function cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hte(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const JH="bindRowsWithHeaders",dte=210,fte="loose",QH=new Map([["loose",nte],["strict",ste]]);var eN=new WeakSet;class gte extends rt{constructor(){super(...arguments),ote(this,eN),lte(this,"headerIndexes",null)}static get PLUGIN_KEY(){return JH}static get PLUGIN_PRIORITY(){return dte}isEnabled(){return!!this.hot.getSettings()[JH]}enablePlugin(){var e;if(this.enabled)return;const n=(e=QH.get(this.getSetting()))!==null&&e!==void 0?e:QH.get(fte);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>hte(eN,this,mte).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function mte(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function pte(t,e){WV(t,e),e.add(t)}function wte(t,e,n){WV(t,e),e.set(t,n)}function WV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tN(t,e,n){return(e=Cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cte(t){var e=yte(t,"string");return typeof e=="symbol"?e:e+""}function yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nN(t,e){return t.get(vc(t,e))}function IS(t,e,n){return t.set(vc(t,e),n),n}function vc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cp="collapsibleColumns",vte=290,bte=["nestedHeaders"],Fc="collapsibleIndicator",rN=cp,iN=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Bu=new WeakMap,zh=new WeakSet;class Ste extends rt{constructor(){super(...arguments),pte(this,zh),tN(this,"nestedHeadersPlugin",null),tN(this,"headerStateManager",null),wte(this,Bu,null)}static get PLUGIN_KEY(){return cp}static get PLUGIN_PRIORITY(){return vte}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[cp,...bte]}isEnabled(){return!!this.hot.getSettings()[cp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||ht("You need to configure the Nested Headers plugin in order to use collapsible headers."),IS(Bu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>vc(zh,this,Tte).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vc(zh,e,_te).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vc(zh,e,Rte).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,s)=>vc(zh,this,Ete).call(this,r,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),IS(Bu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:n,col:o}):this.collapseSection({row:n,col:o}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:rN,relativeToGroup:Za,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rN)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};Re(0,e-1,o=>{const a=n.childNodes[o],l=r.childNodes[o],u=i?i.childNodes[o]:null;Re(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Fc}`);s(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Fc}`),s(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Fc}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=r;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!iN.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Bo(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;F(r,f=>{var m;let{row:y,col:C}=f;const{collapsible:T,isCollapsed:x}=(m=this.headerStateManager.getHeaderSettings(y,C))!==null&&m!==void 0?m:{};if(!T||x&&n==="collapse"||!x&&n==="expand")return i=!1,!1});const s=[],o=[];i&&F(r,f=>{let{row:m,col:y}=f;const{colspanCompensation:C,affectedColumns:T,rollbackModification:x}=this.headerStateManager.triggerNodeModification(n,m,y);C>0&&(o.push(...T),s.push(x))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=dT([...a,...o]):n==="expand"&&(l=Bo(a,f=>!o.includes(f)));const u=iN.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){F(s,f=>{f()});return}this.hot.batchExecution(()=>{F(o,f=>{nN(Bu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&o.includes(m)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,T=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;C!==null&&T!==null&&this.hot.selectCell(C,T)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return nN(Bu,this).getHiddenIndexes()}destroy(){IS(Bu,this,null),super.destroy()}}function Rte(t,e,n){var r;const{collapsible:i,origColspan:s,isCollapsed:o}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Fc}`);if(bu(e,[yi("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),K(u,Fc),e.querySelector("div:first-child").appendChild(u)),_e(u,["collapsed","expanded"]),o?(K(u,"collapsed"),Wa(u,"+"),l&&Pe(e,...yi(!1))):(K(u,"expanded"),Wa(u,"-"),l&&Pe(e,...yi(!0))),l&&Pe(u,...Ka());else{var c;(c=u)===null||c===void 0||c.remove()}}function Ete(t,e){Me(t.target,Fc)&&(Me(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Me(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),_i(t))}function Tte(){this.updatePlugin()}function _te(t,e){e||this.updatePlugin()}function pl(t,e,n){return(e=xte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xte(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ite=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Pte=!1,Ote=!0,Ate=!0;class Hte{constructor(e,n){pl(this,"hot",void 0),pl(this,"sortingStates",new bC),pl(this,"sortEmptyCells",Pte),pl(this,"indicator",Ote),pl(this,"headerAction",Ate),pl(this,"compareFunctionFactory",void 0),pl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){We(e)&&Be(e,(n,r)=>{Ite.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return We(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(we(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function BV(t,e,n){const r=e.locale;return function(i,s){const{sortEmptyCells:o}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof s=="string"&&(s=s.toLocaleLowerCase(r)),i===s?zs:Qt(i)?Qt(s)?zs:o&&t==="asc"?Xt:Zt:Qt(s)?o&&t==="asc"?Zt:Xt:isNaN(i)&&!isNaN(s)?t==="asc"?Zt:Xt:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?Xt:Zt:i>s?t==="asc"?Zt:Xt:zs}}const jV="default";function Nte(t,e,n){return function(r,i){const s=parseFloat(r),o=parseFloat(i),{sortEmptyCells:a}=n;if(s===o||isNaN(s)&&isNaN(o))return zs;if(a){if(Qt(r))return t==="asc"?Xt:Zt;if(Qt(i))return t==="asc"?Zt:Xt}return isNaN(s)?Zt:isNaN(o)?Xt:s<o?t==="asc"?Xt:Zt:s>o?t==="asc"?Zt:Xt:zs}}const Dte="numeric";function Lte(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=n;return function(o,a){const l=Qt(o),u=Qt(a),c=l?i:o,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(s===!1){if(l&&u===!1)return Zt;if(l===!1&&u)return Xt}return d===!1&&f?t==="asc"?Xt:Zt:d&&f===!1?t==="asc"?Zt:Xt:d===!1&&f===!1?BV(t,e,n)(o,a):c===i&&h===r?t==="asc"?Xt:Zt:c===r&&h===i?t==="asc"?Zt:Xt:zs}}const kte="checkbox";function Fte(t,e,n){return KV(t,e.dateFormat,n)}const $te="date";function Vte(t,e,n){return KV(t,e.timeFormat,n)}const Wte="time",{register:eg,getItem:sN,hasItem:Bte}=ss("sorting.compareFunctionFactory"),{register:UV,getItem:jte}=ss("sorting.mainSortComparator");function zV(t){return Bte(t)?sN(t):sN(jV)}eg(kte,Lte);eg($te,Fte);eg(jV,BV);eg(Dte,Nte);eg(Wte,Vte);const zs=0,Xt=-1,Zt=1;function Ute(t,e){const n=jte(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t.sort(n(...i))}const ew="asc",tw="desc",YV="colHeader";function zte(t){if(We(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[ew,tw].includes(n)}function Yte(t){if(t.some(n=>zte(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function oN(t){if(t!==tw)return t===ew?tw:ew}function GV(t){return t.querySelector(`.${YV}`)}function qV(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function sM(t,e,n){return t===-1&&e>=0&&Ba(n)===!1}function KV(t,e,n){return function(r,i){const{sortEmptyCells:s}=n;if(r===i)return zs;if(Qt(r))return Qt(i)?zs:s&&t==="asc"?Xt:Zt;if(Qt(i))return s&&t==="asc"?Zt:Xt;const o=ee(r,e),a=ee(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?Xt:Zt:a.isBefore(o)?t==="asc"?Zt:Xt:zs:Xt:Zt}}const Gte="ascending",qte="descending",XV="indicatorDisabled",ZV="columnSorting",JV="sortAction",QV=new Map([[ew,Gte],[tw,qte]]);function Kte(t,e,n,r){const i=[ZV];if(r&&i.push(JV),n===!1)return i.push(XV),i;const s=t.getSortOrderOfColumn(e);return we(s)&&i.push(QV.get(s)),i}function Xte(){return Array.from(QV.values()).concat(JV,XV,ZV)}function Zte(t,e){return function(n,r){const[,...i]=n,[,...s]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:zV(u.type))(l,u,d)(c,h)}(0)}}function Jte(t,e){Qte(t,e),e.add(t)}function Qte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qg(t,e,n){return(e=ene(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ene(t){var e=tne(t,"string");return typeof e=="symbol"?e:e+""}function tne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nw="columnSorting",nne=50,rw="append",rne="replace",aN=nw;UV(nw,Zte);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var Bl=new WeakSet;class eW extends rt{constructor(){super(...arguments),Jte(this,Bl),Qg(this,"columnStatesManager",null),Qg(this,"columnMetaCache",null),Qg(this,"pluginKey",nw),Qg(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return nw}static get PLUGIN_PRIORITY(){return nne}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new Hte(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Xa(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>gc(Bl,this,ine).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gc(Bl,e,one).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>gc(Bl,this,WE).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gc(Bl,e,sne).call(e,...r)}),this.hot.view&&gc(Bl,this,WE).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=GV(r);qV(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Za,position:"before",group:aN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aN)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new B$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return we(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Yte(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};n.initialConfig=qe(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return we(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=qe(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(we(n)){const i=oN(n);return we(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:oN()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(Ft(o))return[...s.slice(0,r),...s.slice(r+1)];if(n===rw)return[...s.slice(0,r),...s.slice(r+1),o];if(n===rne)return[...s.slice(0,r),o,...s.slice(r+1)]}return we(o)?s.concat(o):s}getPluginColumnConfig(e){if(We(e)){const n=e[this.pluginKey];if(We(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(r,n,this.getPluginColumnConfig(s.columns[e])):Tt(s.columns)?Object.assign(r,n,this.getPluginColumnConfig(s.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>qe(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=qe(n,u=>u[0]);Ute(n,this.pluginKey,qe(e,u=>u.sortOrder),qe(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const o=qe(n,u=>u[0]),a=new Map(qe(s,(u,c)=>[u,o[c]])),l=qe(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(We(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||We(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(_e(e,Xte()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];K(e,Kte(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),we(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Me(e.target,YV)}onAfterOnCellMouseDown(e,n){if(sM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function WE(){const t=this.getAllSavedSortSettings();if(We(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function ine(t,e){const n=GV(e);if(qV(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,s=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);Pe(e,...C3(o?`${o}ending`:"none"))}}function sne(t){t===!0&&this.hot.view&&gc(Bl,this,WE).call(this)}function one(t,e,n,r){sM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function wl(t,e,n){return(e=ane(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ane(t){var e=lne(t,"string");return typeof e=="symbol"?e:e+""}function lne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class une{constructor(e,n){wl(this,"plugin",void 0),wl(this,"hot",void 0),wl(this,"endpoints",[]),wl(this,"settings",void 0),wl(this,"settingsType","array"),wl(this,"currentEndpoint",null),wl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),F(r,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),n.push(s)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();F(s,o=>{i==="row"&&o.destinationRow>=n&&(e==="insert_row"?o.alterRowOffset=r:e==="remove_row"&&(o.alterRowOffset=-1*r)),i==="col"&&o.destinationColumn>=n&&(e==="insert_col"?o.alterColumnOffset=r:e==="remove_col"&&(o.alterColumnOffset=-1*r))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,n,r,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;F(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?F(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):F(u,d=>{this.shiftEndpointCoordinates(d,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){F(e.ranges,s=>{s[1]&&(n>=s[0]&&n<=s[1]?r>s[1]?s[1]+=i:r<s[0]&&(s[0]-=i):r>=s[0]&&r<=s[1]&&(s[1]-=i,n<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];F(n,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),F(i,s=>{let o=[];F(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),r.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),r.push(o))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,F(e.ranges,r=>{F(r,(i,s)=>{i>=n&&(r[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],F(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],F(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],F(e,(r,i,s)=>{`${r[2]||""}`!=`${r[3]}`&&F(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),F(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(n==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){ht("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function PS(t){return t==null||isNaN(t)}function cne(t,e){hne(t,e),e.add(t)}function hne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dne(t,e,n){return(e=fne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fne(t){var e=gne(t,"string");return typeof e=="symbol"?e:e+""}function gne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function em(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OS="columnSummary",mne=220;var Yh=new WeakSet;class pne extends rt{constructor(){super(...arguments),cne(this,Yh),dne(this,"endpoints",null)}static get PLUGIN_KEY(){return OS}static get PLUGIN_PRIORITY(){return mne}isEnabled(){return!!this.hot.getSettings()[OS]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[OS],this.endpoints=new une(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return em(Yh,e,wne).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return em(Yh,e,yne).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return em(Yh,e,Cne).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return em(Yh,e,vne).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Be(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,n),s=PS(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}r+=s||0,i-=1}while(i>=e[0]);return Math.round(r*10**o)/10**o}calculateMinMax(e,n){let r=null;return Be(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&s!==null&&(r=s),s!==null)switch(n){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,n),o=PS(o)?null:o,i===null)i=o;else if(o!==null)switch(r){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,n){let r,i=0,s=e[1]||e[0];do r=this.getCellValue(s,n),r=PS(r)?null:r,r===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Be(r,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);n+=s,n-=o}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let s=this.hot.getSourceDataAtCell(e,n),o="";if(r!==null&&i!==null&&(o=this.hot.getCellMeta(r,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(pt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function wne(){this.endpoints.initEndpoints()}function Cne(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function yne(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function vne(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function bne(t,e){tW(t,e),e.add(t)}function AS(t,e,n){tW(t,e),e.set(t,n)}function tW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mc(t,e){return t.get(oM(t,e))}function BE(t,e,n){return t.set(oM(t,e),n),n}function oM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var iw=new WeakMap,tm=new WeakMap,nm=new WeakMap,lN=new WeakSet;class nW{constructor(){bne(this,lN),AS(this,iw,!0),AS(this,tm,null),AS(this,nm,new ResizeObserver(e=>oM(lN,this,Sne).call(this,e)))}setObservedElement(e){BE(tm,this,e)}unobserve(){mc(nm,this).unobserve(mc(tm,this))}observe(){BE(iw,this,!0),mc(nm,this).observe(mc(tm,this))}destroy(){mc(nm,this).disconnect()}}function Sne(t){if(mc(iw,this)||!Array.isArray(t)||!t.length){BE(iw,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}wt(nW,Wn);function Cl(t,e,n){Rne(t,e),e.set(t,n)}function Rne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yt(t,e){return t.get(rW(t,e))}function co(t,e,n){return t.set(rW(t,e),n),n}function rW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yl=new WeakMap,HS=new WeakMap,ho=new WeakMap,ea=new WeakMap,ta=new WeakMap,rm=new WeakMap,ju=new WeakMap;class Xl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;Cl(this,yl,void 0),Cl(this,HS,!1),Cl(this,ho,null),Cl(this,ea,void 0),Cl(this,ta,void 0),Cl(this,rm,!0),Cl(this,ju,new nW),co(yl,this,e),co(HS,this,n),co(ea,this,this.createEditor()),co(ta,this,yt(ea,this).style),yt(ju,this).setObservedElement(this.getInputElement()),yt(ju,this).addLocalHook("resize",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){yt(ta,this).left=`${e}px`,yt(ta,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:ln(this.getInputElement()),height:en(this.getInputElement())}}observeSize(){yt(ju,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){yt(ta,this).display="block",co(rm,this,!1)}hide(){yt(ju,this).unobserve(),yt(rm,this)||(yt(ta,this).display="none"),co(rm,this,!0)}isVisible(){return yt(ta,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return yt(yl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=yt(yl,this).createElement("div"),n=yt(yl,this).createElement("textarea");return e.style.display="none",co(ho,this,yt(yl,this).createElement("div")),yt(ho,this).setAttribute("dir",yt(HS,this)?"rtl":"ltr"),K(yt(ho,this),Xl.CLASS_EDITOR_CONTAINER),yt(yl,this).body.appendChild(yt(ho,this)),K(e,Xl.CLASS_EDITOR),K(n,Xl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),yt(ho,this).appendChild(e),e}getInputElement(){return yt(ea,this).querySelector(`.${Xl.CLASS_INPUT}`)}getEditorElement(){return yt(ea,this)}destroy(){const e=yt(ho,this)?yt(ho,this).parentNode:null;yt(ea,this).parentNode.removeChild(yt(ea,this)),co(ea,this,null),co(ta,this,null),yt(ju,this).destroy(),e&&e.removeChild(yt(ho,this))}}wt(Xl,Wn);function NS(t,e,n){return(e=Ene(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ene(t){var e=Tne(t,"string");return typeof e=="symbol"?e:e+""}function Tne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _ne=250,xne=250;class iW{constructor(e){NS(this,"wasLastActionShow",!0),NS(this,"showDebounced",null),NS(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},xne)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_ne;this.showDebounced=hC(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}wt(iW,Wn);function Mne(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Ine(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function vl(t,e){const n={};return F(t,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&(n[i]||(n[i]=[]),n[i][s]=e(i,s))})}),n}function ga(t,e,n,r,i){F(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&Pne(o,a,e,n,r,i)})})}function Pne(t,e,n,r,i,s){const o=i(t,e);let a=r;o.className&&(n==="vertical"?a=Mne(o.className,r):a=Ine(o.className,r)),s(t,e,"className",a)}function sW(t){return`<span class="selected">✓</span>${t}`}function hp(t,e){let n=!1;return Array.isArray(t)&&F(t,r=>(r.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return n=!0,!1}),n)),n}function PC(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:s}=r.getBoundingClientRect();n.top=i,n.left=s}return n}const Ve="---------";function One(){return{name:Ve}}const hi="alignment";function Ane(){return{key:hi,name(){return this.getTranslatedPhrase(H_)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${hi}:left`,name(){return this.getTranslatedPhrase(N_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,s)=>this.getCellMeta(i,s).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${hi}:center`,name(){return this.getTranslatedPhrase(D_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,s)=>this.getCellMeta(i,s).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${hi}:right`,name(){return this.getTranslatedPhrase(L_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,s)=>this.getCellMeta(i,s).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${hi}:justify`,name(){return this.getTranslatedPhrase(k_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,s)=>this.getCellMeta(i,s).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:Ve},{key:`${hi}:top`,name(){return this.getTranslatedPhrase(F_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,s)=>this.getCellMeta(i,s).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${hi}:middle`,name(){return this.getTranslatedPhrase($_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,s)=>this.getCellMeta(i,s).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${hi}:bottom`,name(){return this.getTranslatedPhrase(V_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,s)=>this.getCellMeta(i,s).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const OC="clear_column";function Hne(){return{key:OC,name(){return this.getTranslatedPhrase(y_)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const tg="col_left";function Nne(){return{key:tg,name(){return this.getTranslatedPhrase(f_)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const ng="col_right";function Dne(){return{key:ng,name(){return this.getTranslatedPhrase(g_)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const rg="make_read_only";function Lne(){return{key:rg,checkable:!0,ariaChecked(){return hp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(qp)},name(){let t=this.getTranslatedPhrase(qp);return hp(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=sW(t)),t},callback(){const t=this.getSelectedRange(),e=hp(t,(n,r)=>this.getCellMeta(n,r).readOnly);F(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const AC="redo";function kne(){return{key:AC,name(){return this.getTranslatedPhrase(C_)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const ig="remove_col";function Fne(){return{key:ig,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(p_,e)},callback(){this.alter("remove_col",d8(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const HC="remove_row";function $ne(){return{key:HC,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(m_,e)},callback(){this.alter("remove_row",f8(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const NC="row_above";function Vne(){return{key:NC,name(){return this.getTranslatedPhrase(h_)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const DC="row_below";function Wne(){return{key:DC,name(){return this.getTranslatedPhrase(d_)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const vf="no_items";function Bne(){return{key:vf,name(){return this.getTranslatedPhrase(c_)},disabled:!0,isCommand:!1}}const LC="undo";function jne(){return{key:LC,name(){return this.getTranslatedPhrase(w_)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Une=[NC,DC,tg,ng,OC,HC,ig,LC,AC,rg,hi,Ve,vf],zne={[Ve]:One,[vf]:Bne,[NC]:Vne,[DC]:Wne,[tg]:Nne,[ng]:Dne,[OC]:Hne,[HC]:$ne,[ig]:Fne,[LC]:jne,[AC]:kne,[rg]:Lne,[hi]:Ane};function oW(){const t={};return Be(zne,(e,n)=>{t[n]=e()}),t}function Yne(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(P_):this.getTranslatedPhrase(I_)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Gne(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(O_)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function qne(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(A_);return hp(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,dp))?sW(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,dp);t.updateCommentMeta(n,r,{[dp]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Kne(t,e){aW(t,e),e.add(t)}function Uu(t,e,n){aW(t,e),e.set(t,n)}function aW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xne(t,e,n){return(e=Zne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zne(t){var e=Jne(t,"string");return typeof e=="symbol"?e:e+""}function Jne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ia(t,e,n){return t.set(ai(t,e),n),n}function Ge(t,e){return t.get(ai(t,e))}function ai(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sw="comments",Qne=60,Ro="comment",Td="value",lW="style",dp="readOnly",im=sw,jE=`plugin:${sw}`;var Rt=new WeakMap,Os=new WeakMap,kC=new WeakMap,fp=new WeakMap,UE=new WeakMap,ow=new WeakMap,Oi=new WeakSet;class ere extends rt{constructor(){super(...arguments),Kne(this,Oi),Xne(this,"range",{}),Uu(this,Rt,null),Uu(this,Os,null),Uu(this,kC,!1),Uu(this,fp,!1),Uu(this,UE,null),Uu(this,ow,"")}static get PLUGIN_KEY(){return sw}static get PLUGIN_PRIORITY(){return Qne}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[sw]}enablePlugin(){var e=this;this.enabled||(Ge(Rt,this)||(Ia(Rt,this,new Xl(this.hot.rootDocument,this.hot.isRtl())),Ge(Rt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ai(Oi,e,are).call(e,...r)})),Ge(Os,this)||Ia(Os,this,new iW(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,s,o,a)=>ai(Oi,this,ire).call(this,n,a)),this.addHook("afterScroll",()=>ai(Oi,this,ure).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>ai(Oi,this,lre).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ai(Oi,e,cre).call(e,...r)}),Ge(Os,this).addLocalHook("hide",()=>this.hide()),Ge(Os,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ge(Os,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(jE);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Ia(fp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(jE),this.hot._registerTimeout(()=>{Ia(fp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:im}),r.addShortcut({keys:[["Escape"]],callback:()=>{Ge(Rt,this).setValue(Ge(ow,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ge(Rt,this).isVisible()&&Ge(Rt,this).isFocused(),group:im}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ge(Rt,this).isVisible()&&Ge(Rt,this).isFocused(),group:im})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(im)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>ai(Oi,this,nre).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>ai(Oi,this,tre).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>ai(Oi,this,rre).call(this)),this.eventManager.addEventListener(n,"focus",()=>ai(Oi,this,ore).call(this)),this.eventManager.addEventListener(n,"blur",()=>ai(Oi,this,sre).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Va(e.target,"TD","TBODY");return!!(n&&Me(n,"htCommentCell")&&Va(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Ge(Rt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[Td]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ro),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Td)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Td)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ge(Os,this).cancelHiding(),Ge(Rt,this).setValue((e=i[Ro]?i[Ro][Td]:null)!==null&&e!==void 0?e:""),Ge(Rt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Ge(Rt,this).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Ge(Rt,this).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(o),u=s.getRenderableFromVisualIndex(a);const c=l===null;Ge(Rt,this).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1))),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:y}=m,C=m.getCell({row:l,col:u},!0),T=this.getCommentMeta(o,a,lW);T?Ge(Rt,this).setSize(T.width,T.height):Ge(Rt,this).resetSize();const x=d?0:y.getColumnWidth(u),O=c&&!h?en(C):0,{left:b,top:H,width:k,height:V}=C.getBoundingClientRect(),{width:U,height:Z}=Ge(Rt,this).getSize(),{innerWidth:Y,innerHeight:Q}=this.hot.rootWindow,ne=this.hot.rootDocument.documentElement;let ce=b+f.scrollX+x,ae=H+f.scrollY+O;this.hot.isRtl()&&(ce-=U+x),this.hot.isLtr()&&b+k+U>Y?ce=b+f.scrollX-U-1:this.hot.isRtl()&&ce<-(ne.scrollWidth-ne.clientWidth)&&(ce=b+f.scrollX+x+1),H+Z>Q&&(ae-=Z-V+1),Ge(Rt,this).setPosition(ce,ae),Ge(Rt,this).setReadOnlyState(this.getCommentMeta(o,a,dp)),Ge(Rt,this).observeSize()}focusEditor(){Ge(Rt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Ro];let s;i?(s=sr(i),zf(s,r)):s=r,this.hot.setCellMeta(e,n,Ro,s)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Ro])return i[Ro][r]}addToContextMenu(e){e.items.push({name:Ve},Yne(this),Gne(this),qne(this))}getEditorInputElement(){return Ge(Rt,this).getInputElement()}destroy(){var e,n;(e=Ge(Rt,this))===null||e===void 0||e.destroy(),(n=Ge(Os,this))===null||n===void 0||n.destroy(),super.destroy()}}function tre(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Ge(kC,this)&&!this.targetIsCommentTextArea(t)){const e=Va(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function nre(t){const{rootDocument:e}=this.hot;if(!(Ge(kC,this)||Ge(Rt,this).isFocused()||Me(t.target,"wtBorder")||Ge(UE,this)===t.target||!Ge(Rt,this)))if(Ia(UE,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Ge(Os,this).show(n)}else Na(t.target,e)&&!this.targetIsCommentTextArea(t)&&Ge(Os,this).hide()}function rre(){Ia(kC,this,!1)}function ire(t,e){e[Ro]&&e[Ro][Td]&&K(t,e.commentedCellClassName)}function sre(){Ia(ow,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function ore(){Ia(ow,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(jE)}function are(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[lW]:{width:t,height:e}})}function lre(t){Ge(Rt,this).isFocused()&&_i(t)}function ure(){Ge(fp,this)||this.hide()}function cre(){const t=Ge(Rt,this).getEditorElement();_e(t,/ht-theme-.*/g),K(t,this.hot.getCurrentThemeName())}var uN={},DS,cN;function hre(){if(cN)return DS;cN=1;var t=zw(),e=TypeError;return DS=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},DS}var hN;function dre(){if(hN)return uN;hN=1;var t=Mt(),e=Zc(),n=Qc(),r=dk(),i=hre(),s=fk(),o=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){s(d+f);for(var m=d;m--;){var y=m+f;m in h?h[y]=h[m]:i(h,y)}for(var C=0;C<f;C++)h[C]=arguments[C]}return r(h,d+f)}}),uN}dre();function LS(t,e,n){return(e=fre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fre(t){var e=gre(t,"string");return typeof e=="symbol"?e:e+""}function gre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uW{constructor(e){LS(this,"hot",void 0),LS(this,"commands",{}),LS(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=mre(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||dn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(s.join(":")),F(u,c=>c.apply(this.hot,r))}}function mre(t,e){let n;return F(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function kS(t,e,n){return(e=pre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pre(t){var e=wre(t,"string");return typeof e=="symbol"?e:e+""}function wre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cW{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;kS(this,"hot",void 0),kS(this,"predefinedItems",oW()),kS(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Be(e,(r,i)=>{let s="";r.name===Ve?(n[Ve]=r,s=Ve):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,s=r.key):(n[r.key]=r,s=r.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Cre(e,this.defaultOrderPattern,this.predefinedItems)}}function Cre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),We(i)?Be(i,(s,o)=>{let a=n[typeof s=="string"?s:o];a||(a=s),We(s)?fn(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),r.push(a)}):F(i,(s,o)=>{let a=n[s];!a&&Une.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),We(s)&&fn(a,s),a.key===void 0&&(a.key=o),r.push(a))}),r}function na(t,e,n){return(e=yre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yre(t){var e=vre(t,"string");return typeof e=="symbol"?e:e+""}function vre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bre{constructor(e,n){na(this,"top",void 0),na(this,"topRelative",void 0),na(this,"left",void 0),na(this,"leftRelative",void 0),na(this,"scrollTop",void 0),na(this,"scrollLeft",void 0),na(this,"cellHeight",void 0),na(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let s,o,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,o=s,l=a,s+=r,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,o=s-r,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Gh(t,e,n){Sre(t,e),e.set(t,n)}function Sre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(hW(t,e))}function sm(t,e,n){return t.set(hW(t,e),n),n}function hW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cr=new WeakMap,ps=new WeakMap,Tr=new WeakMap,FS=new WeakMap,zu=new WeakMap;class Rre{constructor(e){Gh(this,cr,void 0),Gh(this,ps,void 0),Gh(this,Tr,void 0),Gh(this,FS,!1),Gh(this,zu,{above:0,below:0,left:0,right:0}),sm(FS,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ye(zu,this)[e]=n,this}setElement(e){return sm(cr,this,e),this}setParentElement(e){return sm(ps,this,e),this}updatePosition(e){sm(Tr,this,new bre(e,Ye(cr,this).ownerDocument.defaultView)),Ye(FS,this)?(Ye(Tr,this).fitsBelow(Ye(cr,this))?this.setPositionBelowCursor():Ye(Tr,this).fitsAbove(Ye(cr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ye(cr,this).dir==="rtl"?Ye(Tr,this).fitsOnLeft(Ye(cr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ye(Tr,this).fitsOnRight(Ye(cr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ye(zu,this).above+Ye(Tr,this).top-Ye(cr,this).offsetHeight;Ye(ps,this)&&(e=Ye(Tr,this).top+Ye(Tr,this).cellHeight-Ye(cr,this).offsetHeight+3),Ye(cr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Ye(zu,this).below+Ye(Tr,this).top+1;Ye(ps,this)&&(e=Ye(Tr,this).top-1),Ye(cr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ye(Tr,this).left;if(Ye(ps,this)){const n=Ye(ps,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ye(ps,this).querySelector(".htCore")).borderRightWidth,10);e+=Ye(Tr,this).cellWidth+r}else e+=Ye(zu,this).right;Ye(cr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ye(zu,this).left+Ye(Tr,this).left-Ye(cr,this).offsetWidth;if(Ye(ps,this)){const n=Ye(ps,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ye(ps,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Ye(cr,this).style.left=`${e}px`}}function dW(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const s=new Set;let o=Je(e,-1,m()-1);function a(C,T){const x=m()-1;return C<0&&(C=x),C>x&&(C=0),s.has(C)?-1:(s.add(C),r(C,!1)===!1&&(C=a(T===1?++C:--C,T)),C)}function l(C){C>-1&&C<m()&&r(C,!0)!==!1&&(o=C)}function u(){return o}function c(){m()>0&&(s.clear(),o=a(0,1))}function h(){m()>0&&(s.clear(),o=a(m()-1,-1))}function d(){m()>0&&(s.clear(),o=a(++o,1))}function f(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(n(),0)}function y(){s.clear(),o=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:m,clear:y}}function Ere(t){return qe(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function zE(t){return dn(t,"submenu")}function YE(t){return new RegExp(Ve,"i").test(t.name)}function gp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function dN(t){return dn(t,"disableSelection")}function Tre(t){return Me(t,"htSeparator")}function _re(t){return Me(t,"htSubmenu")}function xre(t){return Me(t,"htDisabled")}function Mre(t){return Me(t,"htSelectionDisabled")}function Ire(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function fW(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Pre(t,e){let n=t.slice(0);return n.reverse(),n=fW(n,e),n.reverse(),n}function Ore(t){const e=[];return F(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Are(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ve,n=t.slice(0);return n=fW(n,e),n=Pre(n,e),n=Ore(n),n}function Hre(t){return t.checkable===!0}function Nre(t){return dW({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Tre(r)||xre(r)||Mre(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Dre(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(r):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const gW="menu",fN=gW;function Lre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Dre(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:gW})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function s(){return[...n]}function o(u){return u?`${fN}:${u}`:fN}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=o(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function kre(t){return(e,n,r,i,s,o)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof o=="function"?o.call(t):o,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Qi(n),K(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!gp(a,t)&&!dN(a)&&!YE(a);Pe(n,[...Hre(a)?[u3(),$p(c),PF(h)]:[l3(),$p(u)],...d?[sh(-1)]:[],...gp(a,t)?[p3()]:[],...zE(a)?[yi(!1)]:[]])}n.className="",n.appendChild(l),YE(a)?K(n,"htSeparator"):typeof a.renderer=="function"?(K(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,s,u))):Su(l,u),gp(a,t)?K(n,"htDisabled"):dN(a)?K(n,"htSelectionDisabled"):zE(a)&&K(n,"htSubmenu")}}function $S(t,e,n){Fre(t,e),e.set(t,n)}function Fre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ws(t,e,n){return(e=$re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $re(t){var e=Vre(t,"string");return typeof e=="symbol"?e:e+""}function Vre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VS(t,e,n){return t.set(mW(t,e),n),n}function bl(t,e){return t.get(mW(t,e))}function mW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gN=215;var qh=new WeakMap,om=new WeakMap,am=new WeakMap;class hh{get tableBorderWidth(){return bl(am,this)===void 0&&this.hotMenu&&VS(am,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),bl(am,this)}constructor(e,n){var r=this;ws(this,"hot",void 0),ws(this,"options",void 0),ws(this,"eventManager",new bi(this)),ws(this,"container",void 0),ws(this,"positioner",void 0),ws(this,"hotMenu",null),ws(this,"hotSubMenus",{}),ws(this,"parentMenu",void 0),ws(this,"menuItems",null),ws(this,"origOutsideClickDeselects",null),$S(this,qh,void 0),$S(this,om,void 0),$S(this,am,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:gN,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Rre(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(i,s)=>{if(!s){var o;(o=this.hotMenu)===null||o===void 0||o.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=su(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return bl(qh,this)}getKeyboardShortcutsCtrl(){return bl(om,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=hC(a=>this.openSubMenu(a),300),n=this.options.minWidth||gN;let r=!1,i=Bo(this.menuItems,a=>(a.key===vf&&(r=!0),Ire(a,this.hot)));if(i.length<1&&!r)i.push(oW()[vf]);else if(i.length===0)return;i=Are(i,Ve);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return we(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:kre(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(a,l)=>{bl(qh,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===Ve?1:void 0,afterOnCellContextMenu:a=>{a.preventDefault(),RE()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!RE()||!Ba(a))&&s&&this.hasSelectedItem()&&(Ho()||OT()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),VS(qh,this,Nre(this.hotMenu)),VS(om,this,Lre(this)),bl(om,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(bl(qh,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Pe(r,[yi(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!_re(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new hh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Pe(n,[yi(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Pe(i,[yi(!1)])}}closeAllSubMenus(){F(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Ere(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||YE(e)||gp(e,this.hot)||zE(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,s=parseInt(r.width,10),o=mn(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?en(this.hotMenu.getCell(u,0)):0;return a+(l.name===Ve?1:h)},0);i.width=`${s}px`,i.height=`${o}px`,r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(Tt(r)&&(r=r.call(this.hot),r===null||Ft(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),K(i,`htMenu ${this.options.className}`),r&&K(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Pe(this.hotMenu.rootElement,[a3(),sh(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Na(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Na(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Me(e.target,"htCore")&&Na(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}wt(hh,Wn);function Wre(t,e){Bre(t,e),e.add(t)}function Bre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WS(t,e,n){return(e=jre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jre(t){var e=Ure(t,"string");return typeof e=="symbol"?e:e+""}function Ure(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _d="contextMenu",zre=70,mN=_d;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var Kh=new WeakSet;class FC extends rt{constructor(){super(...arguments),Wre(this,Kh),WS(this,"commandExecutor",new uW(this.hot)),WS(this,"itemsFactory",null),WS(this,"menu",null)}static get PLUGIN_KEY(){return _d}static get PLUGIN_PRIORITY(){return zre}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[NC,DC,Ve,tg,ng,Ve,HC,ig,Ve,LC,AC,Ve,rg,Ve,hi]}isEnabled(){return!!this.hot.getSettings()[_d]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[_d];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new hh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>lm(Kh,this,Gre).call(this)),this.menu.addLocalHook("afterOpen",()=>lm(Kh,this,qre).call(this)),this.menu.addLocalHook("afterClose",()=>lm(Kh,this,Kre).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>lm(Kh,this,Yre).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=PC(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:mN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mN)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(r.below+=1,r.right+=1,r.above-=1,r.left-=1),Be(r,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new cW(this.hot,FC.DEFAULT_ITEMS);const e=this.hot.getSettings()[_d],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),F(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Yre(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),Me(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(s)&&!(Me(s,"current")&&Me(s,"wtBorder"))))return;const o=PC(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function Gre(){this.hot.runHooks("beforeContextMenuShow",this)}function qre(){this.hot.runHooks("afterContextMenuShow",this)}function Kre(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}FC.SEPARATOR={name:Ve};function Xre(t){return{key:"copy",name(){return this.getTranslatedPhrase(v_)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Zre(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(R_,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Jre(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(S_,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Qre(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(b_,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function eie(t){return{key:"cut",name(){return this.getTranslatedPhrase(E_)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class tie{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class nie{constructor(){this.clipboardData=new tie}preventDefault(){}}function rie(t,e){pW(t,e),e.add(t)}function Yu(t,e,n){pW(t,e),e.set(t,n)}function pW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(t,e){return t.get(bc(t,e))}function Gu(t,e,n){return t.set(bc(t,e),n),n}function bc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ra=new WeakMap,BS=new WeakMap,Xh=new WeakMap,GE=new WeakMap,qE=new WeakMap,Zh=new WeakMap,Jh=new WeakSet;class iie{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;rie(this,Jh),Yu(this,ra,void 0),Yu(this,BS,void 0),Yu(this,Xh,void 0),Yu(this,GE,void 0),Yu(this,qE,void 0),Yu(this,Zh,void 0),Gu(BS,this,n),Gu(Xh,this,r),Gu(GE,this,i),Gu(qE,this,s),Gu(Zh,this,o)}setSelectedRange(e){Gu(ra,this,e)}getCellsRange(){if(gr(BS,this).call(this)===0||gr(Xh,this).call(this)===0)return null;const{row:e,col:n}=gr(ra,this).getTopStartCorner(),{row:r,col:i}=gr(ra,this).getBottomEndCorner(),s=bc(Jh,this,sie).call(this,e,r),o=bc(Jh,this,jS).call(this,n,i);return{isRangeTrimmed:r!==s||i!==o,startRow:e,startCol:n,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(gr(Xh,this).call(this)===0||gr(Zh,this).call(this)===0)return null;const{col:e}=gr(ra,this).getTopStartCorner(),{col:n}=gr(ra,this).getBottomEndCorner(),r=bc(Jh,this,jS).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(gr(Xh,this).call(this)===0||gr(Zh,this).call(this)===0)return null;const{col:e}=gr(ra,this).getTopStartCorner(),{col:n}=gr(ra,this).getBottomEndCorner(),r=bc(Jh,this,jS).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-gr(Zh,this).call(this),startCol:e,endRow:-1,endCol:r}}}function jS(t,e){return Math.min(e,Math.max(t+gr(qE,this).call(this)-1,t))}function sie(t,e){return Math.min(e,Math.max(t+gr(GE,this).call(this)-1,t))}function wW(t){const e=[],n=[];return F(t,r=>{const i=Math.min(r.startRow,r.endRow),s=Math.max(r.startRow,r.endRow);Re(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);Re(o,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function oie(t,e){CW(t,e),e.add(t)}function ia(t,e,n){CW(t,e),e.set(t,n)}function CW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qh(t,e,n){return(e=aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aie(t){var e=lie(t,"string");return typeof e=="symbol"?e:e+""}function lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ar(t,e){return t.get(Hr(t,e))}function Li(t,e,n){return t.set(Hr(t,e),n),n}function Hr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");const US="copyPaste",uie=80,cie=["fragmentSelection"],pN=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var KE=new WeakMap,XE=new WeakMap,ZE=new WeakMap,qu=new WeakMap,um=new WeakMap,cm=new WeakMap,Ku=new WeakMap,aw=new WeakMap,zr=new WeakSet;class hie extends rt{constructor(){super(...arguments),oie(this,zr),Qh(this,"columnsLimit",1/0),Qh(this,"rowsLimit",1/0),Qh(this,"pasteMode","overwrite"),Qh(this,"uiContainer",this.hot.rootDocument.body),ia(this,KE,!1),ia(this,XE,!1),ia(this,ZE,!1),ia(this,qu,"cells-only"),ia(this,um,!1),ia(this,cm,!1),ia(this,Ku,new iie({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),ia(this,aw,!1),Qh(this,"copyableRanges",[])}static get PLUGIN_KEY(){return US}static get SETTING_KEYS(){return[US,...cie]}static get PLUGIN_PRIORITY(){return uie}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[US]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Li(KE,this,this.getSetting("copyColumnHeaders")),Li(XE,this,this.getSetting("copyColumnGroupHeaders")),Li(ZE,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Hr(zr,this,gie).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Hr(zr,r,mie).call(r,...s)}),this.addHook("afterSelectionEnd",()=>Hr(zr,this,pie).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),IT()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Hr(zr,r,wie).call(r,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Hr(zr,r,Cie).call(r,...s)}),this.addHook("afterSelection",()=>Hr(zr,this,yie).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Li(qu,this,e),Li(um,this,!0),Hr(zr,this,wN).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Li(cm,this,!0),Hr(zr,this,wN).call(this,"cut")}getRangedCopyableData(e){return $d(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=wW(e);return F(r,s=>{const o=[];F(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),n.push(o)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new nie;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Ar(Ku,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Ar(qu,this)==="column-headers-only"?n.set("headers",Ar(Ku,this).getMostBottomColumnHeadersRange()):(Ar(qu,this)==="with-column-headers"?n.set("headers",Ar(Ku,this).getMostBottomColumnHeadersRange()):Ar(qu,this)==="with-column-group-headers"&&n.set("headers",Ar(Ku,this).getAllColumnHeadersRange()),n.set("cells",Ar(Ku,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=r;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,s=[],{row:o,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=o,h=a,d=o,f=a;for(;s.length<r||c<=l;){const{skipRowOnPaste:m,visualRow:y}=this.hot.getCellMeta(c,a);if(c=y+1,m===!0)continue;d=y,h=a;const C=[],T=s.length%r;for(;C.length<i||h<=u;){const{skipColumnOnPaste:x,visualCol:O}=this.hot.getCellMeta(o,h);if(h=O+1,x===!0)continue;f=O;const b=C.length%i;C.push(e[T][b])}s.push(C)}return Li(aw,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){var n;const r=this.hot.getFocusManager().getRefocusElement(),i=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Ar(um,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==r||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),Li(um,this,!1);const s=this.getRangedData(this.copyableRanges),o=Hr(zr,this,die).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,o)){const l=$d(s);if(e&&e.clipboardData){const u=xE(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[pN,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",s,this.copyableRanges,o)}Li(qu,this,"cells-only")}onCut(e){var n;const r=this.hot.getFocusManager().getRefocusElement(),i=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Ar(cm,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==r||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),Li(cm,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const a=$d(s);if(e&&e.clipboardData){const l=xE(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[pN,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){var n;const r=this.hot.getFocusManager().getRefocusElement(),i=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(i&&e.target!==r||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const c=sC(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?s=d$(c,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=C8(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[o,a,l,u]=this.populateValues(s);this.hot.selectCell(o,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function wN(t){if(IT()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&zF(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function die(t){const{rows:e}=wW(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function fie(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&ET(r)}}}function yW(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&TT(r)}}}function gie(t){t.items.push({name:"---------"},Xre(this)),Ar(KE,this)&&t.items.push(Qre(this)),Ar(XE,this)&&t.items.push(Jre(this)),Ar(ZE,this)&&t.items.push(Zre(this)),t.items.push(eie(this))}function mie(t,e,n,r,i){Ar(aw,this)&&(i.value=!0),Li(aw,this,!1)}function pie(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function wie(){Hr(zr,this,yW).call(this)}function Cie(){Hr(zr,this,fie).call(this)}function yie(){Hr(zr,this,yW).call(this)}function vW(t,e){return`border_row${t}col${e}`}function xd(){return{width:1,color:"#000"}}function No(){return{hide:!0}}function vie(){return{width:1,color:"#000",cornerVisible:!1}}function zS(t){if(we(t.start)||we(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(we(t.end)||we(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function ed(t){return we(t.start)&&(t.left=t.start),we(t.end)&&(t.right=t.end),t}function YS(t,e){return{id:vW(t,e),border:vie(),row:t,col:e,top:No(),bottom:No(),start:No(),end:No()}}function bie(t,e){return dn(e,"border")&&e.border&&(t.border=e.border),dn(e,"top")&&we(e.top)&&(e.top?(We(e.top)||(e.top=xd()),t.top=e.top):(e.top=No(),t.top=e.top)),dn(e,"bottom")&&we(e.bottom)&&(e.bottom?(We(e.bottom)||(e.bottom=xd()),t.bottom=e.bottom):(e.bottom=No(),t.bottom=e.bottom)),dn(e,"start")&&we(e.start)&&(e.start?(We(e.start)||(e.start=xd()),t.start=e.start):(e.start=No(),t.start=e.start)),dn(e,"end")&&we(e.end)&&(e.end?(We(e.end)||(e.end=xd()),t.end=e.end):(e.end=No(),t.end=e.end)),t}function Uo(t,e){let n=!1;return F(t.getSelectedRange(),r=>{r.forAll((i,s)=>{if(i<0||s<0)return;const o=t.getCellMeta(i,s).borders;if(o)if(e){if(!dn(o[e],"hide")||o[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function $C(t){return`<span class="selected">✓</span>${t}`}function Sie(t){return t.some(e=>we(e.left)||we(e.right))}function Rie(t){return t.some(e=>we(e.start)||we(e.end))}const Eie=new Map([["left","start"],["right","end"]]);function Tie(t){var e;return(e=Eie.get(t))!==null&&e!==void 0?e:t}function _ie(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(U_);return Uo(this,"bottom")&&(e=$C(e)),e},callback(e,n){const r=Uo(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function xie(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(z_);return Uo(this,e)&&(n=$C(n)),n},callback(n,r){const i=Uo(this,e);t.prepareBorder(r,e,i)}}}function Mie(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Y_)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Uo(this)}}}function Iie(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(j_);return Uo(this,e)&&(n=$C(n)),n},callback(n,r){const i=Uo(this,e);t.prepareBorder(r,e,i)}}}function Pie(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(B_);return Uo(this,"top")&&(e=$C(e)),e},callback(e,n){const r=Uo(this,"top");t.prepareBorder(n,"top",r)}}}function Oie(t,e){Aie(t,e),e.add(t)}function Aie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hie(t,e,n){return(e=Nie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nie(t){var e=Die(t,"string");return typeof e=="symbol"?e:e+""}function Die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mp="customBorders",Lie=90;var GS=new WeakSet;class kie extends rt{constructor(){super(...arguments),Oie(this,GS),Hie(this,"savedBorders",[])}static get PLUGIN_KEY(){return mp}static get PLUGIN_PRIORITY(){return Lie}isEnabled(){return!!this.hot.getSettings()[mp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>CN(GS,this,Fie).call(this,e)),this.addHook("init",()=>CN(GS,this,$ie).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=zS(n));const s=Yc(e),o=Cf(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});F(e,a=>{o(a).forAll((l,u)=>{F(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,Tie(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Yc(e),r=Cf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return F(e,s=>{r(s).forAll((o,a)=>{F(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(ed(l))})})}),i}clearBorders(e){e?this.setBorders(e):(F(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||n>=o)return;let a=YS(e,n);r&&(a=bie(a,r),F(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",ed(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Re(e.from.row,r,s=>{Re(e.from.col,i,o=>{const a=YS(s,o);let l=0;s===e.from.row&&dn(n,"top")&&(l+=1,a.top=n.top),s===e.to.row&&dn(n,"bottom")&&(l+=1,a.bottom=n.bottom),o===e.from.col&&dn(n,"start")&&(l+=1,a.start=n.start),o===e.to.col&&dn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(s,o,"borders",ed(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=vW(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let s=this.hot.getCellMeta(e,n).borders;!s||s.border===void 0?s=YS(e,n):s=zS(s),i?(s[r]=No(),this.countHide(s)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",ed(s)))):(s[r]=xd(),this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",ed(s)))}prepareBorder(e,n,r){F(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)n==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,n,r);else switch(n){case"noBorders":Re(s.col,o.col,a=>{Re(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Re(s.col,o.col,a=>{this.setBorder(s.row,a,n,r)});break;case"bottom":Re(s.col,o.col,a=>{this.setBorder(o.row,a,n,r)});break;case"start":Re(s.row,o.row,a=>{this.setBorder(a,s.col,n,r)});break;case"end":Re(s.row,o.row,a=>{this.setBorder(a,o.col,n,r)});break}})}createCustomBorders(e){F(e,n=>{const r=zS(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:s}=e;return mn([n,r,i,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=qe(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){F(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){F(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=qe(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):F(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return F(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return F(o,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):F(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=n,o.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);F(a,l=>{l.changeBorderStyle(r,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[mp];if(Array.isArray(e)){const n=sr(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Sie(e),r=Rie(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Fie(t){this.hot.getSettings()[mp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(W_)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Pie(this),Iie(this),_ie(this),xie(this),Mie(this)]}})}function $ie(){this.changeBorderSettings()}function Vie(t,e){Wie(t,e),e.add(t)}function Wie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qS(t,e,n){return(e=Bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bie(t){var e=jie(t,"string");return typeof e=="symbol"?e:e+""}function jie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vN="dragToScroll",Uie=100;var KS=new WeakSet;class zie extends rt{constructor(){super(...arguments),Vie(this,KS),qS(this,"boundaries",null),qS(this,"callback",null),qS(this,"listening",!1)}static get PLUGIN_KEY(){return vN}static get PLUGIN_PRIORITY(){return Uie}isEnabled(){return!!this.hot.getSettings()[vN]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>yN(KS,this,bN).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>yN(KS,this,bN).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=su(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function bN(t){if(Ba(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Yie(t,e){bW(t,e),e.add(t)}function Gie(t,e,n){bW(t,e),e.set(t,n)}function bW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XS(t,e,n){return(e=qie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qie(t){var e=Kie(t,"string");return typeof e=="symbol"?e:e+""}function Kie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xie(t,e){return t.get(di(t,e))}function SW(t,e,n){return t.set(di(t,e),n),n}function di(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");const pp="dropdownMenu",Zie=230,bf="changeType",ZS=pp;var VC=new WeakMap,$i=new WeakSet;class WC extends rt{static get PLUGIN_KEY(){return pp}static get PLUGIN_PRIORITY(){return Zie}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[tg,ng,Ve,ig,Ve,OC,Ve,rg,Ve,hi]}constructor(e){super(e),Yie(this,$i),XS(this,"commandExecutor",new uW(this.hot)),XS(this,"itemsFactory",null),XS(this,"menu",null),Gie(this,VC,!1),this.hot.addHook("afterGetColHeader",(n,r)=>di($i,this,Qie).call(this,n,r))}isEnabled(){return this.hot.getSettings()[pp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new cW(this.hot,WC.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return di($i,e,sse).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return di($i,e,ise).call(e,...s)});const n=this.hot.getSettings()[pp],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new hh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>di($i,this,ese).call(this)),this.menu.addLocalHook("afterOpen",()=>di($i,this,tse).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>di($i,this,nse).call(this,s)),this.menu.addLocalHook("afterClose",()=>di($i,this,rse).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),F(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=PC(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${bf}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:ZS},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:ZS}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ZS)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>di($i,this,Jie).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Be(r,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function RW(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Jie(t){if(Me(t.target,bf)){const e=PC(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),SW(VC,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Qie(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const s=e.querySelector(`.${bf}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=bf,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Pe(o,[Ka(),$p(" ")]),Pe(e,[xF("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function ese(){this.hot.runHooks("beforeDropdownMenuShow",this)}function tse(){this.hot.runHooks("afterDropdownMenuShow",this),di($i,this,RW).call(this,this.menu)}function nse(t){di($i,this,RW).call(this,t)}function rse(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function ise(t){return Xie(VC,this)?null:t}function sse(t){Me(t.target,bf)&&SW(VC,this,!0)}WC.SEPARATOR={name:Ve};function SN(t,e,n){return(e=ose(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ose(t){var e=ase(t,"string");return typeof e=="symbol"?e:e+""}function ase(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lse{constructor(e){SN(this,"hot",void 0),SN(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),s=this.options,o=[];return Re(e,r,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(Re(n,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();Re(n,r,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();Re(n,r,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,s=n,o=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),s=Math.min(s,n),o=Math.min(o,e),{startRow:r,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function RN(t,e,n){return(e=use(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function use(t){var e=cse(t,"string");return typeof e=="symbol"?e:e+""}function cse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){RN(this,"dataProvider",void 0),RN(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=es(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=fn(es(aM.DEFAULT_OPTIONS),n),n=fn(n,e),n.filename=mT(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const hse="\r",dse='"',fse=`
`;class gse extends aM{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=qe(r,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),F(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Jt(e);return r!==""&&(n||r.indexOf(hse)>=0||r.indexOf(dse)>=0||r.indexOf(fse)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const mse="csv",JE={[mse]:gse};function pse(t,e,n){return typeof JE[t]=="function"?new JE[t](e,n):null}const wse="exportFile",Cse=240;class yse extends rt{static get PLUGIN_KEY(){return wse}static get PLUGIN_PRIORITY(){return Cse}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,n),o=this._createBlob(s),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!JE[e])throw new Error(`Export format type "${e}" is not supported.`);return pse(e,new lse(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Xu(t,e,n){return(e=vse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vse(t){var e=bse(t,"string");return typeof e=="symbol"?e:e+""}function bse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sg{constructor(e,n){let{id:r,stateless:i=!0}=n;Xu(this,"hot",void 0),Xu(this,"id",void 0),Xu(this,"elements",[]),Xu(this,"hidden",!1),Xu(this,"stateId",""),Xu(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new bC)}getElements(){return this.elements}reset(){F(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),F(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}wt(sg,Wn);const Sf={};function ja(t,e){if(!Sf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Sf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(s){return n.apply(s.meta.instance,[].concat([s],[i]))}}function Zl(t){if(!Sf[t])throw Error(`Filter condition "${t}" does not exist.`);return Sf[t].descriptor}function pn(t,e,n){n.key=t,Sf[t]={condition:e,descriptor:n}}const Dn="none";function Sse(){return!0}pn(Dn,Sse,{name:SC,inputsCount:0,showOperators:!1});const jd="empty";function Rse(t){return Qt(t.value)}pn(jd,Rse,{name:Q_,inputsCount:0,showOperators:!0});const wp="not_empty";function Ese(t,e){return!ja(jd,e)(t)}pn(wp,Ese,{name:ex,inputsCount:0,showOperators:!0});const Ud="eq";function Tse(t,e){let[n]=e;return Jt(t.value).toLocaleLowerCase(t.meta.locale)===Jt(n)}pn(Ud,Tse,{name:tx,inputsCount:1,showOperators:!0});const Cp="neq";function _se(t,e){return!ja(Ud,e)(t)}pn(Cp,_se,{name:nx,inputsCount:1,showOperators:!0});const EW="gt";function xse(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}pn(EW,xse,{name:ax,inputsCount:1,showOperators:!0});const TW="gte";function Mse(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}pn(TW,Mse,{name:lx,inputsCount:1,showOperators:!0});const _W="lt";function Ise(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}pn(_W,Ise,{name:ux,inputsCount:1,showOperators:!0});const xW="lte";function Pse(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}pn(xW,Pse,{name:cx,inputsCount:1,showOperators:!0});const lM="date_after";function Ose(t,e){let[n]=e;const r=ee(t.value,t.meta.dateFormat),i=ee(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}pn(lM,Ose,{name:fx,inputsCount:1,showOperators:!0});const uM="date_before";function Ase(t,e){let[n]=e;const r=ee(t.value,t.meta.dateFormat),i=ee(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}pn(uM,Ase,{name:gx,inputsCount:1,showOperators:!0});const lw="between";function Hse(t,e){let[n,r]=e,i=n,s=r;if(t.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=ja(uM,[s]),a=ja(lM,[i]);return o(t)&&a(t)}return t.value>=i&&t.value<=s}pn(lw,Hse,{name:hx,inputsCount:2,showOperators:!0});const MW="not_between";function Nse(t,e){return!ja(lw,e)(t)}pn(MW,Nse,{name:dx,inputsCount:2,showOperators:!0});const IW="begins_with";function Dse(t,e){let[n]=e;return Jt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Jt(n))}pn(IW,Dse,{name:rx,inputsCount:1,showOperators:!0});const PW="ends_with";function Lse(t,e){let[n]=e;return Jt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Jt(n))}pn(PW,Lse,{name:ix,inputsCount:1,showOperators:!0});const cM="contains";function kse(t,e){let[n]=e;return Jt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Jt(n))>=0}pn(cM,kse,{name:sx,inputsCount:1,showOperators:!0});const OW="not_contains";function Fse(t,e){return!ja(cM,e)(t)}pn(OW,Fse,{name:ox,inputsCount:1,showOperators:!0});const AW="date_tomorrow";function $se(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}pn(AW,$se,{name:px,inputsCount:0});const HW="date_today";function Vse(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().startOf("day"),"d"):!1}pn(HW,Vse,{name:mx,inputsCount:0});const NW="date_yesterday";function Wse(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}pn(NW,Wse,{name:wx,inputsCount:0});XF();function Bse(t,e){let n=t;return n===""&&(n=`(${e})`),n}const QE=new Set([1]).has(1),jse=QE&&typeof Array.from=="function";function og(t){let e=t;return QE&&(e=new Set(e)),function(n){let r;return QE?r=e.has(n):r=!!~e.indexOf(n),r}}function DW(t){return t??""}function e0(t){let e=t;return jse?e=Array.from(new Set(e)):e=dT(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function EN(t,e,n,r){const i=[],s=t===e;let o;return s||(o=og(e)),F(t,a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:Bse(a,n)};r&&r(u),i.push(u)}),i}const Jl="by_value";function Use(t,e){let[n]=e;return n(t.value)}pn(Jl,Use,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[og(e)]},showOperators:!1});const Rf={};function zse(t){if(!Rf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Rf[t].func;return function(n,r){return e(n,r)}}function Yse(t){return Rf[t].name}function hM(t,e,n){Rf[t]={name:e,func:n}}const La="conjunction",Gse=vx;function qse(t,e){return t.every(n=>n.func(e))}hM(La,Gse,qse);const uw="disjunction",Kse=RC;function Xse(t,e){return t.some(n=>n.func(e))}hM(uw,Kse,Xse);const dM="disjunctionWithExtraCondition",Zse=RC;function Jse(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}hM(dM,Zse,Jse);const Qse="numeric",LW="text",eoe="date",TN={[Qse]:[Dn,Ve,jd,wp,Ve,Ud,Cp,Ve,EW,TW,_W,xW,lw,MW],[LW]:[Dn,Ve,jd,wp,Ve,Ud,Cp,Ve,IW,PW,Ve,cM,OW],[eoe]:[Dn,Ve,jd,wp,Ve,Ud,Cp,Ve,uM,lM,lw,Ve,AW,HW,NW]};function toe(t){const e=[];let n=t;return TN[n]||(n=LW),F(TN[n],r=>{let i;r===Ve?i={name:Ve}:i=es(Zl(r)),e.push(i)}),e}function td(t,e,n){return(e=noe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function noe(t){var e=roe(t,"string");return typeof e=="symbol"?e:e+""}function roe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const JS="built",QS="building",_N=["click","input","keydown","keypress","keyup","focus","blur","change"];let Ki=class kW{static get DEFAULTS(){return es({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){td(this,"hot",void 0),td(this,"eventManager",new bi(this)),td(this,"options",void 0),td(this,"_element",void 0),td(this,"buildState",void 0),this.hot=e,this.options=fn(kW.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===QS?this._element:this.buildState===JS?(this.update(),this._element):(this.buildState=QS,this.build(),this.buildState=JS,this._element)}isBuilt(){return this.buildState===JS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(br)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=QS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&K(this._element,this.options.className),this.options.children.length)F(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Be(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),F(_N,r=>e(n,r))}else F(_N,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};wt(Ki,Wn);function ioe(t,e){FW(t,e),e.add(t)}function soe(t,e,n){FW(t,e),e.set(t,n)}function FW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hm(t,e){return t.get(fM(t,e))}function ooe(t,e,n){return t.set(fM(t,e),n),n}function fM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zu=new WeakMap,xN=new WeakSet;class ka extends Ki{static get DEFAULTS(){return es({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,fn(ka.DEFAULTS,n)),ioe(this,xN),soe(this,Zu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>fM(xN,this,aoe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");ooe(Zu,this,this._element.firstChild),K(this._element,"htUIInput"),K(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(hm(Zu,this).type=this.options.type,hm(Zu,this).placeholder=this.translateIfPossible(this.options.placeholder),hm(Zu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&hm(Zu,this).focus()}}function aoe(t){this.options.value=t.target.value}function loe(t,e){$W(t,e),e.add(t)}function nd(t,e,n){$W(t,e),e.set(t,n)}function $W(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ju(t,e,n){return t.set(zd(t,e),n),n}function zt(t,e){return t.get(zd(t,e))}function zd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sn=new WeakMap,dm=new WeakMap,fm=new WeakMap,eR=new WeakMap,gm=new WeakMap,mm=new WeakSet;class Ef extends Ki{static get DEFAULTS(){return es({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,fn(Ef.DEFAULTS,n)),loe(this,mm),nd(this,Sn,null),nd(this,dm,[]),nd(this,fm,void 0),nd(this,eR,void 0),nd(this,gm,void 0),this.registerHooks()}getMenu(){return zt(Sn,this)}registerHooks(){this.addLocalHook("click",()=>zd(mm,this,hoe).call(this))}setItems(e){Ju(dm,this,this.translateNames(e)),zt(Sn,this)&&zt(Sn,this).setMenuItems(zt(dm,this))}translateNames(e){return F(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Ju(Sn,this,new hh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),zt(Sn,this).setMenuItems(zt(dm,this));const e=new Ki(this.hot,{className:"htUISelectCaption"}),n=new Ki(this.hot,{className:"htUISelectDropdown"});Ju(fm,this,e),Ju(eR,this,e.element),Ju(gm,this,n),this.hot.getSettings().ariaTags&&(Pe(n.element,[Ka()]),Pe(this._element,[_F()])),F([e,n],r=>this._element.appendChild(r.element)),zt(Sn,this).addLocalHook("select",r=>zd(mm,this,uoe).call(this,r)),zt(Sn,this).addLocalHook("afterClose",()=>zd(mm,this,coe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=zt(Sn,this).hot.getTranslatedPhrase(SC),zt(eR,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();zt(Sn,this)&&(zt(Sn,this).open(),zt(Sn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),zt(Sn,this).getNavigator().toFirstItem(),zt(Sn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){zt(Sn,this)&&zt(Sn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){zt(Sn,this)&&(zt(Sn,this).destroy(),Ju(Sn,this,null)),zt(fm,this)&&zt(fm,this).destroy(),zt(gm,this)&&zt(gm,this).destroy(),super.destroy()}}function uoe(t){t.name!==Ve&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function coe(){this.runLocalHooks("afterClose")}function hoe(){this.openOptions()}function doe(t,e){foe(t,e),e.add(t)}function foe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MN(t,e,n){return(e=goe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function goe(t){var e=moe(t,"string");return typeof e=="symbol"?e:e+""}function moe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tR=new WeakSet;class t0 extends sg{constructor(e,n){super(e,{id:n.id,stateless:!1}),doe(this,tR),MN(this,"name",""),MN(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Ef(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ka(this.hot,{placeholder:_x})),this.elements.push(new ka(this.hot,{placeholder:xx})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>IN(tR,this,poe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),F(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>IN(tR,this,woe).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=es(e.command);n.name.startsWith(tn)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),F(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(r),s[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Zl(Dn),n=[];return F(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Zl(e?e.name:Dn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||F(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Ef)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ka)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,s,o)=>{K(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&K(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return K(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||F(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Zl(Dn)];if(e!==null){const{visualIndex:r}=e;n=toe(this.hot.getDataType(0,r,this.hot.countRows(),r))}F(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function poe(t){F(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function woe(t){ah(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),_i(t))}function PN(t,e,n){Coe(t,e),e.set(t,n)}function Coe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rd(t,e){return t.get(VW(t,e))}function ON(t,e,n){return t.set(VW(t,e),n),n}function VW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qu=new WeakMap,nR=new WeakMap;class cw extends Ki{static get DEFAULTS(){return es({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,fn(cw.DEFAULTS,n)),PN(this,Qu,void 0),PN(this,nR,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),ON(nR,this,e),ON(Qu,this,this._element.firstChild),rd(Qu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(rd(nR,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?rd(Qu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(rd(Qu,this).checked=e)}focus(){this.isBuilt()&&rd(Qu,this).focus()}}function yoe(t,e){voe(t,e),e.add(t)}function voe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function boe(t,e,n){return(e=Soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Soe(t){var e=Roe(t,"string");return typeof e=="symbol"?e:e+""}function Roe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eoe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const AN=0;var HN=new WeakSet;class Toe extends sg{constructor(e,n){super(e,{id:n.id,stateless:!1}),yoe(this,HN),boe(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(K(n.parentNode,"htFiltersMenuOperators"),F(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[La,uw];F(e,n=>{const r=new cw(this.hot,{name:"operator",label:{htmlFor:n,textContent:Yse(n)},value:n,checked:n===e[AN],id:n});r.addLocalHook("change",i=>Eoe(HN,this,_oe).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(pt`Radio button with index ${e} doesn't exist.`);F(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof cw&&n.isChecked());return e?e.getValue():La}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&F(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:La,n=arguments.length>1?arguments[1]:void 0,r=e;r===dM&&(r=uw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(AN)}}function _oe(t){this.setState(t.target.value)}function xoe(t,e,n){Moe(t,e),e.set(t,n)}function Moe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rR(t,e){return t.get(WW(t,e))}function Ioe(t,e,n){return t.set(WW(t,e),n),n}function WW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var id=new WeakMap;class Tf extends Ki{static get DEFAULTS(){return es({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,fn(Tf.DEFAULTS,n)),xoe(this,id,void 0)}build(){super.build(),Ioe(id,this,this._element.firstChild)}update(){this.isBuilt()&&(rR(id,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&rR(id,this).focus()}activate(){rR(id,this).click()}}function Poe(t,e){BW(t,e),e.add(t)}function ec(t,e,n){BW(t,e),e.set(t,n)}function BW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ne(t,e){return t.get(Sc(t,e))}function Ai(t,e,n){return t.set(Sc(t,e),n),n}function Sc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const NN="multipleSelect.itemBox";var Vi=new WeakMap,sn=new WeakMap,iR=new WeakMap,fo=new WeakMap,sa=new WeakMap,oa=new WeakMap,sd=new WeakSet;class _f extends Ki{static get DEFAULTS(){return es({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,fn(_f.DEFAULTS,n)),Poe(this,sd),ec(this,Vi,[]),ec(this,sn,void 0),ec(this,iR,void 0),ec(this,fo,void 0),ec(this,sa,void 0),ec(this,oa,void 0),Ai(fo,this,new ka(this.hot,{placeholder:Tx,className:"htUIMultipleSelectSearch"})),Ai(sa,this,new Tf(this.hot,{textContent:bx,className:"htUISelectAll"})),Ai(oa,this,new Tf(this.hot,{textContent:Sx,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ne(sn,this)}registerHooks(){Ne(fo,this).addLocalHook("keydown",e=>Sc(sd,this,Aoe).call(this,e)),Ne(fo,this).addLocalHook("input",e=>Sc(sd,this,Ooe).call(this,e)),Ne(sa,this).addLocalHook("click",e=>Sc(sd,this,Hoe).call(this,e)),Ne(oa,this).addLocalHook("click",e=>Sc(sd,this,Noe).call(this,e))}setItems(e){var n;Ai(Vi,this,e),(n=Ne(sn,this))===null||n===void 0||n.loadData(Ne(Vi,this))}setLocale(e){Ai(iR,this,e)}getLocale(){return Ne(iR,this)}getItems(){return[...Ne(Vi,this)]}getValue(){return Loe(Ne(Vi,this))}getSearchInputElement(){return Ne(fo,this)}getSelectAllElement(){return Ne(sa,this)}getClearAllElement(){return Ne(oa,this)}isSelectedAllValues(){return Ne(Vi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Ki(this.hot,{className:"htUISelectionControls",children:[Ne(sa,this),Ne(oa,this)]});this._element.appendChild(Ne(fo,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=s=>{var o;if(!this._element)return;(o=Ne(sn,this))===null||o===void 0||o.destroy(),K(s,"htUIMultipleSelectHot"),Ai(sn,this,new this.hot.constructor(s,{data:Ne(Vi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ne(sn,this).listen()},colWidths:()=>Ne(sn,this).container.scrollWidth-Ln(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ne(sn,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Ne(sn,this).useTheme(u)});const l=Ne(sn,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:NN}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Ne(sn,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:NN})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ne(sn,this).listen()}reset(){Ne(fo,this).reset(),Ne(sa,this).reset(),Ne(oa,this).reset()}update(){this.isBuilt()&&(Ne(sn,this).loadData(Doe(Ne(Vi,this),this.options.value)),super.update())}destroy(){var e;(e=Ne(sn,this))===null||e===void 0||e.destroy(),Ne(fo,this).destroy(),Ne(oa,this).destroy(),Ne(sa,this).destroy(),Ai(fo,this,null),Ai(oa,this,null),Ai(sa,this,null),Ai(sn,this,null),Ai(Vi,this,null),super.destroy()}}function Ooe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ne(Vi,this)]:n=Ne(Vi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ne(sn,this).loadData(n)}function Aoe(t){this.runLocalHooks("keydown",t,this),_T(ah,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),_i(t),Ne(sn,this).listen(),Ne(sn,this).selectCell(0,0))}function Hoe(t){const e=[];t.preventDefault(),Ne(sn,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(n_(n,r)[0])}),Ne(sn,this).setSourceDataAtCell(e)}function Noe(t){const e=[];t.preventDefault(),Ne(sn,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(n_(n,r)[0])}),Ne(sn,this).setSourceDataAtCell(e)}function Doe(t,e){const n=og(e);return t.map(r=>(r.checked=n(r.value),r))}function Loe(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function koe(t,e){Foe(t,e),e.add(t)}function Foe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $oe(t,e,n){return(e=Voe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Voe(t){var e=Woe(t,"string");return typeof e=="symbol"?e:e+""}function Woe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var od=new WeakSet;class Boe extends sg{constructor(e,n){super(e,{id:n.id,stateless:!1}),koe(this,od),$oe(this,"name",""),this.name=n.name,this.elements.push(new _f(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>pm(od,this,joe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>pm(od,this,Uoe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Jl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Dn:Jl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,s,o,a)=>{const[l]=Bo(i,h=>h.name===Jl),u={},c=this.hot.getTranslatedPhrase(Kp);if(l){const h=o(r,a),d=qe(h,x=>x.value),f=new Map(h.map(x=>[x.value,this.hot.getCellMeta(x.meta.visualRow,x.meta.visualCol)])),m=e0(d);s&&(l.args[0]=s);const y=[],C=EN(m,l.args[0],c,x=>{x.checked&&y.push(x.value),pm(od,this,DN).call(this,x,f)}),T=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,T).locale,u.args=[y],u.command=Zl(Jl),u.itemsSnapshot=C}else u.args=[],u.command=Zl(Dn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof _f)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,s,o)=>{K(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return K(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||F(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Kp),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),s=e0(r),o=EN(s,s,e,l=>{pm(od,this,DN).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:qe(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:DW(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function joe(t){ah(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),_i(t))}function DN(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Uoe(t,e){switch(e.type){case"numeric":return HV(t,e);default:return t}}var jW;function zoe(t,e){Yoe(t,e),e.add(t)}function Yoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Goe(t,e,n){return(e=qoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qoe(t){var e=Koe(t,"string");return typeof e=="symbol"?e:e+""}function Koe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xoe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var LN=new WeakSet;class xf extends sg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),zoe(this,LN),Goe(this,"name",""),this.name=n.name,this.elements.push(new ka(this.hot,{type:"button",value:Rx,className:"htUIButton htUIButtonOK",identifier:xf.BUTTON_OK})),this.elements.push(new ka(this.hot,{type:"button",value:Ex,className:"htUIButton htUIButtonCancel",identifier:xf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){F(this.elements,e=>{e.addLocalHook("click",(n,r)=>Xoe(LN,this,Zoe).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(K(n.parentNode,"htFiltersMenuActionBar"),F(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}jW=xf;function Zoe(t,e){e.options.identifier===jW.BUTTON_OK?this.accept():this.cancel()}function wm(t,e,n){return(e=Joe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Joe(t){var e=Qoe(t,"string");return typeof e=="symbol"?e:e+""}function Qoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const kN="ConditionCollection.filteringStates";class gM{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;wm(this,"hot",void 0),wm(this,"isMapRegistrable",void 0),wm(this,"filteringStates",new bC),wm(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(kN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),s=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:La;return e.length?zse(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:La,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=qe(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(s):c),a=n.name||n.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(pt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ft(Rf[r]))throw new Error(pt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:o,func:ja(a,o)}]},i):u.push({name:a,args:o,func:ja(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return mn(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:s}]=n;return e.push({column:r,operation:i,conditions:qe(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),F(e,n=>{F(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(kN),this.filteringStates=null,this.clearLocalHooks()}}wt(gM,Wn);function FN(t,e,n){return(e=eae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eae(t){var e=tae(t,"string");return typeof e=="symbol"?e:e+""}function tae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UW{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];FN(this,"conditionCollection",void 0),FN(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return F(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return F(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return F(n,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(r[s]=e[s])}),r}}function nae(t,e){rae(t,e),e.add(t)}function rae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sl(t,e,n){return(e=iae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iae(t){var e=sae(t,"string");return typeof e=="symbol"?e:e+""}function sae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cm=new WeakSet;class zW{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];nae(this,Cm),Sl(this,"hot",void 0),Sl(this,"conditionCollection",void 0),Sl(this,"columnDataFactory",void 0),Sl(this,"changes",[]),Sl(this,"grouping",!1),Sl(this,"latestEditedColumnPosition",-1),Sl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>sR(Cm,this,oae).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>sR(Cm,this,aae).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>sR(Cm,this,lae).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,F(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=GF(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new gM(r.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const y=r.columnDataFactory(h);let C;f.isEmpty()?C=y:C=new UW(f,x=>r.columnDataFactory(x)).filter(),C=qe(C,x=>x.meta.visualRow);const T=og(C);return f.destroy(),Bo(y,x=>T(x.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Be(this,(e,n)=>{this[n]=null})}}function oae(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function aae(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function lae(){F(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}wt(zW,Wn);function uae(t){return dW({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof _f)return r;if(i.element&&!ou(i.element))return!1;i.focus()}})}const ad="filters";function cae(t,e){let n=-1,r;const i=uae(e),s=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(ad),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Ki&&(h.addLocalHook("click",s(h)),h.addLocalHook("focus",s(h)),h.addLocalHook("afterClose",s(h)))}),l(t);function o(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(ad),callback:()=>{h.isSubMenu()&&h.close(),d.listen(ad)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const y=r.getNavigator();y.getCurrentPage()>-1&&(n=y.getCurrentPage()),y.clear(),m.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const y=e[i.getCurrentPage()];y instanceof Ef&&(y.openOptions(),m.preventDefault()),y instanceof Tf&&(y.activate(),m.preventDefault()),y instanceof Ki||m.preventDefault()}}],ad)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(ad)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",o),h.addLocalHook("afterOpen",o),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function hae(t,e){YW(t,e),e.add(t)}function $N(t,e,n){YW(t,e),e.set(t,n)}function YW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ld(t,e,n){return(e=dae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dae(t){var e=fae(t,"string");return typeof e=="symbol"?e:e+""}function fae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gae(t,e,n){return t.set(Mr(t,e),n),n}function _o(t,e){return t.get(Mr(t,e))}function Mr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const n0="filters",mae=250,VN=n0;var Co=new WeakMap,r0=new WeakMap,Fr=new WeakSet;class pae extends rt{static get PLUGIN_KEY(){return n0}static get PLUGIN_PRIORITY(){return mae}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),hae(this,Fr),ld(this,"dropdownMenuPlugin",null),ld(this,"conditionCollection",null),ld(this,"conditionUpdateObserver",null),ld(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ld(this,"filtersRowsMap",null),$N(this,Co,void 0),$N(this,r0,new WeakSet),this.hot.addHook("afterGetColHeader",(n,r)=>Mr(Fr,this,Rae).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[n0]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Xf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>Mr(Fr,this,WN).call(this,"accept")),a.addLocalHook("cancel",()=>Mr(Fr,this,WN).call(this,"cancel")),a.addLocalHook("change",l=>Mr(Fr,this,Sae).call(this,a,l)),a),s=()=>`${this.hot.getTranslatedPhrase(Cx)}:`,o=()=>`${this.hot.getTranslatedPhrase(yx)}:`;if(!this.components.get("filter_by_condition")){const a=new t0(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Mr(Fr,this,BN).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Toe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new t0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Mr(Fr,this,BN).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Boe(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new xf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new gM(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new zW(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Mr(Fr,this,Eae).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Mr(Fr,e,bae).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Mr(Fr,this,vae).call(this)),this.addHook("afterDropdownMenuShow",()=>Mr(Fr,this,Cae).call(this)),this.addHook("afterDropdownMenuHide",()=>Mr(Fr,this,yae).call(this)),this.addHook("afterChange",a=>Mr(Fr,this,wae).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!_o(Co,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=_o(Co,this).getMenu(),c=u.getNavigator(),h=_o(Co,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];gae(Co,this,cae(this.dropdownMenuPlugin.menu,a));const l=u=>{_o(Co,this).listen(),u.preventDefault(),ah(u.keyCode,"TAB")&&(u.shiftKey?_o(Co,this).toPreviousItem():_o(Co,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:VN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VN)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:La;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=qe(n.filter(),u=>u.meta.visualRow);const l=og(i);Re(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),F(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return F(this.hot.getSourceDataAtCol(n),(i,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(s,n),y=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),n))!==null&&o!==void 0?o:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:DW(y)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=e0(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let s=e;return s===uw&&n.command.key!==Dn&&r.command.key!==Dn&&i.command.key!==Dn?s=dM:i.command.key!==Dn&&(n.command.key===Dn||r.command.key===Dn)&&(s=La),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new UW(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return F(i,o=>{F(n.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function wae(t){t&&F(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Cae(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function yae(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function vae(){const t=this.dropdownMenuPlugin.menu;_o(r0,this).has(t)||_o(Co,this).setMenu(t),_o(r0,this).add(t)}function bae(t){t.items.push({name:Ve}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function WN(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),s.command.key!==Dn&&(this.conditionCollection.addCondition(i,s,l,u),o.command.key!==Dn&&this.conditionCollection.addCondition(i,o,l,u)),a.command.key!==Dn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Sae(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===t0&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function BN(){this.setListeningDropdownMenu()}function Rae(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?K(e,"htFiltersActive"):_e(e,"htFiltersActive")}function Eae(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(o=>o.name===Jl),s=n.filter(o=>o.name!==Jl);if(i.length>=2||s.length>=3)ht(pt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(o,r),this.components.get("filter_by_value").updateState(t)}}const GW="internal-use-in-handsontable",i0={licenseKey:GW,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function qW(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Qn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function KW(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Tae(t){var e;const n=t[Qn],r=KW(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=qW(t);return{...i0,...r,...i}}function _ae(t){var e;const n=t[Qn],r=KW(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=qW(t);return{...r,...i}}function xae(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function BC(){const t="engine_relationship",e=ss(Qn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function mM(){const t="shared_engine_usage",e=ss(Qn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Mae(t){const e=t.getSettings(),n=e[Qn],r=n==null?void 0:n.engine;if(n===!0||Ft(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Iae((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Ft(r.hyperformula)){const s=BC(),o=mM().get(r);return s.has(r)||s.set(r,[]),s.get(r).push(t),o&&o.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:GW}),(r.getConfig().leapYear1900!==i0.leapYear1900||dC(r.getConfig().nullDate,i0.nullDate)===!1)&&ht(pt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Iae(t,e,n){const r=e[Qn],i=Tae(e),s=BC(),o=mM();Pae(t,r.functions),Oae(t,r.language);const a=t.buildEmpty(i);return s.set(a,[n]),o.set(a,[n.guid]),Aae(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function jN(t){var e;const n=BC(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function UN(t,e){if(t){const n=BC(),r=n.get(t),i=mM(),s=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function Pae(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:s}=n;try{t.registerFunction(r,i,s)}catch(o){ht(o.message)}})}function Oae(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){ht(r.message)}}}function Aae(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:s,options:o}=n;try{t.addNamedExpression(r,i,s,o)}catch(a){ht(a.message)}}),t.resumeEvaluation())}function Hae(t,e){return(Ft(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const XW="DD/MM/YYYY";function ZW(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Nae(t){return ZW(t)?t.substr(1):t}function Dae(t){return typeof t=="string"&&t.startsWith("=")}function pM(t,e){return typeof t=="string"&&e==="date"}function JW(t,e){return ee(t,e,!0).isValid()}function QW(t,e){return ee(t,e,!0).format(XW)}function Lae(t,e){return ee(t,XW,!0).format(e)}function eB(t,e){const r=new Date(Date.UTC(0,0,t+-1));return ee(r).format(e)}function kae(t,e,n){const r=Array.from(Array(n).keys()).filter(s=>t.includes(s)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Fae(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function $ae(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),t}function wM(t,e,n){const r=Fae(t,kae(t,e,n));return $ae(r)}function Rl(t,e,n){Vae(t,e),e.set(t,n)}function Vae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lt(t,e){return t.get(tB(t,e))}function aa(t,e,n){return t.set(tB(t,e),n),n}function tB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ud=new WeakMap,la=new WeakMap,$r=new WeakMap,ym=new WeakMap,oR=new WeakMap,aR=new WeakMap,vm=new WeakMap;class zN{constructor(e,n,r){Rl(this,ud,void 0),Rl(this,la,void 0),Rl(this,$r,void 0),Rl(this,ym,[]),Rl(this,oR,[]),Rl(this,aR,void 0),Rl(this,vm,[]),aa(ud,this,e),aa(la,this,n),aa($r,this,r)}setRemovedHfIndexes(e){return aa(vm,this,e.map(n=>{const r=Lt(la,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Lt(vm,this)}getRemovedHfIndexes(){return Lt(vm,this)}getHfIndexFromVisualIndex(e){const n=Lt(la,this).getIndexesSequence(),r=Lt(la,this).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${ir(Lt(ud,this))}s`;Lt($r,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&Lt($r,this).getEngine()[r](Lt($r,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(aa(oR,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),aa(aR,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Lt($r,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=wM(Lt(oR,this),Lt(aR,this),Lt(la,this).getNumberOfIndexes());Lt($r,this).getSheetId()===null?Lt($r,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${ir(Lt(ud,this))}Order`;return n=>{if(Lt($r,this).isPerformingUndoRedo())return;const r=Lt(la,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Lt(ym,this).map(l=>r.indexOf(l)),s=Lt($r,this).getEngine().getSheetDimensions(Lt($r,this).getSheetId());let o;Lt(ud,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);Lt($r,this).getEngine()[e](Lt($r,this).getSheetId(),i)}aa(ym,this,r)}}init(){aa(ym,this,Lt(la,this).getIndexesSequence())}}function El(t,e,n){Wae(t,e),e.set(t,n)}function Wae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function go(t,e){return t.get(nB(t,e))}function Tl(t,e,n){return t.set(nB(t,e),n),n}function nB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bm=new WeakMap,Sm=new WeakMap,lR=new WeakMap,uR=new WeakMap,cR=new WeakMap,hR=new WeakMap,dR=new WeakMap;class Bae{constructor(e,n,r){El(this,bm,void 0),El(this,Sm,void 0),El(this,lR,void 0),El(this,uR,!1),El(this,cR,!1),El(this,hR,null),El(this,dR,null),Tl(bm,this,new zN("row",e,this)),Tl(Sm,this,new zN("column",n,this)),Tl(lR,this,r)}getForAxis(e){return e==="row"?go(bm,this):go(Sm,this)}setPerformUndo(e){Tl(uR,this,e)}setPerformRedo(e){Tl(cR,this,e)}isPerformingUndoRedo(){return go(uR,this)||go(cR,this)}getSheetId(){return go(dR,this)}getEngine(){return go(hR,this)}getPostponeAction(){return go(lR,this)}setupSyncEndpoint(e,n){Tl(hR,this,e),Tl(dR,this,n),go(bm,this).init(),go(Sm,this).init()}}function jae(t,e){rB(t,e),e.add(t)}function tc(t,e,n){return(e=Uae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uae(t){var e=zae(t,"string");return typeof e=="symbol"?e:e+""}function zae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fR(t,e,n){rB(t,e),e.set(t,n)}function rB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ua(t,e,n){return t.set(vt(t,e),n),n}function $c(t,e){return t.get(vt(t,e))}function vt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qn="formulas",Yae=["maxRows","maxColumns","language"],Gae=260;ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");const dh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var zo=new WeakMap,CM=new WeakMap,cd=new WeakMap,St=new WeakSet;class qae extends rt{constructor(){var e;super(...arguments),e=this,jae(this,St),fR(this,zo,!1),fR(this,CM,!1),fR(this,cd,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(St,e,cle).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(St,e,hle).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(St,e,dle).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(St,e,fle).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(St,e,gle).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(St,e,mle).call(e,...r)}]]),tc(this,"staticRegister",ss("formulas")),tc(this,"engine",null),tc(this,"sheetName",null),tc(this,"indexSyncer",null),tc(this,"rowAxisSyncer",null),tc(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Qn}static get PLUGIN_PRIORITY(){return Gae}static get SETTING_KEYS(){return[Qn,...Yae]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Qn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Mae(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){ht("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,YN).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,GN).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,YN).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,GN).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,Jae).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,Qae).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,Kae).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,ele).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,qN).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,qN).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,tle).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,nle).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,sle).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,ole).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,rle).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,ile).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,ale).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,lle).call(n,...i)}),this.indexSyncer=new Bae(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("beforeColumnMove",(r,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("afterRowMove",(r,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(r,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,Zae).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,ule).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return vt(St,n,Xae).call(n,...i)}),$c(cd,this).forEach(r=>{let[i,s]=r;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){$c(cd,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),UN(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=_ae(this.hot.getSettings());xae(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Qn];if(we(r)&&we(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Qn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){$c(cd,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ua(cd,this,null),UN(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(we(n)&&!$$(n))return ht("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return ht("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return ht(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){HT(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${ir(Qn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(n);return i!==null&&s!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(r.has(o)||r.add(o))}),jN(this.engine).forEach((i,s)=>{if((n||s!==this.sheetId)&&r.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=s=>{var o;const{row:a,col:l,sheet:u}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return we(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(s=>r(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(we(l)===!1||we(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=r(s);if(c!==void 0&&!i.has(h)){const d=jN(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){ht(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,n);return pM(r,s.type)&&(JW(r,s.dateFormat)?r=QW(r,s.dateFormat):Dae(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Kae(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},s=this.hot.getCellMeta(e,r);let o=this.engine.getCellValue(i);return s.type==="date"&&Jn(o)&&(o=eB(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function Xae(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:y}=h.start,{row:C,col:T}=h.end,x=C-m+1,O=T-y+1;for(let b=0;b<f.length;b+=1)for(let H=0;H<f[b].length;H+=1){const k=f[b][H],V=m+b%x,U=y+H%O,Z=this.hot.getCellMeta(V,U);pM(k,Z.type)&&(k.startsWith("'")?f[b][H]=k.slice(1):this.isFormulaCellType(V,U,this.sheetId)===!1&&(f[b][H]=Lae(k,Z.dateFormat)))}return f}function YN(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(ir(Qn))||Ua(CM,this,Ft(this.hot.getSettings().data))}function Zae(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,s)=>{const o=this.hot.getCellMeta(r,s),a=o.dateFormat;pM(i,o.type)&&(e=!0,JW(i,a)?t[r][s]=QW(i,a):this.isFormulaCellType(r,s)===!1&&(t[r][s]=`'${i}`))})}),e===!0&&(Ua(zo,this,!0),this.engine.setSheetContent(this.sheetId,t),Ua(zo,this,!1))}function GN(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(ir(Qn)))if(this.sheetName=Hae(this.engine,this.hot.getSettings()[Qn].sheetName),$c(CM,this))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Ua(zo,this,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Ua(zo,this,!1)}}}function Jae(t,e,n,r){if(r!=="get"||$c(zo,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){ZW(n.value)&&(n.value=Nae(n.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(o),l=this.hot.getCellsMeta().find(c=>c.visualRow===i&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Jn(a)&&(a=eB(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Qae(t,e,n,r){if(r!=="get"||$c(zo,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(i===null||s===null||!this.isFormulaCellType(i,s)&&this.getCellType(i,s)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function qN(t,e){if(dh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(o,u,l):n.push([o,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{n.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function ele(t,e){if(dh(e))return;const n=[],r=[];t.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!Jn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){ht(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function tle(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function nle(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function rle(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function ile(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function sle(t,e,n){if(dh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function ole(t,e,n){if(dh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function ale(t,e,n,r){if(dh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function lle(t,e,n,r){if(dh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function ule(t,e,n){var r;Ua(zo,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ua(zo,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+o,sheet:this.sheetId},[[a]])})})}function cle(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function hle(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function dle(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function fle(t){this.hot.runHooks("afterSheetAdded",t)}function gle(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function mle(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function ple(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(K_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),s=[];for(let l=r;l<=i;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function wle(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(X_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,s=(r=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const n=qe(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,s=r.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return F(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Cle(t,e){iB(t,e),e.add(t)}function yle(t,e,n){iB(t,e),e.set(t,n)}function iB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e){return t.get(Ca(t,e))}function KN(t,e,n){return t.set(Ca(t,e),n),n}function Ca(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");const XN="hiddenColumns",vle=310;var Cs=new WeakMap,xl=new WeakSet;class ble extends rt{constructor(){super(...arguments),Cle(this,xl),yle(this,Cs,null)}static get PLUGIN_KEY(){return XN}static get PLUGIN_PRIORITY(){return vle}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[XN]}enablePlugin(){var e=this;this.enabled||(KN(Cs,this,new vC),_l(Cs,this).addLocalHook("init",()=>Ca(xl,this,xle).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_l(Cs,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(xl,e,_le).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Ca(xl,this,Rle).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Ca(xl,this,Sle).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(xl,e,Tle).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Ca(xl,this,Ele).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const s=_l(Cs,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));F(l,u=>{s[u]=!1}),i=mn(s,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&o)!==!1&&(r&&o&&_l(Cs,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&o,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{F(e,o=>{_l(Cs,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return qe(_l(Cs,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return _l(Cs,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){F(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){KN(Cs,this,null),super.destroy()}}function Sle(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Rle(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Ele(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return F(t,r=>{let i=!0,s=0;Re(r.startCol,r.endCol,o=>{this.isHidden(o)?(i||n(r.startRow,r.endRow,s,o-1),i=!0):(i&&(s=o),o===r.endCol&&n(r.startRow,r.endRow,s,o),i=!1)})}),e}function Tle(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),K(e,n)}function _le(t){t.items.push({name:Ve},ple(this),wle(this))}function xle(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Mle(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Z_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),s=[];for(let l=r;l<=i;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Ile(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(J_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,s=(r=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const n=qe(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,s=r.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return F(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Ple(t,e){sB(t,e),e.add(t)}function Ole(t,e,n){sB(t,e),e.set(t,n)}function sB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(t,e){return t.get(ya(t,e))}function ZN(t,e,n){return t.set(ya(t,e),n),n}function ya(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");const JN="hiddenRows",Ale=320;var ys=new WeakMap,Il=new WeakSet;class Hle extends rt{constructor(){super(...arguments),Ple(this,Il),Ole(this,ys,null)}static get PLUGIN_KEY(){return JN}static get PLUGIN_PRIORITY(){return Ale}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[JN]}enablePlugin(){var e=this;this.enabled||(ZN(ys,this,new vC),Ml(ys,this).addLocalHook("init",()=>ya(Il,this,$le).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ml(ys,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,Fle).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>ya(Il,this,Dle).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>ya(Il,this,Nle).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,kle).call(e,...r)}),this.addHook("modifyCopyableRange",n=>ya(Il,this,Lle).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const s=Ml(ys,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));F(l,u=>{s[u]=!1}),i=mn(s,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&o)!==!1&&(r&&o&&Ml(ys,this).setValues(s),this.hot.runHooks("afterUnhideRows",n,i,r&&o,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{F(e,o=>{Ml(ys,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return qe(Ml(ys,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ml(ys,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){F(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){ZN(ys,this,null),super.destroy()}}function Nle(t,e){return this.isHidden(e)?0:t}function Dle(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Lle(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return F(t,r=>{let i=!0,s=0;Re(r.startRow,r.endRow,o=>{this.isHidden(o)?(i||n(s,o-1,r.startCol,r.endCol),i=!0):(i&&(s=o),o===r.endRow&&n(s,o,r.startCol,r.endCol),i=!1)})}),e}function kle(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),K(e,n)}function Fle(t){t.items.push({name:Ve},Mle(this),Ile(this))}function $le(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Vle(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(T_)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Wle(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(__)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Ble(t,e){oB(t,e),e.add(t)}function jle(t,e,n){oB(t,e),e.set(t,n)}function oB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s0(t,e){return t.get(hw(t,e))}function gR(t,e,n){return t.set(hw(t,e),n),n}function hw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");const QN="manualColumnFreeze",Ule=110;var jl=new WeakMap,mR=new WeakSet;class zle extends rt{constructor(){super(...arguments),Ble(this,mR),jle(this,jl,!1)}static get PLUGIN_KEY(){return QN}static get PLUGIN_PRIORITY(){return Ule}isEnabled(){return!!this.hot.getSettings()[QN]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>hw(mR,this,Yle).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>hw(mR,this,Gle).call(this,e,n)),super.enablePlugin())}disablePlugin(){gR(jl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;s0(jl,this)||gR(jl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;s0(jl,this)||gR(jl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Yle(t){t.items.push({name:"---------"},Vle(this),Wle(this))}function Gle(t,e){if(s0(jl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Rm(t,e,n){return(e=qle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qle(t){var e=Kle(t,"string");return typeof e=="symbol"?e:e+""}function Kle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pR=0,eD=1,tD=2,nc="px";let aB=class{constructor(e){Rm(this,"hot",void 0),Rm(this,"_element",null),Rm(this,"state",pR),Rm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=tD}build(){this.state===pR&&(this._element=this.hot.rootDocument.createElement("div"),this.state=eD)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=pR}isAppended(){return this.state===tD}isBuilt(){return this.state>=eD}setPosition(e,n){Jn(e)&&(this._element.style.top=e+nc),Jn(n)&&(this._element.style[this.inlineProperty]=n+nc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Jn(e)&&(this._element.style.width=e+nc),Jn(n)&&(this._element.style.height=n+nc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Jn(e)&&(this._element.style.marginTop=e+nc),Jn(n)&&(this._element.style[`margin${ir(this.inlineProperty)}`]=n+nc)}getOffset(){const e=this._element.style,n=`margin${ir(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Xle="ht__manualColumnMove--backlight";let Zle=class extends aB{build(){super.build(),K(this._element,Xle)}};const Jle="ht__manualColumnMove--guideline";let Qle=class extends aB{build(){super.build(),K(this._element,Jle)}};function eue(t,e){lB(t,e),e.add(t)}function Hi(t,e,n){lB(t,e),e.set(t,n)}function lB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nr(t,e,n){return t.set(va(t,e),n),n}function ve(t,e){return t.get(va(t,e))}function va(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");const wR="manualColumnMove",tue=120,nD="ht__manualColumnMove",dw="show-ui",o0="on-moving--columns",a0="after-selection--columns";var pr=new WeakMap,Ra=new WeakMap,Do=new WeakMap,yp=new WeakMap,Pa=new WeakMap,mr=new WeakMap,Em=new WeakMap,ui=new WeakMap,pc=new WeakMap,fw=new WeakMap,Yd=new WeakMap,Pl=new WeakSet;class nue extends rt{constructor(){super(...arguments),eue(this,Pl),Hi(this,pr,new Zle(this.hot)),Hi(this,Ra,new Qle(this.hot)),Hi(this,Do,[]),Hi(this,yp,0),Hi(this,Pa,!1),Hi(this,mr,{}),Hi(this,Em,void 0),Hi(this,ui,void 0),Hi(this,pc,void 0),Hi(this,fw,void 0),Hi(this,Yd,void 0)}static get PLUGIN_KEY(){return wR}static get PLUGIN_PRIORITY(){return tue}isEnabled(){return!!this.hot.getSettings()[wR]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(Pl,e,rue).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(Pl,e,sue).call(e,...r)}),this.addHook("afterScrollVertically",()=>va(Pl,this,aue).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(Pl,e,lue).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),K(this.hot.rootElement,nD),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){_e(this.hot.rootElement,nD),this.unregisterEvents(),ve(pr,this).destroy(),ve(Ra,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=ve(Em,this),i=this.isMovePossible(e,n),s=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Nr(Em,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const o=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,o),o}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Nr(Em,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=mn(e,(i,s)=>(s<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=n;s+=1){const o=r.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[wR];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return Re(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ve(ui,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ve(ui,this)-1);const o=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ve(pr,this).getOffset().start,u=ve(pr,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,y=ln(this.hot.rootElement),C=m.innerWidth-ve(pc,this)-y;h=m.innerWidth-ve(mr,this).eventPageX-C-(r.scrollX===void 0?i:0)}else h=ve(mr,this).eventPageX-(ve(pc,this)-(r.scrollX===void 0?i:0));if(ve(fw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ve(ui,this))&&(s+=i),s+=c,ve(ui,this)<0)ve(Yd,this)>0?ve(mr,this).col=0:ve(mr,this).col=e>0?e-1:e;else if(ve(mr,this).TD.offsetWidth/2+s<=h){const m=ve(ui,this)>=ve(yp,this)?ve(yp,this)-1:ve(ui,this);ve(mr,this).col=m+1,s+=ve(mr,this).TD.offsetWidth}else ve(mr,this).col=ve(ui,this);let d=h,f=s;h+u+l>=o?d=o-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:r.scrollX!==void 0&&ve(ui,this)<ve(Yd,this)&&(f-=ve(pc,this)<=r.scrollX?ve(pc,this):0),ve(pr,this).setPosition(null,d),ve(Ra,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>va(Pl,this,iue).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>va(Pl,this,oue).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ve(pr,this).build(),ve(Ra,this).build()}destroy(){ve(pr,this).destroy(),ve(Ra,this).destroy(),super.destroy()}}function rue(t,e,n,r){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=Me(t.target,"sortAction");if(!o||!s||ve(Pa,this)||t.button!==0||a){Nr(Pa,this,!1),ve(Do,this).length=0,_e(this.hot.rootElement,[o0,dw]);return}const l=ve(Ra,this).isBuilt()&&!ve(Ra,this).isAppended(),u=ve(pr,this).isBuilt()&&!ve(pr,this).isAppended();l&&u&&(ve(Ra,this).appendTo(i.hider),ve(pr,this).appendTo(i.hider));const{from:c,to:h}=o,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Nr(Pa,this,!0);const m=n.firstChild?s$(t,n.firstChild).x:t.offsetX;ve(mr,this).eventPageX=t.pageX,Nr(ui,this,e.col),ve(mr,this).TD=n,ve(mr,this).col=e.col,Nr(Do,this,this.prepareColumnsToMoving(d,f)),Nr(fw,this,!!this.hot.getSettings().rowHeaders),Nr(yp,this,this.hot.countCols()),Nr(Yd,this,this.hot.getSettings().fixedColumnsStart),Nr(pc,this,xn(this.hot.rootElement).left);const y=ve(fw,this)?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,T=e.col<ve(Yd,this),x=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),O=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),b=this.getColumnsWidth(d,e.col-1)+O,H=this.getColumnsWidth(y,d-1)+(T?x:0)+b;ve(pr,this).setPosition(C,H),ve(pr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-C),ve(pr,this).setOffset(null,-b),K(this.hot.rootElement,o0)}else _e(this.hot.rootElement,a0),Nr(Pa,this,!1),ve(Do,this).length=0}function iue(t){ve(Pa,this)&&(ve(mr,this).eventPageX=t.pageX,this.refreshPositions())}function sue(t,e,n,r){!this.hot.getSelectedRangeLast()||!ve(Pa,this)||(ve(Do,this).indexOf(e.col)>-1?_e(this.hot.rootElement,dw):K(this.hot.rootElement,dw),r.row=!0,r.column=!0,r.cell=!0,Nr(ui,this,e.col),ve(mr,this).TD=n)}function oue(){const t=ve(mr,this).col,e=ve(Do,this).length;if(Nr(ui,this,void 0),Nr(Pa,this,!1),_e(this.hot.rootElement,[o0,dw,a0]),this.hot.selection.isSelectedByColumnHeader()&&K(this.hot.rootElement,a0),e<1||t===void 0)return;const n=ve(Do,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(ve(Do,this),t);if(ve(Do,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(r),o=s+e-1;this.hot.selectColumns(s,o)}}function aue(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;ve(pr,this).setPosition(r),ve(pr,this).setSize(null,t.hider.offsetHeight-r)}function lue(){this.moveBySettingsOrLoad()}function uue(t,e){uB(t,e),e.add(t)}function Un(t,e,n){uB(t,e),e.set(t,n)}function uB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function an(t,e,n){return t.set(Wi(t,e),n),n}function he(t,e){return t.get(Wi(t,e))}function Wi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gw="manualColumnResize",cue=130,rD="manualColumnWidths";var Eo=new WeakMap,Tm=new WeakMap,qr=new WeakMap,mw=new WeakMap,Vs=new WeakMap,hue=new WeakMap,Vc=new WeakMap,_m=new WeakMap,xr=new WeakMap,yo=new WeakMap,du=new WeakMap,pw=new WeakMap,Gd=new WeakMap,qd=new WeakMap,Xr=new WeakMap,Kd=new WeakMap,vs=new WeakSet;class due extends rt{static get PLUGIN_KEY(){return gw}static get PLUGIN_PRIORITY(){return cue}constructor(e){super(e),uue(this,vs),Un(this,Eo,null),Un(this,Tm,null),Un(this,qr,[]),Un(this,mw,null),Un(this,Vs,null),Un(this,hue,null),Un(this,Vc,null),Un(this,_m,null),Un(this,xr,this.hot.rootDocument.createElement("DIV")),Un(this,yo,this.hot.rootDocument.createElement("DIV")),Un(this,du,null),Un(this,pw,!1),Un(this,Gd,0),Un(this,qd,null),Un(this,Xr,void 0),Un(this,Kd,void 0),K(he(xr,this),"manualColumnResizer"),K(he(yo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[gw]}enablePlugin(){var e=this;this.enabled||(an(Xr,this,new Xa),he(Xr,this).addLocalHook("init",()=>Wi(vs,this,fue).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,he(Xr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Wi(vs,e,yue).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Wi(vs,e,vue).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Wi(vs,e,bue).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){an(Kd,this,he(Xr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",rD,he(Xr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",rD,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return he(Xr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);he(Xr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;an(Eo,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(he(Eo,this)),i=r.col;if(i<0)return;const s=en(he(Eo,this)),o=he(Eo,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(he(Eo,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(he(Eo,this),r.row,r.col)),an(Tm,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),an(qr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();F(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;Re(d,f,m=>{he(qr,this).includes(m)||he(qr,this).push(m)})})}he(qr,this).includes(he(Tm,this))||an(qr,this,[he(Tm,this)]),an(_m,this,l.start-6),an(Vc,this,parseInt(o.width,10)),he(xr,this).style.top=`${l.top}px`,he(xr,this).style[this.inlineDir]=`${he(_m,this)+he(Vc,this)}px`,he(xr,this).style.height=`${s}px`,this.hot.rootElement.appendChild(he(xr,this))}refreshHandlePosition(){he(xr,this).style[this.inlineDir]=`${he(_m,this)+he(mw,this)}px`}setupGuidePosition(){const e=parseInt(en(he(xr,this)),10),n=parseInt(he(xr,this).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);K(he(xr,this),"active"),K(he(yo,this),"active"),he(yo,this).style.top=`${n}px`,this.refreshGuidePosition(),he(yo,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(he(yo,this))}refreshGuidePosition(){he(yo,this).style[this.inlineDir]=he(xr,this).style[this.inlineDir]}hideHandleAndGuide(){_e(he(xr,this),"active"),_e(he(yo,this),"active")}checkIfColumnHeader(e){const n=Va(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const s=this.hot.runHooks("beforeColumnResize",he(Vs,this),r,!0);s!==void 0&&an(Vs,this,s),this.setManualSize(r,he(Vs,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",he(Vs,this),r,!0),i&&e()};he(Gd,this)>=2&&(he(qr,this).length>1?(F(he(qr,this),i=>{n(i)}),e()):F(he(qr,this),i=>{n(i,!0)})),an(Gd,this,0),an(qd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Wi(vs,this,gue).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Wi(vs,this,mue).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Wi(vs,this,pue).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Wi(vs,this,wue).call(this)),this.eventManager.addEventListener(he(xr,this),"contextmenu",()=>Wi(vs,this,Cue).call(this))}destroy(){super.destroy()}}function fue(){const t=this.hot.getSettings()[gw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{he(Xr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{he(Xr,this).setValueAtIndex(r,n)})},!0),an(Kd,this,t)):t===!0&&Array.isArray(he(Kd,this))&&this.hot.batchExecution(()=>{he(Kd,this).forEach((n,r)=>{he(Xr,this).setValueAtIndex(r,n)})},!0)}function gue(t){if(!RT(t.target)&&he(pw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(he(du,this)||this.setupHandlePosition(e))}}function mue(t){t.target.parentNode===this.hot.rootElement&&Me(t.target,"manualColumnResizer")&&(this.setupHandlePosition(he(Eo,this)),this.setupGuidePosition(),an(du,this,!0),he(qd,this)===null&&(an(qd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(he(qd,this))),an(Gd,this,he(Gd,this)+1),this.startX=t.pageX,an(Vs,this,he(Vc,this)))}function pue(t){if(he(du,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();an(mw,this,he(Vc,this)+e),F(he(qr,this),n=>{an(Vs,this,this.setManualSize(n,he(mw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function wue(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",he(Vs,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",he(Vs,this),n,!1)};he(du,this)&&(this.hideHandleAndGuide(),an(du,this,!1),he(Vs,this)!==he(Vc,this)&&(he(qr,this).length>1?(F(he(qr,this),r=>{e(r)}),t()):F(he(qr,this),r=>{e(r,!0)})),this.setupHandlePosition(he(Eo,this)))}function Cue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(he(xr,this)),this.hot.rootElement.removeChild(he(yo,this)),an(du,this,!1),an(pw,this,!0),this.hot._registerImmediate(()=>{an(pw,this,!1)})}function yue(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=he(Xr,this).getValueAtIndex(r);this.hot.getSettings()[gw]&&i&&(n=i)}return n}function vue(t,e){const n=he(Xr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function bue(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function CR(t,e,n){return(e=Sue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sue(t){var e=Rue(t,"string");return typeof e=="symbol"?e:e+""}function Rue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yR=0,iD=1,sD=2,rc="px";let cB=class{constructor(e){CR(this,"hot",void 0),CR(this,"_element",null),CR(this,"state",yR),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=sD}build(){this.state===yR&&(this._element=this.hot.rootDocument.createElement("div"),this.state=iD)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=yR}isAppended(){return this.state===sD}isBuilt(){return this.state>=iD}setPosition(e,n){e!==void 0&&(this._element.style.top=e+rc),n!==void 0&&(this._element.style.left=n+rc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+rc),n&&(this._element.style.height=n+rc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+rc),n&&(this._element.style.marginLeft=n+rc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Eue="ht__manualRowMove--backlight";class Tue extends cB{build(){super.build(),K(this._element,Eue)}}const _ue="ht__manualRowMove--guideline";class xue extends cB{build(){super.build(),K(this._element,_ue)}}function Mue(t,e){hB(t,e),e.add(t)}function ic(t,e,n){hB(t,e),e.set(t,n)}function hB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ql(t,e,n){return t.set(ba(t,e),n),n}function He(t,e){return t.get(ba(t,e))}function ba(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");const vR="manualRowMove",Iue=140,oD="ht__manualRowMove",ww="show-ui",l0="on-moving--rows",u0="after-selection--rows";var wr=new WeakMap,Ea=new WeakMap,Lo=new WeakMap,Oa=new WeakMap,Dr=new WeakMap,xm=new WeakMap,Ol=new WeakSet;class Pue extends rt{constructor(){super(...arguments),Mue(this,Ol),ic(this,wr,new Tue(this.hot)),ic(this,Ea,new xue(this.hot)),ic(this,Lo,[]),ic(this,Oa,void 0),ic(this,Dr,{}),ic(this,xm,void 0)}static get PLUGIN_KEY(){return vR}static get PLUGIN_PRIORITY(){return Iue}isEnabled(){return!!this.hot.getSettings()[vR]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Ol,e,Oue).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Ol,e,Hue).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>ba(Ol,this,Due).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Ol,e,Lue).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),K(this.hot.rootElement,oD),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){_e(this.hot.rootElement,oD),this.unregisterEvents(),He(wr,this).destroy(),He(Ea,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=He(xm,this),i=this.isMovePossible(e,n),s=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Ql(xm,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const o=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,o),o}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Ql(xm,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=mn(e,(i,s)=>(s<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=n;s++){const o=r.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[vR];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,s=Math.min(r.row,i.row),o=Math.max(r.row,i.row);return Re(s,o,a=>{n.push(a)}),n}refreshPositions(){const e=He(Dr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=He(Dr,this).TD,a=this.hot.rootElement,l=xn(a),u=au(a),c=s.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=He(Dr,this).eventPageY-d+c,m=s.hider.offsetHeight,y=s.TBODY.offsetTop,C=He(wr,this).getOffset().top,T=He(wr,this).getSize().height,x=o.offsetHeight/2,O=o.offsetHeight;let b=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const H=f>=b+x;this.isFixedRowTop(e.row)&&(b+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?He(Dr,this).row=n>0?n-1:n:H?(He(Dr,this).row=e.row+1,b+=e.row===0?O-1:O):He(Dr,this).row=e.row;let k=f,V=b;f+T+C>=m?k=m-T-C:f+C<y&&(k=y+Math.abs(C)),b>=m-1&&(V=m-1),He(wr,this).setPosition(k),He(Ea,this).setPosition(V)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ba(Ol,this,Aue).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ba(Ol,this,Nue).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){He(wr,this).build(),He(Ea,this).build()}destroy(){He(wr,this).destroy(),He(Ea,this).destroy(),super.destroy()}}function Oue(t,e,n,r){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||He(Oa,this)||t.button!==0){Ql(Oa,this,!1),He(Lo,this).length=0,_e(this.hot.rootElement,[l0,ww]);return}const l=He(Ea,this).isBuilt()&&!He(Ea,this).isAppended(),u=He(wr,this).isBuilt()&&!He(wr,this).isAppended();l&&u&&(He(Ea,this).appendTo(i.hider),He(wr,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,Ql(Oa,this,!0),He(Dr,this).eventPageY=t.pageY,He(Dr,this).coords=e,He(Dr,this).TD=n,Ql(Lo,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+s.getRowHeaderWidth(),y=this.getRowsHeight(d,e.row-1)+t.offsetY;He(wr,this).setPosition(null,m),He(wr,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),He(wr,this).setOffset(-y,null),K(this.hot.rootElement,l0),this.refreshPositions()}else _e(this.hot.rootElement,u0),Ql(Oa,this,!1),He(Lo,this).length=0}function Aue(t){He(Oa,this)&&(He(Dr,this).eventPageY=t.pageY,this.refreshPositions())}function Hue(t,e,n,r){!this.hot.getSelectedRangeLast()||!He(Oa,this)||(He(Lo,this).indexOf(e.row)>-1?_e(this.hot.rootElement,ww):K(this.hot.rootElement,ww),r.row=!0,r.column=!0,r.cell=!0,He(Dr,this).coords=e,He(Dr,this).TD=n)}function Nue(){const t=He(Dr,this).row,e=He(Lo,this).length;if(Ql(Oa,this,!1),_e(this.hot.rootElement,[l0,ww,u0]),this.hot.selection.isSelectedByRowHeader()&&K(this.hot.rootElement,u0),e<1||t===void 0)return;const n=He(Lo,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(He(Lo,this),t);if(He(Lo,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(r),o=s+e-1;this.hot.selectRows(s,o)}}function Due(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;He(wr,this).setPosition(null,r),He(wr,this).setSize(t.hider.offsetWidth-r)}function Lue(){this.moveBySettingsOrLoad()}function kue(t,e){dB(t,e),e.add(t)}function zn(t,e,n){dB(t,e),e.set(t,n)}function dB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kt(t,e,n){return t.set(To(t,e),n),n}function ue(t,e){return t.get(To(t,e))}function To(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Cw="manualRowResize",Fue=30,aD="manualRowHeights";var As=new WeakMap,Mm=new WeakMap,Kr=new WeakMap,Xd=new WeakMap,Ta=new WeakMap,yM=new WeakMap,Wc=new WeakMap,Im=new WeakMap,fr=new WeakMap,Ms=new WeakMap,fu=new WeakMap,yw=new WeakMap,Zd=new WeakMap,Jd=new WeakMap,Ui=new WeakMap,Qd=new WeakMap,ua=new WeakSet;class $ue extends rt{static get PLUGIN_KEY(){return Cw}static get PLUGIN_PRIORITY(){return Fue}constructor(e){super(e),kue(this,ua),zn(this,As,null),zn(this,Mm,null),zn(this,Kr,[]),zn(this,Xd,null),zn(this,Ta,null),zn(this,yM,null),zn(this,Wc,null),zn(this,Im,null),zn(this,fr,this.hot.rootDocument.createElement("DIV")),zn(this,Ms,this.hot.rootDocument.createElement("DIV")),zn(this,fu,!1),zn(this,yw,!1),zn(this,Zd,0),zn(this,Jd,null),zn(this,Ui,void 0),zn(this,Qd,void 0),K(ue(fr,this),"manualRowResizer"),K(ue(Ms,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Cw]}enablePlugin(){this.enabled||(Kt(Ui,this,new Xa),ue(Ui,this).addLocalHook("init",()=>To(ua,this,Yue).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ue(Ui,this)),this.addHook("modifyRowHeight",(e,n)=>To(ua,this,zue).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Kt(Qd,this,ue(Ui,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",aD,ue(Ui,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",aD,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return ue(Ui,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ue(Xd,this)}setupHandlePosition(e){Kt(As,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ue(As,this)),s=i.row;if(s<0)return;const o=ln(ue(As,this)),a=ue(As,this).getBoundingClientRect(),l=s<r.getSetting("fixedRowsTop"),u=s>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ue(As,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ue(As,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ue(As,this),i.row,i.col)),Kt(Mm,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Kt(Kr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();F(d,f=>{const m=f.getTopStartCorner().row,y=f.getBottomStartCorner().row;Re(m,y,C=>{ue(Kr,this).includes(C)||ue(Kr,this).push(C)})})}ue(Kr,this).includes(ue(Mm,this))||Kt(Kr,this,[ue(Mm,this)]),Kt(Im,this,c.top-6),Kt(Wc,this,parseInt(a.height,10)),ue(fr,this).style.top=`${ue(Im,this)+ue(Wc,this)}px`,ue(fr,this).style[this.inlineDir]=`${c.start}px`,ue(fr,this).style.width=`${o}px`,this.hot.rootElement.appendChild(ue(fr,this))}refreshHandlePosition(){ue(fr,this).style.top=`${ue(Im,this)+ue(Xd,this)}px`}setupGuidePosition(){const e=parseInt(ln(ue(fr,this)),10),n=parseInt(ue(fr,this).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);K(ue(fr,this),"active"),K(ue(Ms,this),"active"),ue(Ms,this).style.top=ue(fr,this).style.top,ue(Ms,this).style[this.inlineDir]=`${n}px`,ue(Ms,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ue(Ms,this))}refreshGuidePosition(){ue(Ms,this).style.top=ue(fr,this).style.top}hideHandleAndGuide(){_e(ue(fr,this),"active"),_e(ue(Ms,this),"active")}checkIfRowHeader(e){const n=Va(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ue(Ta,this)<n?n:ue(Ta,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);s!==void 0&&Kt(Ta,this,s),this.setManualSize(r,ue(Ta,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ue(Zd,this)>=2&&(ue(Kr,this).length>1?(F(ue(Kr,this),i=>{n(i)}),e()):F(ue(Kr,this),i=>{n(i,!0)})),Kt(Zd,this,0),Kt(Jd,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>To(ua,this,Vue).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>To(ua,this,Wue).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>To(ua,this,Bue).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>To(ua,this,jue).call(this)),this.eventManager.addEventListener(ue(fr,this),"contextmenu",()=>To(ua,this,Uue).call(this))}destroy(){super.destroy()}}function Vue(t){if(!RT(t.target)&&ue(yw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ue(fu,this)||this.setupHandlePosition(e))}}function Wue(t){Me(t.target,"manualRowResizer")&&(this.setupHandlePosition(ue(As,this)),this.setupGuidePosition(),Kt(fu,this,!0),ue(Jd,this)===null&&(Kt(Jd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ue(Jd,this))),Kt(Zd,this,ue(Zd,this)+1),Kt(yM,this,t.pageY),Kt(Ta,this,ue(Wc,this)))}function Bue(t){ue(fu,this)&&(Kt(Xd,this,ue(Wc,this)+(t.pageY-ue(yM,this))),F(ue(Kr,this),e=>{Kt(Ta,this,this.setManualSize(e,ue(Xd,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function jue(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ue(fu,this)&&(this.hideHandleAndGuide(),Kt(fu,this,!1),ue(Ta,this)!==ue(Wc,this)&&(ue(Kr,this).length>1?(F(ue(Kr,this),r=>{e(r)}),t()):F(ue(Kr,this),r=>{e(r,!0)})),this.setupHandlePosition(ue(As,this)))}function Uue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ue(fr,this)),this.hot.rootElement.removeChild(ue(Ms,this)),Kt(fu,this,!1),Kt(yw,this,!0),this.hot._registerImmediate(()=>{Kt(yw,this,!1)})}function zue(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ue(Ui,this).getValueAtIndex(r);this.hot.getSettings()[Cw]&&i&&(n=i)}return n}function Yue(){const t=this.hot.getSettings()[Cw],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ue(Ui,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ue(Ui,this).setValueAtIndex(r,n)}),Kt(Qd,this,t)):t===!0&&Array.isArray(ue(Qd,this))&&ue(Qd,this).forEach((n,r)=>{ue(Ui,this).setValueAtIndex(r,n)})},!0)}var lD={},uD;function Gue(){if(uD)return lD;uD=1;var t=mC();return t("flatMap"),lD}Gue();var cD={},hD={},bR,dD;function que(){if(dD)return bR;dD=1;var t=or(),e=bn(),n=Ks(),r=B0();return bR=function(i,s){(!s||typeof i!="string")&&e(i);var o=r(i);return n(e(o!==void 0?t(o,i):i))},bR}var fD;function Kue(){if(fD)return hD;fD=1;var t=Mt(),e=or(),n=kr(),r=bn(),i=Ks(),s=que(),o=W0(),a=eh(),l=Ga(),u=o(function(){for(var c=this.iterator,h=this.mapper,d,f;;){if(f=this.inner)try{if(d=r(e(f.next,f.iterator)),!d.done)return d.value;this.inner=null}catch(m){a(c,"throw",m)}if(d=r(e(this.next,c)),this.done=!!d.done)return;try{this.inner=s(h(d.value,this.counter++),!1)}catch(m){a(c,"throw",m)}}});return t({target:"Iterator",proto:!0,real:!0,forced:l},{flatMap:function(h){return r(this),n(h),new u(i(this),{mapper:h,inner:null})}}),hD}var gD;function Xue(){return gD||(gD=1,Kue()),cD}Xue();function Zue(t,e,n){Jue(t,e),e.set(t,n)}function Jue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Al(t,e,n){return(e=Que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Que(t){var e=ece(t,"string");return typeof e=="symbol"?e:e+""}function ece(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mD(t,e){return t.get(fB(t,e))}function Pm(t,e,n){return t.set(fB(t,e),n),n}function fB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hl=new WeakMap;class Hs{constructor(e,n,r,i,s,o){Al(this,"row",void 0),Al(this,"col",void 0),Al(this,"rowspan",void 0),Al(this,"colspan",void 0),Al(this,"removed",!1),Al(this,"cellCoordsFactory",void 0),Al(this,"cellRangeFactory",void 0),Zue(this,Hl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:s}=e;return pt`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return pt`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return pt`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return pt`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:s}=e;return n<0||r<0||i<0||s<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),Pm(Hl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[o],c=this[o]+this[s]-1;if(u>=n&&(this[o]+=r),r>0)n<=c&&n>u&&(this[s]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,Pm(Hl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[o]-=d+r,this[s]-=h}else if(u<=a&&c>=l)this[s]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[s]-=h}}return Pm(Hl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return mD(Hl,this)||Pm(Hl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),mD(Hl,this)}}function tce(t,e){nce(t,e),e.add(t)}function nce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Om(t,e,n){return(e=rce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rce(t){var e=ice(t,"string");return typeof e=="symbol"?e:e+""}function ice(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ca=new WeakSet;class vw{constructor(e){tce(this,ca),Om(this,"plugin",void 0),Om(this,"mergedCells",[]),Om(this,"mergedCellsMatrix",new Map),Om(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return pt`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){let n=!1;return F(this.mergedCells,r=>r.row<=e.from.row&&r.row+r.rowspan-1>=e.to.row&&r.col<=e.from.col&&r.col+r.colspan-1>=e.to.col?(n=r,n):!0),n}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let u=s;u<s+l;u++)for(let c=o;c<o+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=s;h<s+l;h++){for(let d=o;d<o+a;d++){const f=`r${h},c${d}`;if(n.has(f)){ht(vw.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=r;l<=s;l++)for(let u=i;u<=o;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new Hs(r,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Nl(ca,this,pD).call(this,a),a):(ht(vw.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Nl(ca,this,sce).call(this,r),r):!1}clear(){F(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:s}=e;Re(n,n+i,o=>{Re(r,r+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:s,rowspan:o,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Je(u,i,i+o-1),d=Je(c,s,s+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,n){const r=Nl(ca,this,Am).call(this,e,"col",-1);let i=n;for(let s=0;s<r.length;s++)if(r[s]<=n){i=r[s];break}return i}getEndMostColumnIndex(e,n){const r=Nl(ca,this,Am).call(this,e,"col",1);let i=n;for(let s=0;s<r.length;s++)if(r[s]>=n){i=r[s];break}return i}getTopMostRowIndex(e,n){const r=Nl(ca,this,Am).call(this,e,"row",-1);let i=n;for(let s=0;s<r.length;s++)if(r[s]<=n){i=r[s];break}return i}getBottomMostRowIndex(e,n){const r=Nl(ca,this,Am).call(this,e,"row",1);let i=n;for(let s=0;s<r.length;s++)if(r[s]>=n){i=r[s];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,n),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{Nl(ca,this,pD).call(this,o)})}}function Am(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),s=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=i.row;n===1?o<=s.row:o>=s.row;o+=n)for(let a=i.col;n===1?a<=s.col:a>=s.col;a+=n){const l=e==="row"?o:a,u=this.get(o,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function pD(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function sce(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function SR(t,e,n){return(e=oce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oce(t){var e=ace(t,"string");return typeof e=="symbol"?e:e+""}function ace(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lce{constructor(e){SR(this,"plugin",void 0),SR(this,"mergedCellsCollection",void 0),SR(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const s=n.slice(0),o=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(o/d)*d,m=o-f,y=this.getFarthestCollection(e,n,r,i);if(y){if(r==="down"){const C=y.row+y.rowspan-a-m;s[2]+C>=this.plugin.hot.countRows()?s[2]-=m:s[2]+=m?C:0}else if(r==="right"){const C=y.col+y.colspan-l-m;s[3]+C>=this.plugin.hot.countCols()?s[3]-=m:s[3]+=m?C:0}else if(r==="up"){const C=u-m-y.row+1;s[0]+C<0?s[0]+=m:s[0]-=m?C:0}else if(r==="left"){const C=c-m-y.col+1;s[1]+C<0?s[1]+=m:s[1]-=m?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),fn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,s,o,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-o;case"left":return s-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,s,o,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[o+1,s,c,a];case"left":return[l,u,o,s-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[s,o,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?s:o,d=this.getAutofillSize(e,n,r),f=u?a-s+1:l-o+1,m=Math.floor(d/f)*f,y=d-m;let C=null,T=null,x=null;switch(r){case"up":C="includesVertically",x=c-y+1;break;case"left":C="includesHorizontally",x=c-y+1;break;case"down":C="includesVertically",x=h+y-1;break;case"right":C="includesHorizontally",x=h+y-1;break}return F(i,O=>{O[C](x)&&O.isFarther(T,r)&&(T=O)}),T}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return F(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(n.min===null||s<n.min)&&(n.min=s),(n.max===null||s>n.max)&&(n.max=s),(r.min===null||o<r.min)&&(r.min=o),(r.max===null||o>r.max)&&(r.max=o)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[s,o,a,l]=i,u=this.plugin.hot._createCellCoords(s,o),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return this.mergedCellsCollection.getWithinRange(h,!0).length>0}}function RR(t,e,n){return(e=uce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uce(t){var e=cce(t,"string");return typeof e=="symbol"?e:e+""}function cce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hce{constructor(e){RR(this,"plugin",void 0),RR(this,"hot",void 0),RR(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(s<=c.row&&o<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<r.length;i+=1){const s=[];for(let o=0;o<n.length;o+=1)s[o]=n[o].includes(r[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function dce(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(M_)}return this.getTranslatedPhrase(x_)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Hs.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function ef(t,e,n){return(e=fce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fce(t){var e=gce(t,"string");return typeof e=="symbol"?e:e+""}function gce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wD{constructor(e){ef(this,"data",void 0),ef(this,"next",null),ef(this,"prev",null),this.data=e}}class Hm{constructor(){ef(this,"first",null),ef(this,"last",null)}push(e){const n=new wD(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new wD(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function mce(t,e){gB(t,e),e.add(t)}function Dl(t,e,n){gB(t,e),e.set(t,n)}function gB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ut(t,e){return t.get(bw(t,e))}function Vr(t,e,n){return t.set(bw(t,e),n),n}function bw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bs=new WeakMap,Ss=new WeakMap,Rs=new WeakMap,Es=new WeakMap,c0=new WeakMap,Nm=new WeakMap,Dm=new WeakMap,ER=new WeakSet;class pce{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;mce(this,ER),Dl(this,bs,new Hm),Dl(this,Ss,new Hm),Dl(this,Rs,null),Dl(this,Es,null),Dl(this,c0,null),Dl(this,Nm,null),Dl(this,Dm,null),Vr(c0,this,n),Vr(Nm,this,r),Vr(Dm,this,i)}getCurrentVerticalNode(){return ut(Es,this).data}getFirstVerticalNode(){return ut(Ss,this).first.data}getNextVerticalNode(){return ut(Es,this).next.data}getPrevVerticalNode(){return ut(Es,this).prev.data}getCurrentHorizontalNode(){return ut(Rs,this).data}getFirstHorizontalNode(){return ut(bs,this).first.data}getNextHorizontalNode(){return ut(Rs,this).next.data}getPrevHorizontalNode(){return ut(Rs,this).prev.data}setPrevNodeAsActive(){Vr(Es,this,ut(Es,this).prev),Vr(Rs,this,ut(Rs,this).prev)}setNextNodeAsActive(){Vr(Es,this,ut(Es,this).next),Vr(Rs,this,ut(Rs,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Vr(bs,this,new Hm);for(let o=n.row;o<=r.row;o++)if(!ut(Nm,this).isHidden(o))for(let a=n.col;a<=r.col;a++){if(ut(Dm,this).isHidden(a))continue;const l=bw(ER,this,CD).call(this,e,ut(bs,this),i,o,a);l&&Vr(Rs,this,l)}ut(bs,this).first&&(ut(bs,this).first.prev=ut(bs,this).last,ut(bs,this).last.next=ut(bs,this).first);const s=new WeakSet;Vr(Ss,this,new Hm);for(let o=n.col;o<=r.col;o++)if(!ut(Dm,this).isHidden(o))for(let a=n.row;a<=r.row;a++){if(ut(Nm,this).isHidden(a))continue;const l=bw(ER,this,CD).call(this,e,ut(Ss,this),s,a,o);l&&Vr(Es,this,l)}ut(Ss,this).first&&(ut(Ss,this).first.prev=ut(Ss,this).last,ut(Ss,this).last.next=ut(Ss,this).first)}setActiveNode(e,n){return ut(bs,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&n>=o&&n<=a)return Vr(Rs,this,r),!1}),ut(Ss,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&n>=o&&n<=a)return Vr(Es,this,r),!1}),this}}function CD(t,e,n,r,i){const s=t.getTopStartCorner(),o=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=ut(c0,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function wce(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e;function i(){}function s(o,a,l){const u=t.mergedCellsCollection.get(a,l);if(!We(u)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:c,col:h,colspan:d,rowspan:f}=u,[m,y]=t.translateMergedCellToRenderable(c,f,h,d),C=t.getSetting("virtualized"),T=n.getRenderableFromVisualIndex(a),x=r.getRenderableFromVisualIndex(l),O=m-T+1,b=y-x+1;let H=n.getNearestNotHiddenIndex(c,1),k=r.getNearestNotHiddenIndex(h,1);if(C){const Z=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(Z)||(H=Math.max(H,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(Z)||(k=Math.max(k,e.getFirstRenderedVisibleColumn()))}const V=Math.min(f,O),U=Math.min(d,b);H===a&&k===l?(o.setAttribute("rowspan",V),o.setAttribute("colspan",U)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:i,after:s}}function Cce(t,e){mB(t,e),e.add(t)}function Lm(t,e,n){mB(t,e),e.set(t,n)}function mB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TR(t,e,n){return(e=yce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yce(t){var e=vce(t,"string");return typeof e=="symbol"?e:e+""}function vce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mf(t,e,n){return t.set(ct(t,e),n),n}function _t(t,e){return t.get(ct(t,e))}function ct(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");const h0="mergeCells",bce=150,yD=h0;var pi=new WeakMap,wi=new WeakMap,Ws=new WeakMap,vD=new WeakMap,dt=new WeakSet;class Sce extends rt{constructor(){super(...arguments),Cce(this,dt),TR(this,"mergedCellsCollection",null),TR(this,"autofillCalculations",null),TR(this,"selectionCalculations",null),Lm(this,pi,null),Lm(this,wi,{row:0,col:0}),Lm(this,Ws,new pce({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Lm(this,vD,wce(this))}static get PLUGIN_KEY(){return h0}static get PLUGIN_PRIORITY(){return bce}static get DEFAULT_SETTINGS(){return{[FV]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[h0]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new vw(this),this.autofillCalculations=new lce(this),this.selectionCalculations=new hce(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Rce).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Tce).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,_ce).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,xce).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Mce).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,SD).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,SD).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Pce).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Oce).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Ace).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,bD).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,bD).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Ece).call(e,...r)}),this.addHook("afterRenderer",function(){return _t(vD,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Ice).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Hce).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Nce).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Dce).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Lce).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,kce).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Fce).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,$ce).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Vce).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Wce).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Bce).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,jce).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Uce).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,zce).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(dt,e,Yce).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!MT())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:s}=r;for(let o=i+1;o<i+s;o++)n.push(o)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=ff(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=ff(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Hs.containsNegativeValues(e)?(ht(Hs.NEGATIVE_VALUES_WARNING(e)),!1):Hs.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(ht(Hs.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Hs.isSingleCell(e)?(ht(Hs.IS_SINGLE_CELL(e)),!1):Hs.containsZeroSpan(e)?(ht(Hs.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:s,col:o,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(s,o),c=this.hot._createCellCoords(s+a-1,o+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=s;d<s+a;d++)for(let f=o;f<o+l;f++)(d!==s||f!==o)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,n)?(this.hot.runHooks("beforeMergeCells",e,n),Re(0,o.rowspan-1,c=>{Re(0,o.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+c,o.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,n)?(r?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),F(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),Re(0,i.rowspan-1,s=>{Re(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,n,r,i){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:yD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yD)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(i,s);if(We(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(i,s);if(We(o)){const a=o.row+o.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,i);if(We(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,i);if(We(o)){const a=o.col+o.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;n===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=o.getNearestNotHiddenIndex(r,1):l=o.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,c=r>=0?o.getRenderableFromVisualIndex(l):r;return[u,c]}}function Rce(){this.generateFromSettings(),this.hot.render()}function Ece(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(r.row===e[s].row&&r.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return t}function Tce(t){_t(wi,this).row=t.row,_t(wi,this).col=t.col}function _ce(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;_t(pi,this)&&(i.getRenderableFromVisualIndex(_t(pi,this).row)!==null&&(n.row=_t(pi,this).row),r.getRenderableFromVisualIndex(_t(pi,this).col)!==null&&(n.col=_t(pi,this).col),Mf(pi,this,null));const s=this.mergedCellsCollection.get(n.row,n.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const c=n.col>=o&&n.col<=a?o-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=o&&n.col<=a?a+1:o,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function xce(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;o(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;o(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;o(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;o(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Mce(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Mf(pi,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Mf(pi,this,e.clone()),n&&e.assign(n)}function bD(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:s,col:o,colspan:a,rowspan:l}=i,u=s,c=o,h=s+l-1,d=o+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),m=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),y=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Je(m,u,h),Je(y,c,d),Je(this.hot.getLastRenderedVisibleRow(),u,h),Je(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Ice(t){t.items.push({name:"---------"},dce(this))}function SD(){Mf(pi,this,null)}function Pce(){if(_t(pi,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=_t(pi,this).clone().normalize();_t(Ws,this).setActiveNode(r.row,r.col),_t(wi,this).row>0||_t(wi,this).col>0?_t(Ws,this).setPrevNodeAsActive():(n==="E-W"&&_t(wi,this).col<0||e==="S-N"&&_t(wi,this).row<0)&&_t(Ws,this).setNextNodeAsActive()}function Oce(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let s=null,o=null;if(_t(wi,this).col<0){const{rowEnd:a,colEnd:l}=_t(Ws,this).getPrevHorizontalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(_t(wi,this).col>0){const{rowStart:a,colStart:l}=_t(Ws,this).getNextHorizontalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}else if(_t(wi,this).row<0){const{rowEnd:a,colEnd:l}=_t(Ws,this).getPrevVerticalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(_t(wi,this).row>0){const{rowStart:a,colStart:l}=_t(Ws,this).getNextVerticalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}_t(Ws,this).setActiveNode(t,e),Mf(wi,this,{row:0,col:0})}function Ace(){this.hot.getSelectedRangeLast().isHeader()||_t(Ws,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Hce(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Nce(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Dce(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Lce(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,s),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0||(r=this.autofillCalculations.snapDragArea(e,r,n,a)),r}function kce(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Fce(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function $ce(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Vce(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Wce(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Bce(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);F(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function jce(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Uce(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function zce(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function Yce(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const o=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{var f;let{rowspan:m}=d,y=0;n==="top"||n==="top_inline_start_corner"?y=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):y=m-h,t=Math.max((f=t)!==null&&f!==void 0?f:0,ct(dt,this,Gce).call(this,e,y))}),t}function Gce(t,e){const n=this.hot.view.getDefaultRowHeight(),r=this.hot.getPlugin("autoRowSize");let i=0;for(let o=t;o<t+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var s;i+=(s=r==null?void 0:r.getRowHeight(o))!==null&&s!==void 0?s:n}return i}function qce(t,e){return function(n,r){const[,...i]=n,[,...s]=r;return function o(a){const l=t[a],u=e[a],c=i[a],h=s[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:zV(u.type))(l,u,d)(c,h);if(m===zs){const y=a+1;if(typeof e[y]<"u")return o(y)}return m}(0)}}function RD(){ht(pt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const pB="sort";function Kce(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${pB}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Xce(t){const e=t.className.split(" "),n=new RegExp(`^${pB}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Zce(t,e,n){return(e=Jce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jce(t){var e=Qce(t,"string");return typeof e=="symbol"?e:e+""}function Qce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Sw="multiColumnSorting",ehe=170,_R="columnSorting",ED=Sw;UV(Sw,qce);class the extends eW{constructor(){super(...arguments),Zce(this,"pluginKey",Sw)}static get PLUGIN_KEY(){return Sw}static get PLUGIN_PRIORITY(){return ehe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[_R]&&(RD(),this.hot.getPlugin(_R).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,rw)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Za,position:"before",group:ED})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ED)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),_e(e,Xce(e)),this.enabled!==!1&&K(e,Kce(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[_R]&&RD(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){sM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,rw))):this.sort(this.getColumnNextConfig(n.col)))}}function TD(t,e,n){return(e=nhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nhe(t){var e=rhe(t,"string");return typeof e=="symbol"?e:e+""}function rhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ihe="multipleSelectionHandles",she=160;class ohe extends rt{constructor(){super(...arguments),TD(this,"dragged",[]),TD(this,"lastSetCell",null)}static get PLUGIN_KEY(){return ihe}static get PLUGIN_PRIORITY(){return she}isEnabled(){return Ho()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let s;if(Me(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(Me(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Me(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Me(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,u,c,h;if(e.dragged.length===0)return;const d=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,o.col)};break;case"SE-NW":s==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":s==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":s==="top"?c={start:n,end:o}:c.end=n;break;case"SW-NE":s==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?c={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(o.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":s==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(o.row,n.col)};break;case"SE-NW":s==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(o.row,n.col)}:s==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(c.end=n);break;case"SE-NW":s==="top"?c.end=n:c={start:n,end:o};break}break}return c}isDragged(){return this.dragged.length>0}}function d0(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function wB(){return{label:"",isPlaceholder:!0}}function ahe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;F(t,i=>{const s=[];let o=0;n.push(s),F(i,a=>{const l=d0();if(We(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Jt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Jt(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)s.push(wB());return!u})});const r=Math.max(...qe(n,i=>i.length));return F(n,i=>{if(i.length<r){const s=qe(new Array(r-i.length),()=>d0());i.splice(i.length,0,...s)}}),n}function xR(t,e,n){lhe(t,e),e.set(t,n)}function lhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ni(t,e){return t.get(CB(t,e))}function hd(t,e,n){return t.set(CB(t,e),n),n}function CB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _D=["label","collapsible"];var mo=new WeakMap,Ll=new WeakMap,MR=new WeakMap;class uhe{constructor(){xR(this,mo,[]),xR(this,Ll,0),xR(this,MR,1/0)}setColumnsLimit(e){hd(MR,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];hd(mo,this,ahe(e,Ni(MR,this))),hd(Ll,this,Ni(mo,this).length)}getData(){return Ni(mo,this)}mergeWith(e){F(e,n=>{let{row:r,col:i,...s}=n;const o=this.getHeaderSettings(r,i);o!==null&&fn(o,s,_D)})}map(e){F(Ni(mo,this),n=>{F(n,r=>{const i=e({...r});We(i)&&fn(r,i,_D)})})}getHeaderSettings(e,n){var r;if(e>=Ni(Ll,this)||e<0)return null;const i=Ni(mo,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Ni(Ll,this)||e<0)return i;const s=Ni(mo,this)[e];let o=0;for(let a=n;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===r)break;if(o>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Ni(Ll,this)}getColumnsCount(){return Ni(Ll,this)>0?Ni(mo,this)[0].length:0}clear(){hd(mo,this,[]),hd(Ll,this,0)}}function IR(t,e,n){return(e=che(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function che(t){var e=hhe(t,"string");return typeof e=="symbol"?e:e+""}function hhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yB="DF-pre-order";function vB(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=vB.call(this.childs[r],t,e)}return n}const dhe="DF-post-order";function bB(t,e){for(let n=0;n<this.childs.length;n++)if(bB.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const SB="BF";function fhe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const ghe=SB,xD=new Map([[yB,vB],[dhe,bB],[SB,fhe]]);class Rw{constructor(e){IR(this,"data",{}),IR(this,"parent",null),IR(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Rw({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ghe;if(!xD.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);xD.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function PR(t,e,n){mhe(t,e),e.set(t,n)}function mhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(t,e){return t.get(RB(t,e))}function phe(t,e,n){return t.set(RB(t,e),n),n}function RB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sc=new WeakMap,kl=new WeakMap,oc=new WeakMap;class whe{constructor(e){PR(this,sc,new Map),PR(this,kl,new Map),PR(this,oc,null),phe(oc,this,e)}getRoots(){return Array.from(hr(sc,this).values())}getRootByColumn(e){let n;return hr(kl,this).has(e)&&(n=hr(sc,this).get(hr(kl,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-hr(kl,this).get(n);let s=0,o;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=n===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;hr(kl,this).clear(),F(hr(sc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)hr(kl,this).set(i,e);e+=r})}buildTree(){this.clear();const e=hr(oc,this).getColumnsCount();let n=0;for(;n<e;){const r=hr(oc,this).getHeaderSettings(0,n),i=new Rw;hr(sc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=hr(oc,this).getHeadersSettings(r,n,i);r+=1,F(s,o=>{const a={...o,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Rw(a),e.addChild(l)),r<hr(oc,this).getLayersCount()&&this.buildLeaves(l,n,r,o.origColspan),n+=o.origColspan})}clear(){hr(sc,this).clear(),hr(kl,this).clear()}}function EB(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let s=1;s<r.colspan;s++)e(r.columnIndex+s)})}function Ew(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Tw(t){return Ew(t,"origColspan")===t.data.origColspan}function vM(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Tw(t))return vM(n[0]);e.isCollapsed=!1;const i=n.slice(1),s=new Set;let o=0;if(i.length>0)F(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,EB(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let c=1;c<l;c++)s.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Tw(a)&&(l.isCollapsed=Ew(a,"isCollapsed"))}),{rollbackModification:()=>bM(t),affectedColumns:Array.from(s),colspanCompensation:o}}function bM(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Tw(t))return bM(r[0]);n.isCollapsed=!0;const s=r.slice(1),o=new Set;if(s.length>0)F(s,l=>{EB(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;o.add(h)}}const a=n.colspan-((e=Ew(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Tw(l)&&(u.isCollapsed=Ew(l,"isCollapsed"))}),{rollbackModification:()=>vM(t),affectedColumns:Array.from(o),colspanCompensation:a}}function Che(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(pt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function yhe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(pt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const MD=new Map([["collapse",bM],["expand",vM],["hide-column",Che],["show-column",yhe]]);function vhe(t,e,n){if(!MD.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return MD.get(t)(e,n)}function km(t){const e=[];return F(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,u=She(e,a);let c=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||c)u.push(wB());else{const f=bhe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function bhe(t){const{crossHiddenColumns:e,...n}=d0(t);return n}function She(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function OR(t,e,n){Rhe(t,e),e.set(t,n)}function Rhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dd(t,e,n){return t.set(TB(t,e),n),n}function Yt(t,e){return t.get(TB(t,e))}function TB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ts=new WeakMap,_r=new WeakMap,Fl=new WeakMap;class Ehe{constructor(){OR(this,Ts,new uhe),OR(this,_r,new whe(Yt(Ts,this))),OR(this,Fl,[[]])}setState(e){Yt(Ts,this).setData(e);let n=!1;try{Yt(_r,this).buildTree()}catch{Yt(_r,this).clear(),Yt(Ts,this).clear(),n=!0}return dd(Fl,this,km(Yt(_r,this).getRoots())),n}setColumnsLimit(e){Yt(Ts,this).setColumnsLimit(e)}mergeStateWith(e){const n=qe(e,r=>{let{row:i,...s}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});Yt(Ts,this).mergeWith(n),Yt(_r,this).buildTree(),dd(Fl,this,km(Yt(_r,this).getRoots()))}mapState(e){Yt(Ts,this).map(e),Yt(_r,this).buildTree(),dd(Fl,this,km(Yt(_r,this).getRoots()))}mapNodes(e){return mn(Yt(_r,this).getRoots(),(n,r)=>(r.walkDown(i=>{const s=e(i.data);s!==void 0&&n.push(s)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Yt(_r,this).getNode(n,r);let s;return i&&(s=vhe(e,i,r),dd(Fl,this,km(Yt(_r,this).getRoots()))),s}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Yt(Fl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Yt(_r,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let s=!1,o=null;for(let a=e;a<=r;a++){const l=Yt(_r,this).getRootByColumn(a);if(!l)break;s=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:f}=u.data;f||d<=i&&c>=e&&c+d-1<=r&&(o===null||h<o)&&(o=h)},yB)}return s&&o===null?-1:this.levelToRowCoords((n=o)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let s=n-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:s}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+s-1;let o=n+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return Yt(Ts,this).getLayersCount()}getColumnsCount(){return Yt(Ts,this).getColumnsCount()}clear(){dd(Fl,this,[]),Yt(Ts,this).clear(),Yt(_r,this).clear()}}function fd(t,e,n){return(e=The(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function The(t){var e=_he(t,"string");return typeof e=="symbol"?e:e+""}function _he(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xhe{constructor(e,n){fd(this,"hot",void 0),fd(this,"nestedHeaderSettingsGetter",void 0),fd(this,"layersCount",0),fd(this,"container",void 0),fd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),s=n.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;o&&(m+='<button class="changeType"></button>'),Su(d,m),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function Mhe(t,e){_B(t,e),e.add(t)}function ID(t,e,n){return(e=Ihe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ihe(t){var e=Phe(t,"string");return typeof e=="symbol"?e:e+""}function Phe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gd(t,e,n){_B(t,e),e.set(t,n)}function _B(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ko(t,e,n){return t.set(Gt(t,e),n),n}function Qe(t,e){return t.get(Gt(t,e))}function Gt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const PD="nestedHeaders",Ohe=280;var bt=new WeakMap,ha=new WeakMap,tf=new WeakMap,jC=new WeakMap,_w=new WeakMap,nn=new WeakSet;class Ahe extends rt{constructor(){super(...arguments),Mhe(this,nn),gd(this,bt,new Ehe),gd(this,ha,null),gd(this,tf,null),gd(this,jC,!1),gd(this,_w,null),ID(this,"ghostTable",new xhe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),ID(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return PD}static get PLUGIN_PRIORITY(){return Ohe}isEnabled(){return!!this.hot.getSettings()[PD]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&ht(pt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Gt(nn,this,qhe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Khe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Lhe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,khe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Fhe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,$he).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Vhe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Whe).call(e,...i)}),this.addHook("afterSelection",()=>Gt(nn,this,Fm).call(this)),this.addHook("afterSelectionFocusSet",()=>Gt(nn,this,Fm).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Hhe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Gt(nn,this,jhe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,zhe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Yhe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Nhe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Dhe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Bhe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Uhe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(nn,e,Ghe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Gt(nn,this,Fm).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Gt(nn,this,Fm).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Qe(bt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Qe(bt,this).setState(e)),this.detectedOverlappedHeaders&&ht(pt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";Qe(bt,this).triggerColumnModification(i,r)}),!Qe(ha,this)&&this.enabled&&ko(ha,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:s,newValue:o}=r;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Qe(bt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Qe(bt,this).clear(),Qe(ha,this).unsubscribe(),ko(ha,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Qe(bt,this)}getLayersCount(){return Qe(bt,this).getLayersCount()}getHeaderSettings(e,n){return Qe(bt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<n;o++){const a=r.childNodes[o];if(!a)break;const l=i.childNodes[o],u=s?s.childNodes[o]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),_e(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),_e(l.childNodes[c],"hiddenHeader")),s&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),_e(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),_e(s,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(o=Qe(bt,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{label:""};if(d||h)K(s,"hiddenHeader");else if(c>1){var m,y;const{wtOverlays:C}=l._wt,T=(m=C.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),x=(y=C.inlineStartOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(s),O=T||x?Math.min(c,r-i):c;O>1&&s.setAttribute("colspan",O)}if(this.hot.view.appendColHeader(u,s,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const C=s.querySelector("div.relative");C&&f&&f.length>0&&(_e(C,this.hot.getColumnMeta(u).headerClassName),K(C,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:s}=(r=Qe(bt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return s||i?"":this.hot.getColHeader(e,n)}destroy(){ko(bt,this,null),Qe(ha,this)!==null&&(Qe(ha,this).unsubscribe(),ko(ha,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Qe(bt,this).getHeaderTreeNodeData(e.row,e.col)}}function Fm(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=Qe(bt,this).findLeftMostColumnIndex(n.row,n.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function Hhe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:s}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),a=s?i.row:(n=Qe(_w,this))===null||n===void 0?void 0:n.row,l=o?t:i.col,u=a<0&&l>=0;if(ko(_w,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Qe(bt,this).findLeftMostColumnIndex(a,l),m=Qe(bt,this).findRightMostColumnIndex(a,l),y=m-f+1;if(f<c&&m>h)return f;if(o){let C=null;return f>=c&&m>h?y>d?(e.value="start",C=f):(e.value="end",C=m):f<c&&m<=h&&(y>d?(e.value="end",C=m):(e.value="start",C=f)),C}return f<=c?f:m}function Nhe(t,e,n){const r=Qe(bt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:s,selectionWidth:o}=n,{isRoot:a,colspan:l}=Qe(bt,this).getHeaderSettings(e,t);if(s===zT){if(!a)return r.columnIndex}else if(s===I$&&(l>o-i||!a))return null;return t}function Dhe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],c=l-o+1,h=a-u+1;if(o>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=o;f<=l;f++){var i;const m=c+f,y=d-a;if(y===0)continue;((i=Qe(bt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[m][y]="")}}}function Lhe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function khe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;ko(tf,this,e.clone()),ko(jC,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(gC(t)||Ba(t)&&l||i$(t))&&s.push(o,o+a-1,e.row),r.selectColumns(...s)}function Fhe(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Je(e.row,-1/0,-1);e.col<c.col?h.push(u.col,s,d):e.col>c.col?h.push(l.col,s+o-1,d):h.push(s,s+o-1,d),this.hot.selection.selectColumns(...h)}function $he(){ko(jC,this,!1)}function Vhe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Qe(jC,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Qe(bt,this).getHeaderTreeNodeData(Qe(tf,this).row,Qe(tf,this).col);if(e.setHighlight(Qe(tf,this)),s>e.getWidth()||i<n||i+s-1>r){const o=Qe(bt,this).findTopMostEntireHeaderLevel(Je(n,i,i+s-1),Je(r,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function Whe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=Qe(bt,this).findLeftMostColumnIndex(n.row,n.col),s=Qe(bt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Bhe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});ko(_w,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function jhe(t){t.length=0;for(let e=0;e<Qe(bt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Uhe(t){const e=Qe(bt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const s=Qe(bt,this).findLeftMostColumnIndex(i,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(r=!1),Jn(o)&&o<t.startColumn){n=o;break}}t.startColumn=r?Qe(bt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function zhe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Yhe(t,e,n){var r;const{label:i}=(r=Qe(bt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Ghe(t,e){if(t<0)return this.hot.getCell(t,Qe(bt,this).findLeftMostColumnIndex(t,e),!0)}function qhe(){this.updatePlugin()}function Khe(t,e){e||this.updatePlugin()}function md(t,e,n){return(e=Xhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xhe(t){var e=Zhe(t,"string");return typeof e=="symbol"?e:e+""}function Zhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jhe{constructor(e,n){md(this,"hot",void 0),md(this,"data",null),md(this,"plugin",void 0),md(this,"parentReference",new WeakMap),md(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Re(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&F(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let s=!1,o=n;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),r!=null&&o===r?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&F(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,r,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Be(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(F(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),r||(r=this.mockNode()),s.__children.push(r),this.rewriteCache();const o=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[n]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),s=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(Re(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),Re(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const s=this.getRowIndex(r),o=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,o+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];F(r,s=>{i.push(this.getDataObject(s))}),F(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?r?s.__children.splice(o,n,...r):s.__children.splice(o,n):r?this.data.splice(o,n,...r):this.data.splice(o,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const s=n===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>n;let c=s?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=s||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=o===c;c.__children.splice(h,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function OD(t,e,n){return(e=Qhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qhe(t){var e=ede(t,"string");return typeof e=="symbol"?e:e+""}function ede(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SM{constructor(e,n){OD(this,"hot",void 0),OD(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Ls extends SM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),s=this.dataManager.getDataObject(r),o=n.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(F(l,c=>{c&&o.removeChild(c)}),K(n,Ls.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);o.innerHTML="",Re(0,i-1,()=>{const d=c.createElement("SPAN");K(d,Ls.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(h)}if(this.dataManager.hasChildren(s)){const c=this.hot.rootDocument.createElement("DIV");u&&Pe(c,[Ka()]),K(n,Ls.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(K(c,`${Ls.CSS_CLASSES.button} ${Ls.CSS_CLASSES.expandButton}`),u&&Pe(n,[yi(!1)])):(K(c,`${Ls.CSS_CLASSES.button} ${Ls.CSS_CLASSES.collapseButton}`),u&&Pe(n,[yi(!0)])),o.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class tde extends SM{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),F(r.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(r.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,s)=>{Re(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&F(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];F(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return F(e,s=>{i.push(s),n&&this.collapseChildRows(s,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);F(i.__children,s=>{const o=this.dataManager.getRowIndex(s);n.push(o),this.collapseChildRows(o,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return F(e,s=>{i.push(s),n&&this.expandChildRows(s,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);F(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);n.push(o),this.expandChildRows(o,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&F(s.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];F(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];F(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];F(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{F(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{F(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&F(n.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Me(e.target,Ls.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),_i(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function nde(t,e,n){rde(t,e),e.set(t,n)}function rde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ide(t,e,n){return(e=sde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sde(t){var e=ode(t,"string");return typeof e=="symbol"?e:e+""}function ode(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ade(t,e){return t.get(lde(t,e))}function lde(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var AD=new WeakMap;class ude extends SM{constructor(){super(...arguments),ide(this,"dataManager",this.plugin.dataManager),nde(this,AD,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(G_)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(q_)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Re(0,e.items.length-1,r=>{if(r===0)return F(n,(i,s)=>{e.items.splice(r+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Re(0,e.items.length-1,n=>{const r=ade(AD,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function $m(t,e,n){return(e=cde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cde(t){var e=hde(t,"string");return typeof e=="symbol"?e:e+""}function hde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dde{constructor(e){$m(this,"plugin",void 0),$m(this,"hot",void 0),$m(this,"dataManager",void 0),$m(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=r===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const y=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(y,a),y}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(o,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:s}=e;let o=!1;return Ft(i)&&(ht(pt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,s,!1),o=!0),o}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(s=>{r.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),s=i}else e[r-1]<n?(s=n-1,i=s-r+1):(i=n,s=i+r-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(i,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function fde(t,e){xB(t,e),e.add(t)}function HD(t,e,n){xB(t,e),e.set(t,n)}function xB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AR(t,e,n){return(e=gde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gde(t){var e=mde(t,"string");return typeof e=="symbol"?e:e+""}function mde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vp(t,e){return t.get(En(t,e))}function xw(t,e,n){return t.set(En(t,e),n),n}function En(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Mw="nestedRows",pde=300,ND=Mw,wde="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var UC=new WeakMap,ac=new WeakMap,Hn=new WeakSet;class Cde extends rt{constructor(){super(...arguments),fde(this,Hn),AR(this,"dataManager",null),AR(this,"headersUI",null),AR(this,"collapsedRowsMap",null),HD(this,UC,!1),HD(this,ac,!1)}static get PLUGIN_KEY(){return Mw}static get PLUGIN_PRIORITY(){return pde}isEnabled(){return!!this.hot.getSettings()[Mw]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Xf),this.dataManager=new Jhe(this,this.hot),this.collapsingUI=new tde(this,this.hot),this.headersUI=new Ls(this,this.hot),this.contextMenuUI=new ude(this,this.hot),this.rowMoveController=new dde(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Ade).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Hde).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,bde).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Sde).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Rde).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,vde).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,_de).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Tde).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,xde).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Mde).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Ide).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Pde).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Ede).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,Ode).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(Hn,e,yde).call(e,...r)}),this.addHook("beforeLoadData",n=>En(Hn,this,DD).call(this,n)),this.addHook("beforeUpdateData",n=>En(Hn,this,DD).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:ND,relativeToGroup:Za,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ND)}disableCoreAPIModifiers(){xw(ac,this,!0)}enableCoreAPIModifiers(){xw(ac,this,!1)}onModifyRowData(e){if(!vp(ac,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!vp(ac,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return vp(ac,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function yde(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function vde(t,e,n){this.collapsingUI.toggleState(t,e,n)}function bde(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),xw(UC,this,!0),this.dataManager.getData().slice()}function Sde(t){return this.contextMenuUI.appendOptions(t)}function Rde(t,e){this.headersUI.appendLevelIndicators(t,e)}function Ede(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Tde(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{xw(UC,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _de(t,e,n){const r=Array.from(n.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));n.length=0,n.push(...r)}function xde(){this.collapsingUI.collapsedRowsStash.stash()}function Mde(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Ide(){this.collapsingUI.collapsedRowsStash.stash()}function Pde(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Ode(){this.dataManager.rewriteCache()}function Ade(){this.headersUI.updateRowHeaderWidth()}function Hde(t,e){vp(UC,this)&&(e.skipRender=!0)}function DD(t){if(!V$(t)){HT(wde),this.hot.getSettings()[Mw]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function HR(t,e,n){return(e=Nde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nde(t){var e=Dde(t,"string");return typeof e=="symbol"?e:e+""}function Dde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lde{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;HR(this,"rootWindow",void 0),HR(this,"prefix",void 0),HR(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){F(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function kde(t,e,n){return(e=Fde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fde(t){var e=$de(t,"string");return typeof e=="symbol"?e:e+""}function $de(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");const LD="persistentState",Vde=0;class Wde extends rt{constructor(){super(...arguments),kde(this,"storage",void 0)}static get PLUGIN_KEY(){return LD}static get PLUGIN_PRIORITY(){return Vde}isEnabled(){return!!this.hot.getSettings()[LD]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Lde(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Bde(t,e){jde(t,e),e.add(t)}function jde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NR(t,e,n){return(e=Ude(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ude(t){var e=zde(t,"string");return typeof e=="symbol"?e:e+""}function zde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const DR="search",Yde=190,Gde="htSearchResult",qde=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Kde=function(t,e,n){return Ft(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ft(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var LR=new WeakSet;class Xde extends rt{constructor(){super(...arguments),Bde(this,LR),NR(this,"callback",qde),NR(this,"queryMethod",Kde),NR(this,"searchResultClass",Gde)}static get PLUGIN_KEY(){return DR}static get PLUGIN_PRIORITY(){return Yde}isEnabled(){return this.hot.getSettings()[DR]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[DR];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return kD(LR,e,FD).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return kD(LR,e,FD).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return Re(0,i-1,l=>{Re(0,s-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||r)(e,c,h);if(m){const y={row:l,col:u,data:c};o.push(y)}d&&d(a,l,u,c,m)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){We(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function FD(t,e,n,r,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function Vm(t,e,n){return(e=Zde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zde(t){var e=Jde(t,"string");return typeof e=="symbol"?e:e+""}function Jde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MB{constructor(e){Vm(this,"viewportWidth",void 0),Vm(this,"overwriteColumnWidthFn",void 0),Vm(this,"baseWidths",new Map),Vm(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Qde extends MB{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],s=[];let o=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),m=this.overwriteColumnWidthFn(f,d);f===m&&f>=zc?(i.push([d,m]),a+=m):f!==m&&(i.push([d,m]),s.push(d),o-=m)}),o<=zc){this.stretchedWidths.clear();return}const l=o/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,m]=h,y=m;s.includes(f)||(y=Math.round(m*l)),this.stretchedWidths.set(f,y),u=f,d<i.length-1&&(c+=y)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function $D(t,e,n){efe(t,e),e.set(t,n)}function efe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kR(t,e){return t.get(IB(t,e))}function Wm(t,e,n){return t.set(IB(t,e),n),n}function IB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bm=new WeakMap,pd=new WeakMap;class tfe extends MB{constructor(){super(...arguments),$D(this,Bm,0),$D(this,pd,-1)}prepare(e){super.prepare(e),Wm(Bm,this,0),Wm(pd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Wm(pd,this,e),Wm(Bm,this,n)}calculate(){if(kR(pd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,s]=i;return r+s},0),n=Math.max(this.viewportWidth-e+kR(Bm,this),0);this.stretchedWidths.set(kR(pd,this),n)}}function nfe(t,e){PB(t,e),e.add(t)}function jm(t,e,n){PB(t,e),e.set(t,n)}function PB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rn(t,e){return t.get(Rc(t,e))}function FR(t,e,n){return t.set(Rc(t,e),n),n}function Rc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rfe="stretchColumns";var Kn=new WeakMap,lc=new WeakMap,$R=new WeakMap,Um=new WeakMap,wd=new WeakSet;class ife{constructor(e){nfe(this,wd),jm(this,Kn,void 0),jm(this,lc,void 0),jm(this,$R,new Map([["all",new Qde(Rc(wd,this,VD).bind(this))],["last",new tfe(Rc(wd,this,VD).bind(this))]])),jm(this,Um,"none"),FR(Kn,this,e),FR(lc,this,rn(Kn,this).columnIndexMapper.createAndRegisterIndexMap(rfe,"physicalIndexToValue"))}useStrategy(e){FR(Um,this,rn($R,this).has(e)?e:"none")}refreshStretching(){if(rn(Um,this)==="none"){rn(lc,this).clear();return}rn(Kn,this).batchExecution(()=>{rn(lc,this).clear();const e=rn($R,this).get(rn(Um,this));let r=rn(Kn,this).view.getViewportWidth();Rc(wd,this,sfe).call(this)&&(r-=Ln(rn(Kn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<rn(Kn,this).countCols();i++)rn(Kn,this).columnIndexMapper.isHidden(rn(Kn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Rc(wd,this,ofe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[s,o]=i;rn(lc,this).setValueAtIndex(rn(Kn,this).toPhysicalColumn(s),o)})},!0)}getStretchedWidth(e){return rn(lc,this).getValueAtIndex(rn(Kn,this).toPhysicalColumn(e))}}function sfe(){const{view:t}=rn(Kn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=rn(Kn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,s=!1;for(let a=0;a<n;a++){var o;if(i+=((o=rn(Kn,this).getRowHeight(a))!==null&&o!==void 0?o:r)+(a===0?1:0),i>e){s=!0;break}}return s}function ofe(t){var e;return(e=rn(Kn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:zc}function VD(t,e){return rn(Kn,this).runHooks("beforeStretchingColumnWidth",t,e)}function afe(t,e){OB(t,e),e.add(t)}function VR(t,e,n){OB(t,e),e.set(t,n)}function OB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WR(t,e,n){return t.set(Iw(t,e),n),n}function vo(t,e){return t.get(Iw(t,e))}function Iw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lfe="stretchColumns",ufe=155;var wc=new WeakMap,zm=new WeakMap,Cd=new WeakMap,BR=new WeakSet;class cfe extends rt{constructor(){super(...arguments),afe(this,BR),VR(this,wc,new ife(this.hot)),VR(this,zm,null),VR(this,Cd,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;vo(zm,this)!==null&&vo(zm,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),WR(zm,this,i.width)})})}))}static get PLUGIN_KEY(){return lfe}static get PLUGIN_PRIORITY(){return ufe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(vo(wc,this).useStrategy(this.hot.getSettings().stretchH),vo(Cd,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Iw(BR,e,dfe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Iw(BR,e,hfe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){vo(wc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),vo(Cd,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return vo(wc,this).getStretchedWidth(e)}destroy(){vo(Cd,this).disconnect(),WR(Cd,this,null),WR(wc,this,null),super.destroy()}}function hfe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function dfe(t){t&&vo(wc,this).refreshStretching()}function ffe(t,e){gfe(t,e),e.add(t)}function gfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ym(t,e,n){return(e=mfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mfe(t){var e=pfe(t,"string");return typeof e=="symbol"?e:e+""}function pfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wfe="touchScroll",Cfe=200;var Gm=new WeakSet;class yfe extends rt{constructor(){super(...arguments),ffe(this,Gm),Ym(this,"scrollbars",[]),Ym(this,"clones",[]),Ym(this,"lockedCollection",!1),Ym(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return wfe}static get PLUGIN_PRIORITY(){return Cfe}static get SETTING_KEYS(){return!0}isEnabled(){return xT()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>jR(Gm,this,vfe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>jR(Gm,this,bfe).call(this)),this.addHook("afterMomentumScroll",()=>jR(Gm,this,Sfe).call(this))}}function vfe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function bfe(){this.freezeOverlays=!0,F(this.clones,t=>{K(t,"hide-tween")})}function Sfe(){this.freezeOverlays=!1,F(this.clones,t=>{_e(t,"hide-tween"),K(t,"show-tween")}),this.hot._registerTimeout(()=>{F(this.clones,t=>{_e(t,"show-tween")})},400),F(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Rfe(t,e){Efe(t,e),e.add(t)}function Efe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tfe(t,e,n){return(e=_fe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _fe(t){var e=xfe(t,"string");return typeof e=="symbol"?e:e+""}function xfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mfe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bp="trimRows",Ife=330;var WD=new WeakSet;class Pfe extends rt{constructor(){super(...arguments),Rfe(this,WD),Tfe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return bp}static get PLUGIN_PRIORITY(){return Ife}isEnabled(){return!!this.hot.getSettings()[bp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Xf),this.trimmedRowsMap.addLocalHook("init",()=>Mfe(WD,this,Ofe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[bp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),F(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{F(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;r&&o&&(F(e,l=>{s[l]=!1}),i=mn(s,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&o)!==!1&&(r&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",n,i,r&&o,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Ofe(){const t=this.hot.getSettings()[bp];Array.isArray(t)&&this.hot.batchExecution(()=>{F(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var BD={},jD;function Afe(){if(jD)return BD;jD=1;var t=Mt(),e=th(),n=mk();return t({target:"Object",stat:!0},{fromEntries:function(i){var s={};return e(i,function(o,a){n(s,o,a)},{AS_ENTRIES:!0}),s}}),BD}Afe();const AB="undoRedo",Hfe="undoRedo";function se(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,i){const s=r&&r.length;if(!s||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);F(l,c=>{c[1]=t.propToCol(c[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new se.ChangeAction(l,u)};e.done(a,i)}),t.addHook("afterCreateRow",(r,i,s)=>{e.done(()=>new se.CreateRowAction(r,i),s)});const n=(r,i,s,o)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return Re(s,o,c=>{Re(r,i,h=>{const d=t.getCellMeta(h,c);if(Object.keys(d).length!==l){const f=Object.fromEntries(Object.entries(d).filter(m=>{let[y]=m;return a.includes(y)===!1}));u.push([d.visualRow,d.visualCol,f])}})}),u};t.addHook("beforeRemoveRow",(r,i,s,o)=>{const a=()=>{const l=t.toPhysicalRow(r),u=l+i-1,c=sr(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new se.RemoveRowAction(l,c,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(l,u,0,t.countCols()-1))};e.done(a,o)}),t.addHook("afterCreateCol",(r,i,s)=>{e.done(()=>new se.CreateColumnAction(r,i),s)}),t.addHook("beforeRemoveCol",(r,i,s,o)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),c=u+i-1,h=[],d=[],f=[];Re(l.length-1,C=>{const T=[],x=l[C];Re(u,c,O=>{T.push(x[t.toPhysicalColumn(O)])}),h.push(T)}),Re(i-1,C=>{f.push(t.toPhysicalColumn(u+C))}),Array.isArray(t.getSettings().colHeaders)&&Re(i-1,C=>{d.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+C)]||null)});const m=t.columnIndexMapper.getIndexesSequence(),y=t.rowIndexMapper.getIndexesSequence();return new se.RemoveColumnAction(u,f,h,d,m,y,t.getSettings().fixedColumnsStart,n(0,t.countRows(),u,c))};e.done(a,o)}),t.addHook("beforeCellAlignment",(r,i,s,o)=>{e.done(()=>new se.CellAlignmentAction(r,i,s,o))}),t.addHook("beforeFilter",(r,i)=>{e.done(()=>new se.FiltersAction(r,i))}),t.addHook("beforeRowMove",(r,i)=>{r!==!1&&e.done(()=>new se.RowMoveAction(r,i))}),t.addHook("beforeColumnMove",(r,i)=>{r!==!1&&e.done(()=>new se.ColumnMoveAction(r,i))}),t.addHook("beforeMergeCells",(r,i)=>{i||e.done(()=>new se.MergeCellsAction(t,r))}),t.addHook("afterUnmergeCells",(r,i)=>{i||e.done(()=>new se.UnmergeCellsAction(t,r))}),t.addHook("beforeColumnSort",(r,i,s)=>{s&&e.done(()=>new se.ColumnSortAction(r,i))}),t.addHook("afterInit",()=>{e.init()})}se.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const s=t(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};se.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=sr(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};se.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=sr(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};se.prototype.isUndoAvailable=function(){return this.doneActions.length>0};se.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};se.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};se.prototype.isEnabled=function(){return this.enabled};se.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,Lfe(t),this.registerShortcuts(),t.addHook("afterChange",HB)};se.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,kfe(t),this.unregisterShortcuts(),t.removeHook("afterChange",HB)};se.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};se.Action=function(){};se.Action.prototype.undo=function(){};se.Action.prototype.redo=function(){};se.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};is(se.ChangeAction,se.Action);se.ChangeAction.prototype.undo=function(t,e){const n=sr(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,a=n.length;o<a;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,a=n.length;o<a;o++){const[l,u]=n[o];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&u+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(u+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const s=t.getSelectedLast();if(s!==void 0){const[o,a]=n[0],[l,u]=s,c=t.getFirstFullyVisibleRow(),h=t.getFirstFullyVisibleColumn(),d=o>=c,f=a>=h;if((d&&f)===!1&&(l!==o||u!==a)===!0){const C={row:o,col:a};d===!1&&(C.verticalSnap="top"),f===!1&&(C.horizontalSnap="start"),t.scrollViewportTo(C)}}t.selectCells(this.selected,!1,!1)};se.ChangeAction.prototype.redo=function(t,e){const n=sr(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};se.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};is(se.CreateRowAction,se.Action);se.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};se.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};se.RemoveRowAction=function(t,e,n,r,i,s){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i,this.removedCellMetas=s};is(se.RemoveRowAction,se.Action);se.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(o=>{const a=parseInt(o,10);r.push([this.index+s,isNaN(a)?o:a,i[o]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[s,o,a]=i;t.setCellMetaObject(s,o,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};se.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};se.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};is(se.CreateColumnAction,se.Action);se.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};se.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};se.RemoveColumnAction=function(t,e,n,r,i,s,o,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=a};is(se.RemoveColumnAction,se.Action);se.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],s=this.data.length,o=[];for(let u=0;u<s;u++)o.push(qe(this.data[u],i));const a=qe(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),F(t.getSourceDataArray(),(u,c)=>{F(r,(h,d)=>{u[h]=o[c][d],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&F(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;t.setCellMetaObject(c,h,d)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};se.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};se.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};se.CellAlignmentAction.prototype.undo=function(t,e){F(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};se.CellAlignmentAction.prototype.redo=function(t,e){ga(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,s)=>t.setCellMeta(n,r,i,s)),t.addHookOnce("afterViewRender",e),t.render()};se.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"};is(se.FiltersAction,se.Action);se.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&n.conditionCollection.importAllConditions(this.previousConditionsStack),n.filter()};se.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class Nfe extends se.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}se.MergeCellsAction=Nfe;class Dfe extends se.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}se.UnmergeCellsAction=Dfe;se.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};is(se.RowMoveAction,se.Action);se.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),wM(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),n.moveRow(o,s)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};se.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};se.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};is(se.ColumnMoveAction,se.Action);se.ColumnMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),wM(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),n.moveColumn(o,s)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};se.ColumnMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),n.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};se.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e};is(se.ColumnSortAction,se.Action);se.ColumnSortAction.prototype.undo=function(t,e){const n=t.getPlugin("columnSorting"),r=t.getPlugin("multiColumnSorting"),i=r.isEnabled()?r:n;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()};se.ColumnSortAction.prototype.redo=function(t,e){const n=t.getPlugin("columnSorting"),r=t.getPlugin("multiColumnSorting");(r.isEnabled()?r:n).sort(this.nextSortState),e()};se.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};se.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:AB};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};se.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(AB)};function HB(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function Lfe(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function kfe(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const ag=ge.getSingleton();ag.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});ag.register("beforeUndo");ag.register("afterUndo");ag.register("beforeRedo");ag.register("afterRedo");se.PLUGIN_KEY=Hfe;se.SETTING_KEYS=!0;function Ffe(){tt(Wd),tt(Dee),tt(Bd),tt(gte),tt(Ste),tt(eW),tt(pne),tt(ere),tt(FC),tt(hie),tt(kie),tt(zie),tt(WC),tt(yse),tt(pae),tt(qae),tt(ble),tt(Hle),tt(zle),tt(nue),tt(due),tt(Pue),tt($ue),tt(Sce),tt(the),tt(ohe),tt(Ahe),tt(Cde),tt(Wde),tt(Xde),tt(cfe),tt(yfe),tt(Pfe),tt(se)}function zC(){sJ(),MQ(),kQ(),ree(),Ffe()}function $fe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let s;if(i)if(typeof i[n]<"u"){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];s=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return s})}var UR,zR,YR,GR,qR;zC();$fe(Oe);Oe.__GhostTable=nM;Oe._getListenersCounter=p6;Oe._getRegisteredMapsCounter=C9;Oe.EventManager=bi;const Vfe=[XK,z3,r9,PQ,B3,F3,e3,k6,W3,n3,q3,L6],Wfe=[N3,K3];Oe.helper={};Oe.dom={};F(Vfe,t=>{F(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Oe.helper[e]=t[e])})});F(Wfe,t=>{F(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Oe.dom[e]=t[e])})});Oe.cellTypes=(UR=Oe.cellTypes)!==null&&UR!==void 0?UR:{};F(R8(),t=>{Oe.cellTypes[t]=Hx(t)});Oe.cellTypes.registerCellType=oi;Oe.cellTypes.getCellType=Hx;Oe.editors=(zR=Oe.editors)!==null&&zR!==void 0?zR:{};F(c6(),t=>{Oe.editors[`${ir(t)}Editor`]=jp(t)});Oe.editors.registerEditor=Pr;Oe.editors.getEditor=jp;Oe.renderers=(YR=Oe.renderers)!==null&&YR!==void 0?YR:{};F(J6(),t=>{const e=Up(t);t==="base"&&(Oe.renderers.cellDecorator=e),Oe.renderers[`${ir(t)}Renderer`]=e});Oe.renderers.registerRenderer=Ur;Oe.renderers.getRenderer=Up;Oe.validators=(GR=Oe.validators)!==null&&GR!==void 0?GR:{};F(t4(),t=>{Oe.validators[`${ir(t)}Validator`]=FT(t)});Oe.validators.registerValidator=Yl;Oe.validators.getValidator=FT;Oe.plugins=(qR=Oe.plugins)!==null&&qR!==void 0?qR:{};F(kT(),t=>{Oe.plugins[t]=Yf(t)});Oe.plugins[`${ir(rt.PLUGIN_KEY)}Plugin`]=rt;Oe.plugins.registerPlugin=tt;Oe.plugins.getPlugin=Yf;const Bfe={style:{"margin-bottom":"-20px"}},jfe={class:"flex items-center justify-between mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},Ufe={class:"border-b border-gray-200 bg-white px-4 py-5 sm:px-6 space-y-4"},zfe={class:"text-2xl font-semibold text-gray-900"},Yfe={class:"text-base font-semibold text-gray-900"},Gfe={class:"flex flex-wrap"},qfe={class:"rounded-lg bg-gray-100 shadow"},Kfe={class:"px-4 py-1 space-y-0 cursor-pointer"},Xfe={class:"text-center"},Zfe={class:"text-base font-semibold text-gray-900 mb-0"},Jfe=["src"],Qfe={__name:"TestResult",setup(t){zC(),fi("0.0"),fi("0.0");const e=["Apollo","Autoware","Carla","LGSVL"],n=["Merging","Lane Change","Crossing with yield signs","Crossing with traffic lights"],r={Merging:[0,5,10,15],"Lane Change":[5,10,15,20],"Crossing with yield signs":[0,5,10,15],"Crossing with traffic lights":[0,5,10,15,20]};return(i,s)=>(Xe(),mt("div",null,[j("header",Bfe,[j("div",jfe,[s[1]||(s[1]=j("h1",{class:"text-xl font-bold tracking-tight text-gray-900",style:{"margin-bottom":"5px"}},"Test Results",-1)),j("button",{onClick:s[0]||(s[0]=(...o)=>i.downloadAll&&i.downloadAll(...o)),class:"bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-1 px-3 rounded text-sm"},"Refresh")])]),j("main",null,[(Xe(),mt(_n,null,tu(e,(o,a)=>j("div",{class:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",key:a},[j("div",Ufe,[j("h1",zfe,Tn(o),1),(Xe(),mt(_n,null,tu(n,(l,u)=>j("div",{key:u},[j("h2",Yfe,Tn(l),1),j("div",Gfe,[(Xe(!0),mt(_n,null,tu(r[l],(c,h)=>(Xe(),mt("div",{class:"w-1/4 p-2",key:h},[j("div",qfe,[j("div",Kfe,[j("div",Xfe,[j("h3",Zfe,[s[2]||(s[2]=ot("v")),s[3]||(s[3]=j("sub",null,"e",-1)),ot(" = "+Tn(c),1)])]),j("img",{src:"http://127.0.0.1:5000/global_view?autopilot="+o.toLowerCase()+"&scenario="+l.replaceAll(" ","_").toLowerCase()+"&ve="+c,alt:"placeholder",class:"mt-4"},null,8,Jfe)])])]))),128))])])),64))])])),64))])]))}},ege={class:"mx-auto max-w-7xl px-2 py-8 lg:px-8 space-y-4 pb-2 sm:grid-cols-6 grid space-x-4 pr-6 lg:pl-4"},tge={class:"sm:col-span-2 sm:col-start-1"},nge={class:"mt-2 grid grid-cols-1"},rge=["disabled"],ige={class:"sm:col-span-2"},sge={class:"mt-2 grid grid-cols-1"},oge=["disabled"],age={class:"sm:col-span-2"},lge={class:"mt-2"},uge=["disabled"],cge={key:0,class:"sm:col-span-2"},hge={class:"mt-2"},dge={class:"mt-2 grid grid-cols-2"},fge={class:"flex items-center bg-white pl-3 outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"},gge=["disabled"],mge={class:"flex items-center bg-white pl-3 outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"},pge=["disabled"],wge={key:1,class:"sm:col-span-2"},Cge={class:"mt-2"},yge={class:"mt-2 grid grid-cols-2"},vge={class:"flex items-center bg-white pl-3 outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"},bge=["disabled"],Sge={class:"flex items-center bg-white pl-3 outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"},Rge=["disabled"],Ege={class:"sm:col-span-2 sm:col-start-1"},Tge={class:"mt-2"},_ge={class:"mt-2 grid grid-cols-2"},xge={class:"flex items-center bg-white pl-3 outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"},Mge=["disabled"],Ige={class:"flex items-center bg-white pl-3 outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"},Pge=["disabled"],Oge={class:"sm:col-span-2"},Age={class:"mt-2"},Hge={class:"mt-2 grid grid-cols-2"},Nge={class:"flex items-center bg-white pl-3 outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"},Dge=["disabled"],Lge={class:"flex items-center bg-white pl-3 outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"},kge=["disabled"],Fge={class:"py-0.5"},$ge=["disabled"],Vge={class:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8 space-y-4"},Wge=["hidden"],Bge={class:"px-4 py-5 sm:p-6"},jge={class:"text-base font-semibold text-gray-900",style:{"margin-bottom":"10px"}},Uge={key:0,class:"text-red-700"},zge={key:1,class:"text-red-700"},Yge={key:2,class:"text-blue-700"},Gge={key:3,class:"text-green-700"},qge={key:4,class:"text-gray-700"},Kge=["src","hidden"],Xge=["hidden"],Zge={__name:"AutomaticGeneration",setup(t){zC();const e=["Apollo","Autoware","Carla","LGSVL"],n=["Merging","Lane Change","Crossing with yield signs","Crossing with traffic lights"],r=Bc({running:"waiting",autopilot:"",scenarioType:"",ve:"",xaLower:"",xaUpper:"",xaMin:"",xaMax:"",xfLower:"",xfUpper:"",xfMin:"",xfMax:""});function i(O,b,H=!1){return isNaN(r[O])||isNaN(r[b])||parseFloat(r[O])>parseFloat(r[b])?(alert("Please enter a valid range for "+O+" and "+b),!1):!H&&(parseFloat(r[O])===0||parseFloat(r[b])===0)?(alert("Please enter a non-zero range for "+O+" and "+b),!1):parseFloat(r[O])<0||parseFloat(r[b])<0?(alert(H?"Please enter a non-negative range for "+O+" and "+b:"Please enter a positive range for "+O+" and "+b),!1):!0}function s(){return r.autopilot===""?(alert("Please select an autopilot"),!1):r.scenarioType===""?(alert("Please select a scenario type"),!1):isNaN(r.ve)?(alert("Please enter a value for ve"),!1):r.scenarioType!=="Crossing with traffic lights"&&(!i("xaLower","xaUpper",!0)||!i("xaMin","xaMax"))?!1:!i("xfLower","xfUpper",!0)||!i("xfMin","xfMax")?(alert("Please enter a range for xf"),!1):!0}const o=fi("0.0"),a=fi("0.0"),l=fi(""),u=fi(""),c=fi(!1),h=()=>{console.log("Image loaded"),c.value=!0};Xm(u,O=>{console.log("Image source changed to",O)});const d=(O,b,H,...k)=>{console.log("Button clicked",b.row,",",b.col,H,...k);const V=C.colHeaders,U=C.rowHeaders,Z=V[b.col],Y=U[b.row];let Q=`http://127.0.0.1:5000/plot?autopilot=autoware&scenario=merging&ve=10&xf=${Z}&xa=${Y}`;parseFloat(Z)>=parseFloat(y)&&parseFloat(Y)>=parseFloat(m)&&(Q+="&progress=true"),u.value=Q,c.value=!1,x.value="Selecting xa="+Y+" and xf="+Z+u.value,o.value=Y,a.value=Z,l.value=C.data[b.row][b.col]},f=(O,b,H,k,V,U,...Z)=>{Oe.renderers.TextRenderer(O,b,H,k,V,U,...Z);const Y={Running:"yellow",Aa:"pink",Ae:"pink",PS:"lightgreen",PU:"tan",CS:"lightblue",CU:"plum",Fsw:"orange",Blk:"lightgray"},Q=U;Q in Y?b.style.backgroundColor=Y[Q]:b.style.backgroundColor="white",U==="pending"&&(b.innerHTML=""),k===-1&&H===-1&&(b.innerHTML="Row Header")};let m=-1,y=-1;const C=Bc({data:[[]],colHeaders:[],rowHeaders:[],fillHandle:!1,selectionMode:"single",rowHeaderWidth:60,width:"100%",stretchH:"all",licenseKey:"non-commercial-and-evaluation",afterOnCellMouseDown:d,cells(O,b){const H={};return this.instance.getData(),H.readOnly=!0,H.renderer=f,H},afterRender:function(){const O=document.querySelector(".ht_clone_top_left_corner .htCore th");O&&(O.innerHTML="xa \\ xf",O.style.textAlign="center",O.style.verticalAlign="middle",O.style.backgroundColor="none")},afterGetColHeader(O,b){const H=b.innerText;parseFloat(H)===y&&(b.style.color="red",b.style.fontWeight="bold")},afterGetRowHeader(O,b){const H=b.innerText;parseFloat(H)===m&&(b.style.color="red",b.style.fontWeight="bold")}});async function T(){if(s()){r.running=!0;try{const O=new AbortController,b=setTimeout(()=>O.abort(),1e3),H=JSON.stringify({autopilot:r.autopilot,scenarioType:r.scenarioType,ve:r.ve,xaLower:r.xaLower,xaUpper:r.xaUpper,xaMin:r.xaMin,xaMax:r.xaMax,xfLower:r.xfLower,xfUpper:r.xfUpper,xfMin:r.xfMin,xfMax:r.xfMax});console.log("body",H);const k=await fetch("http://127.0.0.1:5000/start_running",{method:"POST",headers:{"Content-Type":"application/json"},body:H,signal:O.signal});if(clearTimeout(b),!k.ok)throw new Error(`HTTP error! status: ${k.status}`)}catch(O){O.name==="AbortError"?alert("Request timed out - please check the server is running"):alert("Failed to start running, please check the server is running"),r.running=!1}}}setInterval(async()=>{try{const O=new AbortController,b=setTimeout(()=>O.abort(),1e3),H=await fetch("http://127.0.0.1:5000/running",{signal:O.signal});clearTimeout(b);const k=await H.json();k.running===!0?(r.running=!0,console.log("content",k,C.data,C.colHeaders,C.rowHeaders),m=k.critical_value.xa,y=k.critical_value.xf,C.data.splice(0,C.data.length,...k.data),C.colHeaders.splice(0,C.colHeaders.length,...k.xfs),C.rowHeaders.splice(0,C.rowHeaders.length,...k.xas)):r.running=!1}catch(O){O.name==="AbortError"?console.error("Timeout fetching table data"):(console.error("Error fetching table data:",O),alert("Failed to fetch table data, please check the server configuration")),r.running=!1}},1e3),fi(!0);const x=fi("Hello World");return(O,b)=>(Xe(),mt("div",null,[b[36]||(b[36]=j("header",{style:{"margin-bottom":"-20px"}},[j("div",{class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},[j("h1",{class:"text-xl font-bold tracking-tight text-gray-900",style:{"margin-bottom":"5px"}},"Automatic Scenario Generation")])],-1)),j("main",null,[j("form",null,[j("div",ege,[b[29]||(b[29]=j("div",{class:"sm:col-span-3 sm:col-start-1"},null,-1)),j("div",tge,[b[13]||(b[13]=j("label",{for:"Autopilot",class:"block text-sm/6 font-medium text-gray-900"},"Autopilot",-1)),j("div",nge,[qn(j("select",{id:"autopilot",name:"autopilot","onUpdate:modelValue":b[0]||(b[0]=H=>r.autopilot=H),disabled:r.running,class:"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-8 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"},[(Xe(),mt(_n,null,tu(e,H=>j("option",{key:H},Tn(H),1)),64))],8,rge),[[Op,r.autopilot]]),b[12]||(b[12]=j("svg",{class:"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[j("path",{"fill-rule":"evenodd",d:"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})],-1))])]),j("div",ige,[b[15]||(b[15]=j("label",{for:"Scenario type",class:"block text-sm/6 font-medium text-gray-900"},"Scenario type",-1)),j("div",sge,[qn(j("select",{id:"scenarioType",name:"scenarioType","onUpdate:modelValue":b[1]||(b[1]=H=>r.scenarioType=H),disabled:r.running,class:"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-8 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"},[(Xe(),mt(_n,null,tu(n,H=>j("option",{key:H},Tn(H),1)),64))],8,oge),[[Op,r.scenarioType]]),b[14]||(b[14]=j("svg",{class:"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[j("path",{"fill-rule":"evenodd",d:"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})],-1))])]),j("div",age,[b[16]||(b[16]=j("label",{for:"ve",class:"block text-sm/6 font-medium text-gray-900"},[ot("v"),j("sub",null,"e"),ot(" (m/s)")],-1)),j("div",lge,[qn(j("input",{type:"text","onUpdate:modelValue":b[2]||(b[2]=H=>r.ve=H),disabled:r.running,class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"},null,8,uge),[[li,r.ve]])])]),r.scenarioType!=="Crossing with traffic lights"?(Xe(),mt("div",cge,[b[19]||(b[19]=j("div",{class:"col-span-2"},[j("label",{for:"xa",class:"block text-sm/6 font-medium text-gray-900"},[ot("Range of x"),j("sub",null,"a"),ot(" (m)")])],-1)),j("div",hge,[j("div",dge,[j("div",fge,[b[17]||(b[17]=j("div",{class:"shrink-0 select-none text-base text-gray-500 sm:text-sm/6"},"From",-1)),qn(j("input",{type:"text",name:"xa-lower",id:"xa-lower","onUpdate:modelValue":b[3]||(b[3]=H=>r.xaLower=H),disabled:r.running,class:"block min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",placeholder:"0.0"},null,8,gge),[[li,r.xaLower]])]),j("div",mge,[b[18]||(b[18]=j("div",{class:"shrink-0 select-none text-base text-gray-500 sm:text-sm/6"},"To",-1)),qn(j("input",{type:"text",name:"xa-upper",id:"xa-upper","onUpdate:modelValue":b[4]||(b[4]=H=>r.xaUpper=H),disabled:r.running,class:"block min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",placeholder:"320.0"},null,8,pge),[[li,r.xaUpper]])])])])])):Fo("",!0),r.scenarioType!=="Crossing with traffic lights"?(Xe(),mt("div",wge,[b[22]||(b[22]=j("div",{class:"col-span-2"},[j("label",{for:"xa",class:"block text-sm/6 font-medium text-gray-900"},[ot("Exploration step for x"),j("sub",null,"a")])],-1)),j("div",Cge,[j("div",yge,[j("div",vge,[b[20]||(b[20]=j("div",{class:"shrink-0 select-none text-base text-gray-500 sm:text-sm/6"},"Min",-1)),qn(j("input",{type:"text",name:"xa-min",id:"xa-min","onUpdate:modelValue":b[5]||(b[5]=H=>r.xaMin=H),disabled:r.running,class:"block min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",placeholder:"5.0"},null,8,bge),[[li,r.xaMin]])]),j("div",Sge,[b[21]||(b[21]=j("div",{class:"shrink-0 select-none text-base text-gray-500 sm:text-sm/6"},"Max",-1)),qn(j("input",{type:"text",name:"xa-max",id:"xa-max","onUpdate:modelValue":b[6]||(b[6]=H=>r.xaMax=H),disabled:r.running,class:"block min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",placeholder:"40.0"},null,8,Rge),[[li,r.xaMax]])])])])])):Fo("",!0),j("div",Ege,[b[25]||(b[25]=j("label",{for:"postal-code",class:"block text-sm/6 font-medium text-gray-900"},[ot("Range of x"),j("sub",null,"f"),ot(" (m)")],-1)),j("div",Tge,[j("div",_ge,[j("div",xge,[b[23]||(b[23]=j("div",{class:"shrink-0 select-none text-base text-gray-500 sm:text-sm/6"},"From",-1)),qn(j("input",{type:"text",name:"xf-lower",id:"xf-lower","onUpdate:modelValue":b[7]||(b[7]=H=>r.xfLower=H),disabled:r.running,class:"block min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",placeholder:"0.0"},null,8,Mge),[[li,r.xfLower]])]),j("div",Ige,[b[24]||(b[24]=j("div",{class:"shrink-0 select-none text-base text-gray-500 sm:text-sm/6"},"To",-1)),qn(j("input",{type:"text",name:"xf-upper",id:"xf-upper","onUpdate:modelValue":b[8]||(b[8]=H=>r.xfUpper=H),disabled:r.running,class:"block min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",placeholder:"320.0"},null,8,Pge),[[li,r.xfUpper]])])])])]),j("div",Oge,[b[28]||(b[28]=j("label",{for:"postal-code",class:"block text-sm/6 font-medium text-gray-900"},[ot("Exploration step for x"),j("sub",null,"f"),ot(" (m)")],-1)),j("div",Age,[j("div",Hge,[j("div",Nge,[b[26]||(b[26]=j("div",{class:"shrink-0 select-none text-base text-gray-500 sm:text-sm/6"},"Min",-1)),qn(j("input",{type:"text",name:"xf-min",id:"xf-min","onUpdate:modelValue":b[9]||(b[9]=H=>r.xfMin=H),disabled:r.running,class:"block min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",placeholder:"5.0"},null,8,Dge),[[li,r.xfMin]])]),j("div",Lge,[b[27]||(b[27]=j("div",{class:"shrink-0 select-none text-base text-gray-500 sm:text-sm/6"},"Max",-1)),qn(j("input",{type:"text",name:"xf-max",id:"xf-max","onUpdate:modelValue":b[10]||(b[10]=H=>r.xfMax=H),disabled:r.running,class:"block min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",placeholder:"40.0"},null,8,kge),[[li,r.xfMax]])])])])]),j("div",Fge,[j("button",{type:"button",class:Us(["ml-auto rounded-md px-3 py-2 text-xs font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 mt-8",{"bg-indigo-600 hover:bg-indigo-500 focus-visible:outline-indigo-600":!r.running,"bg-gray-400 hover:bg-gray-400 focus-visible:outline-gray-400":r.running}]),disabled:r.running,onClick:T},Tn(r.running==="waiting"?"Loading...":r.running?"Running":"Start"),11,$ge)])])]),j("div",Vge,[C.data.length>0&&C.data[0].length>0?(Xe(),nu(gL(Nx),{key:0,settings:C},null,8,["settings"])):Fo("",!0),j("div",{class:"bg-white shadow sm:rounded-lg",hidden:u.value===""},[j("div",Bge,[j("h3",jge,[b[30]||(b[30]=ot("Microscopic analysis for x")),b[31]||(b[31]=j("sub",null,"a",-1)),ot("="+Tn(o.value)+" and x",1),b[32]||(b[32]=j("sub",null,"f",-1)),ot("="+Tn(a.value),1)]),j("div",null,[b[33]||(b[33]=j("span",{class:"font-semibold text-gray-900",style:{color:"black","margin-right":"3px"}},"Verdict:  ",-1)),j("span",{class:Us(["inline-flex items-center rounded-md px-2 py-1 text-xs font-bold ring-1 ring-inset",{"bg-red-50 text-red-700 ring-red-600/10":l.value.startsWith("A"),"bg-blue-50 text-blue-700 ring-blue-600/10":l.value.startsWith("CS"),"bg-green-50 text-green-700 ring-green-600/10":l.value.startsWith("PS")}])},Tn(l.value),3),b[34]||(b[34]=ot("   ")),l.value.startsWith("Aa")?(Xe(),mt("span",Uge,"The ego vehicle is hit by the arriving vehicle")):l.value.startsWith("Ae")?(Xe(),mt("span",zge,"The ego vehicle hits the arriving vehicle")):l.value.startsWith("CS")?(Xe(),mt("span",Yge,"The ego vehicle is safely cautious")):l.value.startsWith("PS")?(Xe(),mt("span",Gge,"The ego progresses safely")):(Xe(),mt("span",qge,"Unknown verdict"))]),j("img",{src:u.value,class:"mt-2",style:{width:"70%","max-width":"600px"},onLoad:h,hidden:!c.value},null,40,Kge),j("div",{role:"status",class:"mt-4 max-w-sm animate-pulse",hidden:c.value},b[35]||(b[35]=[iE('<div class="h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-48 mb-4"></div><div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[360px] mb-2.5"></div><div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 mb-2.5"></div><div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[330px] mb-2.5"></div><div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[300px] mb-2.5"></div><div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[360px]"></div><span class="sr-only">Loading...</span>',7)]),8,Xge),j("button",{type:"button",class:"mt-2 rounded bg-white px-2 py-1 text-xs font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",onClick:b[11]||(b[11]=H=>u.value="")},"Close")])],8,Wge)])])]))}},Jge={class:"mx-auto max-w-7xl px-2 py-8 lg:px-8 space-y-4 pb-2 sm:grid-cols-6 grid space-x-4"},Qge={class:"sm:col-span-3 sm:col-start-1"},eme={class:"mt-2 grid grid-cols-1"},tme=["disabled"],nme={class:"sm:col-span-3"},rme={class:"mt-2 grid grid-cols-1"},ime=["disabled"],sme={class:"sm:col-span-2 sm:col-start-1"},ome={class:"mt-2"},ame=["disabled"],lme={key:0,class:"sm:col-span-2"},ume={class:"mt-2"},cme=["disabled"],hme={class:"sm:col-span-2"},dme={class:"mt-2"},fme=["disabled"],gme={class:"mx-auto max-w-7xl mt-6 flex items-center justify-end gap-x-6 lg:px-8 sm:px-2"},mme=["disabled"],pme={key:0,class:"mx-auto max-w-7xl mt-6 flex items-center gap-x-6 lg:px-8 sm:px-2"},wme={class:"bg-white shadow sm:rounded-lg"},Cme={class:"px-4 py-5 sm:p-6"},yme={class:"flex"},vme={class:"text-base font-semibold",style:{"margin-bottom":"10px"}},bme={class:"text-blue-700"},Sme={class:"text-blue-700"},Rme={class:"text-blue-700"},Eme={key:0},Tme={key:0,class:"text-red-700"},_me={key:1,class:"text-red-700"},xme={key:2,class:"text-blue-700"},Mme={key:3,class:"text-green-700"},Ime={key:4,class:"text-yellow-900"},Pme={key:5,class:"text-purple-700"},Ome={key:6,class:"text-gray-700"},Ame={__name:"SingleRun",setup(t){const e=Bc({running:!1,autopilot:"",scenarioType:"",ve:"",xa:"",xf:""}),n=fi(!1);function r(){return e.autopilot===""?(alert("Please select an autopilot"),!1):e.scenarioType===""?(alert("Please select a scenario type"),!1):e.ve===""||isNaN(e.ve)||e.ve<0?(alert("Please input the value of ve"),!1):e.scenarioType!=="Crossing with traffic lights"&&(e.xa===""||isNaN(e.xa)||e.xa<0)?(alert("Please input the value of xa"),!1):e.xf===""||isNaN(e.xf)||e.xf<0?(alert("Please input the value of xf"),!1):e.scenarioType==="Lane change"&&e.ve<5?(alert("The speed of the ego vehicle must be greater than 5 m/s for the lane change scenario"),!1):!0}async function i(){if(r()){n.value=JSON.parse(JSON.stringify(e)),e.running=!0;try{const l=await fetch("http://127.0.0.1:5000/single_run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);a.value="Run";const u=await l.json();u.success===!1?alert(u.message):a.value=u,e.running=!1}catch(l){alert("Request error: "+l.message),e.running=!1}}}const s=["Merging","Lane change","Crossing with yield signs","Crossing with traffic lights"],o=["Apollo","Autoware","Carla","LGSVL"],a=fi("");return(l,u)=>(Xe(),mt("div",null,[u[25]||(u[25]=j("header",{style:{"margin-bottom":"-20px"}},[j("div",{class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},[j("h1",{class:"text-xl font-bold tracking-tight text-gray-900",style:{"margin-bottom":"5px"}}," Setting parameter values ")])],-1)),j("main",null,[j("form",null,[j("div",Jge,[u[13]||(u[13]=j("div",{class:"sm:col-span-3 sm:col-start-1"},null,-1)),j("div",Qge,[u[7]||(u[7]=j("label",{for:"Autopilot",class:"block text-sm/6 font-medium text-gray-900"},"Autopilot",-1)),j("div",eme,[qn(j("select",{disabled:e.running,id:"autopilot",name:"autopilot","onUpdate:modelValue":u[0]||(u[0]=c=>e.autopilot=c),class:"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-8 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"},[(Xe(),mt(_n,null,tu(o,c=>j("option",{key:c},Tn(c),1)),64))],8,tme),[[Op,e.autopilot]]),u[6]||(u[6]=j("svg",{class:"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[j("path",{"fill-rule":"evenodd",d:"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})],-1))])]),j("div",nme,[u[9]||(u[9]=j("label",{for:"Scenario type",class:"block text-sm/6 font-medium text-gray-900"},"Scenario type",-1)),j("div",rme,[qn(j("select",{disabled:e.running,id:"scenarioType",name:"scenarioType","onUpdate:modelValue":u[1]||(u[1]=c=>e.scenarioType=c),class:"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-8 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"},[(Xe(),mt(_n,null,tu(s,c=>j("option",{key:c},Tn(c),1)),64))],8,ime),[[Op,e.scenarioType]]),u[8]||(u[8]=j("svg",{class:"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[j("path",{"fill-rule":"evenodd",d:"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})],-1))])]),j("div",sme,[u[10]||(u[10]=j("label",{for:"ve",class:"block text-sm/6 font-medium text-gray-900"},[ot("v"),j("sub",null,"e"),ot(" (m/s)")],-1)),j("div",ome,[qn(j("input",{disabled:e.running,type:"text",name:"ve",id:"ve","onUpdate:modelValue":u[2]||(u[2]=c=>e.ve=c),class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"},null,8,ame),[[li,e.ve]])])]),e.scenarioType!=="Crossing with traffic lights"?(Xe(),mt("div",lme,[u[11]||(u[11]=j("label",{for:"xa",class:"block text-sm/6 font-medium text-gray-900"},[ot("x"),j("sub",null,"a"),ot(" (m)")],-1)),j("div",ume,[qn(j("input",{disabled:e.running,type:"text",name:"region",id:"region","onUpdate:modelValue":u[3]||(u[3]=c=>e.xa=c),class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"},null,8,cme),[[li,e.xa]])])])):Fo("",!0),j("div",hme,[u[12]||(u[12]=j("label",{for:"postal-code",class:"block text-sm/6 font-medium text-gray-900"},[ot("x"),j("sub",null,"f"),ot(" (m)")],-1)),j("div",dme,[qn(j("input",{disabled:e.running,type:"text",name:"postal-code",id:"postal-code","onUpdate:modelValue":u[4]||(u[4]=c=>e.xf=c),class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"},null,8,fme),[[li,e.xf]])])])]),j("div",gme,[j("button",{disabled:e.running,type:"button",class:Us(e.running?"rounded-md bg-gray-400 px-3 py-2 text-sm font-semibold text-white shadow-sm":"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"),onClick:sz(i,["prevent"])},Tn(e.running?"Running...":"Run"),11,mme)])]),a.value.result?(Xe(),mt("div",pme,[j("div",wme,[j("div",Cme,[j("div",yme,[j("h3",vme,[u[20]||(u[20]=ot("Result for ")),j("text",bme,Tn(n.value.autopilot),1),u[21]||(u[21]=ot(" Autopilot in ")),j("text",Sme,Tn(n.value.scenarioType),1),u[22]||(u[22]=ot(" scenario with ")),j("text",Rme,[u[16]||(u[16]=ot("v")),u[17]||(u[17]=j("sub",null,"e",-1)),ot("="+Tn(n.value.ve)+" m/s",1),n.value.scenarioType!=="Crossing with traffic lights"?(Xe(),mt("text",Eme,[u[14]||(u[14]=ot(", x")),u[15]||(u[15]=j("sub",null,"a",-1)),ot("="+Tn(n.value.xa)+" m",1)])):Fo("",!0),u[18]||(u[18]=ot(", x")),u[19]||(u[19]=j("sub",null,"f",-1)),ot("="+Tn(n.value.xf)+" m",1)])]),j("button",{type:"button",class:"mb-3 ml-4 rounded bg-white px-2 py-1 text-[10px] font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",onClick:u[5]||(u[5]=c=>a.value="")},"Close")]),j("div",null,[u[23]||(u[23]=j("span",{class:"font-semibold text-gray-900",style:{color:"black","margin-right":"3px"}},"Verdict:  ",-1)),j("span",{class:Us(["inline-flex items-center rounded-md px-2 py-1 text-xs font-bold ring-1 ring-inset",{"bg-red-50 text-red-700 ring-red-600/10":a.value.result.verdict.startsWith("A"),"bg-blue-50 text-blue-700 ring-blue-600/10":a.value.result.verdict.startsWith("CS"),"bg-green-50 text-green-700 ring-green-600/10":a.value.result.verdict.startsWith("PS"),"bg-purple-50 text-purple-700 ring-purple-600/10":a.value.result.verdict.startsWith("CU"),"bg-yellow-50 text-yellow-900 ring-yellow-900/10":a.value.result.verdict.startsWith("PU")}])},Tn(a.value.result.verdict),3),u[24]||(u[24]=ot("   ")),a.value.result.verdict.startsWith("Aa")?(Xe(),mt("span",Tme,"The ego vehicle is hit by the arriving vehicle")):a.value.result.verdict.startsWith("Ae")?(Xe(),mt("span",_me,"The ego vehicle hits the arriving vehicle")):a.value.result.verdict.startsWith("CS")?(Xe(),mt("span",xme,"The ego vehicle is safely cautious")):a.value.result.verdict.startsWith("PS")?(Xe(),mt("span",Mme,"The ego progresses safely")):a.value.result.verdict.startsWith("PU")?(Xe(),mt("span",Ime,"The ego progresses unsafely")):a.value.result.verdict.startsWith("CU")?(Xe(),mt("span",Pme,"The ego is unsafely cautious")):(Xe(),mt("span",Ome,"Unknown verdict"))])])])])):Fo("",!0)])]))}},Hme={class:"min-h-full"},Nme={class:"bg-white shadow-sm"},Dme={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},Lme={class:"flex h-16 justify-between"},kme={class:"flex"},Fme={class:"hidden sm:-my-px sm:ml-6 sm:flex sm:space-x-8"},$me={class:"py-10"},Vme={__name:"App",setup(t){zC();const e=fi("automatic-generation");return(n,r)=>(Xe(),mt("div",Hme,[j("nav",Nme,[j("div",Dme,[j("div",Lme,[j("div",kme,[r[3]||(r[3]=j("div",{class:"flex shrink-0 items-center"},"CCTest",-1)),j("div",Fme,[j("a",{href:"#",class:Us(e.value==="test-result"?"inline-flex items-center border-b-2 border-indigo-500 px-1 pt-1 text-sm font-medium text-gray-900":"inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700"),onClick:r[0]||(r[0]=i=>e.value="test-result")},"Test result",2),j("a",{href:"#",class:Us(e.value==="automatic-generation"?"inline-flex items-center border-b-2 border-indigo-500 px-1 pt-1 text-sm font-medium text-gray-900":"inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700"),onClick:r[1]||(r[1]=i=>e.value="automatic-generation")},"Automatic Generation",2),j("a",{href:"#",class:Us(e.value==="manual-run"?"inline-flex items-center border-b-2 border-indigo-500 px-1 pt-1 text-sm font-medium text-gray-900":"inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700"),onClick:r[2]||(r[2]=i=>e.value="manual-run")},"Run Configuration",2)])]),r[4]||(r[4]=iE('<div class="-mr-2 flex items-center sm:hidden"><button type="button" class="relative inline-flex items-center justify-center rounded-md bg-white p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" aria-controls="mobile-menu" aria-expanded="false"><span class="absolute -inset-0.5"></span><span class="sr-only">Open main menu</span><svg class="block size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg><svg class="hidden size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg></button></div>',1))])]),r[5]||(r[5]=iE('<div class="sm:hidden" id="mobile-menu"><div class="space-y-1 pb-3 pt-2"><a href="#" class="block border-l-4 border-indigo-500 bg-indigo-50 py-2 pl-3 pr-4 text-base font-medium text-indigo-700" aria-current="page">Test Results</a><a href="#" class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-800">Team</a><a href="#" class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-800">Projects</a><a href="#" class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-800">Calendar</a></div><div class="border-t border-gray-200 pb-3 pt-4"><div class="flex items-center px-4"><div class="shrink-0"><img class="size-10 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=facearea&amp;facepad=2&amp;w=256&amp;h=256&amp;q=80" alt=""></div><div class="ml-3"><div class="text-base font-medium text-gray-800">Tom Cook</div><div class="text-sm font-medium text-gray-500">tom@example.com</div></div><button type="button" class="relative ml-auto shrink-0 rounded-full bg-white p-1 text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"><span class="absolute -inset-1.5"></span><span class="sr-only">View notifications</span><svg class="size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon"><path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"></path></svg></button></div><div class="mt-3 space-y-1"><a href="#" class="block px-4 py-2 text-base font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-800">Your Profile</a><a href="#" class="block px-4 py-2 text-base font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-800">Settings</a><a href="#" class="block px-4 py-2 text-base font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-800">Sign out</a></div></div></div>',1))]),j("div",$me,[e.value==="test-result"?(Xe(),nu(Qfe,{key:0})):Fo("",!0),e.value==="automatic-generation"?(Xe(),nu(Zge,{key:1})):Fo("",!0),e.value==="manual-run"?(Xe(),nu(Ame,{key:2})):Fo("",!0)])]))}};lz(Vme).mount("#app")});export default Wme();
